typedef unsigned char   undefined;

typedef unsigned char    bool;
typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned char    uchar;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined7;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    word;
typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef longlong __quad_t;

typedef __quad_t __off64_t;

typedef ulong size_t;

struct _IO_FILE {
    int _flags;
    char *_IO_read_ptr;
    char *_IO_read_end;
    char *_IO_read_base;
    char *_IO_write_base;
    char *_IO_write_ptr;
    char *_IO_write_end;
    char *_IO_buf_base;
    char *_IO_buf_end;
    char *_IO_save_base;
    char *_IO_backup_base;
    char *_IO_save_end;
    struct _IO_marker *_markers;
    struct _IO_FILE *_chain;
    int _fileno;
    int _flags2;
    __off_t _old_offset;
    ushort _cur_column;
    char _vtable_offset;
    char _shortbuf[1];
    _IO_lock_t *_lock;
    __off64_t _offset;
    void *__pad1;
    void *__pad2;
    void *__pad3;
    void *__pad4;
    size_t __pad5;
    int _mode;
    char _unused2[40];
};

struct _IO_marker {
    struct _IO_marker *_next;
    struct _IO_FILE *_sbuf;
    int _pos;
};

typedef struct stat stat, *Pstat;

typedef ulonglong __u_quad_t;

typedef __u_quad_t __dev_t;

typedef ulong __ino_t;

typedef uint __mode_t;

typedef uint __nlink_t;

typedef uint __uid_t;

typedef uint __gid_t;

typedef long __blksize_t;

typedef long __blkcnt_t;

typedef struct timespec timespec, *Ptimespec;

typedef long __time_t;

struct timespec {
    __time_t tv_sec;
    long tv_nsec;
};

struct stat {
    __dev_t st_dev;
    ushort __pad1;
    __ino_t st_ino;
    __mode_t st_mode;
    __nlink_t st_nlink;
    __uid_t st_uid;
    __gid_t st_gid;
    __dev_t st_rdev;
    ushort __pad2;
    __off_t st_size;
    __blksize_t st_blksize;
    __blkcnt_t st_blocks;
    struct timespec st_atim;
    struct timespec st_mtim;
    struct timespec st_ctim;
    ulong __unused4;
    ulong __unused5;
};

typedef void *__gnuc_va_list;

typedef struct timezone timezone, *Ptimezone;

struct timezone {
    int tz_minuteswest;
    int tz_dsttime;
};

typedef __time_t time_t;

typedef int __clockid_t;

typedef __clockid_t clockid_t;

typedef struct timeval timeval, *Ptimeval;

typedef long __suseconds_t;

struct timeval {
    __time_t tv_sec;
    __suseconds_t tv_usec;
};

typedef struct timezone *__timezone_ptr_t;

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
    long tm_gmtoff;
    char *tm_zone;
};

typedef struct in_addr in_addr, *Pin_addr;

typedef uint uint32_t;

typedef uint32_t in_addr_t;

struct in_addr {
    in_addr_t s_addr;
};

typedef struct _IO_FILE FILE;

typedef int __ssize_t;

typedef __ssize_t ssize_t;

typedef int __pid_t;

typedef uint __useconds_t;

typedef struct evp_pkey_ctx_st evp_pkey_ctx_st, *Pevp_pkey_ctx_st;

struct evp_pkey_ctx_st {
};

typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;

typedef struct __dirstream __dirstream, *P__dirstream;

struct __dirstream {
};

typedef struct __dirstream DIR;

typedef struct dirent dirent, *Pdirent;

struct dirent {
    __ino_t d_ino;
    __off_t d_off;
    ushort d_reclen;
    uchar d_type;
    char d_name[256];
};

typedef struct __pthread_internal_slist __pthread_internal_slist, *P__pthread_internal_slist;

struct __pthread_internal_slist {
    struct __pthread_internal_slist *__next;
};

typedef union pthread_mutex_t pthread_mutex_t, *Ppthread_mutex_t;

typedef struct __pthread_mutex_s __pthread_mutex_s, *P__pthread_mutex_s;

typedef union _union_13 _union_13, *P_union_13;

typedef struct __pthread_internal_slist __pthread_slist_t;

union _union_13 {
    int __spins;
    __pthread_slist_t __list;
};

struct __pthread_mutex_s {
    int __lock;
    uint __count;
    int __owner;
    int __kind;
    uint __nusers;
    union _union_13 field5_0x14;
};

union pthread_mutex_t {
    struct __pthread_mutex_s __data;
    char __size[24];
    long __align;
};

typedef union pthread_mutexattr_t pthread_mutexattr_t, *Ppthread_mutexattr_t;

union pthread_mutexattr_t {
    char __size[4];
    int __align;
};

typedef ulong pthread_t;

typedef union pthread_attr_t pthread_attr_t, *Ppthread_attr_t;

union pthread_attr_t {
    char __size[36];
    long __align;
};

typedef struct Elf32_Phdr Elf32_Phdr, *PElf32_Phdr;

typedef enum Elf_ProgramHeaderType_ARM {
    PT_NULL=0,
    PT_LOAD=1,
    PT_DYNAMIC=2,
    PT_INTERP=3,
    PT_NOTE=4,
    PT_SHLIB=5,
    PT_PHDR=6,
    PT_TLS=7,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_STACK=1685382481,
    PT_GNU_RELRO=1685382482,
    PT_ARM_EXIDX=1879048192
} Elf_ProgramHeaderType_ARM;

struct Elf32_Phdr {
    enum Elf_ProgramHeaderType_ARM p_type;
    dword p_offset;
    dword p_vaddr;
    dword p_paddr;
    dword p_filesz;
    dword p_memsz;
    dword p_flags;
    dword p_align;
};

typedef struct Elf32_Sym Elf32_Sym, *PElf32_Sym;

struct Elf32_Sym {
    dword st_name;
    dword st_value;
    dword st_size;
    byte st_info;
    byte st_other;
    word st_shndx;
};

typedef enum Elf32_DynTag_ARM {
    DT_NULL=0,
    DT_NEEDED=1,
    DT_PLTRELSZ=2,
    DT_PLTGOT=3,
    DT_HASH=4,
    DT_STRTAB=5,
    DT_SYMTAB=6,
    DT_RELA=7,
    DT_RELASZ=8,
    DT_RELAENT=9,
    DT_STRSZ=10,
    DT_SYMENT=11,
    DT_INIT=12,
    DT_FINI=13,
    DT_SONAME=14,
    DT_RPATH=15,
    DT_SYMBOLIC=16,
    DT_REL=17,
    DT_RELSZ=18,
    DT_RELENT=19,
    DT_PLTREL=20,
    DT_DEBUG=21,
    DT_TEXTREL=22,
    DT_JMPREL=23,
    DT_BIND_NOW=24,
    DT_INIT_ARRAY=25,
    DT_FINI_ARRAY=26,
    DT_INIT_ARRAYSZ=27,
    DT_FINI_ARRAYSZ=28,
    DT_RUNPATH=29,
    DT_FLAGS=30,
    DT_PREINIT_ARRAY=32,
    DT_PREINIT_ARRAYSZ=33,
    DT_RELRSZ=35,
    DT_RELR=36,
    DT_RELRENT=37,
    DT_ANDROID_REL=1610612751,
    DT_ANDROID_RELSZ=1610612752,
    DT_ANDROID_RELA=1610612753,
    DT_ANDROID_RELASZ=1610612754,
    DT_ANDROID_RELR=1879040000,
    DT_ANDROID_RELRSZ=1879040001,
    DT_ANDROID_RELRENT=1879040003,
    DT_GNU_PRELINKED=1879047669,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_CHECKSUM=1879047672,
    DT_PLTPADSZ=1879047673,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_FEATURE_1=1879047676,
    DT_POSFLAG_1=1879047677,
    DT_SYMINSZ=1879047678,
    DT_SYMINENT=1879047679,
    DT_GNU_XHASH=1879047924,
    DT_GNU_HASH=1879047925,
    DT_TLSDESC_PLT=1879047926,
    DT_TLSDESC_GOT=1879047927,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_LIBLIST=1879047929,
    DT_CONFIG=1879047930,
    DT_DEPAUDIT=1879047931,
    DT_AUDIT=1879047932,
    DT_PLTPAD=1879047933,
    DT_MOVETAB=1879047934,
    DT_SYMINFO=1879047935,
    DT_VERSYM=1879048176,
    DT_RELACOUNT=1879048185,
    DT_RELCOUNT=1879048186,
    DT_FLAGS_1=1879048187,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_AUXILIARY=2147483645,
    DT_FILTER=2147483647
} Elf32_DynTag_ARM;

typedef struct Elf32_Rel Elf32_Rel, *PElf32_Rel;

struct Elf32_Rel {
    dword r_offset; // location to apply the relocation action
    dword r_info; // the symbol table index and the type of relocation
};

typedef enum Elf_SectionHeaderType_ARM {
    SHT_NULL=0,
    SHT_PROGBITS=1,
    SHT_SYMTAB=2,
    SHT_STRTAB=3,
    SHT_RELA=4,
    SHT_HASH=5,
    SHT_DYNAMIC=6,
    SHT_NOTE=7,
    SHT_NOBITS=8,
    SHT_REL=9,
    SHT_SHLIB=10,
    SHT_DYNSYM=11,
    SHT_INIT_ARRAY=14,
    SHT_FINI_ARRAY=15,
    SHT_PREINIT_ARRAY=16,
    SHT_GROUP=17,
    SHT_SYMTAB_SHNDX=18,
    SHT_ANDROID_REL=1610612737,
    SHT_ANDROID_RELA=1610612738,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_CHECKSUM=1879048184,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_syminfo=1879048188,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191,
    SHT_ARM_EXIDX=1879048193,
    SHT_ARM_PREEMPTMAP=1879048194,
    SHT_ARM_ATTRIBUTES=1879048195,
    SHT_ARM_DEBUGOVERLAY=1879048196,
    SHT_ARM_OVERLAYSECTION=1879048197
} Elf_SectionHeaderType_ARM;

typedef struct Elf32_Shdr Elf32_Shdr, *PElf32_Shdr;

struct Elf32_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType_ARM sh_type;
    dword sh_flags;
    dword sh_addr;
    dword sh_offset;
    dword sh_size;
    dword sh_link;
    dword sh_info;
    dword sh_addralign;
    dword sh_entsize;
};

typedef struct Elf32_Dyn_ARM Elf32_Dyn_ARM, *PElf32_Dyn_ARM;

struct Elf32_Dyn_ARM {
    enum Elf32_DynTag_ARM d_tag;
    dword d_val;
};

typedef struct Elf32_Ehdr Elf32_Ehdr, *PElf32_Ehdr;

struct Elf32_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_osabi;
    byte e_ident_abiversion;
    byte e_ident_pad[7];
    word e_type;
    word e_machine;
    dword e_version;
    dword e_entry;
    dword e_phoff;
    dword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};




int _init(EVP_PKEY_CTX *ctx)

{
  return (int)ctx;
}



void BSA_TmQosInit(void)

{
  BSA_TmQosInit();
  return;
}



void BSA_BleClRefreshInit(void)

{
  BSA_BleClRefreshInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int tolower(int __c)

{
  int iVar1;
  
  iVar1 = tolower(__c);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void rewind(FILE *__stream)

{
  rewind(__stream);
  return;
}



void BSA_BleClNotifDeregisterInit(void)

{
  BSA_BleClNotifDeregisterInit();
  return;
}



void BSA_HhDisable(void)

{
  BSA_HhDisable();
  return;
}



void BSA_BleSeCloseInit(void)

{
  BSA_BleSeCloseInit();
  return;
}



void BSA_BleClAppRegister(void)

{
  BSA_BleClAppRegister();
  return;
}



void BSA_DmSetConfigInit(void)

{
  BSA_DmSetConfigInit();
  return;
}



void BSA_BleClGetNextCharDescrInit(void)

{
  BSA_BleClGetNextCharDescrInit();
  return;
}



void __register_frame_info(void)

{
  __register_frame_info();
  return;
}



void BSA_BleClCacheLoad(void)

{
  BSA_BleClCacheLoad();
  return;
}



void BSA_BleClRefresh(void)

{
  BSA_BleClRefresh();
  return;
}



void BSA_SecSpCfmReplyInit(void)

{
  BSA_SecSpCfmReplyInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strftime(char *__s,size_t __maxsize,char *__format,tm *__tp)

{
  size_t sVar1;
  
  sVar1 = strftime(__s,__maxsize,__format,__tp);
  return sVar1;
}



void BSA_DmSetLocalDiRecord(void)

{
  BSA_DmSetLocalDiRecord();
  return;
}



void BSA_BleSeConnect(void)

{
  BSA_BleSeConnect();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * calloc(size_t __nmemb,size_t __size)

{
  void *pvVar1;
  
  pvVar1 = calloc(__nmemb,__size);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int * __errno_location(void)

{
  int *piVar1;
  
  piVar1 = __errno_location();
  return piVar1;
}



void duss_hal_device_open(void)

{
  duss_hal_device_open();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int inet_aton(char *__cp,in_addr *__inp)

{
  int iVar1;
  
  iVar1 = inet_aton(__cp,__inp);
  return iVar1;
}



void GKI_freebuf(void)

{
  GKI_freebuf();
  return;
}



void duss_osal_timer_create(void)

{
  duss_osal_timer_create();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int clock_gettime(clockid_t __clock_id,timespec *__tp)

{
  int iVar1;
  
  iVar1 = clock_gettime(__clock_id,__tp);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int open(char *__file,int __oflag,...)

{
  int iVar1;
  
  iVar1 = open(__file,__oflag);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_attr_setdetachstate(pthread_attr_t *__attr,int __detachstate)

{
  int iVar1;
  
  iVar1 = pthread_attr_setdetachstate(__attr,__detachstate);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)

{
  size_t sVar1;
  
  sVar1 = fwrite(__ptr,__size,__n,__s);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int system(char *__command)

{
  int iVar1;
  
  iVar1 = system(__command);
  return iVar1;
}



void BSA_BleClAppDeregister(void)

{
  BSA_BleClAppDeregister();
  return;
}



void BSA_BleSeAppRegister(void)

{
  BSA_BleSeAppRegister();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long telldir(DIR *__dirp)

{
  long lVar1;
  
  lVar1 = telldir(__dirp);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int usleep(__useconds_t __useconds)

{
  int iVar1;
  
  iVar1 = usleep(__useconds);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memcpy(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memcpy(__dest,__src,__n);
  return pvVar1;
}



void BSA_TmCoexOpInit(void)

{
  BSA_TmCoexOpInit();
  return;
}



void BSA_BleClReadInit(void)

{
  BSA_BleClReadInit();
  return;
}



void BSA_BleClAppDeregisterInit(void)

{
  BSA_BleClAppDeregisterInit();
  return;
}



void BSA_BleClGetFirstCharInit(void)

{
  BSA_BleClGetFirstCharInit();
  return;
}



void BSA_BleApcfCfgInit(void)

{
  BSA_BleApcfCfgInit();
  return;
}



void duss_hal_device_close(void)

{
  duss_hal_device_close();
  return;
}



void BSA_TmSetTraceLevel(void)

{
  BSA_TmSetTraceLevel();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * realloc(void *__ptr,size_t __size)

{
  void *pvVar1;
  
  pvVar1 = realloc(__ptr,__size);
  return pvVar1;
}



void BSA_DmGetConfigInit(void)

{
  BSA_DmGetConfigInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_init(pthread_mutex_t *__mutex,pthread_mutexattr_t *__mutexattr)

{
  int iVar1;
  
  iVar1 = pthread_mutex_init(__mutex,__mutexattr);
  return iVar1;
}



void bdcpy(void)

{
  bdcpy();
  return;
}



void duss_osal_task_sleep(void)

{
  duss_osal_task_sleep();
  return;
}



void BSA_HhCloseInit(void)

{
  BSA_HhCloseInit();
  return;
}



void BSA_TmReadVersionInit(void)

{
  BSA_TmReadVersionInit();
  return;
}



void BSA_TmDisconnectInit(void)

{
  BSA_TmDisconnectInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strspn(char *__s,char *__accept)

{
  size_t sVar1;
  
  sVar1 = strspn(__s,__accept);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_attr_init(pthread_attr_t *__attr)

{
  int iVar1;
  
  iVar1 = pthread_attr_init(__attr);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int gettimeofday(timeval *__tv,__timezone_ptr_t __tz)

{
  int iVar1;
  
  iVar1 = gettimeofday(__tv,__tz);
  return iVar1;
}



void BSA_BleClSearchInit(void)

{
  BSA_BleClSearchInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int feof(FILE *__stream)

{
  int iVar1;
  
  iVar1 = feof(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int scanf(char *__format,...)

{
  int iVar1;
  
  iVar1 = scanf(__format);
  return iVar1;
}



void BSA_BleClClose(void)

{
  BSA_BleClClose();
  return;
}



void BSA_BleSeAddCharInit(void)

{
  BSA_BleSeAddCharInit();
  return;
}



void BSA_SecPinCodeReplyInit(void)

{
  BSA_SecPinCodeReplyInit();
  return;
}



void BSA_SecSpCfmReply(void)

{
  BSA_SecSpCfmReply();
  return;
}



void BSA_BleClConnect(void)

{
  BSA_BleClConnect();
  return;
}



void BSA_SecSetRemoteOOBInit(void)

{
  BSA_SecSetRemoteOOBInit();
  return;
}



void duss_event_resp_ok(void)

{
  duss_event_resp_ok();
  return;
}



void BSA_HhGet(void)

{
  BSA_HhGet();
  return;
}



void BSA_TmReadVersion(void)

{
  BSA_TmReadVersion();
  return;
}



void BSA_TmGetMemUsage(void)

{
  BSA_TmGetMemUsage();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void seekdir(DIR *__dirp,long __pos)

{
  seekdir(__dirp,__pos);
  return;
}



void BSA_TmVscInit(void)

{
  BSA_TmVscInit();
  return;
}



void BSA_BleClSearch(void)

{
  BSA_BleClSearch();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ulong strtoul(char *__nptr,char **__endptr,int __base)

{
  ulong uVar1;
  
  uVar1 = strtoul(__nptr,__endptr,__base);
  return uVar1;
}



void BSA_SecBondCancelInit(void)

{
  BSA_SecBondCancelInit();
  return;
}



void BSA_BleClGetFirstChar(void)

{
  BSA_BleClGetFirstChar();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * malloc(size_t __size)

{
  void *pvVar1;
  
  pvVar1 = malloc(__size);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strrchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strrchr(__s,__c);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = strncmp(__s1,__s2,__n);
  return iVar1;
}



void duss_sketch_initialize(void)

{
  duss_sketch_initialize();
  return;
}



void duss_log_print(void)

{
  duss_log_print();
  return;
}



void BSA_SecSpPasskeyReply(void)

{
  BSA_SecSpPasskeyReply();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ioctl(int __fd,ulong __request,...)

{
  int iVar1;
  
  iVar1 = ioctl(__fd,__request);
  return iVar1;
}



void BSA_BleClGetNextCharInit(void)

{
  BSA_BleClGetNextCharInit();
  return;
}



void BSA_BleClWrite(void)

{
  BSA_BleClWrite();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  
  sVar1 = strlen(__s);
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_lock(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_lock(__mutex);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

DIR * opendir(char *__name)

{
  DIR *pDVar1;
  
  pDVar1 = opendir(__name);
  return pDVar1;
}



void BSA_BleClCloseInit(void)

{
  BSA_BleClCloseInit();
  return;
}



void BSA_TmSetTraceLevelInit(void)

{
  BSA_TmSetTraceLevelInit();
  return;
}



void BSA_BleSeAddChar(void)

{
  BSA_BleSeAddChar();
  return;
}



void duss_util_crc16_append(void)

{
  duss_util_crc16_append();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long strtol(char *__nptr,char **__endptr,int __base)

{
  long lVar1;
  
  lVar1 = strtol(__nptr,__endptr,__base);
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__off_t lseek(int __fd,__off_t __offset,int __whence)

{
  __off_t _Var1;
  
  _Var1 = lseek(__fd,__offset,__whence);
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int snprintf(char *__s,size_t __maxlen,char *__format,...)

{
  int iVar1;
  
  iVar1 = snprintf(__s,__maxlen,__format);
  return iVar1;
}



void BSA_SecAddDevice(void)

{
  BSA_SecAddDevice();
  return;
}



void duss_hal_gpio_set_value(void)

{
  duss_hal_gpio_set_value();
  return;
}



void BSA_BleWakeEnableInit(void)

{
  BSA_BleWakeEnableInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  
  sVar1 = read(__fd,__buf,__nbytes);
  return sVar1;
}



void BSA_DiscAbort(void)

{
  BSA_DiscAbort();
  return;
}



void BSA_BleSeSendRspInit(void)

{
  BSA_BleSeSendRspInit();
  return;
}



void BSA_BleApcfEnableInit(void)

{
  BSA_BleApcfEnableInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * localtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  
  ptVar1 = localtime_r(__timer,__tp);
  return ptVar1;
}



void BSA_TmVseDeregister(void)

{
  BSA_TmVseDeregister();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int rand_r(uint *__seed)

{
  int iVar1;
  
  iVar1 = rand_r(__seed);
  return iVar1;
}



void BSA_BleSeStopServiceInit(void)

{
  BSA_BleSeStopServiceInit();
  return;
}



void BSA_TmSetTraceTextInit(void)

{
  BSA_TmSetTraceTextInit();
  return;
}



void BSA_BleSeStopService(void)

{
  BSA_BleSeStopService();
  return;
}



void duss_hal_gpio_get_value(void)

{
  duss_hal_gpio_get_value();
  return;
}



void BSA_SecPinCodeReply(void)

{
  BSA_SecPinCodeReply();
  return;
}



void duss_mb_create_route_table(void)

{
  duss_mb_create_route_table();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int access(char *__name,int __type)

{
  int iVar1;
  
  iVar1 = access(__name,__type);
  return iVar1;
}



void BSA_SecBondCancel(void)

{
  BSA_SecBondCancel();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t getpid(void)

{
  __pid_t _Var1;
  
  _Var1 = getpid();
  return _Var1;
}



void BSA_HhRemoveDev(void)

{
  BSA_HhRemoveDev();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_destroy(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_destroy(__mutex);
  return iVar1;
}



void BSA_BleClCacheLoadInit(void)

{
  BSA_BleClCacheLoadInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memmove(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memmove(__dest,__src,__n);
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = pclose(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fclose(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fclose(__stream);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fread(void *__ptr,size_t __size,size_t __n,FILE *__stream)

{
  size_t sVar1;
  
  sVar1 = fread(__ptr,__size,__n,__stream);
  return sVar1;
}



void BSA_TmGetHandle(void)

{
  BSA_TmGetHandle();
  return;
}



void duss_event_create_client(void)

{
  duss_event_create_client();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strncat(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = strncat(__dest,__src,__n);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

FILE * fopen(char *__filename,char *__modes)

{
  FILE *pFVar1;
  
  pFVar1 = fopen(__filename,__modes);
  return pFVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int chmod(char *__file,__mode_t __mode)

{
  int iVar1;
  
  iVar1 = chmod(__file,__mode);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int dprintf(int __fd,char *__fmt,...)

{
  int iVar1;
  
  iVar1 = dprintf(__fd,__fmt);
  return iVar1;
}



void BSA_BleEnableInit(void)

{
  BSA_BleEnableInit();
  return;
}



void __libc_start_main(void)

{
  __libc_start_main();
  return;
}



void BSA_SecReadOOBInit(void)

{
  BSA_SecReadOOBInit();
  return;
}



void duss_event_send(void)

{
  duss_event_send();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fileno(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fileno(__stream);
  return iVar1;
}



void BSA_DmSetConfig(void)

{
  BSA_DmSetConfig();
  return;
}



void BSA_TmHciInit(void)

{
  BSA_TmHciInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_create(pthread_t *__newthread,pthread_attr_t *__attr,__start_routine *__start_routine,
                  void *__arg)

{
  int iVar1;
  
  iVar1 = pthread_create(__newthread,__attr,__start_routine,__arg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int vprintf(char *__format,__gnuc_va_list __arg)

{
  int iVar1;
  
  iVar1 = vprintf(__format,__arg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  
  sVar1 = write(__fd,__buf,__n);
  return sVar1;
}



void BSA_HhAddDev(void)

{
  BSA_HhAddDev();
  return;
}



void BSA_MgtClose(void)

{
  BSA_MgtClose();
  return;
}



void BSA_BleApcfCfg(void)

{
  BSA_BleApcfCfg();
  return;
}



void BSA_HhSet(void)

{
  BSA_HhSet();
  return;
}



void BSA_TmQos(void)

{
  BSA_TmQos();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int closedir(DIR *__dirp)

{
  int iVar1;
  
  iVar1 = closedir(__dirp);
  return iVar1;
}



void BSA_DiscStart(void)

{
  BSA_DiscStart();
  return;
}



void duss_hal_gpio_set_direction(void)

{
  duss_hal_gpio_set_direction();
  return;
}



void UIPC_Open(void)

{
  UIPC_Open();
  return;
}



void BSA_SecAddDeviceInit(void)

{
  BSA_SecAddDeviceInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int close(int __fd)

{
  int iVar1;
  
  iVar1 = close(__fd);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fputc(int __c,FILE *__stream)

{
  int iVar1;
  
  iVar1 = fputc(__c,__stream);
  return iVar1;
}



void duss_osal_msgq_send(void)

{
  duss_osal_msgq_send();
  return;
}



void BSA_BleClAppRegisterInit(void)

{
  BSA_BleClAppRegisterInit();
  return;
}



void BSA_SecAddSiDev(void)

{
  BSA_SecAddSiDev();
  return;
}



void BSA_SecAddSiDevInit(void)

{
  BSA_SecAddSiDevInit();
  return;
}



void UIPC_Close(void)

{
  UIPC_Close();
  return;
}



void BSA_ReadRemoteNameInit(void)

{
  BSA_ReadRemoteNameInit();
  return;
}



void BSA_ReadRemoteName(void)

{
  BSA_ReadRemoteName();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long random(void)

{
  long lVar1;
  
  lVar1 = random();
  return lVar1;
}



void BSA_TmPingInit(void)

{
  BSA_TmPingInit();
  return;
}



void BSA_SecAuthorizeReply(void)

{
  BSA_SecAuthorizeReply();
  return;
}



void BSA_TmVseDeregisterInit(void)

{
  BSA_TmVseDeregisterInit();
  return;
}



void BSA_TmVseRegisterInit(void)

{
  BSA_TmVseRegisterInit();
  return;
}



void BSA_HhEnable(void)

{
  BSA_HhEnable();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * fgets(char *__s,int __n,FILE *__stream)

{
  char *pcVar1;
  
  pcVar1 = fgets(__s,__n,__stream);
  return pcVar1;
}



void BSA_MgtOpenInit(void)

{
  BSA_MgtOpenInit();
  return;
}



void BSA_HhSendCtrl(void)

{
  BSA_HhSendCtrl();
  return;
}



void BSA_SecAuthorizeReplyInit(void)

{
  BSA_SecAuthorizeReplyInit();
  return;
}



void BSA_DiscStartInit(void)

{
  BSA_DiscStartInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sscanf(char *__s,char *__format,...)

{
  int iVar1;
  
  iVar1 = sscanf(__s,__format);
  return iVar1;
}



void BSA_BleClIndConf(void)

{
  BSA_BleClIndConf();
  return;
}



void BSA_TmCoexOp(void)

{
  BSA_TmCoexOp();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strncpy(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  
  pcVar1 = strncpy(__dest,__src,__n);
  return pcVar1;
}



void BSA_SecRemoveDeviceInit(void)

{
  BSA_SecRemoveDeviceInit();
  return;
}



void BSA_BleClCfgMtuInit(void)

{
  BSA_BleClCfgMtuInit();
  return;
}



void BSA_TmHciCmd(void)

{
  BSA_TmHciCmd();
  return;
}



void BSA_BleClCfgMtu(void)

{
  BSA_BleClCfgMtu();
  return;
}



void BSA_HhOpenInit(void)

{
  BSA_HhOpenInit();
  return;
}



void duss_event_start_client(void)

{
  duss_event_start_client();
  return;
}



void BSA_BleApcfEnable(void)

{
  BSA_BleApcfEnable();
  return;
}



void BSA_TmSetTraceText(void)

{
  BSA_TmSetTraceText();
  return;
}



void duss_event_resp_data(void)

{
  duss_event_resp_data();
  return;
}



void BSA_TmSetTestMode(void)

{
  BSA_TmSetTestMode();
  return;
}



void BSA_TmReadRawRssiInit(void)

{
  BSA_TmReadRawRssiInit();
  return;
}



void BSA_HhRemoveDevInit(void)

{
  BSA_HhRemoveDevInit();
  return;
}



void BSA_MgtKillServer(void)

{
  BSA_MgtKillServer();
  return;
}



void duss_util_crc8_append(void)

{
  duss_util_crc8_append();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int unlink(char *__name)

{
  int iVar1;
  
  iVar1 = unlink(__name);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int execl(char *__path,char *__arg,...)

{
  int iVar1;
  
  iVar1 = execl(__path,__arg);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void sync(void)

{
  sync();
  return;
}



void BSA_BleDisableInit(void)

{
  BSA_BleDisableInit();
  return;
}



void GKI_delay(void)

{
  GKI_delay();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fflush(FILE *__stream)

{
  int iVar1;
  
  iVar1 = fflush(__stream);
  return iVar1;
}



void BSA_HhSendData(void)

{
  BSA_HhSendData();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memset(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  
  pvVar1 = memset(__s,__c,__n);
  return pvVar1;
}



void BSA_BleClNotifRegisterInit(void)

{
  BSA_BleClNotifRegisterInit();
  return;
}



void BSA_SecReadOOB(void)

{
  BSA_SecReadOOB();
  return;
}



void BSA_HhAddDevInit(void)

{
  BSA_HhAddDevInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void srandom(uint __seed)

{
  srandom(__seed);
  return;
}



void BSA_BleSeAppRegisterInit(void)

{
  BSA_BleSeAppRegisterInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void perror(char *__s)

{
  perror(__s);
  return;
}



void BSA_HhDisableInit(void)

{
  BSA_HhDisableInit();
  return;
}



void flock(void)

{
  flock();
  return;
}



void BSA_BleSeCreateService(void)

{
  BSA_BleSeCreateService();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fprintf(FILE *__stream,char *__format,...)

{
  int iVar1;
  
  iVar1 = fprintf(__stream,__format);
  return iVar1;
}



void BSA_TmDisconnect(void)

{
  BSA_TmDisconnect();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int memcmp(void *__s1,void *__s2,size_t __n)

{
  int iVar1;
  
  iVar1 = memcmp(__s1,__s2,__n);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int vsnprintf(char *__s,size_t __maxlen,char *__format,__gnuc_va_list __arg)

{
  int iVar1;
  
  iVar1 = vsnprintf(__s,__maxlen,__format,__arg);
  return iVar1;
}



void BSA_BleClGetNextCharDescr(void)

{
  BSA_BleClGetNextCharDescr();
  return;
}



void BSA_BleClWriteInit(void)

{
  BSA_BleClWriteInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fchown(int __fd,__uid_t __owner,__gid_t __group)

{
  int iVar1;
  
  iVar1 = fchown(__fd,__owner,__group);
  return iVar1;
}



void BSA_BleClNotifRegister(void)

{
  BSA_BleClNotifRegister();
  return;
}



void BSA_TmLeTestCmd(void)

{
  BSA_TmLeTestCmd();
  return;
}



void LogMsg_0(void)

{
  LogMsg_0();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sprintf(char *__s,char *__format,...)

{
  int iVar1;
  
  iVar1 = sprintf(__s,__format);
  return iVar1;
}



void BSA_BleWakeCfg(void)

{
  BSA_BleWakeCfg();
  return;
}



void BSA_HhGetInit(void)

{
  BSA_HhGetInit();
  return;
}



void BSA_HhOpen(void)

{
  BSA_HhOpen();
  return;
}



void bdcmp(void)

{
  bdcmp();
  return;
}



void BSA_SecSetSecurityInit(void)

{
  BSA_SecSetSecurityInit();
  return;
}



void BSA_DmGetLocalDiRecord(void)

{
  BSA_DmGetLocalDiRecord();
  return;
}



void BSA_MgtKillServerInit(void)

{
  BSA_MgtKillServerInit();
  return;
}



void BSA_TmReadRawRssi(void)

{
  BSA_TmReadRawRssi();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int socket(int __domain,int __type,int __protocol)

{
  int iVar1;
  
  iVar1 = socket(__domain,__type,__protocol);
  return iVar1;
}



void BSA_BleClGetFirstCharDescrInit(void)

{
  BSA_BleClGetFirstCharDescrInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_cancel(pthread_t __th)

{
  int iVar1;
  
  iVar1 = pthread_cancel(__th);
  return iVar1;
}



void BSA_BleSeConnectInit(void)

{
  BSA_BleSeConnectInit();
  return;
}



void BSA_BleSeStartServiceInit(void)

{
  BSA_BleSeStartServiceInit();
  return;
}



void BSA_BleSeSendRsp(void)

{
  BSA_BleSeSendRsp();
  return;
}



void scru_dump_hex(void)

{
  scru_dump_hex();
  return;
}



void BSA_DiscAbortInit(void)

{
  BSA_DiscAbortInit();
  return;
}



void BSA_MgtOpen(void)

{
  BSA_MgtOpen();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void exit(int __status)

{
                    // WARNING: Subroutine does not return
  exit(__status);
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int rename(char *__old,char *__new)

{
  int iVar1;
  
  iVar1 = rename(__old,__new);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t fork(void)

{
  __pid_t _Var1;
  
  _Var1 = fork();
  return _Var1;
}



void BSA_TmVseRegister(void)

{
  BSA_TmVseRegister();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_unlock(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  iVar1 = pthread_mutex_unlock(__mutex);
  return iVar1;
}



void BSA_BleSeSendInd(void)

{
  BSA_BleSeSendInd();
  return;
}



void BSA_SecRemoveDevice(void)

{
  BSA_SecRemoveDevice();
  return;
}



void BSA_BleClGetFirstCharDescr(void)

{
  BSA_BleClGetFirstCharDescr();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int raise(int __sig)

{
  int iVar1;
  
  iVar1 = raise(__sig);
  return iVar1;
}



void BSA_SecSetSecurity(void)

{
  BSA_SecSetSecurity();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  
  pcVar1 = strstr(__haystack,__needle);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fstat(int __fd,stat *__buf)

{
  int iVar1;
  
  iVar1 = fstat(__fd,__buf);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strcmp(char *__s1,char *__s2)

{
  int iVar1;
  
  iVar1 = strcmp(__s1,__s2);
  return iVar1;
}



void BSA_BleClIndConfInit(void)

{
  BSA_BleClIndConfInit();
  return;
}



void BSA_BleSeCreateServiceInit(void)

{
  BSA_BleSeCreateServiceInit();
  return;
}



void BSA_SecSetRemoteOOB(void)

{
  BSA_SecSetRemoteOOB();
  return;
}



void BSA_BleWakeEnable(void)

{
  BSA_BleWakeEnable();
  return;
}



void BSA_BleClConnectInit(void)

{
  BSA_BleClConnectInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t waitpid(__pid_t __pid,int *__stat_loc,int __options)

{
  __pid_t _Var1;
  
  _Var1 = waitpid(__pid,__stat_loc,__options);
  return _Var1;
}



void BSA_TmGetHandleInit(void)

{
  BSA_TmGetHandleInit();
  return;
}



void BSA_SecBondInit(void)

{
  BSA_SecBondInit();
  return;
}



void BSA_HhSetInit(void)

{
  BSA_HhSetInit();
  return;
}



void BSA_BleSeClose(void)

{
  BSA_BleSeClose();
  return;
}



void BSA_BleWakeCfgInit(void)

{
  BSA_BleWakeCfgInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void free(void *__ptr)

{
  free(__ptr);
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strpbrk(char *__s,char *__accept)

{
  char *pcVar1;
  
  pcVar1 = strpbrk(__s,__accept);
  return pcVar1;
}



void BSA_HhEnableInit(void)

{
  BSA_HhEnableInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

dirent * readdir(DIR *__dirp)

{
  dirent *pdVar1;
  
  pdVar1 = readdir(__dirp);
  return pdVar1;
}



void BSA_BleDisable(void)

{
  BSA_BleDisable();
  return;
}



void BSA_BleSeSendIndInit(void)

{
  BSA_BleSeSendIndInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  
  pcVar1 = strchr(__s,__c);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fchmod(int __fd,__mode_t __mode)

{
  int iVar1;
  
  iVar1 = fchmod(__fd,__mode);
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fsync(int __fd)

{
  int iVar1;
  
  iVar1 = fsync(__fd);
  return iVar1;
}



void BSA_DmGetConfig(void)

{
  BSA_DmGetConfig();
  return;
}



void BSA_MgtCloseInit(void)

{
  BSA_MgtCloseInit();
  return;
}



void duss_event_resp_err(void)

{
  duss_event_resp_err();
  return;
}



void duss_osal_timer_destroy(void)

{
  duss_osal_timer_destroy();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strerror(int __errnum)

{
  char *pcVar1;
  
  pcVar1 = strerror(__errnum);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int printf(char *__format,...)

{
  int iVar1;
  
  iVar1 = printf(__format);
  return iVar1;
}



void BSA_BleSeStartService(void)

{
  BSA_BleSeStartService();
  return;
}



void BSA_TmVsc(void)

{
  BSA_TmVsc();
  return;
}



void BSA_SecBond(void)

{
  BSA_SecBond();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

FILE * popen(char *__command,char *__modes)

{
  FILE *pFVar1;
  
  pFVar1 = popen(__command,__modes);
  return pFVar1;
}



void BSA_BleSeAppDeregisterInit(void)

{
  BSA_BleSeAppDeregisterInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int puts(char *__s)

{
  int iVar1;
  
  iVar1 = puts(__s);
  return iVar1;
}



void BSA_BleClGetNextChar(void)

{
  BSA_BleClGetNextChar();
  return;
}



void duss_sketch_get_config_file_name(void)

{
  duss_sketch_get_config_file_name();
  return;
}



void BSA_HhClose(void)

{
  BSA_HhClose();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int getchar(void)

{
  int iVar1;
  
  iVar1 = getchar();
  return iVar1;
}



void BSA_HhSendDataInit(void)

{
  BSA_HhSendDataInit();
  return;
}



void BSA_TmSetTestModeInit(void)

{
  BSA_TmSetTestModeInit();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int isxdigit(int param_1)

{
  int iVar1;
  
  iVar1 = isxdigit(param_1);
  return iVar1;
}



void BSA_HhSendCtrlInit(void)

{
  BSA_HhSendCtrlInit();
  return;
}



void BSA_TmGetMemUsageInit(void)

{
  BSA_TmGetMemUsageInit();
  return;
}



void duss_log_gen_head(void)

{
  duss_log_gen_head();
  return;
}



void BSA_TmPing(void)

{
  BSA_TmPing();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strcpy(char *__dest,char *__src)

{
  char *pcVar1;
  
  pcVar1 = strcpy(__dest,__src);
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int kill(__pid_t __pid,int __sig)

{
  int iVar1;
  
  iVar1 = kill(__pid,__sig);
  return iVar1;
}



void BSA_BleEnable(void)

{
  BSA_BleEnable();
  return;
}



void BSA_BleClNotifDeregister(void)

{
  BSA_BleClNotifDeregister();
  return;
}



void __deregister_frame_info(void)

{
  __deregister_frame_info();
  return;
}



void BSA_BleClRead(void)

{
  BSA_BleClRead();
  return;
}



void BSA_BleSeAppDeregister(void)

{
  BSA_BleSeAppDeregister();
  return;
}



// WARNING: Removing unreachable block (ram,0x00014622)
// WARNING: Removing unreachable block (ram,0x0001461e)
// WARNING: Removing unreachable block (ram,0x00014648)

void entry(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int unaff_r4;
  undefined unaff_r5;
  code *UNRECOVERED_JUMPTABLE;
  undefined in_ZR;
  undefined in_CY;
  
  UNRECOVERED_JUMPTABLE = (code *)0x145ed;
  puVar1 = (undefined4 *)FUN_000145f0((undefined4 *)&stack0x00000000,_DYNAMIC,param_3);
  if ((bool)in_CY && !(bool)in_ZR) {
    uVar2 = 0x13845;
    __libc_start_main(0x162e3,*puVar1,puVar1 + 1,0x13845,0x57765,0,param_3,UNRECOVERED_JUMPTABLE);
    *(undefined *)(unaff_r4 + 0x1d) = unaff_r5;
    *(undefined4 *)(unaff_r4 + 0x2c) = uVar2;
    return;
  }
                    // WARNING: Could not recover jumptable at 0x0001464a. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



// WARNING: Removing unreachable block (ram,0x0001461e)
// WARNING: Removing unreachable block (ram,0x00014622)

void FUN_000145f0(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int unaff_r4;
  undefined unaff_r5;
  
  uVar1 = 0x13845;
  __libc_start_main(0x162e3,*param_1,param_1 + 1,0x13845,0x57765,0,param_3);
  *(undefined *)(unaff_r4 + 0x1d) = unaff_r5;
  *(undefined4 *)(unaff_r4 + 0x2c) = uVar1;
  return;
}



// WARNING: Removing unreachable block (ram,0x0001461e)
// WARNING: Removing unreachable block (ram,0x00014622)

void FUN_00014614(void)

{
  return;
}



// WARNING: Removing unreachable block (ram,0x00014668)

void _FINI_0(void)

{
  if (DAT_00085770 == '\0') {
    FUN_00014614();
    DAT_00085770 = '\x01';
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x00014644)
// WARNING: Removing unreachable block (ram,0x00014686)
// WARNING: Removing unreachable block (ram,0x00014698)
// WARNING: Removing unreachable block (ram,0x00014648)
// WARNING: Removing unreachable block (ram,0x00014694)

void _INIT_0(void)

{
  code *UNRECOVERED_JUMPTABLE;
  
                    // WARNING: Could not recover jumptable at 0x0001464a. Too many branches
                    // WARNING: Treating indirect jump as call
  (*UNRECOVERED_JUMPTABLE)();
  return;
}



byte FUN_000146b4(byte param_1,byte *param_2,int param_3)

{
  int local_1c;
  byte *local_18;
  byte local_11;
  
  local_1c = param_3;
  local_18 = param_2;
  local_11 = param_1;
  while (local_1c != 0) {
    local_11 = (&DAT_0005776c)[local_11 ^ *local_18];
    local_18 = local_18 + 1;
    local_1c = local_1c + -1;
  }
  return local_11;
}



ushort FUN_000146fe(ushort param_1,byte *param_2,int param_3)

{
  int local_1c;
  byte *local_18;
  ushort local_12;
  
  local_1c = param_3;
  local_18 = param_2;
  local_12 = param_1;
  while (local_1c != 0) {
    local_12 = *(ushort *)(&DAT_0005786c + (uint)(byte)(*local_18 ^ (byte)local_12) * 2) ^
               local_12 >> 8;
    local_1c = local_1c + -1;
    local_18 = local_18 + 1;
  }
  return local_12;
}



int FUN_0001474e(byte *param_1,byte *param_2,void *param_3,size_t param_4)

{
  short sVar1;
  byte bVar2;
  ushort uVar3;
  
  sVar1 = (short)param_4 + 0xd;
  *param_1 = 0x55;
  param_1[1] = (byte)sVar1;
  param_1[2] = (byte)((ushort)sVar1 >> 8) | 4;
  bVar2 = FUN_000146b4(0x77,param_1,3);
  param_1[3] = bVar2;
  param_1[4] = *param_2;
  param_1[5] = param_2[1];
  param_1[6] = (byte)*(undefined2 *)(param_2 + 6);
  param_1[7] = (byte)((ushort)*(undefined2 *)(param_2 + 6) >> 8);
  param_1[8] = param_2[2];
  if (param_2[5] != 0) {
    param_1[8] = param_1[8] | 0x80;
  }
  param_1[9] = param_2[3];
  param_1[10] = param_2[4];
  if ((param_3 != (void *)0x0) && (param_4 != 0)) {
    memcpy(param_1 + 0xb,param_3,param_4);
  }
  uVar3 = FUN_000146fe(0x3692,param_1,param_4 + 0xb);
  param_1[param_4 + 0xb] = (byte)uVar3;
  param_1[param_4 + 0xc] = (byte)(uVar3 >> 8);
  return param_4 + 0xd;
}



int FUN_00014860(int param_1,void *param_2,size_t param_3,byte *param_4)

{
  int iVar1;
  byte local_10;
  undefined local_f;
  undefined local_e;
  undefined local_d;
  undefined local_c;
  undefined local_b;
  undefined2 local_a;
  
  memset(&local_10,0,8);
  local_10 = *(byte *)(param_1 + 5);
  local_f = *(undefined *)(param_1 + 4);
  local_d = *(undefined *)(param_1 + 9);
  local_c = *(undefined *)(param_1 + 10);
  local_e = *(undefined *)(param_1 + 8);
  local_b = 1;
  local_a = *(undefined2 *)(param_1 + 6);
  iVar1 = FUN_0001474e(param_4,&local_10,param_2,param_3);
  return iVar1;
}



undefined4 FUN_000148d0(int param_1,undefined param_2)

{
  **(undefined **)(param_1 + 8) = param_2;
  *(undefined4 *)(param_1 + 0xc) = 1;
  return 1;
}



undefined4 FUN_000148f8(int param_1)

{
  undefined *puVar1;
  char acStack_34 [36];
  size_t local_10;
  undefined *local_c;
  
  memset(acStack_34,0,0x21);
  local_c = *(undefined **)(param_1 + 8);
  FUN_0001ba38(acStack_34);
  local_10 = strlen(acStack_34);
  puVar1 = local_c + 1;
  *local_c = 0;
  local_c = local_c + 2;
  *puVar1 = (char)local_10;
  memcpy(local_c,acStack_34,local_10);
  *(undefined **)(param_1 + 0xc) = local_c + (local_10 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_0001496e(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_b8 [128];
  char acStack_38 [36];
  int local_14;
  byte local_d;
  byte *local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_set_ssid",0x77);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"wms: enter\n");
  }
  local_c = *param_1;
  local_d = *local_c;
  if ((local_d < 0x21) && (local_d != 0)) {
    if ((byte *)(local_d + 1) == param_1[1]) {
      memcpy(acStack_38,local_c + 1,(uint)local_d);
      acStack_38[local_d] = '\0';
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_set_ssid",0x88);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"wms: ssid:%s\n",acStack_38);
      }
      local_14 = FUN_0001ba50(acStack_38);
      if (local_14 == 0) {
        uVar2 = FUN_000148d0((int)param_1,0);
        return uVar2;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_set_ssid",0x82);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_b8,"wms: ssid len invalid :%d\n",local_d);
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_ssid",0x7d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"wms: ssid len invalid :%d\n",local_d);
    }
  }
  uVar2 = FUN_000148d0((int)param_1,0xff);
  return uVar2;
}



undefined4 FUN_00014b1e(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  byte *local_c;
  
  local_c = *param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_set_macaddr",0x9a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_8c,"wms: %s enter\n","v1_proc_set_macaddr");
  }
  if ((int)param_1[1] < 6) {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_macaddr",0x9d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: %s, len is invalid:%d\n","v1_proc_set_macaddr",
                     param_1[1]);
    }
    uVar2 = FUN_000148d0((int)param_1,0xff);
  }
  else if ((*local_c & 1) == 0) {
    FUN_0001ba08(local_c);
    uVar2 = FUN_000148d0((int)param_1,0);
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_macaddr",0xa2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: %s, mac[0] is invalid:%02x\n","v1_proc_set_macaddr",
                     *local_c);
    }
    uVar2 = FUN_000148d0((int)param_1,0xff);
  }
  return uVar2;
}



undefined4 FUN_00014c64(int param_1)

{
  int iVar1;
  undefined4 local_10;
  undefined2 local_c;
  
  FUN_0001ba20((undefined *)&local_10);
  **(undefined **)(param_1 + 8) = 0;
  iVar1 = *(int *)(param_1 + 8);
  *(undefined4 *)(iVar1 + 1) = local_10;
  *(undefined2 *)(iVar1 + 5) = local_c;
  *(undefined4 *)(param_1 + 0xc) = 7;
  return 1;
}



undefined4 FUN_00014ca2(int param_1)

{
  undefined *puVar1;
  char acStack_50 [64];
  undefined *local_10;
  size_t local_c;
  
  local_c = 0;
  local_10 = *(undefined **)(param_1 + 8);
  FUN_0001babe(acStack_50);
  local_c = strlen(acStack_50);
  puVar1 = local_10 + 1;
  *local_10 = 0;
  local_10 = local_10 + 2;
  *puVar1 = (char)local_c;
  memcpy(local_10,acStack_50,local_c);
  *(undefined **)(param_1 + 0xc) = local_10 + (local_c - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00014d0e(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_d4 [128];
  char acStack_54 [64];
  int local_14;
  byte local_d;
  byte *local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_d4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_set_passwd",0xd3);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_d4,"wms: enter\n");
  }
  local_c = *param_1;
  local_d = *local_c;
  if (((local_d < 0x40) && (7 < local_d)) && ((byte *)(local_d + 1) == param_1[1])) {
    memcpy(acStack_54,local_c + 1,(uint)local_d);
    acStack_54[local_d] = '\0';
    iVar1 = duss_log_gen_head(0x5c,0,auStack_d4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_passwd",0xe2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_d4,"wms: passwd:%s\n",acStack_54);
    }
    local_14 = FUN_0001bad6(acStack_54);
    if (local_14 == 0) {
      uVar2 = FUN_000148d0((int)param_1,0);
      return uVar2;
    }
  }
  uVar2 = FUN_000148d0((int)param_1,0xff);
  return uVar2;
}



undefined4 FUN_00014e2a(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_restore_default",0xf1);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: enter\n");
  }
  FUN_0001bb44();
  uVar2 = FUN_000148d0(param_1,0);
  return uVar2;
}



undefined4 FUN_00014e88(ushort **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [130];
  ushort local_e;
  int local_c;
  
  local_e = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_set_chan",0xfc);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: enter\n");
  }
  local_e = **param_1;
  if ((param_1[1] == (ushort *)0x2) && (local_e < 0x100)) {
    local_c = FUN_0001bb52((byte)local_e);
    if (local_c == 0) {
      uVar2 = FUN_000148d0((int)param_1,0);
      return uVar2;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_chan",0x102);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: channel cmd param is not valid, len[%d], channel [%d]."
                     ,param_1[1],local_e);
    }
  }
  uVar2 = FUN_000148d0((int)param_1,0xff);
  return uVar2;
}



undefined4 FUN_00014f82(byte **param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined auStack_94 [128];
  int local_14;
  char local_d;
  byte *local_c;
  
  local_c = *param_1;
  if (*local_c < 3) {
    local_d = FUN_0001fbec();
    if (local_d == '\0') {
      iVar2 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_start_wifi",0x121);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_94,"wms: %s enter, bss_type:%d\n","v1_proc_start_wifi",
                       *local_c);
      }
      local_14 = FUN_0001adac();
      if (local_14 == 0) {
        iVar2 = FUN_000234e4();
        if (iVar2 != 0) {
          iVar2 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                    ,"v1_proc_start_wifi",299);
          if (iVar2 != 0) {
            duss_log_print(0x5c,0,auStack_94,"wms: %s bt_init failed\n","v1_proc_start_wifi");
          }
        }
        FUN_0001fb5e('\x02');
        uVar1 = FUN_000148d0((int)param_1,0);
      }
      else {
        uVar1 = FUN_000148d0((int)param_1,0xff);
      }
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_start_wifi",0x11d);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_94,"wms: %s wifi aready started,status:%d\n",
                       "v1_proc_start_wifi",local_d);
      }
      uVar1 = 1;
    }
  }
  else {
    uVar1 = FUN_000148d0((int)param_1,0xff);
  }
  return uVar1;
}



int FUN_000150f6(int param_1)

{
  int iVar1;
  undefined *puVar2;
  undefined8 uVar3;
  undefined auStack_90 [128];
  int local_10;
  char local_9;
  
  local_9 = FUN_0001fbec();
  if (local_9 == '\0') {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_stop_wifi",0x13c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_90,"wms: %s wifi aready closed\n","v1_proc_stop_wifi");
    }
    local_10 = 1;
  }
  else {
    puVar2 = auStack_90;
    iVar1 = duss_log_gen_head(0x5c,0,puVar2,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_stop_wifi",0x140);
    if (iVar1 != 0) {
      puVar2 = auStack_90;
      duss_log_print(0x5c,0,puVar2,"wms: %s enter\n","v1_proc_stop_wifi");
    }
    uVar3 = FUN_0001fb5e('\0');
    local_10 = FUN_0001adca((int)uVar3,(int)((ulonglong)uVar3 >> 0x20),puVar2);
    if (local_10 == 0) {
      FUN_000238a6();
      local_10 = FUN_000148d0(param_1,0);
    }
  }
  return local_10;
}



undefined4 FUN_000151de(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  byte *local_c;
  
  local_c = *param_1;
  iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_set_band",0x156);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_8c,"wms: set band check:%d\n",*local_c);
  }
  if (*local_c < 3) {
    uVar2 = FUN_000148d0((int)param_1,0);
  }
  else {
    uVar2 = FUN_000148d0((int)param_1,0xff);
  }
  return uVar2;
}



undefined4 FUN_00015260(int param_1)

{
  undefined4 uVar1;
  
  if (*(byte *)(param_1 + 0xb) < 3) {
    usleep(100000);
    FUN_0001bbf6(*(byte *)(param_1 + 0xb));
    uVar1 = 0;
  }
  else {
    uVar1 = 0xffffffff;
  }
  return uVar1;
}



undefined4 FUN_0001529e(int param_1)

{
  byte local_d;
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  FUN_0001bbca(&local_d);
  *local_c = 0;
  local_c[1] = local_d;
  *(undefined4 *)(param_1 + 0xc) = 2;
  return 1;
}



undefined4 FUN_000152d4(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_restart_wifi",0x180);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: enter, responde ack first\n");
  }
  uVar2 = FUN_000148d0(param_1,0);
  return uVar2;
}



undefined4 FUN_00015330(void)

{
  int iVar1;
  undefined4 extraout_r1;
  undefined *puVar2;
  undefined auStack_88 [128];
  
  puVar2 = auStack_88;
  iVar1 = duss_log_gen_head(0x5c,0,puVar2,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_after_restart_wifi",0x18a);
  if (iVar1 != 0) {
    puVar2 = auStack_88;
    duss_log_print(0x5c,0,puVar2,"wms: enter, restart after 1s\n");
  }
  iVar1 = usleep(500000);
  FUN_0001ade0(iVar1,extraout_r1,puVar2);
  return 0;
}



undefined4 FUN_00015396(char **param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined auStack_94 [128];
  char local_14;
  char local_13;
  undefined local_12;
  int local_10;
  char *local_c;
  
  local_c = *param_1;
  if ((int)param_1[1] < 4) {
    uVar1 = FUN_000148d0((int)param_1,0xff);
  }
  else if (*local_c == -1) {
    local_14 = local_c[1];
    local_13 = local_c[2];
    local_12 = 0;
    iVar2 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_country",0x1b5);
    if (iVar2 != 0) {
      duss_log_print(0x5c,0,auStack_94,"wms: enter, country:%s\n",&local_14);
    }
    local_10 = FUN_0001bce4(&local_14);
    if (local_10 == 0) {
      uVar1 = FUN_000148d0((int)param_1,0);
    }
    else {
      uVar1 = FUN_000148d0((int)param_1,0xff);
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,2,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_country",0x1ad);
    if (iVar2 != 0) {
      duss_log_print(0x5c,2,auStack_94,"wms: pin[0] not 0xff, not support, do nothing\n");
    }
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 FUN_000154a4(char **param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined auStack_94 [128];
  char local_14;
  char local_13;
  undefined local_12;
  int local_10;
  char *local_c;
  
  local_c = *param_1;
  if ((int)param_1[1] < 4) {
    uVar1 = FUN_000148d0((int)param_1,0xff);
  }
  else {
    local_14 = *local_c;
    local_13 = local_c[1];
    local_12 = 0;
    iVar2 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_set_country_ext",0x1cd);
    if (iVar2 != 0) {
      duss_log_print(0x5c,0,auStack_94,"wms: enter, country:%s\n",&local_14);
    }
    local_10 = FUN_0001bce4(&local_14);
    if (local_10 == 0) {
      uVar1 = FUN_000148d0((int)param_1,0);
    }
    else {
      uVar1 = FUN_000148d0((int)param_1,0xff);
    }
  }
  return uVar1;
}



undefined4 FUN_00015560(int param_1,int param_2)

{
  int iVar1;
  undefined4 extraout_r1;
  undefined *puVar2;
  undefined4 uVar3;
  undefined auStack_8c [131];
  char local_9;
  
  if (param_2 + -0xd < 4) {
    uVar3 = 0xffffffff;
  }
  else {
    local_9 = *(char *)(param_1 + 4);
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_after_set_country",0x1e4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: enter, send id:%d\n",local_9);
    }
    if (local_9 == '\x02') {
      puVar2 = auStack_8c;
      iVar1 = duss_log_gen_head(0x5c,0,puVar2,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_after_set_country",0x1ea);
      if (iVar1 != 0) {
        puVar2 = auStack_8c;
        duss_log_print(0x5c,0,puVar2,"wms: app set country, restart wifi after 500ms\n");
      }
      iVar1 = usleep(500000);
      FUN_0001ade0(iVar1,extraout_r1,puVar2);
      uVar3 = 0;
    }
    else {
      uVar3 = 0;
    }
  }
  return uVar3;
}



undefined4 FUN_00015630(int param_1)

{
  undefined4 uVar1;
  undefined local_14;
  undefined local_13;
  int local_10;
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  local_10 = FUN_0001bd16(&local_14);
  if (local_10 == 0) {
    *local_c = 0;
    local_c[1] = local_14;
    local_c[2] = local_13;
    local_c[3] = 0;
    *(undefined **)(param_1 + 0xc) = local_c + (4 - *(int *)(param_1 + 8));
    uVar1 = 1;
  }
  else {
    uVar1 = FUN_000148d0(param_1,0xff);
  }
  return uVar1;
}



undefined4 FUN_0001569a(char **param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  char *local_c;
  
  local_c = *param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_connect_resp",0x213);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_8c,"wms: enter\n");
  }
  if (*local_c == '\x01') {
    FUN_00021e5a();
  }
  return 8;
}



undefined4 FUN_00015704(void **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  char *pcVar5;
  undefined4 uVar6;
  undefined auStack_9c [128];
  int local_1c;
  
  if (param_1[1] == (void *)0x0) {
    *(undefined *)param_1[2] = 0;
    puVar3 = (undefined4 *)((int)param_1[2] + 1);
    pcVar5 = "wms161,00.00.03.83,20201023-1509";
    do {
      uVar2 = *(undefined4 *)((int)pcVar5 + 4);
      uVar4 = *(undefined4 *)((int)pcVar5 + 8);
      uVar6 = *(undefined4 *)((int)pcVar5 + 0xc);
      *puVar3 = *(undefined4 *)pcVar5;
      puVar3[1] = uVar2;
      puVar3[2] = uVar4;
      puVar3[3] = uVar6;
      pcVar5 = (char *)((int)pcVar5 + 0x10);
      puVar3 = puVar3 + 4;
    } while ((undefined4 *)pcVar5 != (undefined4 *)0x57d20);
    *(char *)puVar3 = '\0';
    local_1c = 0x20;
    iVar1 = duss_log_gen_head(0x5c,0,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_ping",0x23d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_9c,"wms: return version:%s\n","wms161,00.00.03.83,20201023-1509"
                    );
    }
    param_1[3] = (void *)(local_1c + 2);
  }
  else {
    *(undefined *)param_1[2] = 0;
    memcpy((void *)((int)param_1[2] + 1),*param_1,(size_t)param_1[1]);
    param_1[3] = (void *)((int)param_1[1] + 1);
  }
  return 1;
}



undefined4 FUN_000157e2(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [131];
  undefined uStack_15;
  uint local_14;
  byte local_d;
  byte *local_c;
  
  if (*(char *)(param_1 + 4) == '\x01') {
    local_c = *param_1;
    local_d = (byte)(((uint)*local_c << 0x1f) >> 0x1f);
    if (local_d != DAT_0008578c) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                                ,"v1_proc_self_check_push",0x255);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_98,"wms: app link status change, new state:%d\n",local_d);
      }
      DAT_0008578c = local_d;
    }
    if (local_d == 1) {
      FUN_0001fb46();
    }
    local_14 = FUN_0001fc04(&uStack_15);
    if (local_14 < 3) {
      FUN_000225e6("v1_proc_self_check_push",'\0');
    }
    else {
      FUN_000225e6("v1_proc_self_check_push",'\x01');
    }
    uVar2 = FUN_000148d0((int)param_1,0);
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_self_check_push",0x24d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"wms: unknown sender %#x, do nothing\n",
                     *(undefined *)(param_1 + 4));
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_00015910(char **param_1)

{
  int iVar1;
  undefined auStack_94 [131];
  char local_11;
  char *local_10;
  int local_c;
  
  local_c = 0xffffffff;
  local_10 = param_1[2];
  local_11 = **param_1;
  if (local_11 == '\0') {
    FUN_000238a6();
    local_c = 0;
  }
  else {
    local_c = FUN_000234e4();
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_init",0x282);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"wms: bt init %d, ret %d\n",local_11,local_c);
  }
  if (local_c == 0) {
    *local_10 = '\0';
  }
  else {
    *local_10 = -1;
  }
  param_1[3] = local_10 + (1 - (int)param_1[2]);
  return 1;
}



undefined4 FUN_000159dc(int param_1)

{
  int iVar1;
  undefined *puVar2;
  undefined auStack_90 [131];
  undefined local_d;
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  local_d = FUN_00022a7e();
  puVar2 = local_c + 1;
  *local_c = 0;
  local_c = local_c + 2;
  *puVar2 = local_d;
  iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_check_init",0x29a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_90,"wms: check bt return:%d\n",local_d);
  }
  *(int *)(param_1 + 0xc) = (int)local_c - *(int *)(param_1 + 8);
  return 1;
}



undefined4 FUN_00015a74(int param_1)

{
  int iVar1;
  undefined auStack_90 [132];
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_set_lpm",0x2a6);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: enter\n");
  }
  iVar1 = FUN_00022a96();
  if (iVar1 == 0) {
    *local_c = 0;
  }
  else {
    *local_c = 0xff;
  }
  *(undefined **)(param_1 + 0xc) = local_c + (1 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00015b0c(byte **param_1)

{
  int iVar1;
  undefined auStack_94 [135];
  byte local_d;
  byte *local_c;
  
  local_c = param_1[2];
  local_d = **param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_scan",699);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"wms: enter\n");
  }
  iVar1 = FUN_00022ab4((uint)local_d);
  if (iVar1 == 0) {
    *local_c = 0;
  }
  else {
    *local_c = 0xff;
  }
  param_1[3] = local_c + (1 - (int)param_1[2]);
  return 1;
}



undefined4 FUN_00015bb4(int param_1)

{
  int iVar1;
  undefined auStack_90 [132];
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_cancel_scan",0x2cf);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: enter\n");
  }
  iVar1 = FUN_00022ae8();
  if (iVar1 == 0) {
    *local_c = 0;
  }
  else {
    *local_c = 0xff;
  }
  *(undefined **)(param_1 + 0xc) = local_c + (1 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00015c4c(int param_1)

{
  int iVar1;
  undefined *puVar2;
  undefined auStack_b4 [128];
  undefined4 auStack_34 [9];
  size_t local_10;
  undefined *local_c;
  
  memset(auStack_34,0,0x21);
  local_c = *(undefined **)(param_1 + 8);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_get_name",0x2e4);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b4,"wms: enter\n");
  }
  FUN_0002196c(auStack_34);
  local_10 = strlen((char *)auStack_34);
  puVar2 = local_c + 1;
  *local_c = 0;
  local_c = local_c + 2;
  *puVar2 = (char)local_10;
  memcpy(local_c,auStack_34,local_10);
  *(undefined **)(param_1 + 0xc) = local_c + (local_10 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00015d1e(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_set_name",0x2f5);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: not support yet\n");
  }
  uVar2 = FUN_000148d0(param_1,0xff);
  return uVar2;
}



undefined4 FUN_00015d7a(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined4 local_c;
  
  local_c = *param_1;
  if ((int)param_1[1] < 6) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_bt_set_macaddr",0x2fe);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"wms: %s, len is invalid: %d\n","v1_proc_bt_set_macaddr",
                     param_1[1]);
    }
    uVar2 = FUN_000148d0((int)param_1,0xff);
  }
  else {
    FUN_00022592();
    uVar2 = FUN_000148d0((int)param_1,0);
  }
  return uVar2;
}



undefined4 FUN_00015e0a(int param_1)

{
  int iVar1;
  undefined auStack_94 [128];
  undefined4 local_14;
  undefined2 local_10;
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_get_macaddr",0x30c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"wms: %s enter\n","v1_proc_bt_get_macaddr");
  }
  FUN_00022522((byte *)&local_14);
  *local_c = 0;
  *(undefined4 *)(local_c + 1) = local_14;
  *(undefined2 *)(local_c + 5) = local_10;
  *(undefined **)(param_1 + 0xc) = local_c + (7 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00015eb2(byte **param_1)

{
  int iVar1;
  undefined auStack_94 [128];
  uint local_14;
  byte *local_10;
  byte *local_c;
  
  local_10 = *param_1;
  local_c = param_1[2];
  local_14 = (uint)*local_10;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_pair_state",799);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"wms: bt pair state %d\n",local_14);
  }
  iVar1 = FUN_00022f50();
  if (iVar1 == 0) {
    *local_c = 0;
  }
  else {
    *local_c = 0xff;
  }
  param_1[3] = local_c + (1 - (int)param_1[2]);
  return 1;
}



undefined4 FUN_00015f60(int param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  int local_10;
  undefined *local_c;
  
  local_c = *(undefined **)(param_1 + 8);
  local_10 = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_pair_rc",0x332);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: pair RC with duration %d\n",local_10);
  }
  iVar1 = FUN_00022f74(local_10);
  if (iVar1 == 0) {
    *local_c = 0;
  }
  else {
    *local_c = 0xff;
  }
  *(undefined **)(param_1 + 0xc) = local_c + (1 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_00016002(void **param_1)

{
  int iVar1;
  undefined auStack_a4 [128];
  char acStack_24 [20];
  void *local_10;
  undefined *local_c;
  
  local_10 = *param_1;
  local_c = (undefined *)param_1[2];
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_connect_rc",0x346);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a4,"wms: enter\n");
  }
  if (param_1[1] == (void *)0x11) {
    memset(acStack_24,0,0x12);
    memcpy(acStack_24,local_10,(size_t)param_1[1]);
    iVar1 = FUN_00022fd0(acStack_24);
    if (iVar1 == 0) {
      *local_c = 0;
      local_c = local_c + 1;
    }
    else {
      *local_c = 0xff;
      local_c = local_c + 1;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                              ,"v1_proc_bt_connect_rc",0x349);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_a4,"wms: %d wrong data for connect rc\n",param_1[1]);
    }
    *local_c = 0xff;
    local_c = local_c + 1;
  }
  param_1[3] = local_c + -(int)param_1[2];
  return 1;
}



undefined4 FUN_00016124(char **param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  char *local_10;
  char *local_c;
  
  local_c = *param_1;
  local_10 = param_1[2];
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_proc.c"
                            ,"v1_proc_bt_connect_resp",0x361);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: enter\n");
  }
  if (*local_c == '\x01') {
    FUN_00021e5a();
    FUN_00023264();
  }
  *local_10 = '\0';
  param_1[3] = local_10 + (1 - (int)param_1[2]);
  return 1;
}



undefined4 FUN_000161b6(void **param_1)

{
  undefined *puVar1;
  
  puVar1 = (undefined *)param_1[2];
  FUN_00023424(*param_1,(size_t)param_1[1]);
  *puVar1 = 0;
  param_1[3] = puVar1 + (1 - (int)param_1[2]);
  return 1;
}



void FUN_000161f6(void)

{
  byte local_34;
  undefined local_33;
  undefined local_32;
  undefined local_31;
  undefined local_30;
  undefined local_2f;
  undefined2 local_2e;
  undefined auStack_2c [4];
  byte abStack_28 [24];
  int local_10;
  int local_c;
  
  local_c = FUN_0001bd2e(auStack_2c);
  if (local_c == 0) {
    memset(&local_34,0,8);
    local_34 = 0x1b;
    local_33 = 2;
    local_31 = 7;
    local_30 = 9;
    local_32 = 0;
    local_2f = 0;
    local_2e = 0xffff;
    local_10 = FUN_0001474e(abStack_28,&local_34,auStack_2c,1);
    FUN_0001a90e();
  }
  return;
}



undefined4 FUN_00016260(int param_1)

{
  undefined *puVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 local_40 [8];
  undefined4 uStack_20;
  undefined4 *local_1c;
  
  memset(local_40,0,0x24);
  local_1c = *(undefined4 **)(param_1 + 8);
  FUN_0001aeb0();
  puVar1 = (undefined *)local_1c;
  puVar3 = (undefined *)((int)local_1c + 1);
  *(undefined *)local_1c = 0;
  local_1c = (undefined4 *)((int)local_1c + 2);
  *puVar3 = 0x24;
  puVar6 = local_40;
  do {
    uVar2 = puVar6[1];
    uVar4 = puVar6[2];
    uVar5 = puVar6[3];
    *local_1c = *puVar6;
    local_1c[1] = uVar2;
    local_1c[2] = uVar4;
    local_1c[3] = uVar5;
    puVar6 = puVar6 + 4;
    local_1c = local_1c + 4;
  } while (puVar6 != &uStack_20);
  *local_1c = *puVar6;
  *(undefined **)(param_1 + 0xc) = puVar1 + (0x26 - *(int *)(param_1 + 8));
  return 1;
}



undefined4 FUN_000162e2(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined auStack_88 [128];
  
  FUN_000218f8();
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/main.c"
                            ,&DAT_000581f4,9);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: Service Start:: Ver %s\n",
                   "wms161,00.00.03.83,20201023-1509");
  }
  FUN_0001a734(param_1,param_2);
  return 0;
}



undefined4 FUN_0001634c(undefined *param_1,undefined4 *param_2)

{
  *param_1 = 0xff;
  param_1[1] = 0;
  param_1[2] = 5;
  param_1[3] = 0x46;
  param_1[4] = 0x61;
  param_1[5] = 0x69;
  param_1[6] = 0x6c;
  param_1[7] = 0;
  *param_2 = 8;
  return 1;
}



undefined FUN_000163a8(int param_1)

{
  undefined local_9;
  
  if (param_1 == 4) {
    local_9 = 0;
  }
  else if ((param_1 < 4) || (6 < param_1)) {
    local_9 = 2;
  }
  else {
    local_9 = 1;
  }
  return local_9;
}



undefined4 FUN_000163e0(int *param_1)

{
  ushort uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_c4 [128];
  undefined auStack_44 [8];
  undefined4 local_3c;
  undefined4 local_28;
  ushort *local_24;
  byte local_1d;
  ushort *local_1c;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  
  local_14 = *param_1;
  local_18 = param_1[1];
  local_10 = 0;
  iVar2 = duss_log_gen_head(0x5c,0,auStack_c4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                            ,"v1_proc_get_wireless_test",0x3b);
  if (iVar2 != 0) {
    duss_log_print(0x5c,0,auStack_c4,"wms: %s enter, test_type %d\n","v1_proc_get_wireless_test",
                   DAT_00082660);
  }
  memset(auStack_44,0,0x20);
  iVar2 = FUN_0001adee((int)auStack_44);
  if (iVar2 == 0) {
    if ((DAT_00082660 == 0xb) && (iVar2 = FUN_00023ba2((int)auStack_44), iVar2 != 0)) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_get_wireless_test",0x47);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_c4,"wms: get bt test result fail\n");
      }
      uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
    }
    else {
      *(undefined *)param_1[2] = 0;
      local_10 = 1;
      for (local_c = 0; local_c < local_18; local_c = local_c + 2) {
        local_1c = (ushort *)(local_c + local_14);
        uVar1 = *local_1c;
        local_1d = (byte)uVar1;
        if (0x24 < local_1d) {
          uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
          return uVar3;
        }
        local_24 = (ushort *)(local_10 + param_1[2]);
        *(undefined *)(local_24 + 1) = 0;
        *(undefined *)((int)local_24 + 3) = 0;
        if (local_1d == 0x17) {
          *local_24 = uVar1 & 0xff;
          *(undefined *)(local_24 + 1) = 4;
          *(undefined *)((int)local_24 + 3) = 0;
          *(undefined4 *)(local_24 + 2) = local_3c;
          iVar2 = duss_log_gen_head(0x5c,0,auStack_c4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                    ,"v1_proc_get_wireless_test",0x66);
          if (iVar2 != 0) {
            duss_log_print(0x5c,0,auStack_c4,"wms: debug, get rx pkts:%d\n",
                           *(undefined4 *)(local_24 + 2));
          }
        }
        else if (local_1d == 0x24) {
          *local_24 = uVar1 & 0xff;
          *(undefined *)(local_24 + 1) = 4;
          *(undefined *)((int)local_24 + 3) = 0;
          *(undefined4 *)(local_24 + 2) = local_28;
          iVar2 = duss_log_gen_head(0x5c,0,auStack_c4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                    ,"v1_proc_get_wireless_test",0x6c);
          if (iVar2 != 0) {
            duss_log_print(0x5c,0,auStack_c4,"wms: debug, get rssi:%#x\n",
                           *(undefined4 *)(local_24 + 2));
          }
        }
        else if (local_1d == 7) {
          *local_24 = uVar1 & 0xff;
          *(undefined *)(local_24 + 1) = 4;
          *(undefined *)((int)local_24 + 3) = 0;
          *(undefined *)(local_24 + 2) = 10;
          *(undefined *)((int)local_24 + 5) = 0;
          *(undefined *)(local_24 + 3) = 0;
          *(undefined *)((int)local_24 + 7) = 0;
          iVar2 = duss_log_gen_head(0x5c,0,auStack_c4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                    ,"v1_proc_get_wireless_test",0x60);
          if (iVar2 != 0) {
            duss_log_print(0x5c,0,auStack_c4,"wms: get device version:%d\n",
                           *(undefined4 *)(local_24 + 2));
          }
        }
        else {
          iVar2 = duss_log_gen_head(0x5c,0,auStack_c4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                    ,"v1_proc_get_wireless_test",0x6f);
          if (iVar2 != 0) {
            duss_log_print(0x5c,0,auStack_c4,"wms: %s, not supported tag id:%d\n",
                           "v1_proc_get_wireless_test",local_1d);
          }
        }
        if (local_24[1] != 0) {
          local_10 = local_24[1] + 4 + local_10;
        }
      }
      param_1[3] = local_10;
      uVar3 = 1;
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                              ,"v1_proc_get_wireless_test",0x40);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_c4,"wms: get test result fail\n");
    }
    uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
  }
  return uVar3;
}



undefined4 FUN_000167bc(ushort *param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = FUN_000238f6(param_1);
  if (iVar1 == 0) {
    return 0;
  }
  if (*(char *)(param_1 + 1) == '\x01') {
    if (((*(char *)(param_1 + 2) == '\x02') || (*(char *)(param_1 + 2) == '\x04')) &&
       (*(char *)((int)param_1 + 3) != '\x01')) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"wirless_test_set_param_check",0x89);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_88,"wms: param check fail: band error\n");
      }
      return 0xffffffff;
    }
    if (((*(char *)(param_1 + 2) == '\0') || (*(char *)(param_1 + 2) == '\x01')) &&
       (*(char *)((int)param_1 + 3) != '\0')) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"wirless_test_set_param_check",0x90);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_88,"wms: param check fail: band error\n");
      }
      return 0xffffffff;
    }
    if (((*(char *)(param_1 + 2) == '\x04') && (*(char *)((int)param_1 + 5) == '\x14')) &&
       (*(char *)(param_1 + 3) == '\t')) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"wirless_test_set_param_check",0x98);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_88,"wms: param check fail: 20MHz do not support MCS9\n");
      }
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_00016902(int *param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 extraout_r1;
  undefined4 extraout_r1_00;
  uint uVar4;
  undefined8 uVar5;
  undefined auStack_c8 [128];
  ushort local_48;
  byte local_46;
  char local_45;
  char local_44;
  undefined local_43;
  undefined local_42;
  undefined local_41;
  undefined4 local_3c;
  undefined local_38;
  undefined local_34;
  undefined local_33;
  undefined local_32;
  undefined local_31;
  undefined2 local_30;
  int local_28;
  ushort *local_24;
  ushort *local_20;
  int local_1c;
  int local_18;
  ushort local_12;
  
  local_18 = *param_1;
  local_1c = param_1[1];
  local_12 = 0;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                            ,"v1_proc_set_wireless_test",0xab);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_c8,"wms: %s enter\n","v1_proc_set_wireless_test");
  }
  memset(&local_48,0,0x20);
  DAT_00082660 = 10;
  while (uVar4 = (uint)local_12, (int)uVar4 < local_1c) {
    local_20 = (ushort *)((uint)local_12 + local_18);
    if (0x24 < *local_20) {
      uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
      return uVar3;
    }
    local_12 = local_12 + local_20[1] + 4;
    switch(*local_20) {
    case 0:
      uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
      return uVar3;
    case 6:
      local_34 = (undefined)*(undefined4 *)(local_20 + 2);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xc1);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag device type:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 10:
      local_48 = (ushort)(*(int *)(local_20 + 2) / 10000);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",199);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag tx freq:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0xb:
      local_43 = (undefined)*(undefined4 *)(local_20 + 2);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xcd);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag tx bw:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0xc:
      local_38 = (undefined)*(undefined4 *)(local_20 + 2);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xd3);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag tx ant:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0xd:
      local_41 = (undefined)(*(int *)(local_20 + 2) / 100);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xd9);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag tx pwr:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0xe:
      local_48 = (ushort)(*(int *)(local_20 + 2) / 10000);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xdf);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag rx freq:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0xf:
      local_43 = (undefined)*(undefined4 *)(local_20 + 2);
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xe5);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag rx bw:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      break;
    case 0x13:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xea);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag band:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_45 = FUN_000163a8(*(int *)(local_24 + 2));
      if (local_45 == '\x02') {
        uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
        return uVar3;
      }
      break;
    case 0x14:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xf3);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag rate mode:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_44 = (char)*(undefined4 *)(local_24 + 2) + -1;
      break;
    case 0x15:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0xf9);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tag work mode:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_46 = (byte)*(undefined4 *)(local_24 + 2);
      if (7 < local_46) {
        uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
        return uVar3;
      }
      break;
    case 0x16:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x102);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: wifi rate:%d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_42 = (undefined)*(undefined4 *)(local_24 + 2);
      break;
    case 0x1f:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x108);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: bt channel: %d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_33 = (undefined)*(undefined4 *)(local_24 + 2);
      break;
    case 0x20:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x10e);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: payload pattern: %d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_32 = (undefined)*(undefined4 *)(local_24 + 2);
      break;
    case 0x21:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x120);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: tx pkt num: %d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_3c = *(undefined4 *)(local_24 + 2);
      break;
    case 0x22:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x114);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: pkt type: %d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_31 = (undefined)*(undefined4 *)(local_24 + 2);
      break;
    case 0x23:
      local_24 = local_20;
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x11a);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: wireless test: pkt length: %d\n",
                       *(undefined4 *)(local_24 + 2));
      }
      local_30 = (undefined2)*(undefined4 *)(local_24 + 2);
    }
  }
  local_28 = FUN_000167bc(&local_48);
  if (local_28 != 0) {
    uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
    return uVar3;
  }
  bVar1 = FUN_00023a42((int)&local_48,extraout_r1,uVar4);
  if (bVar1) {
    DAT_00082660 = 0xb;
    uVar4 = FUN_00023c26((int)&local_48);
    if (uVar4 == 0) {
      iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x133);
      if (iVar2 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: set bt test ok\n");
      }
      *(undefined *)param_1[2] = 0;
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                                ,"v1_proc_set_wireless_test",0x137);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_c8,"wms: set bt test fail\n");
      }
      *(undefined *)param_1[2] = 0xff;
    }
    param_1[3] = 1;
    return 1;
  }
  uVar5 = FUN_00022a7e();
  uVar3 = (undefined4)((ulonglong)uVar5 >> 0x20);
  if ((int)uVar5 != 0) {
    FUN_000238a6();
    uVar3 = extraout_r1_00;
  }
  local_28 = FUN_0001ae08(&local_48,uVar3,uVar4);
  if (local_28 != 0) {
    uVar3 = FUN_0001634c((undefined *)param_1[2],param_1 + 3);
    return uVar3;
  }
  iVar2 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                            ,"v1_proc_set_wireless_test",0x149);
  if (iVar2 != 0) {
    duss_log_print(0x5c,0,auStack_c8,"wms: set wireless test ok\n");
  }
  *(undefined *)param_1[2] = 0;
  param_1[3] = 1;
  return 1;
}



undefined4 FUN_0001728c(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int local_10;
  byte local_9;
  
  if (param_1[1] == (byte *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                              ,"v1_proc_wifi_run_qcmbr",0x158);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: empty req data\n");
    }
    uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
  }
  else {
    local_9 = **param_1;
    iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                              ,"v1_proc_wifi_run_qcmbr",0x15d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_90,"wms: enter wifi test: %d. \n",local_9);
    }
    if (local_9 < 2) {
      local_10 = FUN_0001ae74();
      if (local_10 == 0) {
        *param_1[2] = 0;
        param_1[3] = (byte *)0x1;
        uVar2 = 1;
      }
      else {
        uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
      }
    }
    else {
      uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
    }
  }
  return uVar2;
}



undefined4 FUN_000173a2(byte **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int local_10;
  byte local_9;
  
  if (param_1[1] == (byte *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                              ,"v1_proc_bt_run_btdiag",0x172);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: empty req data\n");
    }
    uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
  }
  else {
    local_9 = **param_1;
    iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/v1_wireless_test.c"
                              ,"v1_proc_bt_run_btdiag",0x177);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_90,"wms: enter wifi test: %d. \n",local_9);
    }
    if (local_9 < 2) {
      local_10 = FUN_0001ae92();
      if (local_10 == 0) {
        *param_1[2] = 0;
        param_1[3] = (byte *)0x1;
        uVar2 = 1;
      }
      else {
        uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
      }
    }
    else {
      uVar2 = FUN_0001634c(param_1[2],param_1 + 3);
    }
  }
  return uVar2;
}



ushort FUN_000174e8(byte param_1)

{
  return (ushort)(param_1 >> 5) | (param_1 & 0x1f) << 8;
}



undefined4 FUN_00019c84(undefined4 *param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined auStack_518 [128];
  undefined auStack_498 [28];
  undefined4 local_47c;
  undefined4 local_474;
  undefined4 local_450;
  undefined auStack_35c [28];
  undefined *local_340;
  undefined *local_338;
  undefined *local_314;
  undefined auStack_220 [522];
  undefined2 local_16;
  int local_14;
  
  local_14 = 0;
  memset(auStack_220,0,0x208);
  memset(auStack_35c,0,0x13c);
  memset(auStack_498,0,0x13c);
  local_340 = &DAT_00082664;
  local_47c = 0x4c;
  local_338 = &DAT_000829f4;
  local_474 = 0x92;
  local_314 = &DAT_000830cc;
  local_450 = 0x42;
  uVar1 = duss_sketch_get_config_file_name();
  local_14 = duss_mb_create_route_table(uVar1,"network_service","wms_local",&local_16,auStack_220);
  if (local_14 == 0) {
    local_14 = duss_event_create_client
                         (auStack_220,local_16,auStack_35c,auStack_498,param_1,param_1);
    if (local_14 != 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_518,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"wms_start_event",0x418);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_518,"wms: wms_run create_client error: %d\n",local_14);
      }
                    // WARNING: Subroutine does not return
      exit(-1);
    }
    local_14 = duss_event_start_client(*param_1);
    if (local_14 != 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_518,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"wms_start_event",0x41f);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_518,"wms: wms_run start_client() error: %d\n",local_14);
      }
                    // WARNING: Subroutine does not return
      exit(-1);
    }
    iVar2 = duss_log_gen_head(0x5c,3,auStack_518,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"wms_start_event",0x423);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_518,"wms: wms_run start event succ.\n");
    }
    uVar1 = 0;
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_518,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"wms_start_event",0x40f);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_518,"wms: wms_run create_route_table error: %d",local_14);
    }
    uVar1 = 0xffffffff;
  }
  return uVar1;
}



ssize_t FUN_00019ec0(char *param_1,void *param_2,size_t param_3,int param_4)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  int local_a8;
  undefined auStack_94 [128];
  int local_14;
  int local_10;
  ssize_t local_c;
  
  local_10 = -1;
  if ((param_1 == (char *)0x0) || (param_2 == (void *)0x0)) {
    local_c = -1;
  }
  else {
    local_a8 = param_4;
    if (param_4 < 1) {
      local_a8 = 1;
    }
    if (0x1e < local_a8) {
      local_a8 = 0x1e;
    }
    while (iVar3 = local_a8 + -1, local_a8 != 0) {
      local_14 = access(param_1,0);
      local_a8 = iVar3;
      if (local_14 < 0) {
        iVar3 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                  ,"wms_write_wifi_dev",0x4b2);
        if (iVar3 != 0) {
          piVar1 = __errno_location();
          pcVar2 = strerror(*piVar1);
          duss_log_print(0x5c,0,auStack_94,"wms: wms_run phy_debug [%s] access failed %s",param_1,
                         pcVar2);
        }
        duss_osal_task_sleep(&DAT_000186a0);
      }
      else {
        local_10 = open(param_1,2);
        if (local_10 < 0) {
          iVar3 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                    ,"wms_write_wifi_dev",0x4b9);
          if (iVar3 != 0) {
            piVar1 = __errno_location();
            pcVar2 = strerror(*piVar1);
            duss_log_print(0x5c,0,auStack_94,"wms: wms_run open [%s] failed %s",param_1,pcVar2);
          }
          duss_osal_task_sleep(&DAT_000186a0);
        }
        else {
          local_c = write(local_10,param_2,param_3);
          if (0 < local_c) {
            close(local_10);
            break;
          }
          iVar3 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                    ,"wms_write_wifi_dev",0x4c0);
          if (iVar3 != 0) {
            piVar1 = __errno_location();
            pcVar2 = strerror(*piVar1);
            duss_log_print(0x5c,0,auStack_94,"wms: wms_run write to [%s], err %s",param_1,pcVar2);
          }
          close(local_10);
          duss_osal_task_sleep(&DAT_000186a0);
        }
      }
    }
    if (iVar3 < 0) {
      iVar3 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"wms_write_wifi_dev",0x4c9);
      if (iVar3 != 0) {
        duss_log_print(0x5c,0,auStack_94,"wms: wms_run write to [%s], retry failed",param_1);
      }
      local_c = -1;
    }
  }
  return local_c;
}



ssize_t FUN_0001a0f0(char *param_1,void *param_2,size_t param_3)

{
  int iVar1;
  undefined auStack_94 [128];
  ssize_t local_14;
  int local_10;
  int local_c;
  
  local_c = 0xffffffff;
  if ((param_1 == (char *)0x0) || (param_2 == (void *)0x0)) {
    local_14 = -1;
  }
  else {
    local_10 = access(param_1,0);
    if (local_10 < 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"wms_read_wifi_dev",0x4d7);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_94,"wms: wms_run access [%s] failed",param_1);
      }
      local_14 = -1;
    }
    else {
      local_c = open(param_1,0);
      if (local_c < 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                  ,"wms_read_wifi_dev",0x4dd);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_94,"wms: wms_run open [%s] failed",param_1);
        }
        local_14 = -1;
      }
      else {
        local_14 = read(local_c,param_2,param_3);
        close(local_c);
      }
    }
  }
  return local_14;
}



void FUN_0001a1fc(undefined4 param_1)

{
  fprintf((FILE *)0x0,
          "Usage: %s [ -b ] [ -h ]\n    -b  bt baudrate ifdef BT_SUPPORT, default 1000,000 \n    -h  Display this help screen.\n"
          ,param_1);
  return;
}



undefined4 FUN_0001a226(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = 1;
  while( true ) {
    if (param_1 <= local_c) {
      return 0;
    }
    iVar1 = strcmp((char *)param_2[local_c],"-b");
    if (iVar1 != 0) break;
    DAT_0008353c = strtol(optarg,(char **)0x0,10);
    local_c = local_c + 1;
  }
  iVar1 = strcmp((char *)param_2[local_c],"-h");
  if (iVar1 == 0) {
    FUN_0001a1fc(*param_2);
                    // WARNING: Subroutine does not return
    exit(0);
  }
  iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                            ,"parse_options",0x518);
  if (iVar1 != 0) {
    duss_log_print(0x5c,1,auStack_8c,"wms: Invalid argument \"%s\".\n",param_2[local_c]);
  }
  FUN_0001a1fc(*param_2);
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Heritage AFTER dead removal. Example location: s0xfffffbfc : 0x0001a39e
// WARNING: Restarted to delay deadcode elimination for space: stack

int FUN_0001a328(undefined param_1)

{
  int iVar1;
  undefined auStack_494 [131];
  undefined local_411;
  char *local_410;
  undefined2 local_40c;
  undefined2 local_40a;
  short local_408;
  undefined4 local_404;
  undefined auStack_400 [1008];
  char **local_10;
  int local_c;
  
  local_c = 0;
  local_10 = &local_410;
  local_410 = "x%x] length:%d";
  local_40c = 0x200;
  local_40a = 0;
  local_408 = DAT_00085792;
  local_404 = 1;
  DAT_00085792 = DAT_00085792 + 1;
  local_411 = param_1;
  memcpy(auStack_400,&local_411,1);
  local_c = duss_event_send(DAT_00085b04,local_10);
  if ((local_c != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_494,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"push_wifi_link_quanlity",0x534), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_494,"wms: rc_connect_status push fail:%d\n",local_c);
  }
  return local_c;
}



// WARNING: Heritage AFTER dead removal. Example location: s0xfffffbfc : 0x0001a49c
// WARNING: Restarted to delay deadcode elimination for space: stack

int FUN_0001a426(undefined param_1)

{
  int iVar1;
  undefined auStack_494 [131];
  undefined local_411;
  char *local_410;
  undefined2 local_40c;
  undefined2 local_40a;
  short local_408;
  undefined4 local_404;
  undefined auStack_400 [1008];
  char **local_10;
  int local_c;
  
  local_c = 0;
  local_10 = &local_410;
  local_410 = "th:%d";
  local_40c = 0x200;
  local_40a = 0;
  local_408 = DAT_00085794;
  local_404 = 1;
  DAT_00085794 = DAT_00085794 + 1;
  local_411 = param_1;
  memcpy(auStack_400,&local_411,1);
  local_c = duss_event_send(DAT_00085b04,local_10);
  if ((local_c != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_494,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                ,"push_wifi_quanlity",0x550), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_494,"wms: rc_connect_status push fail:%d\n",local_c);
  }
  return local_c;
}



undefined4 FUN_0001a524(undefined *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined4 local_14;
  undefined4 local_10;
  char *local_c;
  
  local_c = "wl assoclist | grep -c assoclist";
  local_10 = 0;
  local_14 = 0;
  if (param_1 == (undefined *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"wifi_get_link_count",0x55e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"wms: bad parameter\n");
    }
    uVar2 = 0xfffffffd;
  }
  else {
    FUN_0001f438("wl assoclist | grep -c assoclist",&local_10,4);
    iVar1 = sscanf((char *)&local_10,"%d",&local_14);
    if (iVar1 == 1) {
      *param_1 = (char)local_14;
      uVar2 = 0;
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



int FUN_0001a5d8(void)

{
  short sVar1;
  int iVar2;
  undefined auStack_494 [131];
  byte local_411;
  char *local_410 [256];
  char **local_10;
  int local_c;
  
  local_c = 0;
  memset(local_410,0,0x400);
  local_10 = local_410;
  local_411 = 0;
  iVar2 = FUN_0001a524(&local_411);
  if (iVar2 == 0) {
    *local_10 = " Id[id:0x%x] length:%d";
    *(undefined2 *)(local_10 + 1) = 0x200;
    *(undefined2 *)((int)local_10 + 6) = 0;
    sVar1 = DAT_00085796 + 1;
    *(short *)(local_10 + 2) = DAT_00085796;
    DAT_00085796 = sVar1;
    local_10[3] = (char *)((uint)local_411 * 10 + 1);
    *(byte *)(local_10 + 4) = local_411;
    local_c = duss_event_send(DAT_00085b04,local_10);
    if ((local_c != 0) &&
       (iVar2 = duss_log_gen_head(0x5c,1,auStack_494,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                                  ,"push_wifi_link_count",0x587), iVar2 != 0)) {
      duss_log_print(0x5c,1,auStack_494,"wms: push_wifi_link_count push fail:%d\n",local_c);
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_494,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"push_wifi_link_count",0x576);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_494,"wms: get wifi sta link count fail\n");
    }
    local_c = -1;
  }
  return local_c;
}



int FUN_0001a734(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 extraout_r1;
  undefined4 uVar2;
  undefined auStack_94 [130];
  byte local_12;
  undefined local_11;
  undefined4 *local_10;
  int local_c;
  
  local_c = 0;
  local_10 = &DAT_00085b04;
  local_11 = 0;
  local_12 = 0xff;
  uVar2 = 0x234;
  memset(&DAT_00085b04,0,0x234);
  FUN_0001a226(param_1,param_2);
  local_c = FUN_0001a926((undefined *)(local_10 + 0xb));
  if (local_c == 0) {
    FUN_0001bdd4(0,extraout_r1,uVar2,0);
    FUN_0001b4a4("/tmp/EMMC/wireless/wifi/whitelist.conf");
    local_c = FUN_00019c84(local_10);
    if (local_c == 0) {
      do {
        duss_osal_task_sleep(500000);
        if (((DAT_00085798 & 1) == 0) && (iVar1 = FUN_0001fbec(), iVar1 != 0)) {
          FUN_0001a5d8();
          iVar1 = FUN_0001bd2e(&local_11);
          if (iVar1 == 0) {
            FUN_0001a328(local_11);
          }
          FUN_0001bd46();
          local_c = FUN_0001bd64(&local_12);
          FUN_0001a426(local_12);
        }
        DAT_00085798 = DAT_00085798 + 1;
      } while( true );
    }
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"start_wms",0x5ba);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"wms: wms_run event start failed: %d",local_c);
    }
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"start_wms",0x5e1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"wms: wms_run dji_wms exit.");
    }
    local_c = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_run.c"
                              ,"start_wms",0x59e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"wms: wms_run gpio_init failed: %d\n",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_0001a90e(void)

{
  return 0;
}



undefined4 FUN_0001a926(undefined *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int local_10;
  int local_c;
  
  *param_1 = 0;
  local_10 = duss_hal_device_open("/sys/class/gpio",param_1,param_1 + 4);
  if (local_10 == 0) {
    for (local_c = 0; local_c < 0x100; local_c = local_c + 1) {
      param_1[(local_c + 4) * 2] = 0xff;
      param_1[(local_c + 4) * 2 + 1] = 0xff;
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                              ,"wms_gpio_init",0x10);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: duss_hal_device_open %s error\n","/sys/class/gpio");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0001a9e6(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = duss_hal_device_close(*(undefined4 *)(param_1 + 4));
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                              ,"wms_gpio_deinit",0x22);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"wms: duss_hal_device_close %s error\n","/sys/class/gpio");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0001aa5e(int param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined4 local_10;
  int local_c;
  
  if (*(int *)(param_1 + 4) == 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                              ,"wms_gpio_get_input",0x30);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: wms gpio get:_un-inited\n");
    }
    uVar2 = 0xffffffff;
  }
  else {
    if (*(char *)(param_1 + (param_3 + 4) * 2) != '\0') {
      local_c = duss_hal_gpio_set_direction(*(undefined4 *)(param_1 + 4),param_2,param_3,0);
      if (local_c != 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                  ,"wms_gpio_get_input",0x3a);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"wms: wms_gpio set_direction() error: index = %d\n",
                         param_3);
        }
        return 0xffffffff;
      }
      *(undefined *)(param_1 + (param_3 + 4) * 2) = 0;
      local_c = 0;
    }
    local_c = duss_hal_gpio_get_value(*(undefined4 *)(param_1 + 4),param_2,param_3,&local_10);
    if (local_c == 0) {
      *(char *)((param_3 + 4) * 2 + param_1 + 1) = (char)local_10;
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = local_10;
      }
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                ,"wms_gpio_get_input",0x46);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"wms: wms_gpio get_value error %d\n",local_c);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0001abcc(int param_1,undefined4 param_2,int param_3,int param_4)

{
  int iVar1;
  undefined auStack_90 [128];
  int local_10;
  int local_c;
  
  if (*(char *)(param_1 + (param_3 + 4) * 2) != '\x01') {
    local_c = duss_hal_gpio_set_direction(*(undefined4 *)(param_1 + 4),param_2,param_3,1);
    if (local_c != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                ,"wms_gpio_set_output",0x60);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"wms: duss_hal_gpio_set_direction() error: index = %d\n",
                       param_3);
      }
      return 0xffffffff;
    }
    *(undefined *)(param_1 + (param_3 + 4) * 2) = 1;
    local_c = 0;
  }
  if (*(char *)((param_3 + 4) * 2 + param_1 + 1) != param_4) {
    local_c = duss_hal_gpio_set_value(*(undefined4 *)(param_1 + 4),param_2,param_3,param_4);
    if (local_c != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                ,"wms_gpio_set_output",0x6e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"wms: duss_hal_gpio_set_value() error: val = %d\n",param_4)
        ;
      }
      return 0xffffffff;
    }
    *(char *)((param_3 + 4) * 2 + param_1 + 1) = (char)param_4;
    local_c = duss_hal_gpio_get_value(*(undefined4 *)(param_1 + 4),param_2,param_3,&local_10);
    if (local_c != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                ,"wms_gpio_set_output",0x78);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"wms: wms_gpio duss_hal_gpio_get_value error\n");
      }
      return 0xffffffff;
    }
    if (local_10 != param_4) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//v1_interface/duss_ipc/wms_gpio.c"
                                ,"wms_gpio_set_output",0x7c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,
                       "wms: wms_gpio set_output_value failed: set_val = %d != get_val = %d\n",
                       param_4,local_10);
      }
      return 0xffffffff;
    }
  }
  return 0;
}



int FUN_0001adac(void)

{
  int iVar1;
  
  iVar1 = FUN_0001ceb8();
  return iVar1;
}



undefined4 FUN_0001adca(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001d04a(param_1,param_2,param_3);
  return uVar1;
}



int FUN_0001ade0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  
  iVar1 = FUN_0001d0b8(param_1,param_2,param_3);
  return iVar1;
}



undefined4 FUN_0001adee(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001d6ce(param_1);
  return uVar1;
}



int FUN_0001ae08(ushort *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0001d382(param_1,param_2,param_3);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/bss_mgmt.c"
                              ,"wifi_mgmt_set_wireless_test",0x30);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: device_set_wireless_test return fail:%d\n",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_0001ae74(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001d724();
  return uVar1;
}



undefined4 FUN_0001ae92(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001d73c();
  return uVar1;
}



undefined4 FUN_0001aeb0(void)

{
  return 0xfffffffd;
}



void FUN_0001aecc(void)

{
  int iVar1;
  undefined auStack_194 [128];
  char acStack_114 [256];
  undefined *local_14;
  int local_10;
  int local_c;
  
  memset(acStack_114,0,0x100);
  for (local_c = 0;
      (local_c < 10 &&
      (local_14 = &DAT_0008579c + local_c * 0x21, (&DAT_000857bc)[local_c * 0x21] != '\0'));
      local_c = local_c + 1) {
    memset(acStack_114,0,0x100);
    for (local_10 = 0; local_10 < (int)(uint)(byte)local_14[0x20]; local_10 = local_10 + 1) {
      if ((byte)local_14[0x20] - 1 == local_10) {
        sprintf(acStack_114 + local_10 * 3,"%02x",(uint)(byte)local_14[local_10]);
      }
      else {
        sprintf(acStack_114 + local_10 * 3,"%02x-",(uint)(byte)local_14[local_10]);
      }
    }
    iVar1 = duss_log_gen_head(0x5c,0,auStack_194,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_conn_req_info_dump",0x29);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_194,"wms: wifi_conn dump id=%d, len=%d, buf=%s",local_c,
                     local_14[0x20],acStack_114);
    }
  }
  return;
}



undefined4 FUN_0001b028(char *param_1,char *param_2,int *param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c0 [128];
  undefined auStack_40 [32];
  undefined4 local_20;
  size_t local_1c;
  int local_18;
  undefined *local_14;
  int local_10;
  char *local_c;
  
  local_18 = 0xff;
  local_1c = 0;
  sscanf(param_1,"id%d",&local_18);
  if (*param_3 == local_18) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_conn_req_info_parse",0x37);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"wms: wifi_conn check the duplicate index, %u, line %d",
                     local_18,param_4);
    }
    uVar2 = 0xffffffff;
  }
  else {
    *param_3 = local_18;
    local_14 = &DAT_0008579c + local_18 * 0x21;
    local_c = strchr(param_2,0x3a);
    if (local_c == (char *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_conn_req_info_parse",0x3f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c0,"wms: wifi_conn format err, line %d, buf %s",param_4,
                       param_2);
      }
      uVar2 = 0xffffffff;
    }
    else {
      sscanf(param_2,"%d",&local_1c);
      if (((int)local_1c < 1) || (0x20 < (int)local_1c)) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                  ,"wifi_conn_req_info_parse",0x44);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_c0,"wms: wifi_conn len err, line %d, len %d, buf %s",param_4
                         ,local_1c,param_2);
        }
        uVar2 = 0xffffffff;
      }
      else {
        local_14[0x20] = (char)local_1c;
        *local_c = '\0';
        local_c = local_c + 1;
        for (local_10 = 0; local_10 < (int)local_1c; local_10 = local_10 + 1) {
          if (local_1c - 1 == local_10) {
            sscanf(local_c,"%02x",&local_20);
            local_c = local_c + 2;
          }
          else {
            sscanf(local_c,"%02x-",&local_20);
            local_c = local_c + 3;
          }
          auStack_40[local_10] = (char)local_20;
        }
        memcpy(local_14,auStack_40,local_1c);
        uVar2 = 0;
      }
    }
  }
  return uVar2;
}



bool FUN_0001b26e(void *param_1,byte param_2,int *param_3)

{
  int iVar1;
  undefined auStack_94 [131];
  byte local_11;
  undefined *local_10;
  int local_c;
  
  local_c = 0;
  do {
    iVar1 = local_c * 0x21;
    local_10 = &DAT_0008579c + iVar1;
    if ((&DAT_000857bc)[iVar1] == '\0') {
      *param_3 = local_c;
      return false;
    }
    local_11 = param_2;
    if ((byte)(&DAT_000857bc)[iVar1] <= param_2) {
      local_11 = (&DAT_000857bc)[iVar1];
    }
    iVar1 = memcmp(local_10,param_1,(uint)local_11);
    if (iVar1 == 0) {
      if (param_2 == local_10[0x20]) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                  ,"wifi_conn_req_info_check",0x6b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_94,"wms: wifi_conn same to %d, len %d",local_c,param_2);
        }
        break;
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_conn_req_info_check",0x6e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_94,"wms: wifi_conn new %d, len differ, %d != %d",local_c,
                       param_2,local_10[0x20]);
      }
    }
    else {
      local_c = local_c + 1;
    }
  } while (local_c < 10);
  *param_3 = local_c;
  return local_c < 10;
}



void FUN_0001b3c8(void *param_1,byte param_2,int param_3)

{
  int local_24;
  
  if (param_3 < 10) {
    if ((param_3 == -1) || (param_3 == 0)) goto LAB_0001b47c;
  }
  else {
    local_24 = 9;
    param_3 = local_24;
  }
  while (local_24 = param_3 + -1, -1 < local_24) {
    memcpy(&DAT_0008579c + param_3 * 0x21,&DAT_0008579c + local_24 * 0x21,
           (uint)(&DAT_000857bc)[local_24 * 0x21]);
    (&DAT_000857bc)[param_3 * 0x21] = (&DAT_000857bc)[local_24 * 0x21];
    param_3 = local_24;
  }
LAB_0001b47c:
  memcpy(&DAT_0008579c,param_1,(uint)param_2);
  DAT_000857bc = param_2;
  return;
}



undefined4 FUN_0001b4a4(char *param_1)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  undefined4 uVar4;
  undefined auStack_19c [128];
  int iStack_11c;
  char local_118 [256];
  FILE *local_18;
  int local_14;
  int local_10;
  char *local_c;
  
  memset(local_118,0,0x100);
  local_10 = 0;
  local_14 = 0;
  local_18 = (FILE *)0x0;
  iVar1 = access(param_1,0);
  if (iVar1 == 0) {
    local_18 = fopen(param_1,"r");
    if (local_18 == (FILE *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_19c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_conn_req_info_get",0xa1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_19c,"wms: Could not open file, %s",param_1);
      }
      uVar4 = 0xffffffff;
    }
    else {
      while (pcVar3 = fgets(local_118,0x100,local_18), pcVar3 != (char *)0x0) {
        local_10 = local_10 + 1;
        sVar2 = strlen(local_118);
        local_14 = local_14 + sVar2;
        if (local_118[0] != '#') {
          for (local_c = local_118; *local_c != '\0'; local_c = local_c + 1) {
            if (*local_c == '\n') {
              *local_c = '\0';
              break;
            }
          }
          if (local_118[0] != '\0') {
            local_c = strchr(local_118,0x3a);
            if (local_c == (char *)0x0) {
              iVar1 = duss_log_gen_head(0x5c,2,auStack_19c,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                        ,"wifi_conn_req_info_get",0xb9);
              if (iVar1 != 0) {
                duss_log_print(0x5c,2,auStack_19c,"wms: Line %d: format invalid line \'%s\'\n",
                               local_10,local_118);
              }
            }
            else {
              *local_c = '\0';
              local_c = local_c + 1;
              FUN_0001b028(local_118,local_c,&iStack_11c,local_10);
            }
          }
        }
      }
      uVar4 = 0;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_19c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_conn_req_info_get",0x9b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_19c,"wms: Could not find file, %s",param_1);
    }
    uVar4 = 0xfffffffa;
  }
  return uVar4;
}



undefined4 FUN_0001b6b4(char *param_1,void *param_2,byte param_3,char *param_4,int param_5)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  undefined auStack_654 [128];
  char acStack_5d4 [256];
  char acStack_4d4 [1200];
  undefined *local_24;
  int local_20;
  FILE *local_1c;
  int local_18;
  byte local_12;
  byte local_11;
  
  memset(acStack_4d4,0,0x4b0);
  memset(acStack_5d4,0,0x100);
  local_1c = (FILE *)0x0;
  local_20 = 0;
  local_18 = 0;
  if ((param_5 == 0) && (param_4 == (char *)0x1)) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_654,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_conn_req_info_set",0xce);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_654,"wms: wifi_conn in list id0, no need update");
    }
    uVar2 = 0;
  }
  else {
    pcVar3 = 
    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c";
    iVar1 = duss_log_gen_head(0x5c,2,auStack_654,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_conn_req_info_set",0xd2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_654,"wms: wifi_conn set exist %d, index %d update",param_4,
                     param_5);
      pcVar3 = param_4;
    }
    FUN_0001b3c8(param_2,param_3,param_5);
    local_1c = fopen(param_1,"w");
    if (local_1c == (FILE *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_654,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_conn_req_info_set",0xdb);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_654,"wms: wifi_conn open file %s failed",param_1);
      }
      uVar2 = 0xffffffff;
    }
    else {
      fwrite("## conn_whitelist ##",1,0x14,local_1c);
      fputc(10,local_1c);
      memset(acStack_4d4,0,0x4b0);
      local_12 = 0;
      while( true ) {
        if ((9 < local_12) ||
           (local_24 = &DAT_0008579c + (uint)local_12 * 0x21,
           (&DAT_000857bc)[(uint)local_12 * 0x21] == '\0')) goto LAB_0001b9de;
        memset(acStack_5d4,0,0x100);
        for (local_11 = 0; local_11 < (byte)local_24[0x20]; local_11 = local_11 + 1) {
          if ((uint)local_11 == (byte)local_24[0x20] - 1) {
            sprintf(acStack_5d4 + (uint)local_11 * 3,"%02x",(uint)(byte)local_24[local_11],
                    (uint)(byte)local_24[local_11],pcVar3);
          }
          else {
            sprintf(acStack_5d4 + (uint)local_11 * 3,"%02x-",(uint)(byte)local_24[local_11],
                    (uint)(byte)local_24[local_11],pcVar3);
          }
        }
        pcVar3 = acStack_5d4;
        local_20 = sprintf(acStack_4d4 + local_18,"id%d:%d:%s\n",(uint)local_12,
                           (uint)(byte)local_24[0x20],pcVar3);
        if (local_20 < 1) break;
        local_18 = local_20 + local_18;
        local_12 = local_12 + 1;
      }
      iVar1 = duss_log_gen_head(0x5c,1,auStack_654,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_conn_req_info_set",0xf0);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_654,"wms: wifi_conn sprintf id=%d, len=%d, file=%s failed",
                       local_12,local_24[0x20],param_1);
      }
LAB_0001b9de:
      fprintf(local_1c,acStack_4d4);
      fflush(local_1c);
      fclose(local_1c);
      uVar2 = 0;
    }
  }
  return uVar2;
}



size_t FUN_0001ba08(undefined *param_1)

{
  size_t sVar1;
  
  sVar1 = FUN_0002101e(param_1);
  return sVar1;
}



size_t FUN_0001ba20(undefined *param_1)

{
  size_t sVar1;
  
  sVar1 = FUN_00020ef6(param_1);
  return sVar1;
}



undefined4 FUN_0001ba38(void *param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00021176(param_1);
  return uVar1;
}



int FUN_0001ba50(char *param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002126a(param_1);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_mgmt_set_ssid",0x117);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: wms_mgmt return fail:%d\n",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_0001babe(void *param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0002131c(param_1);
  return uVar1;
}



int FUN_0001bad6(char *param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_00021414(param_1);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_mgmt_set_passwd",0x128);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: wms_mgmt return fail:%d\n",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_0001bb44(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00020ebe();
  return uVar1;
}



int FUN_0001bb52(byte param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = 0;
  local_c = FUN_0002157c(param_1);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_mgmt_set_channel",0x139);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: wms_mgmt return fail:%d\n",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_0001bbca(byte *param_1)

{
  byte bVar1;
  undefined4 uVar2;
  
  bVar1 = FUN_00021694();
  *param_1 = bVar1;
  if (*param_1 < 3) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0001bbf6(char param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  char acStack_c [3];
  char local_9;
  
  local_9 = FUN_00021694();
  if (local_9 == param_1) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_mgmt_set_band",0x14f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: wms_mgmt same band:%d\n",param_1);
    }
    uVar2 = 0;
  }
  else {
    FUN_00021772(acStack_c);
    iVar1 = FUN_0001f752(acStack_c);
    if ((iVar1 == 0) || (param_1 == '\0')) {
      FUN_000216ae(param_1);
      uVar2 = FUN_0001d29e(param_1);
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                                ,"wifi_mgmt_set_band",0x155);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_8c,"wms: wms_mgmt 2.4G only country:%s, not support 5G\n",
                       acStack_c);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_0001bce4(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_0001f752(param_1);
  if (iVar1 == 0) {
    FUN_000216ae('\x01');
  }
  else {
    FUN_000216ae('\0');
  }
  uVar2 = FUN_0002180e(param_1);
  return uVar2;
}



undefined4 FUN_0001bd16(undefined *param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00021772(param_1);
  return uVar1;
}



undefined4 FUN_0001bd2e(undefined *param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001d76c(param_1);
  return uVar1;
}



undefined4 FUN_0001bd46(void)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_0001fc4a();
  if (iVar1 == 0) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = FUN_0001d994();
  }
  return uVar2;
}



undefined4 FUN_0001bd64(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  if (param_1 == (byte *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//wifi_mgmt/wifi_config.c"
                              ,"wifi_mgmt_get_wifi_quanlity",0x188);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: %s bad parameter\r\n","wifi_mgmt_get_wifi_quanlity");
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = FUN_0001e082(param_1);
  }
  return uVar2;
}



undefined4 FUN_0001bdd4(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  undefined4 extraout_r1;
  
  uVar1 = FUN_00020c64(param_1,param_2,param_3);
  FUN_0001d754(uVar1,extraout_r1,param_3,param_4);
  return 0;
}



undefined4 FUN_0001bde8(char *param_1)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined auStack_bc [128];
  char acStack_3c [16];
  ushort local_2c [8];
  int local_1c;
  ushort *local_18;
  undefined4 local_14;
  
  local_14 = 0;
  if (param_1 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_net_ifconfig_down",0x41);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"wms: w_ctrl_ip: UP parameter invalid");
    }
    local_14 = 0xffffffff;
  }
  else {
    memset(acStack_3c,0,0x20);
    strncpy(acStack_3c,param_1,0xf);
    local_18 = local_2c;
    local_2c[0] = 2;
    local_1c = socket(2,2,0);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_net_ifconfig_down",0x4b);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        pcVar3 = strerror(*piVar2);
        duss_log_print(0x5c,1,auStack_bc,"wms: w_ctrl_ip: down socket failed %s",pcVar3);
      }
      local_14 = 0xffffffff;
    }
    else {
      iVar1 = ioctl(local_1c,0x8913,acStack_3c);
      if (iVar1 < 0) {
        piVar2 = __errno_location();
        if (*piVar2 == 0x13) {
          local_14 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                    ,"device_net_ifconfig_down",0x55);
          if (iVar1 != 0) {
            piVar2 = __errno_location();
            iVar1 = *piVar2;
            piVar2 = __errno_location();
            pcVar3 = strerror(*piVar2);
            duss_log_print(0x5c,1,auStack_bc,"wms: w_ctrl_ip: down %s get failed %d %s",param_1,
                           iVar1,pcVar3);
          }
          local_14 = 0xffffffff;
        }
      }
      else {
        local_2c[0] = local_2c[0] & 0xffbe;
        iVar1 = ioctl(local_1c,0x8914,acStack_3c);
        if (iVar1 < 0) {
          piVar2 = __errno_location();
          if (*piVar2 == 0x13) {
            local_14 = 0;
          }
          else {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                      ,"device_net_ifconfig_down",0x60);
            if (iVar1 != 0) {
              piVar2 = __errno_location();
              pcVar3 = strerror(*piVar2);
              duss_log_print(0x5c,1,auStack_bc,"wms: w_ctrl_ip: down %s set failed %s",param_1,
                             pcVar3);
            }
          }
        }
      }
      close(local_1c);
    }
  }
  return local_14;
}



undefined4 FUN_0001c018(char *param_1,char *param_2,char *param_3,uint param_4,int param_5)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined auStack_b8 [128];
  char acStack_38 [16];
  uint local_28 [4];
  uint *local_18;
  int local_14;
  undefined4 local_10;
  int local_c;
  
  local_c = 0;
  local_10 = 0xffffffff;
  local_14 = 0;
  if (((param_1 == (char *)0x0) || (param_2 == (char *)0x0)) || (param_3 == (char *)0x0)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_net_ifconfig_up",0x6f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: UP parameter invalid");
    }
    local_10 = 0xffffffff;
  }
  else {
    while( true ) {
      while( true ) {
        while( true ) {
          while( true ) {
            while( true ) {
              while( true ) {
                while( true ) {
                  while( true ) {
                    if (local_14 != 0) {
                      duss_osal_task_sleep(300000);
                    }
                    if (param_5 < local_14) {
                      local_10 = 0xffffffff;
                      goto LAB_0001c53a;
                    }
                    local_14 = local_14 + 1;
                    if (local_c != 0) {
                      close(local_c);
                    }
                    memset(acStack_38,0,0x20);
                    strncpy(acStack_38,param_1,0xf);
                    local_18 = local_28;
                    // WARNING: Ignoring partial resolution of indirect
                    local_28[0]._0_2_ = 2;
                    local_c = socket(2,2,0);
                    if (-1 < local_c) break;
                    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                              ,"device_net_ifconfig_up",0x83);
                    if (iVar1 != 0) {
                      piVar2 = __errno_location();
                      pcVar3 = strerror(*piVar2);
                      duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: socket failed %s",pcVar3);
                    }
                    local_c = 0;
                  }
                  iVar1 = inet_aton(param_2,(in_addr *)(local_18 + 1));
                  if (-1 < iVar1) break;
                  iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                            ,"device_net_ifconfig_up",0x8a);
                  if (iVar1 != 0) {
                    duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: invalid ip %s",param_2);
                  }
                }
                iVar1 = ioctl(local_c,0x8916,acStack_38);
                if (-1 < iVar1) break;
                iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                          "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                          ,"device_net_ifconfig_up",0x8e);
                if (iVar1 != 0) {
                  piVar2 = __errno_location();
                  pcVar3 = strerror(*piVar2);
                  duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: set ip %s failed %s",param_2,
                                 pcVar3);
                }
              }
              iVar1 = inet_aton(param_3,(in_addr *)(local_18 + 1));
              if (-1 < iVar1) break;
              iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                        ,"device_net_ifconfig_up",0x94);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: invalid mask %s",param_3);
              }
            }
            iVar1 = ioctl(local_c,0x891c,acStack_38);
            if (-1 < iVar1) break;
            iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                      ,"device_net_ifconfig_up",0x98);
            if (iVar1 != 0) {
              piVar2 = __errno_location();
              pcVar3 = strerror(*piVar2);
              duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: set mask %s failed %s",param_2,
                             pcVar3);
            }
          }
          local_28[0] = param_4;
          iVar1 = ioctl(local_c,0x8921,acStack_38);
          if ((iVar1 < 0) &&
             (iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                        ,"device_net_ifconfig_up",0x9f), iVar1 != 0)) {
            piVar2 = __errno_location();
            pcVar3 = strerror(*piVar2);
            duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: set mtu %s failed %s",param_2,pcVar3);
          }
          iVar1 = ioctl(local_c,0x8913,acStack_38);
          if (-1 < iVar1) break;
          iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                    ,"device_net_ifconfig_up",0xa3);
          if (iVar1 != 0) {
            piVar2 = __errno_location();
            pcVar3 = strerror(*piVar2);
            duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: detect %s get failed %s",param_1,
                           pcVar3);
          }
        }
        local_28[0] = local_28[0] | 0x41;
        iVar1 = ioctl(local_c,0x8914,acStack_38);
        if (-1 < iVar1) break;
        iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_net_ifconfig_up",0xa8);
        if (iVar1 != 0) {
          piVar2 = __errno_location();
          pcVar3 = strerror(*piVar2);
          duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: up %s set failed %s",param_1,pcVar3);
        }
      }
      local_28[0] = local_28[0] & 0xffff0000;
      iVar1 = ioctl(local_c,0x8913,acStack_38);
      if (-1 < iVar1) break;
      iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_net_ifconfig_up",0xaf);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        pcVar3 = strerror(*piVar2);
        duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: up %s get failed %s",param_1,pcVar3);
      }
    }
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_net_ifconfig_up",0xb2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"wms: w_ctrl_ip: netdev status %x",(int)(short)local_28[0]);
    }
    local_10 = 0;
LAB_0001c53a:
    if (local_c != 0) {
      close(local_c);
    }
  }
  return local_10;
}



undefined4 FUN_0001c556(void)

{
  int iVar1;
  undefined4 uVar2;
  bool bVar3;
  undefined auStack_98 [128];
  int local_18;
  __pid_t local_14;
  int local_10;
  int local_c;
  
  local_c = 10;
  local_10 = FUN_0001fc6c("hostapd");
  if (local_10 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_stop_hostapd",0xc6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"wms: hostapd is not yet started");
    }
    uVar2 = 0xffffffff;
  }
  else if (DAT_000858ea == '\0') {
    uVar2 = 0;
  }
  else {
    local_18 = FUN_0001bde8("wlan0");
    if ((local_18 < 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_stop_hostapd",0xd0), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_98,"wms: w_ctrl stop softap network down failed");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_stop_hostapd",0xd3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"wms: killing hostapd...");
    }
    kill(local_10,9);
    usleep(100000);
    while (iVar1 = local_c + -1, bVar3 = local_c != 0, local_c = iVar1, bVar3) {
      local_14 = waitpid(local_10,&local_18,1);
      if ((0 < local_14) && (local_14 == local_10)) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_stop_hostapd",0xda);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_98,"wms: w_ctrl_softap: child %d status %d exited",local_10,
                         local_18);
        }
        break;
      }
      usleep(300000);
    }
    if ((local_c < 1) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_stop_hostapd",0xe0), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_98,"wms: w_ctrl_softap exit failed");
    }
    system("busybox pkill -f udhcpd");
    DAT_000858ea = '\0';
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0001c76e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  __pid_t local_c;
  
  local_c = FUN_0001fc6c("hostapd");
  if (local_c < 1) {
    local_c = fork();
    if (local_c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"hostapd_start_cmdline",0xf3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"wms: hostapd fork failed");
      }
      uVar2 = 0xffffffff;
    }
    else {
      if (local_c == 0) {
        iVar1 = execl(DAT_000833e4,DAT_000833e4,&DAT_00059f7c,"/tmp/hostapd.conf",0);
        if (iVar1 != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                    ,"hostapd_start_cmdline",0xfb);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_8c,"wms: hostapd execl failed");
          }
          return 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"hostapd_start_cmdline",0x100);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"wms: hostapd: %d started successfully",local_c);
        }
        DAT_00085d38 = local_c;
        FUN_0001ef6a('\x01',"busybox udhcpd /etc/udhcpd_wifi.conf",local_c,&DAT_00085d38);
      }
      uVar2 = 0;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"hostapd_start_cmdline",0xed);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: w_ctrl_hostapd still run pid %d",local_c);
    }
    uVar2 = 0;
  }
  return uVar2;
}



int FUN_0001c90c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c8 [128];
  char acStack_48 [32];
  undefined2 local_28;
  undefined local_26;
  byte local_24;
  byte local_23;
  byte local_22;
  byte local_21;
  byte local_20;
  byte local_1f;
  int local_1c;
  
  local_28 = 0;
  uVar2 = 0;
  local_26 = 0;
  if (DAT_000858e9 == '\x01') {
    local_1c = 0;
  }
  else {
    if ((DAT_000858f0 ^ 1) == 0) {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"cypress_insmod_ko",0x137);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_c8,"wms: %s has insmoded\n","/lib/modules/bcmdhd.ko");
      }
    }
    else {
      FUN_0001ef6a('\0',"echo on > /sys/kernel/bcm_detect/foo",0,(uint)(DAT_000858f0 ^ 1));
      usleep(150000);
      FUN_00021772((undefined *)&local_28);
      iVar1 = FUN_0001f6ec((char *)&local_28);
      if (iVar1 == 0) {
        FUN_0001ef6a('\x01',
                     "cp /lib/firmware/wifi/bcm943455wlsagb_Type1MW_Common_MP_180322.txt /tmp/nvram.txt"
                     ,uVar2,0);
      }
      else {
        FUN_0001ef6a('\x01',
                     "cp /lib/firmware/wifi/bcm943455wlsagb_Type1MW_Common_MP_180322_ce.txt /tmp/nvram.txt"
                     ,uVar2,iVar1);
      }
      FUN_00020ef6(&local_24);
      sprintf(acStack_48,"%02X:%02X:%02X:%02X:%02X:%02X",(uint)local_24,(uint)local_23,
              (uint)local_22,(uint)local_21,(uint)local_20,(uint)local_1f);
      FUN_0001ef6a('\x01',"insmod %s firmware_path=%s nvram_path=%s amba_initmac=%s clm_path=%s",
                   "/lib/modules/bcmdhd.ko","/lib/firmware/wifi/43455_7.45.203_noclminc-clm_min.bin"
                  );
      DAT_000858f0 = 1;
    }
    local_1c = FUN_0001c018("wlan0","192.168.2.1","255.255.255.0",0x5dc,0xf);
    if (local_1c == 0) {
      iVar1 = FUN_0001f6b2((byte *)&local_28);
      if (iVar1 == 0) {
        FUN_0001ef6a('\x01',"iw reg set %c%c",(uint)(byte)local_28,(uint)local_28._1_1_);
      }
      FUN_0001e6c6();
      DAT_000858e9 = '\x01';
      iVar1 = duss_log_gen_head(0x5c,0,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"cypress_insmod_ko",0x14f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_c8,"wms: sucess!\n");
      }
      local_1c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_c8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"cypress_insmod_ko",0x142);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_c8,"wms: start wifi failed, no wlan0\n");
      }
    }
  }
  return local_1c;
}



void FUN_0001cb5e(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  uint uVar2;
  undefined auStack_88 [128];
  
  uVar2 = (uint)DAT_000858e9;
  if (uVar2 != 0) {
    FUN_0001ef6a('\x01',"wl down",param_3,uVar2);
    FUN_0001ef6a('\x01',"ifconfig wlan0 down",param_3,uVar2);
    DAT_000858e9 = 0;
    iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"cypress_rmmod_ko",0x163);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_88,"wms: cypress_rmmod_ko sucess!\n");
    }
  }
  return;
}



void FUN_0001cbe2(void)

{
  FUN_0001ef6a('\x01',"insmod %s firmware_path=%s nvram_path=%s clm_path=%s",
               "/lib/modules/bcmdhd.ko","/lib/firmware/wifi/fw_43455c0_sdio_mfgtest.bin");
  return;
}



undefined4 FUN_0001cc20(void)

{
  int iVar1;
  undefined auStack_f8 [128];
  undefined2 local_78;
  undefined local_76;
  undefined auStack_74 [64];
  undefined auStack_34 [36];
  undefined4 local_10;
  char local_a;
  byte local_9;
  
  memset(auStack_34,0,0x21);
  memset(auStack_74,0,0x40);
  local_78 = 0;
  local_76 = 0;
  if (DAT_000858ea == '\x01') {
    local_10 = 0;
  }
  else {
    local_a = FUN_00021694();
    iVar1 = FUN_0002167a();
    if (iVar1 == 0) {
      local_9 = FUN_00021562();
    }
    else {
      local_9 = FUN_0001ee3e(local_a);
    }
    FUN_0002157c(local_9);
    FUN_00021176(auStack_34);
    FUN_0002131c(auStack_74);
    FUN_0001ef6a('\0',"cp %s %s","/etc/hostapd.conf","/tmp/hostapd.conf");
    FUN_0001f1fa("/tmp/hostapd.conf",&DAT_0005a2fc,auStack_34);
    FUN_0001f1fa("/tmp/hostapd.conf","wpa_passphrase",auStack_74);
    if (local_9 < 0xf) {
      FUN_0001f1fa("/tmp/hostapd.conf","hw_mode",&DAT_0005a314);
      FUN_0001f28a("/tmp/hostapd.conf","vht_oper_chwidth",0);
    }
    else {
      FUN_0001f1fa("/tmp/hostapd.conf","hw_mode",&DAT_0005a334);
      FUN_0001f28a("/tmp/hostapd.conf","vht_oper_chwidth",1);
      if ((((local_9 == 0x24) || (local_9 == 0x28)) || (local_9 == 0x2c)) || (local_9 == 0x30)) {
        FUN_0001f28a("/tmp/hostapd.conf","vht_oper_centr_freq_seg0_idx",0x2a);
      }
      else if (((local_9 == 0x34) || (local_9 == 0x38)) || ((local_9 == 0x3c || (local_9 == 0x40))))
      {
        FUN_0001f28a("/tmp/hostapd.conf","vht_oper_centr_freq_seg0_idx",0x3a);
      }
      else if (((local_9 == 0x95) || (local_9 == 0x99)) || ((local_9 == 0x9d || (local_9 == 0xa1))))
      {
        FUN_0001f28a("/tmp/hostapd.conf","vht_oper_centr_freq_seg0_idx",0x9b);
      }
    }
    FUN_0001f28a("/tmp/hostapd.conf","channel",(uint)local_9);
    FUN_00021772((undefined *)&local_78);
    FUN_0001f1fa("/tmp/hostapd.conf","country_code",&local_78);
    local_10 = FUN_0001c76e();
    DAT_000858ea = '\x01';
    iVar1 = duss_log_gen_head(0x5c,0,auStack_f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_start_hostapd",0x1c3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_f8,"wms: hostapd start ret %d\n",local_10);
    }
  }
  return local_10;
}



int FUN_0001ceb8(void)

{
  int iVar1;
  undefined auStack_94 [128];
  int local_14;
  int local_10;
  int local_c;
  
  if (DAT_000858e8 == '\0') {
    local_c = FUN_0001faca();
    local_10 = FUN_0001c90c();
    if (local_10 == 0) {
      local_10 = FUN_0001cc20();
      if (local_10 == 0) {
        local_14 = FUN_0001faca();
        if ((200 < (uint)(local_14 - local_c)) &&
           (iVar1 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                      ,"device_start_wifi",0x1f2), iVar1 != 0)) {
          duss_log_print(0x5c,0,auStack_94,"wms: wifi start ok, cost time:%dms\n",local_14 - local_c
                        );
        }
        FUN_00020ede();
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,2,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_start_wifi",0x1ec);
        if (iVar1 != 0) {
          duss_log_print(0x5c,2,auStack_94,"wms: start wifi fail, hostapd not run\n");
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_start_wifi",0x1e6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_94,"wms: insmod fail, ret:%d\n",local_10);
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_start_wifi",0x1d1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_94,"wms: in mfg mode, just return\n");
    }
    local_10 = 0;
  }
  return local_10;
}



undefined4 FUN_0001d04a(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  undefined4 extraout_r1;
  undefined4 extraout_r1_00;
  char local_d;
  uint local_c;
  
  if (DAT_000858e8 == '\0') {
    local_c = FUN_0001fc04(&local_d);
    if (local_d == '\0') {
      uVar1 = FUN_0001c556();
      FUN_0001cb5e(uVar1,extraout_r1,param_3);
      FUN_00020ede();
    }
    else if ((local_d != '\x02') || (0x3c < local_c)) {
      uVar1 = FUN_0001c556();
      if (0x3d < local_c) {
        FUN_0001cb5e(uVar1,extraout_r1_00,param_3);
        FUN_0001fb5e('\0');
      }
      FUN_00020ede();
    }
  }
  return 0;
}



int FUN_0001d0b8(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined8 uVar2;
  
  uVar2 = FUN_0001fb5e('\0');
  FUN_0001d04a((int)uVar2,(int)((ulonglong)uVar2 >> 0x20),param_3);
  usleep(150000);
  iVar1 = FUN_0001ceb8();
  return iVar1;
}



int FUN_0001d0de(ushort *param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int extraout_r1;
  int extraout_r1_00;
  int iVar4;
  int extraout_r1_01;
  int iVar5;
  undefined8 uVar6;
  int local_c;
  
  uVar1 = FUN_0001ef6a('\x01',"wl down",param_3,0);
  uVar2 = FUN_0001ef6a('\x01',"wl mpc 0",uVar1,uVar1);
  uVar3 = FUN_0001ef6a('\x01',"wl scansuppress 0",uVar2,uVar1 + uVar2);
  iVar5 = uVar1 + uVar2 + uVar3;
  uVar1 = FUN_0001ef6a('\x01',"wl phy_watchdog 0",uVar3,iVar5);
  iVar5 = iVar5 + uVar1;
  uVar1 = FUN_0001ef6a('\x01',"wl country ALL",uVar1,iVar5);
  if (*(byte *)((int)param_1 + 3) == 0) {
    uVar2 = FUN_0001ef6a('\x01',"wl band b",uVar1,0);
    iVar4 = extraout_r1;
  }
  else {
    uVar2 = FUN_0001ef6a('\x01',"wl band a",uVar1,(uint)*(byte *)((int)param_1 + 3));
    iVar4 = extraout_r1_00;
  }
  local_c = iVar5 + uVar1 + uVar2;
  if ((*(char *)((int)param_1 + 3) == '\0') && (*(char *)((int)param_1 + 5) == '(')) {
    uVar2 = FUN_0001ef6a('\x01',"wl mimo_bw_cap 1",uVar2,0x28);
    uVar6 = FUN_0001f4f6((uint)*param_1,extraout_r1_01);
    iVar5 = (int)((ulonglong)uVar6 >> 0x20);
    if ((int)uVar6 < 7) {
      uVar6 = FUN_0001f4f6((uint)*param_1,iVar5);
      uVar1 = FUN_0001ef6a('\x01',"wl chanspec %dl",(int)uVar6,(int)uVar6);
      local_c = local_c + uVar2 + uVar1;
    }
    else {
      uVar6 = FUN_0001f4f6((uint)*param_1,iVar5);
      uVar1 = FUN_0001ef6a('\x01',"wl chanspec %du",(int)uVar6,(int)uVar6);
      local_c = local_c + uVar2 + uVar1;
    }
  }
  else {
    uVar6 = FUN_0001f4f6((uint)*param_1,iVar4);
    uVar1 = FUN_0001ef6a('\x01',"wl chanspec %d/%d",(int)uVar6,(uint)*(byte *)((int)param_1 + 5));
    local_c = local_c + uVar1;
  }
  uVar1 = FUN_0001ef6a('\x01',"wl up",uVar1,local_c);
  uVar2 = FUN_0001ef6a('\x01',"wl phy_forcecal 1",uVar1,local_c + uVar1);
  iVar5 = local_c + uVar1 + uVar2;
  uVar1 = FUN_0001ef6a('\x01',"wl scansuppress 1",uVar2,iVar5);
  iVar5 = iVar5 + uVar1;
  uVar1 = FUN_0001ef6a('\x01',"wl phy_txpwrctrl 1",uVar1,iVar5);
  return iVar5 + uVar1;
}



undefined4 FUN_0001d29e(char param_1)

{
  int iVar1;
  undefined *puVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined auStack_8c [131];
  byte local_9;
  
  puVar2 = auStack_8c;
  iVar1 = duss_log_gen_head(0x5c,3,puVar2,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                            ,"device_set_band",599);
  if (iVar1 != 0) {
    puVar2 = auStack_8c;
    duss_log_print(0x5c,3,puVar2,"wms: enter\n");
  }
  uVar3 = (uint)DAT_000858ea;
  if (uVar3 == 1) {
    FUN_0001c556();
    usleep(600000);
    FUN_0001ef6a('\0',"ifconfig wlan0 up",puVar2,uVar3);
    local_9 = FUN_0001ee3e(param_1);
    FUN_0002157c(local_9);
    uVar4 = FUN_0001cc20();
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_set_band",0x25a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_8c,"wms: hostapd is not started, do noting\n");
    }
    uVar4 = 0;
  }
  return uVar4;
}



int FUN_0001d382(ushort *param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  undefined4 extraout_r1;
  undefined4 extraout_r1_00;
  undefined1 *puVar4;
  undefined4 local_1c;
  undefined4 uStack_18;
  int local_c;
  
  local_c = 0;
  puVar4 = (undefined1 *)(uint)DAT_000858e8;
  if (puVar4 == (undefined1 *)0x0) {
    uVar1 = FUN_0001c556();
    FUN_0001cb5e(uVar1,extraout_r1,param_3);
    FUN_0001ef6a('\0',"echo on > /sys/kernel/bcm_detect/foo",param_3,puVar4);
    usleep(150000);
    FUN_0001ef6a('\x01',
                 "cp /lib/firmware/wifi/bcm943455wlsagb_Type1MW_Common_MP_180322.txt /tmp/nvram.txt"
                 ,param_3,puVar4);
    FUN_0001cbe2();
    FUN_0001c018("wlan0","192.168.2.1","255.255.255.0",0x5dc,10);
    puVar4 = &DAT_000858e8;
    param_3 = 1;
    DAT_000858e8 = 1;
  }
  FUN_0001ef6a('\x01',"wl pkteng_stop tx",param_3,puVar4);
  FUN_0001ef6a('\x01',"wl pkteng_stop rx",param_3,puVar4);
  if ((*(char *)(param_1 + 1) == '\x01') || (*(char *)(param_1 + 1) == '\x06')) {
    if (*(char *)((int)param_1 + 3) == '\0') {
      local_1c._0_1_ = '2';
      local_1c._1_1_ = 'g';
      local_1c._2_1_ = '_';
      local_1c._3_1_ = 'r';
    }
    else {
      if (*(char *)((int)param_1 + 3) != '\x01') {
        printf("wl test: band error:%d\n",(uint)*(byte *)((int)param_1 + 3));
        return -1;
      }
      local_1c._0_1_ = '5';
      local_1c._1_1_ = 'g';
      local_1c._2_1_ = '_';
      local_1c._3_1_ = 'r';
    }
    uStack_18._0_1_ = 'a';
    uStack_18._1_1_ = 't';
    uStack_18._2_1_ = 'e';
    uStack_18._3_1_ = '\0';
    iVar2 = FUN_0001d0de(param_1,0x657461,&local_1c);
    local_c = local_c + iVar2;
    switch(*(undefined *)(param_1 + 2)) {
    case 0:
    case 1:
    case 2:
      uVar3 = FUN_0001ef6a('\x01',"wl %s -r %d -b %d",&local_1c,(uint)*(byte *)(param_1 + 3));
      local_c = local_c + uVar3;
      break;
    case 3:
      uVar3 = FUN_0001ef6a('\x01',"wl %s -h %d -b %d",&local_1c,(uint)*(byte *)(param_1 + 3));
      local_c = local_c + uVar3;
      break;
    case 4:
      uVar3 = FUN_0001ef6a('\x01',"wl %s -v %d -b %d",&local_1c,(uint)*(byte *)(param_1 + 3));
      local_c = local_c + uVar3;
      break;
    default:
      printf("wl test: rate mode error:%d\n",(uint)*(byte *)(param_1 + 2));
      return -1;
    }
    if (*(char *)((int)param_1 + 7) == '\0') {
      uVar3 = FUN_0001ef6a('\x01',"wl txpwr1 -1",uVar3,0);
      local_c = local_c + uVar3;
    }
    else {
      uVar3 = FUN_0001ef6a('\x01',"wl txpwr1 -o -d %d",(int)*(char *)((int)param_1 + 7),
                           (int)*(char *)((int)param_1 + 7));
      local_c = local_c + uVar3;
    }
    uVar3 = FUN_0001ef6a('\x01',"wl pkteng_start 00:11:22:33:44:55 tx 100 2048 %d",
                         *(undefined4 *)(param_1 + 6),*(undefined4 *)(param_1 + 6));
    local_c = local_c + uVar3;
    if (*(char *)(param_1 + 1) == '\x06') {
      uVar3 = FUN_0001ef6a('\x01',"wl down",uVar3,6);
      local_c = local_c + uVar3;
      uVar3 = FUN_0001ef6a('\x01',"wl country ALL",uVar3,local_c);
      local_c = local_c + uVar3;
      if (*(byte *)((int)param_1 + 3) == 0) {
        uVar3 = FUN_0001ef6a('\x01',"wl band b",uVar3,0);
        local_c = local_c + uVar3;
      }
      else {
        uVar3 = FUN_0001ef6a('\x01',"wl band a",uVar3,(uint)*(byte *)((int)param_1 + 3));
        local_c = local_c + uVar3;
      }
      uVar3 = FUN_0001ef6a('\x01',"wl mpc 0",uVar3,local_c);
      local_c = local_c + uVar3;
      uVar3 = FUN_0001ef6a('\x01',"wl up",uVar3,local_c);
      local_c = local_c + uVar3;
      uVar3 = FUN_0001ef6a('\x01',"wl phy_txpwrctrl 0",uVar3,local_c);
      local_c = local_c + uVar3;
      uVar3 = FUN_0001ef6a('\x01',"wl phy_txpwrindex 120",uVar3,local_c);
      local_c = local_c + uVar3;
      uVar3 = FUN_0001ef6a('\x01',"wl phy_tx_tone 10",uVar3,local_c);
      local_c = local_c + uVar3;
    }
  }
  else if (*(char *)(param_1 + 1) == '\x02') {
    iVar2 = FUN_0001d0de(param_1,extraout_r1_00,param_3);
    local_c = local_c + iVar2;
    uVar3 = FUN_0001ef6a('\x01',"wl pkteng_start 00:11:22:33:44:55 rx",iVar2,local_c);
    local_c = local_c + uVar3;
    uVar3 = FUN_0001ef6a('\x01',"wl reset_cnts",uVar3,local_c);
    local_c = local_c + uVar3;
  }
  return local_c;
}



undefined4 FUN_0001d6ce(int param_1)

{
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
  local_10 = 0;
  local_c = 0;
  local_14 = 0;
  FUN_0001f3f6("wl counters |grep pktengrxdmcast |awk \'{print $2+$4}\'","/tmp/rx_packet",&local_10,
               8);
  sscanf((char *)&local_10,"%d",&local_14);
  *(undefined4 *)(param_1 + 8) = local_14;
  return 0;
}



undefined4 FUN_0001d724(void)

{
  return 0;
}



undefined4 FUN_0001d73c(void)

{
  return 0;
}



undefined4 FUN_0001d754(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_0001ef6a('\x01',"insmod /usr/lib/modules/bcm_detect.ko",param_3,param_4);
  return 0;
}



undefined4 FUN_0001d76c(undefined *param_1)

{
  undefined uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_164 [128];
  int local_e4;
  undefined4 local_e0;
  int local_dc;
  char acStack_d8 [128];
  char acStack_58 [8];
  char acStack_50 [32];
  undefined auStack_30 [20];
  size_t local_1c;
  char *local_18;
  int local_14;
  
  memset(acStack_d8,0,0x80);
  local_18 = "wl assoclist | grep -c assoclist";
  local_e0 = 0;
  local_e4 = 0;
  FUN_0001f438("wl assoclist | grep -c assoclist",&local_e0,4);
  iVar2 = sscanf((char *)&local_e0,"%d",&local_e4);
  if (iVar2 == 1) {
    if (local_e4 == 0) {
      DAT_000858ec = 0;
      uVar3 = 0xfffffffa;
    }
    else {
      for (local_14 = 1; local_14 <= local_e4; local_14 = local_14 + 1) {
        memset(acStack_d8,0,0x80);
        snprintf(acStack_d8,0x80,"wl assoclist | awk \'NR==%d{print $2}\'",local_14);
        local_1c = FUN_0001f3f6(acStack_d8,"/tmp/tmp_peer_mac",auStack_30,0x14);
        if ((int)local_1c < 6) {
          return 0xffffffff;
        }
        FUN_0001f31a((int)auStack_30,'\n');
        sprintf(acStack_50,"wl rssi %s",auStack_30);
        local_1c = FUN_0001f3f6(acStack_50,"/tmp/tmp_peer_rssi",acStack_58,8);
        if ((int)local_1c < 2) {
          return 0xffffffff;
        }
        local_1c = sscanf(acStack_58,"%d",&local_dc);
        if (local_1c != 1) {
          return 0xffffffff;
        }
        uVar1 = FUN_0001fb06(local_dc);
        *param_1 = uVar1;
        DAT_000858ec = local_dc;
        if ((DAT_000858f4 % 5 == 0) &&
           (iVar2 = duss_log_gen_head(0x5c,0,auStack_164,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                      ,"device_get_link_strength",0x321), iVar2 != 0)) {
          duss_log_print(0x5c,0,auStack_164,
                         "wms: total_link=%d/%d, rssi: %d, strength %u%%, peer_mac %s\n",local_14,
                         local_e4,local_dc,*param_1,auStack_30);
        }
      }
      DAT_000858f4 = DAT_000858f4 + 1;
      uVar3 = 0;
    }
  }
  else {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_0001d994(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_e4 [128];
  int local_64;
  int local_60;
  char acStack_5c [80];
  size_t local_c;
  
  local_c = FUN_0001f3f6("cat /proc/net/dev | grep wlan0 | awk \'{print $2, $10}\'","/tmp/net_stats"
                         ,acStack_5c,0x50);
  if ((int)local_c < 2) {
    uVar2 = 0xffffffff;
  }
  else {
    local_c = sscanf(acStack_5c,"%u %u",&local_60,&local_64);
    if (local_c == 2) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_e4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_stats",0x33d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_e4,"wms: rx speed:%dkbps, tx speed:%dkbps\n",
                       (uint)(local_60 - DAT_000858f8) >> 7,(uint)(local_64 - DAT_000858fc) >> 7);
      }
      DAT_000858f8 = local_60;
      DAT_000858fc = local_64;
      uVar2 = 0;
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0001da7e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_134 [128];
  int local_b4;
  int local_b0;
  char acStack_ac [80];
  char acStack_5c [80];
  size_t local_c;
  
  local_c = FUN_0001f3f6("/bin/wl counters |grep txbcnfrm |awk \'{print $4}\'","/tmp/wifi_tx_beacon"
                         ,acStack_5c,0x50);
  if ((int)local_c < 2) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_134,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_get_beacon_info",0x350);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_134,"wms: run wl counters txbcnfrm fail:%d\r\n",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_c = sscanf(acStack_5c,"%u",&local_b0);
    if (local_c == 1) {
      local_c = FUN_0001f3f6("/bin/wl dtim |awk \'{print $0}\'","/tmp/wifi_tx_dtim",acStack_ac,0x50)
      ;
      if ((int)local_c < 2) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_134,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_get_beacon_info",0x35c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_134,"wms: run wl dtim fail:%d\r\n",local_c);
        }
        uVar2 = 0xffffffff;
      }
      else {
        local_c = sscanf(acStack_ac,"%u",&local_b4);
        if (local_c == 1) {
          iVar1 = duss_log_gen_head(0x5c,0,auStack_134,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                    ,"device_get_beacon_info",0x365);
          if (iVar1 != 0) {
            duss_log_print(0x5c,0,auStack_134,"wms: wifi_sta bcn_diff:%d bcn_per:%d ms\n",
                           local_b0 - DAT_00085900,local_b4 * 100);
          }
          DAT_00085900 = local_b0;
          uVar2 = 0;
        }
        else {
          uVar2 = 0xffffffff;
        }
      }
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0001dc2c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_cc [128];
  undefined auStack_4c [32];
  undefined auStack_2c [32];
  size_t local_c;
  
  memset(auStack_2c,0,0x20);
  memset(auStack_4c,0,0x20);
  local_c = FUN_0001f3f6("/bin/wl country |awk \'{print $2}\'","/tmp/wl_country",auStack_2c,0x20);
  if ((int)local_c < 2) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_get_cc_info",0x374);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_cc,"wms: run wl country fail:%d\r\n",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_c = FUN_0001f3f6("/bin/wl status |grep Channel: |awk \'{print $13}\'","/tmp/wl_channel",
                           auStack_4c,0x20);
    if ((int)local_c < 2) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_cc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_cc_info",0x37b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_cc,"wms: run wl channel fail:%d\r\n",local_c);
      }
      uVar2 = 0xffffffff;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_cc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_cc_info",0x37f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_cc,"wms: wifi_sta %s %s\n",auStack_2c,auStack_4c);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_0001dd82(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_12c [128];
  undefined auStack_ac [80];
  undefined auStack_5c [80];
  size_t local_c;
  
  memset(auStack_5c,0,0x50);
  memset(auStack_ac,0,0x50);
  local_c = FUN_0001f3f6("/bin/wl nrate","/tmp/wl_nrate",auStack_5c,0x50);
  if ((int)local_c < 2) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_12c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_get_mcs_info",0x38d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_12c,"wms: run wl nrate fail:%d\r\n",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_c = FUN_0001f3f6("/bin/wl rate","/tmp/wl_rate",auStack_ac,0x50);
    if ((int)local_c < 2) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_12c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_mcs_info",0x394);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_12c,"wms: run wl rate fail:%d\r\n",local_c);
      }
      uVar2 = 0xffffffff;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_12c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_mcs_info",0x398);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_12c,"wms: wifi_sta wl_nrate:%s wl_rate:%s\n",auStack_5c,
                       auStack_ac);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_0001deda(uint *param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined auStack_a0 [128];
  undefined4 local_20;
  uint local_1c;
  undefined4 local_18;
  FILE *local_14;
  
  local_14 = (FILE *)0x0;
  if (param_1 == (uint *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_get_sw_send",0x3b1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a0,"wms: %s bad parameter\n","device_get_sw_send");
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_14 = fopen("/tmp/sw_send_calc","rb");
    if (local_14 == (FILE *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_sw_send",0x3b7);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a0,"wms: %s open %s fail\n","device_get_sw_send",
                       "/tmp/sw_send_calc");
      }
      uVar3 = 0xffffffff;
    }
    else {
      rewind(local_14);
      fread(&local_20,1,0xc,local_14);
      uVar2 = DAT_00085904 + 1;
      if ((DAT_00085904 % 5 == 0) || (DAT_00085904 = uVar2, 0x32 < local_1c)) {
        DAT_00085904 = uVar2;
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                  ,"device_get_sw_send",0x3be);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a0,"wms: avgDSockMs:%d avgTcpMs:%d totalCount:%d\n",local_20
                         ,local_1c,local_18);
        }
      }
      *param_1 = local_1c;
      fclose(local_14);
      uVar3 = 0;
    }
  }
  return uVar3;
}



undefined4 FUN_0001e082(byte *param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  ulonglong uVar4;
  undefined4 *puVar5;
  undefined auStack_164 [128];
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  int local_d4;
  undefined4 local_d0;
  int local_cc;
  uint local_c8;
  char acStack_c4 [80];
  char acStack_74 [80];
  size_t local_24;
  byte local_1e;
  byte local_1d;
  uint local_1c;
  
  local_1c = 0;
  local_1d = 0xff;
  local_1e = 0xff;
  local_c8 = 0;
  local_cc = 0;
  local_d0 = 0;
  local_d4 = 0;
  local_d8 = 0;
  local_dc = 0;
  local_e0 = 0;
  local_e4 = 0;
  if (param_1 == (byte *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_164,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                              ,"device_get_wifi_quanlity",0x3e1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_164,"wms: %s bad parameter\r\n","device_get_wifi_quanlity");
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_24 = FUN_0001f3f6("/bin/wl counters |grep txframe |awk \'{print $2, $4, $6, $8}\'",
                            "/tmp/wifi_tx_sta",acStack_74,0x50);
    if ((int)local_24 < 2) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_164,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                ,"device_get_wifi_quanlity",1000);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_164,"wms: run wl counters txframe fail:%d\r\n",local_24);
      }
      uVar3 = 0xffffffff;
    }
    else {
      puVar5 = &local_d8;
      local_24 = sscanf(acStack_74,"%u %u %u %u",&local_cc,&local_d0,&local_d4,puVar5);
      if (local_24 == 4) {
        local_24 = FUN_0001f3f6("/bin/wl counters |grep rxframe |awk \'{print $2, $4, $6}\'",
                                "/tmp/wifi_rx_sta",acStack_c4,0x50);
        if ((int)local_24 < 2) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_164,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                    ,"device_get_wifi_quanlity",0x3f4);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_164,"wms: run wl counters txframe fail:%d\r\n",local_24);
          }
          uVar3 = 0xffffffff;
        }
        else {
          local_24 = sscanf(acStack_c4,"%u %u %u",&local_dc,&local_e0,&local_e4,puVar5);
          if (local_24 == 3) {
            if (local_cc == DAT_00085908) {
              local_1d = 0xff;
            }
            else {
              uVar4 = FUN_000576ac((local_d4 - DAT_0008590c) * 100,local_cc - DAT_00085908);
              local_1c = (uint)uVar4;
              if (local_1c < 0x1e) {
                if (local_1c < 0x14) {
                  if (local_1c < 10) {
                    local_1d = 0;
                  }
                  else {
                    local_1d = 1;
                  }
                }
                else {
                  local_1d = 2;
                }
              }
              else {
                local_1d = 3;
              }
            }
            iVar1 = FUN_0001deda(&local_c8);
            if (iVar1 == 0) {
              if (local_c8 < 4) {
                if (local_c8 < 2) {
                  if (local_c8 == 0) {
                    local_1e = 0;
                  }
                  else {
                    local_1e = 1;
                  }
                }
                else {
                  local_1e = 2;
                }
              }
              else {
                local_1e = 3;
              }
              if (1 < local_1e) {
                local_1d = local_1e;
              }
            }
            if (DAT_000858ec + 0x4b < 0 != SCARRY4(DAT_000858ec,0x4b)) {
              local_1d = 3;
            }
            *param_1 = local_1d;
            uVar2 = DAT_00085910 + 1;
            if ((DAT_00085910 % 5 == 0) || (DAT_00085910 = uVar2, local_1d != DAT_00085914)) {
              DAT_00085910 = uVar2;
              FUN_0001dc2c();
              FUN_0001dd82();
              FUN_0001da7e();
              iVar1 = duss_log_gen_head(0x5c,0,auStack_164,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                        ,"device_get_wifi_quanlity",0x42a);
              if (iVar1 != 0) {
                duss_log_print(0x5c,0,auStack_164,
                               "wms: wifi_sta tx_frames:%u tx_bytes:%u tx_retrans:%u tx_fail:%u\n",
                               local_cc,local_d0,local_d4,local_d8);
              }
              iVar1 = duss_log_gen_head(0x5c,0,auStack_164,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                        ,"device_get_wifi_quanlity",0x42b);
              if (iVar1 != 0) {
                duss_log_print(0x5c,0,auStack_164,
                               "wms: wifi_sta rx_frames:%u rx_bytes:%u rx_errs:%u\n",local_dc,
                               local_e0,local_e4);
              }
              if (local_1d == 0xff) {
                iVar1 = duss_log_gen_head(0x5c,0,auStack_164,0x80,
                                          "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                          ,"device_get_wifi_quanlity",0x42d);
                if (iVar1 != 0) {
                  duss_log_print(0x5c,0,auStack_164,
                                 "wms: wifi_sta tcp_wait:(%d %d) rssi:%d q_level:%d\n",local_c8,
                                 local_1e,DAT_000858ec,local_1d);
                }
              }
              else {
                iVar1 = duss_log_gen_head(0x5c,0,auStack_164,0x80,
                                          "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/cypress43455/cypress_bss_mgmt.c"
                                          ,"device_get_wifi_quanlity",0x431);
                if (iVar1 != 0) {
                  duss_log_print(0x5c,0,auStack_164,
                                 "wms: wifi_sta retry:%d%%(%d/%d) tcp_wait:(%d %d) ms rssi:%d q_level:%d\n"
                                 ,local_1c,local_d4 - DAT_0008590c,local_cc - DAT_00085908,local_c8,
                                 local_1e,DAT_000858ec,local_1d);
                }
              }
            }
            DAT_00085914 = local_1d;
            DAT_00085908 = local_cc;
            DAT_0008590c = local_d4;
            uVar3 = 0;
          }
          else {
            uVar3 = 0xffffffff;
          }
        }
      }
      else {
        uVar3 = 0xffffffff;
      }
    }
  }
  return uVar3;
}



uint FUN_0001e5a4(int param_1,byte param_2,int param_3)

{
  uint local_c;
  
  for (local_c = 0;
      ((int)local_c < (int)(uint)param_2 && (*(int *)(param_1 + local_c * 0xc) != param_3));
      local_c = local_c + 1) {
  }
  return local_c & 0xff;
}



undefined4 FUN_0001e5f6(int param_1)

{
  undefined4 uVar1;
  
  if (param_1 + 0x28 < 0 == SCARRY4(param_1,0x28)) {
    uVar1 = 0xc;
  }
  else if (param_1 + 0x32 < 0 == SCARRY4(param_1,0x32)) {
    uVar1 = 10;
  }
  else if (param_1 + 0x3c < 0 == SCARRY4(param_1,0x3c)) {
    uVar1 = 8;
  }
  else if (param_1 + 0x46 < 0 == SCARRY4(param_1,0x46)) {
    uVar1 = 6;
  }
  else if (param_1 + 0x50 < 0 == SCARRY4(param_1,0x50)) {
    uVar1 = 4;
  }
  else if (param_1 + 0x55 < 0 == SCARRY4(param_1,0x55)) {
    uVar1 = 2;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 FUN_0001e654(int param_1)

{
  undefined4 uVar1;
  
  if (param_1 < 0xc) {
    if (param_1 < 8) {
      if (param_1 < 4) {
        if (param_1 < 1) {
          uVar1 = 0;
        }
        else {
          uVar1 = 1;
        }
      }
      else {
        uVar1 = 2;
      }
    }
    else {
      uVar1 = 3;
    }
  }
  else {
    uVar1 = 4;
  }
  return uVar1;
}



undefined4 FUN_0001e692(int param_1)

{
  undefined4 uVar1;
  
  if (param_1 < 0xaf) {
    if (param_1 < 100) {
      if (param_1 < 0x32) {
        uVar1 = 0;
      }
      else {
        uVar1 = 2;
      }
    }
    else {
      uVar1 = 3;
    }
  }
  else {
    uVar1 = 4;
  }
  return uVar1;
}



undefined4 FUN_0001e6c6(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  FILE *__stream;
  uint uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined auStack_644 [128];
  undefined4 auStack_5c4 [21];
  undefined4 local_570;
  undefined4 auStack_56c [4];
  undefined4 uStack_55c;
  undefined4 uStack_558;
  undefined4 uStack_554;
  undefined4 local_550;
  undefined4 uStack_54c;
  undefined4 uStack_548;
  undefined4 uStack_544;
  undefined4 local_540;
  undefined4 auStack_53c [4];
  undefined4 uStack_52c;
  undefined4 uStack_528;
  undefined4 uStack_524;
  undefined4 local_520;
  undefined local_51c [8];
  undefined local_514 [4];
  char *local_510;
  char acStack_50c [1024];
  char acStack_10c [4];
  undefined4 local_108;
  undefined4 uStack_104;
  undefined4 uStack_100;
  undefined4 uStack_fc;
  undefined4 local_f8;
  undefined2 local_f4;
  undefined local_f2;
  uint local_40;
  byte local_39;
  FILE *local_38;
  int local_34;
  int local_30;
  undefined local_2a;
  undefined local_29;
  undefined4 *local_28;
  uint local_24;
  int local_20;
  uint local_1c;
  
  local_1c = 0;
  local_29 = 1;
  local_2a = 0x95;
  local_30 = 0xffff;
  local_34 = 0xffff;
  local_540 = 0x96c;
  auStack_53c[0] = 1;
  auStack_53c[1] = 0x1f;
  auStack_53c[2] = 0x985;
  auStack_53c[3] = 6;
  uStack_52c = 0x1f;
  uStack_528 = 0x99e;
  uStack_524 = 0xb;
  local_520 = 0x1f;
  local_570 = 0x1671;
  auStack_56c[0] = 0x95;
  auStack_56c[1] = 0;
  auStack_56c[2] = 0x1685;
  auStack_56c[3] = 0x99;
  uStack_55c = 0;
  uStack_558 = 0x1699;
  uStack_554 = 0x9d;
  local_550 = 0;
  uStack_54c = 0x16ad;
  uStack_548 = 0xa1;
  uStack_544 = 0;
  uVar5 = 0x54;
  memcpy(auStack_5c4,&DAT_0005b1a8,0x54);
  iVar3 = FUN_0002167a();
  if (iVar3 == 0) {
    iVar3 = duss_log_gen_head(0x5c,0,auStack_644,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/common/simple_acs.c"
                              ,"acs_scan_all",0x77);
    if (iVar3 != 0) {
      uVar5 = FUN_00021562();
      duss_log_print(0x5c,0,auStack_644,"wms: ACS skip, manual channel=%d\n",uVar5);
    }
  }
  else {
    FUN_0001ef6a('\0',"iw dev wlan0 scan trigger flush",uVar5,iVar3);
    FUN_00021772(acStack_10c);
    iVar3 = FUN_0001f752(acStack_10c);
    if (iVar3 == 0) {
      local_28 = auStack_5c4;
      local_24 = 7;
    }
    else {
      local_28 = &local_540;
      local_24 = 3;
      iVar3 = duss_log_gen_head(0x5c,0,auStack_644,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/common/simple_acs.c"
                                ,"acs_scan_all",0x83);
      if (iVar3 != 0) {
        duss_log_print(0x5c,0,auStack_644,"wms: 2g only country:%s, only scan 2g channel\n",
                       acStack_10c);
      }
    }
    local_108._0_1_ = 'i';
    local_108._1_1_ = 'w';
    local_108._2_1_ = ' ';
    local_108._3_1_ = 'd';
    uStack_104._0_1_ = 'e';
    uStack_104._1_1_ = 'v';
    uStack_104._2_1_ = ' ';
    uStack_104._3_1_ = 'w';
    uStack_100._0_1_ = 'l';
    uStack_100._1_1_ = 'a';
    uStack_100._2_1_ = 'n';
    uStack_100._3_1_ = '0';
    uStack_fc._0_1_ = ' ';
    uStack_fc._1_1_ = 's';
    uStack_fc._2_1_ = 'c';
    uStack_fc._3_1_ = 'a';
    local_f8._0_1_ = 'n';
    local_f8._1_1_ = ' ';
    local_f8._2_1_ = 'f';
    local_f8._3_1_ = 'r';
    local_f4 = 0x7165;
    local_f2 = 0;
    local_1c = 0x16;
    for (local_20 = 0; local_20 < (int)local_24; local_20 = local_20 + 1) {
      iVar3 = sprintf((char *)((int)&local_108 + local_1c)," %d",local_28[local_20 * 3]);
      local_1c = local_1c + iVar3;
    }
    puVar1 = (undefined4 *)" | grep -E \'freq:|signal:|channel utilisation:|station count\'";
    puVar2 = (undefined4 *)((int)&local_108 + local_1c);
    do {
      puVar9 = puVar2;
      puVar8 = puVar1;
      uVar5 = puVar8[1];
      uVar6 = puVar8[2];
      uVar7 = puVar8[3];
      *puVar9 = *puVar8;
      puVar9[1] = uVar5;
      puVar9[2] = uVar6;
      puVar9[3] = uVar7;
      puVar1 = puVar8 + 4;
      puVar2 = puVar9 + 4;
    } while (puVar8 + 4 != (undefined4 *)0x5afe8);
    uVar5 = puVar8[5];
    uVar6 = puVar8[6];
    puVar9[4] = 0x69746174;
    puVar9[5] = uVar5;
    puVar9[6] = uVar6;
    *(undefined2 *)(puVar9 + 7) = *(undefined2 *)(puVar8 + 7);
    local_1c = FUN_0001ef6a('\x01',"%s > %s",&local_108,"/tmp/scan_res");
    if (local_1c == 0) {
      local_38 = (FILE *)0x0;
      __stream = fopen("/tmp/scan_res","r");
      local_38 = __stream;
      if (__stream != (FILE *)0x0) {
        fgets(local_514 + 8,0x400,__stream);
        while (iVar3 = feof(local_38), iVar3 == 0) {
          local_1c = sscanf(local_514 + 8," freq: %d",local_514 + 4);
          if (local_1c == 1) {
            uVar4 = FUN_0001e5a4((int)local_28,(byte)local_24,(int)local_510);
            local_39 = (byte)uVar4;
            if ((uVar4 & 0xff) == local_24) {
              __stream = local_38;
              fgets(local_514 + 8,0x400,local_38);
            }
            else {
              fgets(local_514 + 8,0x400,local_38);
              __stream = (FILE *)local_514;
              local_1c = sscanf(local_514 + 8," signal: %d");
              if (local_1c == 1) {
                iVar3 = FUN_0001e5f6((int)local_514);
                local_28[(uint)local_39 * 3 + 2] = local_28[(uint)local_39 * 3 + 2] + iVar3;
                fgets(local_514 + 8,0x400,local_38);
                __stream = (FILE *)(local_51c + 4);
                local_1c = sscanf(local_514 + 8," * station count: %d");
                if (local_1c == 1) {
                  fgets(local_514 + 8,0x400,local_38);
                  __stream = (FILE *)local_51c;
                  local_1c = sscanf(local_514 + 8," * channel utilisation: %d");
                  if (local_1c == 1) {
                    iVar3 = FUN_0001e654(local_51c._4_4_);
                    local_28[(uint)local_39 * 3 + 2] = local_28[(uint)local_39 * 3 + 2] + iVar3;
                    iVar3 = FUN_0001e692(local_51c._0_4_);
                    local_28[(uint)local_39 * 3 + 2] = local_28[(uint)local_39 * 3 + 2] + iVar3;
                    __stream = local_38;
                    fgets(local_514 + 8,0x400,local_38);
                  }
                }
              }
            }
          }
          else {
            __stream = local_38;
            fgets(local_514 + 8,0x400,local_38);
          }
        }
        fclose(local_38);
        FUN_0001ef6a('\0',"echo \'acs result:\'> /tmp/acs_result",__stream,iVar3);
        for (local_20 = 0; local_20 < (int)local_24; local_20 = local_20 + 1) {
          FUN_0001ef6a('\0',"echo \'chan:%d weight:%d\'>> /tmp/acs_result",
                       local_28[local_20 * 3 + 1],local_28[local_20 * 3 + 2]);
          if ((uint)local_28[local_20 * 3 + 1] < 0xf) {
            if ((int)local_28[local_20 * 3 + 2] < local_30) {
              local_29 = (undefined)local_28[local_20 * 3 + 1];
              local_30 = local_28[local_20 * 3 + 2];
            }
          }
          else if ((int)local_28[local_20 * 3 + 2] < local_34) {
            local_2a = (undefined)local_28[local_20 * 3 + 1];
            local_34 = local_28[local_20 * 3 + 2];
          }
        }
        DAT_000833e8 = local_29;
        DAT_000833e9 = local_2a;
        if (local_30 < local_34) {
          DAT_000833ea = local_29;
        }
        else {
          DAT_000833ea = local_2a;
        }
        iVar3 = duss_log_gen_head(0x5c,0,auStack_644,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/common/simple_acs.c"
                                  ,"acs_scan_all",0xdb);
        if (iVar3 != 0) {
          duss_log_print(0x5c,0,auStack_644,
                         "wms: ACS: best 2g chan:%d, weight:%d; best 5g chan:%d, weight:%d\n",
                         local_29,local_30,local_2a,local_34);
        }
        iVar3 = duss_log_gen_head(0x5c,0,auStack_644,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/common/simple_acs.c"
                                  ,"acs_scan_all",0xdc);
        if (iVar3 == 0) {
          return 0;
        }
        duss_log_print(0x5c,0,auStack_644,"wms: ACS: best all:%d\n",DAT_000833ea);
        return 0;
      }
    }
    uVar4 = random();
    local_40 = uVar4 % 3;
    local_29 = (undefined)auStack_53c[(uVar4 % 3) * 3];
    uVar4 = random();
    local_40 = uVar4 & 3;
    DAT_000833e9 = (undefined)auStack_56c[(uVar4 & 3) * 3];
    DAT_000833e8 = local_29;
    DAT_000833ea = DAT_000833e9;
    local_2a = DAT_000833e9;
    iVar3 = duss_log_gen_head(0x5c,0,auStack_644,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//device/common/simple_acs.c"
                              ,"acs_scan_all",0xf2);
    if (iVar3 != 0) {
      duss_log_print(0x5c,0,auStack_644,
                     "wms: ACS error, use random chan. best_2g_chan: %d, best_5g_chan: %d\n",
                     local_29,local_2a);
    }
  }
  return 0;
}



undefined FUN_0001ee3e(char param_1)

{
  undefined uVar1;
  
  uVar1 = DAT_000833e9;
  if ((param_1 != '\x01') && (uVar1 = DAT_000833e8, param_1 == '\x02')) {
    uVar1 = DAT_000833ea;
  }
  return uVar1;
}



void hex_dump(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  int local_e4;
  undefined auStack_d4 [128];
  char acStack_54 [64];
  int local_14;
  int local_10;
  int local_c;
  
  local_10 = param_2;
  for (local_e4 = param_3; 0 < local_e4; local_e4 = local_e4 - local_14) {
    memset(acStack_54,0,0x40);
    local_14 = local_e4;
    if (0xf < local_e4) {
      local_14 = 0x10;
    }
    for (local_c = 0; local_c < local_14; local_c = local_c + 1) {
      sprintf(acStack_54 + local_c * 3,"%02x ",(uint)*(byte *)(local_c + local_10));
    }
    iVar1 = duss_log_gen_head(0x5c,0,auStack_d4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"hex_dump",0x22);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_d4,"wms: %s:  %s\n",param_1,acStack_54);
    }
    local_10 = local_14 + local_10;
  }
  return;
}



uint FUN_0001ef6a(char param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined auStack_1a4 [128];
  undefined4 *local_124;
  char acStack_120 [256];
  int local_20;
  uint local_1c;
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  uStack_8 = param_3;
  uStack_4 = param_4;
  memset(acStack_120,0,0x100);
  local_20 = 0;
  local_1c = 0xffffffff;
  local_124 = &uStack_8;
  local_20 = vsnprintf(acStack_120,0x100,param_2,local_124);
  if ((local_20 < 1) || (0xff < local_20)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"_run_sys_cmd",0x41);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a4,"wms: cmd len err: %d\n",local_20);
    }
  }
  else {
    if (param_1 != '\0') {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                ,"_run_sys_cmd",0x46);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_1a4,"wms: %s\n",acStack_120);
      }
    }
    local_1c = system(acStack_120);
    if (local_1c == 0xffffffff) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                ,"_run_sys_cmd",0x4b);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        pcVar3 = strerror(*piVar2);
        duss_log_print(0x5c,1,auStack_1a4,"wms: system_call failed %s reason %s",acStack_120,pcVar3)
        ;
      }
    }
    else if ((local_1c & 0x7f) == 0) {
      if ((local_1c >> 8 & 0xff) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                  ,"_run_sys_cmd",0x4f);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a4,"wms: run cmd %s is ok",acStack_120);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                  ,"_run_sys_cmd",0x51);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1a4,"wms: run cmd failed err %d %s",local_1c >> 8 & 0xff,
                         acStack_120);
        }
        local_1c = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                ,"_run_sys_cmd",0x55);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1a4,"wms: run cmd failed may be by signal %s",acStack_120);
      }
      local_1c = 0xffffffff;
    }
  }
  return local_1c;
}



undefined4 FUN_0001f1fa(char *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  iVar1 = access(param_1,0);
  if (iVar1 == 0) {
    FUN_0001ef6a('\0',"sed -i \'s/^%s=.*/%s=%s/\' %s",param_2,param_2);
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"update_str_config_file",0x67);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: %s is not found, update %s=%s failed",param_1,param_2,
                     param_3);
    }
    uVar2 = 0xfffffffa;
  }
  return uVar2;
}



undefined4 FUN_0001f28a(char *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  iVar1 = access(param_1,0);
  if (iVar1 == 0) {
    FUN_0001ef6a('\0',"sed -i \'s/^%s=.*/%s=%d/\' %s",param_2,param_2);
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"update_int_config_file",0x78);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: %s is not found, update %s=%d failed",param_1,param_2,
                     param_3);
    }
    uVar2 = 0xfffffffa;
  }
  return uVar2;
}



void FUN_0001f31a(int param_1,char param_2)

{
  int local_10;
  int local_c;
  
  local_10 = 0;
  for (local_c = 0; *(char *)(local_c + param_1) != '\0'; local_c = local_c + 1) {
    if (param_2 != *(char *)(local_c + param_1)) {
      *(undefined *)(param_1 + local_10) = *(undefined *)(local_c + param_1);
      local_10 = local_10 + 1;
    }
  }
  *(undefined *)(local_10 + param_1) = 0;
  return;
}



size_t FUN_0001f37c(char *param_1,void *param_2,size_t param_3)

{
  FILE *__stream;
  size_t sVar1;
  
  if (param_3 == 0) {
    sVar1 = 0xffffffff;
  }
  else {
    __stream = fopen(param_1,"rb");
    if (__stream == (FILE *)0x0) {
      sVar1 = 0xffffffff;
    }
    else {
      sVar1 = fread(param_2,1,param_3,__stream);
      if (-1 < (int)sVar1) {
        if ((int)sVar1 < (int)param_3) {
          *(undefined *)(sVar1 + (int)param_2) = 0;
        }
        else {
          *(undefined *)((param_3 - 1) + (int)param_2) = 0;
        }
      }
      fclose(__stream);
    }
  }
  return sVar1;
}



size_t FUN_0001f3f6(undefined4 param_1,char *param_2,void *param_3,size_t param_4)

{
  uint uVar1;
  size_t sVar2;
  
  uVar1 = FUN_0001ef6a('\0',"%s > %s",param_1,param_2);
  if (uVar1 == 0) {
    sVar2 = FUN_0001f37c(param_2,param_3,param_4);
  }
  else {
    sVar2 = 0xffffffff;
  }
  return sVar2;
}



size_t FUN_0001f438(char *param_1,void *param_2,size_t param_3)

{
  FILE *__stream;
  size_t local_c;
  
  __stream = popen(param_1,"r");
  if (__stream == (FILE *)0x0) {
    local_c = 0xffffffff;
  }
  else {
    local_c = fread(param_2,1,param_3,__stream);
    if (-1 < (int)local_c) {
      if ((int)local_c < (int)param_3) {
        *(undefined *)(local_c + (int)param_2) = 0;
      }
      else {
        *(undefined *)((param_3 - 1) + (int)param_2) = 0;
      }
    }
    pclose(__stream);
  }
  return local_c;
}



undefined8 FUN_0001f4f6(int param_1,int param_2)

{
  int iVar1;
  
  if (param_1 == 0x9b4) {
    iVar1 = 0xe;
  }
  else if (param_1 < 0x9b4) {
    iVar1 = param_1 + -0x967 >> 0x1f;
    param_2 = (param_1 + -0x967) / 5 + iVar1;
    iVar1 = param_2 - iVar1;
  }
  else if ((param_1 < 0x132e) || (0x1374 < param_1)) {
    if (param_1 < 0xafc9) {
      param_2 = (param_1 + -5000) * 0x66666667;
      iVar1 = (param_1 + -5000) / 5;
    }
    else if ((param_1 < 0xe3d0) || (0xfd20 < param_1)) {
      iVar1 = 0;
    }
    else {
      param_2 = (param_1 + -0xdb60) * -0xd4629b7;
      iVar1 = (param_1 + -0xdb60) / 0x870;
    }
  }
  else {
    iVar1 = param_1 + -4000 >> 0x1f;
    param_2 = (param_1 + -4000) / 5 + iVar1;
    iVar1 = param_2 - iVar1;
  }
  return CONCAT44(param_2,iVar1);
}



undefined4 FUN_0001f5c2(pthread_t *param_1,__start_routine *param_2,void *param_3)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined auStack_ac [128];
  pthread_attr_t pStack_2c;
  
  pthread_attr_init(&pStack_2c);
  pthread_attr_setdetachstate(&pStack_2c,1);
  iVar1 = pthread_create(param_1,&pStack_2c,param_2,param_3);
  if (iVar1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"pthread_create_detach",0x134);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_ac,"wms: pthread_create failed: %d",*piVar2);
    }
    uVar3 = 0xffffffff;
  }
  else {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_0001f654(byte param_1)

{
  undefined4 uVar1;
  
  if (((param_1 < 0x61) || (0x7a < param_1)) && ((param_1 < 0x41 || (0x5a < param_1)))) {
    uVar1 = 0;
  }
  else {
    uVar1 = 1;
  }
  return uVar1;
}



undefined4 FUN_0001f6b2(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_0001f654(*param_1);
  if ((iVar1 == 0) || (iVar1 = FUN_0001f654(param_1[1]), iVar1 == 0)) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0001f6ec(char *param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (0x26 < local_c) {
      return 0;
    }
    if ((*param_1 == *(&PTR_DAT_000833ec)[local_c]) &&
       (param_1[1] == (&PTR_DAT_000833ec)[local_c][1])) break;
    local_c = local_c + 1;
  }
  return 1;
}



undefined4 FUN_0001f752(char *param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (3 < local_c) {
      return 0;
    }
    if ((*param_1 == *(&PTR_DAT_00083488)[local_c]) &&
       (param_1[1] == (&PTR_DAT_00083488)[local_c][1])) break;
    local_c = local_c + 1;
  }
  return 1;
}



undefined4 FUN_0001f7b8(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_9c [128];
  int local_1c;
  
  local_1c = (uint)param_1[1] + (uint)*param_1 + (uint)param_1[2] + (uint)param_1[3] +
             (uint)param_1[4] + (uint)param_1[5];
  if ((local_1c == 0) || (local_1c == 0x5fa)) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"check_mac_addr",0x194);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_9c,"wms: mac is invalid:%02x:%02x:%02x:%02x:%02x:%02x\n",
                     *param_1,param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
    }
    uVar2 = 0xfffffffd;
  }
  else if ((*param_1 & 1) == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"check_mac_addr",0x199);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_9c,"wms: mac[0] is invalid:%02x\n",*param_1);
    }
    uVar2 = 0xfffffffd;
  }
  return uVar2;
}



undefined4 FUN_0001f8ec(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  uint local_c;
  
  local_c = ((uint)*(byte *)(param_1 + 4) << 8 | (uint)*(byte *)(param_1 + 3) << 0x10 |
            (uint)*(byte *)(param_1 + 5)) + 1;
  *(char *)(param_1 + 3) = (char)(local_c >> 0x10);
  *(char *)(param_1 + 4) = (char)(local_c >> 8);
  *(char *)(param_1 + 5) = (char)local_c;
  if (local_c >> 0x18 == 0) {
    uVar2 = 1;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"increase_mac_addr",0x1ac);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: low_mac is overflow: 0x%x\n",local_c);
    }
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 * FUN_0001f9a4(byte *param_1,undefined4 *param_2)

{
  if (param_1 == (byte *)0x0) {
    *param_2 = 0x4c4c554e;
    *(undefined *)(param_2 + 1) = 0;
  }
  else {
    snprintf((char *)param_2,0x12,"%02x:%02x:%02x:%02x:%02x:%02x",(uint)*param_1,(uint)param_1[1],
             (uint)param_1[2],(uint)param_1[3],(uint)param_1[4],(uint)param_1[5]);
  }
  return param_2;
}



undefined4 FUN_0001fa22(char *param_1,int param_2)

{
  size_t sVar1;
  int iVar2;
  long lVar3;
  undefined4 uVar4;
  undefined *puVar5;
  char *local_9c;
  undefined auStack_94 [128];
  int local_14;
  
  local_14 = 0;
  sVar1 = strlen(param_1);
  if (sVar1 == 0x11) {
    local_9c = param_1;
    for (local_14 = 5; -1 < local_14; local_14 = local_14 + -1) {
      puVar5 = (undefined *)(param_2 + local_14);
      lVar3 = strtol(local_9c,(char **)0x0,0x10);
      *puVar5 = (char)lVar3;
      local_9c = local_9c + 3;
    }
    uVar4 = 1;
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,2,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                              ,"str2macaddr",0x1c7);
    if (iVar2 != 0) {
      duss_log_print(0x5c,2,auStack_94,"wms: illegal mac string format: %s",param_1);
    }
    uVar4 = 0;
  }
  return uVar4;
}



int FUN_0001faca(void)

{
  timespec local_1c [2];
  
  clock_gettime(1,local_1c);
  return local_1c[0].tv_nsec / 1000000 + local_1c[0].tv_sec * 1000;
}



undefined FUN_0001fb06(int param_1)

{
  undefined local_9;
  
  if (param_1 + 0x32 < 0 == SCARRY4(param_1,0x32)) {
    local_9 = 100;
  }
  else if (param_1 + 99 < 0 == SCARRY4(param_1,99)) {
    local_9 = (undefined)((param_1 + 100U & 0xff) << 1);
  }
  else {
    local_9 = 0;
  }
  return local_9;
}



void FUN_0001fb46(void)

{
  DAT_0008591c = FUN_0001faca();
  return;
}



void FUN_0001fb5e(char param_1)

{
  char cVar1;
  int iVar2;
  undefined auStack_88 [128];
  
  if (param_1 != '\0') {
    FUN_0001fb46();
  }
  cVar1 = DAT_00085918;
  if ((param_1 != DAT_00085918) &&
     (iVar2 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/comm_utils.c"
                                ,"set_wifi_state",0x200), cVar1 = param_1, iVar2 != 0)) {
    duss_log_print(0x5c,0,auStack_88,"wms: new state:%d, old state:%d\n",param_1,DAT_00085918);
    cVar1 = param_1;
  }
  DAT_00085918 = cVar1;
  return;
}



undefined FUN_0001fbec(void)

{
  return DAT_00085918;
}



uint FUN_0001fc04(undefined *param_1)

{
  int iVar1;
  
  if (param_1 != (undefined *)0x0) {
    *param_1 = DAT_00085918;
  }
  iVar1 = FUN_0001faca();
  return (uint)(iVar1 - DAT_0008591c) / 1000;
}



undefined FUN_0001fc4a(void)

{
  uint uVar1;
  undefined uVar2;
  uint uVar3;
  
  uVar1 = FUN_0001fc04((undefined *)0x0);
  uVar3 = uVar1;
  if (uVar1 < 3) {
    uVar3 = 1;
  }
  uVar2 = (undefined)uVar3;
  if (2 < uVar1) {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0001fc6c(char *param_1)

{
  int iVar1;
  char *pcVar2;
  undefined4 local_438;
  char acStack_434 [32];
  char acStack_414 [512];
  char acStack_214 [512];
  FILE *local_14;
  dirent *local_10;
  DIR *local_c;
  
  local_c = opendir("/proc");
  local_438 = 0xffffffff;
  if (local_c != (DIR *)0x0) {
    while (local_10 = readdir(local_c), local_10 != (dirent *)0x0) {
      iVar1 = strcmp(local_10->d_name + 8,".");
      if (((iVar1 != 0) && (iVar1 = strcmp(local_10->d_name + 8,".."), iVar1 != 0)) &&
         (local_10->d_name[7] == '\x04')) {
        sprintf(acStack_214,"/proc/%s/status",local_10->d_name + 8);
        local_14 = fopen(acStack_214,"r");
        if (local_14 != (FILE *)0x0) {
          pcVar2 = fgets(acStack_414,0x1ff,local_14);
          if (pcVar2 == (char *)0x0) {
            fclose(local_14);
          }
          else {
            sscanf(acStack_414,"%*s %s",acStack_434);
            iVar1 = strcmp(acStack_434,param_1);
            if (iVar1 == 0) {
              sscanf(local_10->d_name + 8,"%d",&local_438);
              fclose(local_14);
              break;
            }
            fclose(local_14);
          }
        }
      }
    }
  }
  if (local_c != (DIR *)0x0) {
    closedir(local_c);
  }
  return local_438;
}



undefined4 FUN_0001fdc4(void *param_1,ushort param_2,char *param_3,char *param_4)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  ssize_t sVar4;
  undefined auStack_90 [128];
  int local_10;
  int local_c;
  
  local_c = open(param_3,0x8241,0x1b6);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"config_buf_to_file",0x22);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      duss_log_print(0x5c,1,auStack_90,"wms: open %s failed: %s",param_3,pcVar3);
    }
    return 0xffffffff;
  }
  flock(local_c,2);
  do {
    sVar4 = write(local_c,param_1,(uint)param_2);
    local_10 = -(sVar4 >> 0x1f);
    if (local_10 != -1) break;
    piVar2 = __errno_location();
  } while (*piVar2 == 4);
  if (local_10 == 0) {
    iVar1 = fchmod(local_c,0x1b6);
    if (iVar1 < 0) {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                ,"config_buf_to_file",0x2e);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        pcVar3 = strerror(*piVar2);
        duss_log_print(0x5c,0,auStack_90,"wms: chmod %s failed: %s",param_3,pcVar3);
      }
    }
    else {
      iVar1 = fchown(local_c,0x3f2,0x3f2);
      if (iVar1 < 0) {
        iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                  ,"config_buf_to_file",0x33);
        if (iVar1 != 0) {
          piVar2 = __errno_location();
          pcVar3 = strerror(*piVar2);
          duss_log_print(0x5c,0,auStack_90,"wms: chown %s failed: %s",param_3,pcVar3);
        }
      }
      else {
        iVar1 = fsync(local_c);
        if (-1 < iVar1) {
          flock(local_c,8);
          close(local_c);
          iVar1 = rename(param_3,param_4);
          if (iVar1 < 0) {
            iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                      ,"config_buf_to_file",0x40);
            if (iVar1 != 0) {
              piVar2 = __errno_location();
              pcVar3 = strerror(*piVar2);
              duss_log_print(0x5c,0,auStack_90,"wms: replace %s failed: %s",param_4,pcVar3);
            }
            unlink(param_3);
            return 0xffffffff;
          }
          sync();
          iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                    ,"config_buf_to_file",0x44);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_90,"wms: [%s] is replaced",param_4);
          }
          return 0;
        }
        iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                  ,"config_buf_to_file",0x38);
        if (iVar1 != 0) {
          piVar2 = __errno_location();
          pcVar3 = strerror(*piVar2);
          duss_log_print(0x5c,0,auStack_90,"wms: fsync %s failed: %s",param_3,pcVar3);
        }
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"config_buf_to_file",0x28);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      duss_log_print(0x5c,0,auStack_90,"wms: write %s failed: %s",param_3,pcVar3);
    }
  }
  flock(local_c,8);
  close(local_c);
  unlink(param_4);
                    // WARNING: Subroutine does not return
  exit(1);
}



int FUN_0002012a(FILE **param_1,char *param_2)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  FILE *pFVar4;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = access(param_2,0);
  if (local_c == 0) {
    local_c = access(param_2,4);
    if ((local_c == 0) || (local_c = chmod(param_2,0x1b0), local_c == 0)) {
      pFVar4 = fopen(param_2,"r");
      *param_1 = pFVar4;
      if (*param_1 == (FILE *)0x0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                  ,"get_file_handle",0x66);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"wms: open file \'%s\' failed",param_2);
        }
        local_c = -1;
      }
      else {
        local_c = 0;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                ,"get_file_handle",0x5f);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        pcVar3 = strerror(*piVar2);
        duss_log_print(0x5c,1,auStack_8c,"wms: chmod to %s failed: %s",param_2,pcVar3);
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_file_handle",0x57);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      duss_log_print(0x5c,1,auStack_8c,"wms: access %s failed: %s",param_2,pcVar3);
    }
    local_c = -6;
  }
  return local_c;
}



int FUN_0002029a(FILE *param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined auStack_94 [128];
  int local_14;
  
  local_14 = 0;
  if ((param_1 == (FILE *)0x0) && (param_2 < 0)) {
    local_14 = -1;
  }
  else {
    if (param_1 == (FILE *)0x0) {
      local_14 = flock(param_2,2);
    }
    else {
      iVar1 = fileno(param_1);
      local_14 = flock(iVar1,2);
    }
    if ((local_14 < 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                  ,"lock_file",0x76), iVar1 != 0)) {
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_94,"wms: flock LOCK_EX failed: %s, %d, ret = %d",pcVar3,*piVar2,
                     local_14);
    }
  }
  return local_14;
}



int FUN_0002035c(FILE *param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined auStack_94 [128];
  int local_14;
  
  local_14 = 0;
  if ((param_1 == (FILE *)0x0) && (param_2 < 0)) {
    local_14 = -1;
  }
  else {
    if (param_1 == (FILE *)0x0) {
      local_14 = flock(param_2,8);
    }
    else {
      iVar1 = fileno(param_1);
      local_14 = flock(iVar1,8);
    }
    if ((local_14 < 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                  ,"unlock_file",0x85), iVar1 != 0)) {
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_94,"wms: flock LOCK_UN failed: %s, %d, ret = %d",pcVar3,*piVar2,
                     local_14);
    }
  }
  return local_14;
}



char * FUN_0002041e(FILE *param_1,char *param_2,void *param_3)

{
  char *pcVar1;
  int iVar2;
  size_t sVar3;
  undefined auStack_190 [128];
  char acStack_110 [256];
  char *local_10;
  char *local_c;
  
  memset(acStack_110,0,0x100);
  local_c = (char *)0x0;
  do {
    local_10 = local_c;
    pcVar1 = fgets(acStack_110,0x100,param_1);
    if (pcVar1 == (char *)0x0) break;
    local_10 = strstr(acStack_110,param_2);
    local_c = local_10;
  } while (local_10 == (char *)0x0);
  if (local_10 == (char *)0x0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"load_config_str_item",0x97);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_190,"wms: Failed to get %s\n",param_2);
    }
    local_10 = (char *)0x0;
  }
  else {
    for (; *local_c != '\0'; local_c = local_c + 1) {
      if (*local_c == '\n') {
        *local_c = '\0';
        break;
      }
    }
    sVar3 = strlen(param_2);
    local_10 = local_10 + sVar3;
    iVar2 = duss_log_gen_head(0x5c,3,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"load_config_str_item",0xa7);
    if (iVar2 != 0) {
      sVar3 = strlen(local_10);
      duss_log_print(0x5c,3,auStack_190,"wms: %s%s, %zu",param_2,local_10,sVar3);
    }
    sVar3 = strlen(local_10);
    memcpy(param_3,local_10,sVar3 + 1);
  }
  return local_10;
}



int FUN_000205a6(FILE *param_1,char *param_2,char *param_3)

{
  char *pcVar1;
  int iVar2;
  size_t sVar3;
  long lVar4;
  undefined auStack_190 [128];
  char *local_110;
  char acStack_10c [256];
  char *local_c;
  
  memset(acStack_10c,0,0x100);
  local_c = (char *)0x0;
  do {
    local_110 = local_c;
    pcVar1 = fgets(acStack_10c,0x100,param_1);
    if (pcVar1 == (char *)0x0) break;
    local_110 = strstr(acStack_10c,param_2);
    local_c = local_110;
  } while (local_110 == (char *)0x0);
  if (local_c == (char *)0x0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"load_config_uint8_item",0xb8);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_190,"wms: fail to find %s",param_2);
    }
    iVar2 = -1;
  }
  else {
    for (; *local_110 != '\0'; local_110 = local_110 + 1) {
      if (*local_110 == '\n') {
        *local_110 = '\0';
        break;
      }
    }
    sVar3 = strlen(param_2);
    local_c = local_c + sVar3;
    lVar4 = strtol(local_c,&local_110,10);
    *param_3 = (char)lVar4;
    iVar2 = duss_log_gen_head(0x5c,3,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"load_config_uint8_item",199);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_190,"wms: %s%d",param_2,*param_3);
    }
    iVar2 = (int)*param_3;
  }
  return iVar2;
}



undefined4 FUN_0002073c(void *param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  FILE *local_10;
  int local_c;
  
  local_10 = (FILE *)0x0;
  local_c = FUN_0002012a(&local_10,DAT_0008349c);
  if (local_c == 0) {
    FUN_0002029a(local_10,-1);
    iVar1 = FUN_000205a6(local_10,"mode=",(char *)((int)param_1 + 0x6a));
    if (iVar1 == -1) {
      *(undefined *)((int)param_1 + 0x6a) = 1;
    }
    rewind(local_10);
    iVar1 = FUN_000205a6(local_10,"band=",(char *)((int)param_1 + 0x6b));
    if (iVar1 == -1) {
      *(undefined *)((int)param_1 + 0x6b) = 2;
    }
    rewind(local_10);
    FUN_0002041e(local_10,"ssid=",param_1);
    rewind(local_10);
    FUN_0002041e(local_10,"passwd=",(void *)((int)param_1 + 0x21));
    rewind(local_10);
    FUN_0002041e(local_10,"country=",(void *)((int)param_1 + 0x67));
    rewind(local_10);
    iVar1 = FUN_000205a6(local_10,"channel=",(char *)((int)param_1 + 0x6c));
    if (iVar1 == -1) {
      *(undefined *)((int)param_1 + 0x6c) = 6;
    }
    rewind(local_10);
    iVar1 = FUN_000205a6(local_10,"channel_auto=",(char *)((int)param_1 + 0x6d));
    if (iVar1 == -1) {
      *(undefined *)((int)param_1 + 0x6d) = 1;
    }
    rewind(local_10);
    iVar1 = FUN_000205a6(local_10,"bt_setup_cnt=",(char *)((int)param_1 + 0x6e));
    if (iVar1 == -1) {
      *(undefined *)((int)param_1 + 0x6e) = 0;
    }
    FUN_0002035c(local_10,-1);
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"load_user_wifi_config",0xd2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: open %s failed, ret %d",DAT_0008349c,local_c);
    }
    *(undefined *)((int)param_1 + 0x6a) = 1;
    *(undefined *)((int)param_1 + 0x6d) = 1;
    *(undefined *)((int)param_1 + 0x6c) = 1;
  }
  if (local_10 != (FILE *)0x0) {
    fclose(local_10);
  }
  return 0;
}



undefined4 FUN_00020956(undefined *param_1)

{
  int iVar1;
  long lVar2;
  undefined4 uVar3;
  timespec tStack_18;
  
  iVar1 = clock_gettime(1,&tStack_18);
  if (iVar1 == 0) {
    srandom(tStack_18.tv_nsec);
    *param_1 = 0x80;
    param_1[1] = 0x80;
    param_1[2] = 0x3f;
    lVar2 = random();
    param_1[3] = (char)lVar2;
    lVar2 = random();
    param_1[4] = (char)lVar2;
    lVar2 = random();
    param_1[5] = (char)lVar2;
    uVar3 = 0;
  }
  else {
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



void FUN_000209e6(int param_1)

{
  char acStack_2c [36];
  
  memset(acStack_2c,0,0x21);
  sprintf(acStack_2c,"DJI-MINI2-%02X%02X%02X",(uint)*(byte *)(param_1 + 3),
          (uint)*(byte *)(param_1 + 4),(uint)*(byte *)(param_1 + 5));
  FUN_0002126a(acStack_2c);
  return;
}



void FUN_00020a38(void)

{
  long lVar1;
  uint uVar2;
  int iVar3;
  undefined auStack_d4 [128];
  byte local_54;
  byte local_53;
  byte local_52;
  undefined local_51;
  char acStack_50 [68];
  
  memset(acStack_50,0,0x40);
  lVar1 = random();
  local_54 = (byte)lVar1;
  lVar1 = random();
  local_53 = (byte)lVar1;
  lVar1 = random();
  local_52 = (byte)lVar1;
  uVar2 = random();
  local_51 = (undefined)uVar2;
  sprintf(acStack_50,"%02x%02x%02x%02x",(uint)local_54,(uint)local_53,(uint)local_52,uVar2 & 0xff);
  iVar3 = duss_log_gen_head(0x5c,3,auStack_d4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"generate_default_passwd",300);
  if (iVar3 != 0) {
    duss_log_print(0x5c,3,auStack_d4,"wms: the random passwd is %s\n",acStack_50);
  }
  FUN_00021414(acStack_50);
  return;
}



void FUN_00020b26(void)

{
  size_t sVar1;
  
  if (DAT_00085920 == '\0') {
    FUN_000209e6(0x85981);
  }
  if ((DAT_00085941 == '\0') || (sVar1 = strlen(&DAT_00085941), sVar1 < 8)) {
    FUN_00020a38();
  }
  return;
}



void FUN_00020b6e(int param_1)

{
  size_t sVar1;
  char acStack_98 [132];
  
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,
          "ssid=%s\npasswd=%s\nmac=%02x%02x%02x%02x%02x%02x\ncountry=%c%c\nmode=%d\nband=%d\nchannel=%d\nchannel_auto=%d\nbt_setup_cnt=%d\n"
          ,param_1,param_1 + 0x21,(uint)*(byte *)(param_1 + 0x61),(uint)*(byte *)(param_1 + 0x62),
          (uint)*(byte *)(param_1 + 99),(uint)*(byte *)(param_1 + 100),
          (uint)*(byte *)(param_1 + 0x65),(uint)*(byte *)(param_1 + 0x66),
          (uint)*(byte *)(param_1 + 0x67),(uint)*(byte *)(param_1 + 0x68),
          (uint)*(byte *)(param_1 + 0x6a),(uint)*(byte *)(param_1 + 0x6b),
          (uint)*(byte *)(param_1 + 0x6c),(uint)*(byte *)(param_1 + 0x6d),
          (uint)*(byte *)(param_1 + 0x6e));
  sVar1 = strlen(acStack_98);
  FUN_0001fdc4(acStack_98,(ushort)sVar1,DAT_000834a0,DAT_0008349c);
  return;
}



undefined4 FUN_00020c64(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined auStack_a0 [128];
  int local_20;
  undefined1 *local_1c;
  
  local_1c = &DAT_00085920;
  FUN_0001ef6a('\x01',"/usr/bin/athwifi_comm.sh",param_3,&DAT_00085920);
  iVar1 = duss_log_gen_head(0x5c,0,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"init_config_files",0x162);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_a0,"wms: Get config data from user_file...\n");
  }
  memset(local_1c,0,0x6f);
  FUN_00020ef6(local_1c + 0x61);
  FUN_0002073c(local_1c);
  local_20 = FUN_0001f7b8(local_1c + 0x61);
  if (local_20 != 0) {
    FUN_00020956(local_1c + 0x61);
    FUN_0002101e(local_1c + 0x61);
  }
  if (2 < (byte)local_1c[0x6b]) {
    FUN_000216ae('\x01');
  }
  local_20 = FUN_0001f6b2(local_1c + 0x67);
  if (local_20 != 0) {
    FUN_0002180e(&DAT_0005ba64);
    FUN_000216ae('\0');
  }
  iVar1 = FUN_0001f752(local_1c + 0x67);
  if (iVar1 == 0) {
    FUN_000216ae('\x02');
  }
  else {
    FUN_000216ae('\0');
  }
  FUN_00020b26();
  iVar1 = duss_log_gen_head(0x5c,0,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"init_config_files",0x180);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_a0,"wms: ssid=%s passwd=%s mac=%02x:%02x:%02x:%02x:%02x:%02x\n",
                   local_1c,local_1c + 0x21,local_1c[0x61],local_1c[0x62],local_1c[99],local_1c[100]
                   ,local_1c[0x65],local_1c[0x66]);
  }
  iVar1 = duss_log_gen_head(0x5c,0,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"init_config_files",0x182);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_a0,
                   "wms: mode=%d channel=%d auto=%d band=%d country=%c%c stp_cnt=%d\n",
                   local_1c[0x6a],local_1c[0x6c],local_1c[0x6d],local_1c[0x6b],local_1c[0x67],
                   local_1c[0x68],local_1c[0x6e]);
  }
  FUN_00020b6e((int)local_1c);
  return 0;
}



undefined4 FUN_00020ebe(void)

{
  return 0;
}



undefined4 FUN_00020ede(void)

{
  return 0;
}



size_t FUN_00020ef6(undefined *param_1)

{
  int iVar1;
  undefined auStack_a0 [128];
  size_t local_20;
  FILE *local_1c;
  
  local_1c = fopen(DAT_00083498,"rb");
  if (local_1c == (FILE *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_mac_addr_config",0x1a1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a0,"wms: find no mac file!!! %s",DAT_00083498);
    }
    local_20 = 0xffffffff;
  }
  else {
    local_20 = fread(param_1,6,1,local_1c);
    fclose(local_1c);
    iVar1 = duss_log_gen_head(0x5c,0,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_mac_addr_config",0x1a7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_a0,"wms: get_wifi_mac[%d]: %02x:%02x:%02x:%02x:%02x:%02x\n",
                     local_20,*param_1,param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
    }
  }
  return local_20;
}



size_t FUN_0002101e(undefined *param_1)

{
  int iVar1;
  undefined auStack_a4 [128];
  int local_24;
  size_t local_20;
  FILE *local_1c;
  
  local_1c = fopen(DAT_00083498,"wb");
  if (local_1c == (FILE *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"set_mac_addr_config",0x1b0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"wms: create mac file failed!!! %s",DAT_00083498);
    }
    local_20 = 0xffffffff;
  }
  else {
    local_20 = fwrite(param_1,1,6,local_1c);
    fflush(local_1c);
    local_24 = fileno(local_1c);
    if (-1 < local_24) {
      fsync(local_24);
    }
    iVar1 = fclose(local_1c);
    if (iVar1 < 0) {
      local_20 = 0xffffffff;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                                ,"set_mac_addr_config",0x1b9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_a4,"wms: set_wifi_mac[%d]: %02x:%02x:%02x:%02x:%02x:%02x\n",
                       local_20,*param_1,param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
      }
    }
  }
  return local_20;
}



undefined4 FUN_00021176(void *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_90 [131];
  byte local_d;
  undefined1 *local_c;
  
  local_c = &DAT_00085920;
  sVar1 = strlen(&DAT_00085920);
  local_d = (byte)sVar1;
  if ((param_1 == (void *)0x0) || (local_d == 0)) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_ssid_config",0x1c9);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: Could not get_ssid, len %d\n",local_d);
    }
    uVar3 = 0xffffffff;
  }
  else {
    memcpy(param_1,local_c,sVar1 & 0xff);
    *(undefined *)((uint)local_d + (int)param_1) = 0;
    iVar2 = duss_log_gen_head(0x5c,2,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_ssid_config",0x1c5);
    if (iVar2 != 0) {
      duss_log_print(0x5c,2,auStack_90,"wms: get_ssid, len %d, %s\n",local_d,param_1);
    }
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_0002126a(char *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined auStack_90 [128];
  undefined1 *local_10;
  byte local_9;
  
  sVar1 = strlen(param_1);
  local_9 = (byte)sVar1;
  local_10 = &DAT_00085920;
  memset(&DAT_00085920,0,0x21);
  memcpy(local_10,param_1,(uint)local_9);
  iVar2 = duss_log_gen_head(0x5c,2,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"set_ssid_config",0x1d5);
  if (iVar2 != 0) {
    duss_log_print(0x5c,2,auStack_90,"wms: set_ssid len %d, %s",local_9,local_10);
  }
  FUN_0001f1fa(DAT_0008349c,&DAT_0005bbfc,param_1);
  return 0;
}



undefined4 FUN_0002131c(void *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_90 [131];
  byte local_d;
  undefined1 *local_c;
  
  local_c = &DAT_00085920;
  sVar1 = strlen(&DAT_00085941);
  local_d = (byte)sVar1;
  if ((param_1 == (void *)0x0) || (local_d == 0)) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_passwd_config",0x1e6);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: password not found, len %d\n",local_d);
    }
    uVar3 = 0xffffffff;
  }
  else {
    memcpy(param_1,local_c + 0x21,sVar1 & 0xff);
    *(undefined *)((uint)local_d + (int)param_1) = 0;
    iVar2 = duss_log_gen_head(0x5c,2,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"get_passwd_config",0x1e2);
    if (iVar2 != 0) {
      duss_log_print(0x5c,2,auStack_90,"wms: get_password len %d, %s",local_d,param_1);
    }
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_00021414(char *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined auStack_90 [128];
  undefined1 *local_10;
  byte local_9;
  
  sVar1 = strlen(param_1);
  local_9 = (byte)sVar1;
  local_10 = &DAT_00085920;
  memset(&DAT_00085941,0,0x40);
  memcpy(local_10 + 0x21,param_1,(uint)local_9);
  local_10[local_9 + 0x21] = 0;
  iVar2 = duss_log_gen_head(0x5c,0,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"set_passwd_config",499);
  if (iVar2 != 0) {
    duss_log_print(0x5c,0,auStack_90,"wms: set_password len %d, %s",local_9,param_1);
  }
  return 0;
}



undefined4 FUN_000214be(void)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"get_bandwidth_config",0x1f9);
  if (iVar1 != 0) {
    duss_log_print(0x5c,2,auStack_88,"wms: get_bandwidth not support");
  }
  return 0;
}



undefined4 FUN_0002150c(void)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"set_bandwidth_config",0x1ff);
  if (iVar1 != 0) {
    duss_log_print(0x5c,2,auStack_88,"wms: set_bandwidth not support");
  }
  return 0;
}



undefined FUN_00021562(void)

{
  return DAT_0008598c;
}



undefined4 FUN_0002157c(byte param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_1 == DAT_0008598c) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"set_channel_config",0x20b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_88,"wms: same channel, %d",param_1);
    }
  }
  else if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"set_channel_config",0x210);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_88,"wms: invalid channel 0, use channel auto");
    }
    FUN_0001f28a(DAT_0008349c,"channel_auto",1);
  }
  else {
    DAT_0008598c = param_1;
    FUN_0001f28a(DAT_0008349c,"channel",(uint)param_1);
  }
  return 0;
}



undefined FUN_0002167a(void)

{
  return DAT_0008598d;
}



undefined FUN_00021694(void)

{
  return DAT_0008598b;
}



undefined4 FUN_000216ae(char param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_1 == DAT_0008598b) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"set_band_config",0x227);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: same band %d.\n",param_1);
    }
  }
  else {
    DAT_0008598b = param_1;
    iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                              ,"set_band_config",0x22c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_88,"wms: set_band %d\n",param_1);
    }
  }
  return 0;
}



undefined4 FUN_00021772(undefined *param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"get_country_config",0x232);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: get_country %c%c",DAT_00085987,DAT_00085988);
  }
  *param_1 = DAT_00085987;
  param_1[1] = DAT_00085988;
  param_1[2] = 0;
  return 0;
}



undefined4 FUN_0002180e(undefined *param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//host_interface/amba_new/plat_wifi_config.c"
                            ,"set_country_config",0x23c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,2,auStack_88,"wms: set country %c%c",*param_1,param_1[1]);
  }
  DAT_00085987 = *param_1;
  DAT_00085988 = param_1[1];
  return 0;
}



undefined FUN_00021892(void)

{
  return DAT_0008598e;
}



undefined4 FUN_000218ac(void)

{
  byte bVar1;
  
  bVar1 = DAT_0008598e + 1;
  FUN_0001f28a(DAT_0008349c,"bt_setup_cnt",(uint)bVar1);
  DAT_0008598e = bVar1;
  return 0;
}



undefined4 FUN_000218f8(void)

{
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  char *local_18;
  int local_c;
  
  local_c = 0;
  memset(&local_b4,0,0xa8);
  local_b0 = 0;
  local_ac = 0x160;
  local_18 = "/etc/dji.json";
  local_b4 = 3;
  local_c = duss_sketch_initialize(&local_b4);
  if (local_c != 0) {
    fwrite("duss_sketch_initialize failed\n",1,0x1e,(FILE *)0x0);
                    // WARNING: Subroutine does not return
    exit(1);
  }
  return 0;
}



void FUN_0002196c(undefined4 *param_1)

{
  int iVar1;
  undefined auStack_90 [132];
  
  FUN_00021176(param_1);
  if (*(char *)param_1 == '\0') {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_get_name",0x1e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: error: bt empty ssid, use default [%s]\n",
                     "WM161-default");
    }
    *param_1 = 0x36314d57;
    param_1[1] = 0x65642d31;
    param_1[2] = 0x6c756166;
    *(undefined2 *)(param_1 + 3) = 0x74;
  }
  return;
}



void FUN_00021a02(void *param_1,size_t param_2)

{
  int iVar1;
  size_t local_90;
  undefined auStack_88 [128];
  
  local_90 = param_2;
  if (0x20 < (int)param_2) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_set_dev_id",0x2b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_88,"wms: dev id: %s, %d too long, truncate to %d\n",
                     &DAT_000859a8,param_2,0x20);
    }
    local_90 = 0x20;
  }
  FUN_00021ad4();
  memcpy(&DAT_000859a8,param_1,local_90);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                            ,"bt_set_dev_id",0x33);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"wms: dev id: %s, %d\n",&DAT_000859a8,local_90);
  }
  return;
}



void FUN_00021ad4(void)

{
  memset(&DAT_000859a8,0,0x20);
  return;
}



char FUN_00021aec(byte param_1,byte param_2)

{
  int iVar1;
  char cVar2;
  undefined auStack_8c [132];
  
  if ((param_2 < 4) || (0x1d < param_2)) {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"rc_key2alpha",0x41);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_8c,"wms: key %#x out of range\n",param_2);
    }
    cVar2 = -1;
  }
  else {
    if ((param_1 & 2) == 0) {
      cVar2 = 'a';
    }
    else {
      cVar2 = 'A';
    }
    cVar2 = param_2 + cVar2 + -4;
  }
  return cVar2;
}



int FUN_00021b80(int param_1,char param_2)

{
  int local_c;
  
  local_c = param_1 + -0x962;
  if (param_2 != '\0') {
    local_c = local_c / 2;
  }
  return local_c;
}



int FUN_00021bb2(byte *param_1)

{
  short sVar1;
  int iVar2;
  undefined auStack_90 [128];
  byte *local_10;
  size_t local_c;
  
  local_c = 0;
  *param_1 = 0x1b;
  param_1[3] = 0x12;
  param_1[2] = 1;
  param_1[5] = 0;
  sVar1 = DAT_00085b00 + 1;
  *(short *)(param_1 + 6) = DAT_00085b00;
  DAT_00085b00 = sVar1;
  local_10 = param_1;
  local_c = FUN_0001474e(*(byte **)(param_1 + 8),param_1,*(void **)(param_1 + 0xc),
                         *(size_t *)(param_1 + 0x10));
  if ((int)local_c < 0xd) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_push_cmd",100);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: invalid v1 pkt\n");
    }
    iVar2 = -1;
  }
  else if (local_10[1] == 2) {
    iVar2 = FUN_0003a00a(*(int *)(param_1 + 8),local_c);
  }
  else {
    iVar2 = FUN_0001a90e();
  }
  return iVar2;
}



int FUN_00021c9e(int param_1,int param_2)

{
  ushort uVar1;
  int iVar2;
  int local_4b0;
  int local_4ac;
  undefined auStack_4a4 [128];
  uint local_424 [256];
  ushort local_22;
  int local_20;
  uint *local_1c;
  int *local_18;
  int local_14;
  
  local_18 = &DAT_00085b04;
  local_1c = local_424;
  local_424[0] = (uint)*(byte *)(param_1 + 9) << 0x10 | (uint)*(byte *)(param_1 + 10);
  local_20 = param_1;
  uVar1 = FUN_000174e8(*(byte *)(param_1 + 4));
  local_4b0 = param_2;
  local_4ac = param_1;
  *(ushort *)(local_1c + 1) = uVar1;
  local_22 = FUN_000174e8(*(byte *)(local_20 + 5));
  *(ushort *)((int)local_1c + 6) = (ushort)*(byte *)(local_20 + 8);
  *(undefined2 *)(local_1c + 2) = *(undefined2 *)(local_20 + 6);
  local_1c[3] = local_4b0 - 0xd;
  memcpy(local_1c + 4,(void *)(local_4ac + 0xb),local_1c[3]);
  iVar2 = duss_log_gen_head(0x5c,2,auStack_4a4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                            ,"bt_recv_process",0x86);
  if (iVar2 != 0) {
    duss_log_print(0x5c,2,auStack_4a4,
                   "wms: recv_ble_v1: msg_id=0x%x, sender=0x%x, receiver=0x%x, msg_len=%d, seq=%d\n"
                   ,*local_1c,*(undefined2 *)(local_1c + 1),local_22,local_1c[3],
                   *(undefined2 *)(local_1c + 2));
  }
  if (local_22 == 0x700) {
    local_14 = duss_osal_msgq_send(*(undefined4 *)(*local_18 + 8),local_1c,local_1c[3] + 0x10,
                                   0xffffffff);
  }
  else {
    local_14 = duss_event_send(*local_18,local_1c);
  }
  if (local_14 != 0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_4a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_recv_process",0x90);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_4a4,"wms: duss_osal_msgq_send() error: %d\n",local_14);
    }
  }
  return local_14;
}



undefined4 FUN_00021e5a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  if (DAT_000859a8 == '\0') {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_save_whitelist",0x98);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: save whitelist error, empty dev id\n");
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_save_whitelist",0x9b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_88,"wms: save %s to whitelist\n",&DAT_000859a8);
    }
    uVar2 = 0;
  }
  return uVar2;
}



uint FUN_00021f00(void *param_1)

{
  int iVar1;
  uint uVar2;
  undefined auStack_a8 [128];
  int local_28;
  ushort local_22;
  ushort local_20;
  byte local_1e;
  byte local_1d;
  int local_1c;
  uint local_18;
  uint local_14;
  int local_10;
  uint local_c;
  
  local_c = 0;
  local_14 = 0;
  local_18 = 0;
  local_1c = 0;
  local_10 = 0;
  local_1d = 0;
  local_1e = 0;
  local_20 = 0;
  local_22 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&DAT_00085990);
LAB_00021f4a:
  do {
    if (DAT_00086d3c == 0) {
LAB_00022388:
      pthread_mutex_unlock((pthread_mutex_t *)&DAT_00085990);
      return local_c;
    }
    for (; (DAT_00086d3c != 0 && ((&DAT_00085d3c)[local_10] != 'U')); local_10 = local_10 + 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                                ,"bt_get_v1_pkt",0x181);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"wms: invalid v1 pkt SOF, drop %#x, left %d\n",
                       (&DAT_00085d3c)[local_10],DAT_00086d3c);
      }
      DAT_00086d3c = DAT_00086d3c - 1;
    }
    if ((local_10 != 0) && (DAT_00086d3c != 0)) {
      memmove(&DAT_00085d3c,&DAT_00085d3c + local_10,DAT_00086d3c);
    }
    if (DAT_00086d3c < 0xd) goto LAB_00022388;
    local_14 = (uint)(DAT_00085d3e >> 2);
    local_18 = (DAT_00085d3e & 3) << 8 | (uint)DAT_00085d3d;
    if (((local_14 == 1) && (0xc < local_18)) && (local_18 < 0x401)) {
      if (DAT_00086d3c < local_18) goto LAB_00022388;
      local_1d = DAT_00085d3f;
      local_1e = FUN_000146b4(0x77,&DAT_00085d3c,3);
      if (local_1d == local_1e) {
        local_1c = local_18 - 2;
        uVar2 = (DAT_00085d3e & 3) << 8 | (uint)DAT_00085d3d;
        local_28 = uVar2 - 2;
        local_20 = *(ushort *)((int)&DAT_00085d38 + uVar2 + 2);
        local_22 = FUN_000146fe(0x3692,&DAT_00085d3c,local_1c);
        if (local_20 == local_22) {
          memcpy(param_1,&DAT_00085d3c,local_18);
          local_c = local_18;
          DAT_00086d3c = DAT_00086d3c - local_18;
          if (DAT_00086d3c != 0) {
            memmove(&DAT_00085d3c,&DAT_00085d3c + local_18,DAT_00086d3c);
          }
          goto LAB_00022388;
        }
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                                  ,"bt_get_v1_pkt",0x1b1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a8,
                         "wms: invalid v1 pkt, pkt crc %#x, cal crc %#x, skip this SOF\n",local_20,
                         local_22);
        }
        hex_dump("bt_get_v1_pkt",0x85d3c,local_18);
        DAT_00086d3c = DAT_00086d3c - 1;
        memmove(&DAT_00085d3c,&DAT_00085d3d,DAT_00086d3c);
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                                  ,"bt_get_v1_pkt",0x1a5);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a8,
                         "wms: invalid v1 pkt, hdr crc %#x, cal crc %#x, skip this SOF\n",local_1d,
                         local_1e);
        }
        hex_dump("bt_get_v1_pkt",0x85d3c,local_18);
        DAT_00086d3c = DAT_00086d3c - 1;
        memmove(&DAT_00085d3c,&DAT_00085d3d,DAT_00086d3c);
      }
      goto LAB_00021f4a;
    }
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_get_v1_pkt",0x196);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"wms: invalid v1 pkt fmt, ver %d, len %d, skip this SOF\n",
                     local_14,local_18);
    }
    DAT_00086d3c = DAT_00086d3c - 1;
    memmove(&DAT_00085d3c,&DAT_00085d3d,DAT_00086d3c);
  } while( true );
}



int FUN_000223f2(pthread_t *param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0001f5c2(param_1,(__start_routine *)&LAB_000223a4_1,(void *)0x0);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/bt_common.c"
                              ,"bt_process_thread",0x1e2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"wms: thread create error\n");
    }
  }
  return local_c;
}



undefined4 FUN_00022474(int param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  undefined4 local_10;
  int local_c;
  
  local_10 = 10;
  local_c = 0;
  do {
    if (0x12 < local_c) {
LAB_000224cc:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"baudrate2rlevel",0x69);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"wms: userial baudrate %d rlevel %d\n",param_1,local_10);
      }
      return local_10;
    }
    if (*(int *)(&DAT_000834a4 + local_c * 8) == param_1) {
      local_10 = *(undefined4 *)(&DAT_000834a8 + local_c * 8);
      goto LAB_000224cc;
    }
    local_c = local_c + 1;
  } while( true );
}



undefined4 FUN_00022522(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  FUN_00020ef6(param_1);
  iVar1 = FUN_0001f7b8(param_1);
  if (iVar1 == 0) {
    FUN_0001f8ec((int)param_1);
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_get_mac_addr",0x72);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: error: invalid mac\n");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00022592(void)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_set_mac_addr",0x7b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,2,auStack_88,"wms: not support\n");
  }
  return 0xffffffff;
}



undefined4 FUN_000225e6(undefined4 param_1,char param_2)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (DAT_000859ca == '\0') {
    if (param_2 == DAT_000859cb) {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_set_visible",0x87);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_88,"wms: visible %d no changed, do nothing\n",DAT_000859cb);
      }
    }
    else if ((DAT_00086d4c == '\0') || (param_2 == '\0')) {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_set_visible",0x90);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_88,"wms: %s: set visible %d\n",param_1,param_2);
      }
      if (param_2 == '\0') {
        FUN_00027fac(0,0);
        DAT_000859cb = param_2;
      }
      else {
        FUN_00027fac(1,1);
        DAT_000859cb = param_2;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_set_visible",0x8c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_88,"wms: %s ignore set visible req while connected\n",param_1)
        ;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_set_visible",0x82);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_88,"wms: lpm mode, ignore set visible\n");
    }
  }
  return 0;
}



undefined4 FUN_00022776(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001abcc(0x85b30,3,3,1);
  return uVar1;
}



undefined4 FUN_000227a8(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0001abcc(0x85b30,3,3,0);
  return uVar1;
}



undefined4 FUN_000227da(void)

{
  return 0;
}



uint FUN_000227f2(undefined4 param_1)

{
  int iVar1;
  char *pcVar2;
  undefined auStack_98 [128];
  char *local_18;
  char *local_14;
  char *local_10;
  uint local_c;
  
  local_c = 0xffffffff;
  local_10 = "/dev/ttyUSB0";
  local_14 = "/tmp/blackbox/bsa_server";
  local_18 = "/tmp/BCM4345C0_003.001.025.0163.0000.hcd";
  iVar1 = access("/tmp/blackbox/bsa_server",1);
  if (iVar1 != 0) {
    local_14 = "bsa_server";
  }
  iVar1 = access(local_18,0);
  if (iVar1 != 0) {
    local_18 = "/etc/BCM4345C0_003.001.025.0163.0000.hcd";
  }
  iVar1 = access(local_10,0);
  if (iVar1 != 0) {
    local_10 = "/dev/ttyS1";
  }
  iVar1 = duss_log_gen_head(0x5c,2,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_run_server",0xfb);
  if (iVar1 != 0) {
    duss_log_print(0x5c,2,auStack_98,"wms: bt_baudrate is %d, bt_device %s\n",DAT_0008353c,local_10)
    ;
  }
  iVar1 = access("/tmp/bt_debug",0);
  if (iVar1 == 0) {
    FUN_00022474(DAT_0008353c);
    pcVar2 = "/tmp/EMMC/wireless/bluetooth/./ble_local_keys";
    local_c = FUN_0001ef6a('\x01',
                           "%s -d%s -r%d -p%s -u%s -k%s -all=%d -b/tmp/blackbox/btsnoop.log > /tmp/blackbox/bt_debug.log &"
                           ,local_14,local_10);
  }
  else {
    FUN_00022474(DAT_0008353c);
    pcVar2 = "/tmp/EMMC/wireless/bluetooth/./ble_local_keys";
    local_c = FUN_0001ef6a('\x01',"%s -d%s -r%d -p%s -u%s -k%s -all=%d &",local_14,local_10);
  }
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,0,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_run_server",0x108,pcVar2,param_1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,0,auStack_98,"wms: run bsa_server fail\n");
    }
  }
  return local_c;
}



undefined4 FUN_000229d2(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0003977e();
  return uVar1;
}



undefined4 FUN_000229ee(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0003a286();
  return uVar1;
}



void FUN_00022a0a(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_00048d34();
  FUN_00039c5e();
  FUN_0003975c();
  FUN_0001ef6a('\0',"killall -KILL bsa_server",param_3,param_4);
  FUN_000227a8();
  if (DAT_000859cc != 0) {
    pthread_cancel(DAT_000859cc);
    DAT_000859cc = 0;
  }
  DAT_00086d4c = 0;
  DAT_000859c9 = 0;
  DAT_00085790 = 0;
  return;
}



undefined FUN_00022a7e(void)

{
  return DAT_000859c9;
}



undefined4 FUN_00022a96(void)

{
  return 0;
}



undefined4 FUN_00022ab4(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  DAT_000859c8 = 0;
  iVar1 = FUN_00025ce4(0,param_1);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00022ae8(void)

{
  int iVar1;
  undefined4 uVar2;
  
  if ((DAT_000859c8 == '\0') || (DAT_00083544 == '\0')) {
    iVar1 = FUN_0002630e();
    if (iVar1 == 0) {
      if (DAT_000859c8 != '\0') {
        DAT_00083544 = '\x01';
      }
      uVar2 = 0;
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



int FUN_00022b44(void)

{
  int iVar1;
  undefined auStack_89c [128];
  byte abStack_81c [8];
  undefined *local_814;
  undefined *local_810;
  int local_80c;
  undefined auStack_808 [1012];
  undefined auStack_414 [1024];
  int local_14;
  byte *local_10;
  undefined *local_c;
  
  local_c = auStack_808;
  local_10 = abStack_81c;
  if (DAT_000859c8 == '\0') {
    memset(abStack_81c,0,0x14);
    local_10[1] = 1;
    local_10[4] = 5;
    local_814 = auStack_414;
    local_810 = auStack_808;
    local_80c = (int)local_c - (int)local_810;
    iVar1 = FUN_00021bb2(abStack_81c);
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_89c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_push_scan_complete",0x183);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_89c,"wms: in pair mode, ignore scan complete event to host\n");
    }
    local_14 = FUN_0001f7b8((byte *)&DAT_00086d40);
    if (local_14 == 0) {
      FUN_0004bb12(0,0x86d40);
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_89c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_push_scan_complete",0x186);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_89c,"wms: invalid target pair RC mac address, skip connect\n")
        ;
      }
    }
    iVar1 = 0;
  }
  return iVar1;
}



undefined4 FUN_00022c6c(undefined4 *param_1,char *param_2)

{
  if (DAT_000859c8 == '\0') {
    FUN_00022cae(param_1,param_2);
  }
  else {
    DAT_00086d40 = *param_1;
    DAT_00086d44 = *(undefined2 *)(param_1 + 1);
    FUN_00022ae8();
  }
  return 0;
}



int FUN_00022cae(void *param_1,char *param_2)

{
  undefined *puVar1;
  int iVar2;
  char *local_828;
  void *local_824;
  byte abStack_81c [8];
  undefined *local_814;
  undefined *local_810;
  int local_80c;
  undefined auStack_808 [1012];
  undefined auStack_414 [1024];
  size_t local_14;
  byte *local_10;
  undefined *local_c;
  
  local_c = auStack_808;
  local_10 = abStack_81c;
  local_14 = 0;
  memset(abStack_81c,0,0x14);
  local_828 = param_2;
  local_824 = param_1;
  local_10[1] = 1;
  local_10[4] = 6;
  local_814 = auStack_414;
  local_810 = auStack_808;
  memcpy(local_c,local_824,6);
  local_c = local_c + 6;
  local_14 = strlen(local_828);
  puVar1 = local_c + 1;
  *local_c = (char)local_14;
  local_c = puVar1;
  memcpy(local_c,local_828,local_14);
  local_c = local_c + local_14;
  local_80c = (int)local_c - (int)local_810;
  iVar2 = FUN_00021bb2(abStack_81c);
  return iVar2;
}



int FUN_00022d84(int param_1)

{
  undefined *puVar1;
  int iVar2;
  undefined auStack_898 [128];
  byte abStack_818 [8];
  undefined *local_810;
  undefined *local_80c;
  int local_808;
  undefined local_804 [1012];
  undefined auStack_410 [1024];
  byte *local_10;
  undefined *local_c;
  
  local_c = local_804;
  local_10 = abStack_818;
  if (param_1 == 0) {
    iVar2 = duss_log_gen_head(0x5c,3,auStack_898,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_push_connect_status",0x1d2);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_898,"wms: RC connected\n");
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_898,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_push_connect_status",0x1cf);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_898,"wms: connect RC fail %d\n",param_1);
    }
  }
  if ((DAT_000859c8 == '\0') || (DAT_00083544 != '\0')) {
    DAT_000859c8 = '\0';
    memset(abStack_818,0,0x14);
    local_10[1] = 1;
    local_10[4] = 0x43;
    local_810 = auStack_410;
    local_80c = local_804;
    puVar1 = local_c + 1;
    *local_c = (char)param_1;
    local_c = puVar1;
    local_808 = (int)local_c - (int)local_80c;
    iVar2 = duss_log_gen_head(0x5c,3,auStack_898,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_push_connect_status",0x1e8);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_898,"wms: push RC connect status to host\n");
    }
    iVar2 = FUN_00021bb2(abStack_818);
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,2,auStack_898,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_push_connect_status",0x1d6);
    if (iVar2 != 0) {
      duss_log_print(0x5c,2,auStack_898,"wms: scanning RC, ignore connect status\n");
    }
    iVar2 = 0;
  }
  return iVar2;
}



undefined4 FUN_00022f50(void)

{
  FUN_00039936('\0');
  return 0;
}



undefined4 FUN_00022f74(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  DAT_000859c8 = 1;
  DAT_00083544 = 0;
  FUN_0004c6f8(&DAT_00086d40);
  memset(&DAT_00086d40,0,6);
  iVar1 = FUN_00025ce4(0,param_1);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00022fd0(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [8];
  
  FUN_0001fa22(param_1,(int)auStack_10);
  iVar1 = FUN_0004bb12(0,(int)auStack_10);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_connect_rc",0x20f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: req connect rc %s fail\n",param_1);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0002304c(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [8];
  
  FUN_0001fa22(param_1,(int)auStack_10);
  iVar1 = FUN_00042650((int)auStack_10);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_connect_ble",0x21d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"wms: req connect peripheral %s fail\n",param_1);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000230c6(byte *param_1,char *param_2)

{
  size_t sVar1;
  int iVar2;
  undefined auStack_9c [128];
  undefined4 auStack_1c [5];
  
  memset(auStack_1c,0,0x12);
  FUN_0001f9a4(param_1,auStack_1c);
  sVar1 = strlen((char *)auStack_1c);
  FUN_00021a02(auStack_1c,sVar1);
  iVar2 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_handle_connect_req",0x22d);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"wms: incoming req %s - %s\n",auStack_1c,param_2);
  }
  if (DAT_000859c8 == '\0') {
    FUN_00023182((char *)auStack_1c,param_2);
  }
  else {
    FUN_0003761e(0xa7d71);
  }
  return 0;
}



int FUN_00023182(char *param_1,char *param_2)

{
  undefined *puVar1;
  int iVar2;
  char *local_828;
  char *local_824;
  byte abStack_820 [8];
  undefined *local_818;
  undefined *local_814;
  int local_810;
  undefined auStack_80c [1012];
  undefined auStack_418 [1024];
  size_t local_18;
  size_t local_14;
  byte *local_10;
  undefined *local_c;
  
  local_c = auStack_80c;
  local_10 = abStack_820;
  local_14 = 0;
  local_18 = 0;
  memset(abStack_820,0,0x14);
  local_828 = param_2;
  local_824 = param_1;
  local_10[1] = 1;
  local_10[4] = 0x45;
  local_818 = auStack_418;
  local_814 = auStack_80c;
  local_14 = strlen(local_824);
  memcpy(local_c,local_824,local_14);
  local_c = local_c + local_14;
  local_18 = strlen(local_828);
  puVar1 = local_c + 1;
  *local_c = (char)local_18;
  local_c = puVar1;
  memcpy(local_c,local_828,local_18);
  local_810 = (int)local_c - (int)local_814;
  iVar2 = FUN_00021bb2(abStack_820);
  return iVar2;
}



undefined4 FUN_00023264(void)

{
  short sVar1;
  undefined4 uVar2;
  
  sVar1 = FUN_0003761e(0xa7d71);
  if (sVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0002328e(char *param_1)

{
  int iVar1;
  undefined auStack_90 [129];
  char local_f;
  byte local_e;
  byte local_d;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  local_d = param_1[1];
  local_e = param_1[3];
  if (*param_1 == '\x01') {
    local_f = FUN_00021aec(local_d,local_e);
    if (local_e != 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_handle_rc_report_data",0x26f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"wms: RC report key %#x, %c\n",local_e,local_f);
      }
    }
    FUN_0002339c(local_e);
    local_c = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,2,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_handle_rc_report_data",0x275);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_90,"wms: unknown report data %#x, %#x\n",local_d,local_e);
    }
    local_c = 0xffffffff;
  }
  return local_c;
}



int FUN_0002339c(undefined param_1)

{
  undefined *puVar1;
  int iVar2;
  undefined local_819;
  byte abStack_818 [8];
  undefined *local_810;
  undefined *local_80c;
  int local_808;
  undefined local_804 [1012];
  undefined auStack_410 [1024];
  byte *local_10;
  undefined *local_c;
  
  local_c = local_804;
  local_10 = abStack_818;
  memset(abStack_818,0,0x14);
  local_819 = param_1;
  local_10[1] = 1;
  local_10[4] = 0x47;
  local_810 = auStack_410;
  local_80c = local_804;
  puVar1 = local_c + 1;
  *local_c = local_819;
  local_c = puVar1;
  local_808 = (int)local_c - (int)local_80c;
  iVar2 = FUN_00021bb2(abStack_818);
  return iVar2;
}



undefined4 FUN_00023424(void *param_1,size_t param_2)

{
  int iVar1;
  size_t local_98;
  undefined auStack_90 [128];
  int local_10;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  local_10 = 0;
  if (DAT_00083540 < 0) {
    local_c = 0xffffffff;
  }
  else {
    local_98 = param_2;
    if (8 < (int)param_2) {
      local_98 = 8;
    }
    local_10 = FUN_0004d26c(DAT_00083540,param_1,local_98);
    if (local_10 == 0) {
      local_c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,2,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_send_control_data",0x2a6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,2,auStack_90,"wms: write control handle %d ret %d\n",DAT_00083540,
                       local_10);
      }
    }
  }
  return local_c;
}



int FUN_000234e4(void)

{
  int iVar1;
  undefined *puVar2;
  char *pcVar3;
  undefined8 uVar4;
  undefined auStack_130 [128];
  undefined4 local_b0;
  undefined4 local_ac;
  char acStack_a8 [128];
  int local_28;
  int local_24;
  char *local_20;
  char *local_1c;
  uint local_18;
  char local_11;
  
  local_11 = '\0';
  local_18 = -1;
  local_1c = "cat /sys/class/gpio/gpio107/value";
  local_20 = "cat /proc/tty/driver/ambarella-uart | grep mmio:0xE0032000 | awk \'{print $5, $6}\'";
  memset(acStack_a8,0,0x80);
  local_24 = FUN_0001faca();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_130,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_init",699);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_130,"wms: enter\n");
  }
  while( true ) {
    FUN_000218ac();
    FUN_0001f438(local_20,acStack_a8,0x80);
    sscanf(acStack_a8,"tx:%d rx:%d",&local_ac,&local_b0);
    puVar2 = auStack_130;
    uVar4 = duss_log_gen_head(0x5c,2,auStack_130,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_init",0x2c3);
    pcVar3 = (char *)uVar4;
    if (pcVar3 != (char *)0x0) {
      pcVar3 = "wms: bt_uart(%d) [tx %d, rx %d]: %s\n";
      puVar2 = auStack_130;
      uVar4 = duss_log_print(0x5c,2,auStack_130,"wms: bt_uart(%d) [tx %d, rx %d]: %s\n",local_11,
                             local_ac,local_b0,acStack_a8);
    }
    FUN_00022a0a((int)uVar4,(int)((ulonglong)uVar4 >> 0x20),puVar2,pcVar3);
    DAT_000859ca = 0;
    DAT_000859cb = 0;
    local_18 = FUN_00022776();
    if ((local_18 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_130,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                  ,"bt_init",0x2cd), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_130,"wms: bt turn on fail\n");
    }
    usleep(300000);
    local_18 = FUN_000227da();
    local_18 = FUN_000227f2(2);
    if ((local_18 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,0,auStack_130,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                  ,"bt_init",0x2d4), iVar1 != 0)) {
      duss_log_print(0x5c,0,auStack_130,"wms: run bt server fail\n");
    }
    local_18 = FUN_000229d2();
    if (local_18 == 0) {
      local_18 = FUN_000229ee();
      if (local_18 == 0) {
        local_18 = FUN_00039a58();
        if (local_18 == 0) {
          FUN_0003973e();
          FUN_00048d18();
          FUN_0004f3d0();
          FUN_000223f2(&DAT_000859cc);
          DAT_000859c9 = 1;
          local_28 = FUN_0001faca();
          iVar1 = duss_log_gen_head(0x5c,3,auStack_130,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                    ,"bt_init",0x2f8);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_130,"wms: bt init time cost %dms\n",local_28 - local_24);
          }
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,0,auStack_130,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                    ,"bt_init",0x2e9);
          if (iVar1 != 0) {
            duss_log_print(0x5c,0,auStack_130,"wms: ble setup fail\n");
          }
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,0,auStack_130,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                  ,"bt_init",0x2e3);
        if (iVar1 != 0) {
          duss_log_print(0x5c,0,auStack_130,"wms: run ble fail\n");
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,0,auStack_130,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                ,"bt_init",0x2dd);
      if (iVar1 != 0) {
        duss_log_print(0x5c,0,auStack_130,"wms: run bt manager fail\n");
      }
    }
    if ((local_18 == 0) || (local_11 != '\0')) break;
    local_11 = '\x01';
    FUN_0001f438(local_1c,acStack_a8,0x80);
    iVar1 = duss_log_gen_head(0x5c,2,auStack_130,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_init",0x300);
    if (iVar1 != 0) {
      duss_log_print(0x5c,2,auStack_130,"wms: try bt reinit, gpio107: %s\n",acStack_a8);
    }
  }
  return local_18;
}



void FUN_000238a6(void)

{
  undefined *puVar1;
  undefined *puVar2;
  char *pcVar3;
  undefined8 uVar4;
  undefined auStack_88 [128];
  
  puVar2 = auStack_88;
  puVar1 = puVar2;
  uVar4 = duss_log_gen_head(0x5c,3,puVar2,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_exit",0x309);
  pcVar3 = (char *)uVar4;
  if (pcVar3 != (char *)0x0) {
    pcVar3 = "wms: enter\n";
    uVar4 = duss_log_print(0x5c,3);
    puVar1 = puVar2;
  }
  FUN_00022a0a((int)uVar4,(int)((ulonglong)uVar4 >> 0x20),puVar1,pcVar3);
  return;
}



undefined4 FUN_000238f6(ushort *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_88 [128];
  
  if (*(char *)(param_1 + 10) == '\v') {
    if (*(char *)(param_1 + 1) == '\x03') {
      uVar2 = 0;
    }
    else if (*(char *)(param_1 + 1) == '\x05') {
      uVar2 = 0;
    }
    else {
      if (*param_1 == 0) {
        iVar1 = duss_log_gen_head(0x5c,2,auStack_88,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                  ,"bt_test_check_param",0x31c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,2,auStack_88,"wms: invalid freq %d\n",*param_1);
        }
      }
      else {
        iVar1 = FUN_00021b80((uint)*param_1,'\x01');
        *(char *)((int)param_1 + 0x15) = (char)iVar1;
      }
      if (*(byte *)((int)param_1 + 0x15) < 0x28) {
        if (*(byte *)(param_1 + 0xb) < 8) {
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                    ,"bt_test_check_param",0x325);
          if (iVar1 != 0) {
            duss_log_print(0x5c,0,auStack_88,"wms: invalid payload pattern %d\n",
                           *(undefined *)(param_1 + 0xb));
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                                  ,"bt_test_check_param",800);
        if (iVar1 != 0) {
          duss_log_print(0x5c,0,auStack_88,"wms: invalid bt channel %d\n",
                         *(undefined *)((int)param_1 + 0x15));
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



bool FUN_00023a42(int param_1,undefined4 param_2,undefined4 param_3)

{
  uint uVar1;
  bool bVar2;
  
  uVar1 = (uint)*(byte *)(param_1 + 0x14);
  bVar2 = uVar1 == 0xb;
  if (bVar2) {
    FUN_0001ef6a('\x01',"killall -KILL hostapd",param_3,0xb);
    FUN_0001ef6a('\0',"ifconfig wlan0 down",param_3,uVar1);
  }
  return bVar2;
}



undefined4 FUN_00023a7c(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0004f3de((uint)*(byte *)(param_1 + 0x15),(uint)*(byte *)(param_1 + 0x16));
  return uVar1;
}



undefined4 FUN_00023aa0(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0004f4fe((uint)*(byte *)(param_1 + 0x15));
  return uVar1;
}



undefined4 FUN_00023abc(void)

{
  int iVar1;
  undefined4 uVar2;
  
  DAT_00083545 = 0x81;
  iVar1 = FUN_00028616('\x01',1);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



uint FUN_00023aee(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined auStack_108 [128];
  char acStack_88 [128];
  
  memset(acStack_88,0,0x80);
  memset(acStack_88,0,0x80);
  sprintf(acStack_88,"14FC0700%02X0000090000",(*(byte *)(param_1 + 0x15) + 1) * 2);
  iVar1 = duss_log_gen_head(0x5c,0,auStack_108,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_test_tx_tone",0x350);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_108,"wms: %s: %s","bt_test_tx_tone",acStack_88);
  }
  uVar2 = FUN_0001ef6a('\x01',"/usr/bin/bt_test.sh %s",acStack_88,acStack_88);
  return uVar2;
}



undefined4 FUN_00023ba2(int param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  *(undefined4 *)(param_1 + 8) = DAT_00086d48;
  *(int *)(param_1 + 0x1c) = (int)DAT_00083545;
  iVar1 = duss_log_gen_head(0x5c,0,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                            ,"bt_get_test",0x359);
  if (iVar1 != 0) {
    duss_log_print(0x5c,0,auStack_88,"wms: get bt test: rx pakects %d, rssi %d\n",
                   *(undefined4 *)(param_1 + 8),*(undefined4 *)(param_1 + 0x1c));
  }
  return 0;
}



uint FUN_00023c26(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined auStack_88 [128];
  
  switch(*(undefined *)(param_1 + 2)) {
  case 1:
    uVar2 = FUN_00023a7c(param_1);
    break;
  case 2:
    uVar2 = FUN_00023aa0(param_1);
    break;
  case 3:
    uVar2 = FUN_0004f616();
    break;
  default:
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/bt_config.c"
                              ,"bt_test",0x36e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"wms: unsupport bt test type %d\n",
                     *(undefined *)(param_1 + 2));
    }
    uVar2 = 0xfffffffd;
    break;
  case 5:
    uVar2 = FUN_00023abc();
    break;
  case 7:
    uVar2 = FUN_00023aee(param_1);
  }
  return uVar2;
}



void FUN_00023ce4(void)

{
  undefined uVar1;
  undefined uVar2;
  undefined uVar3;
  int iVar4;
  char *pcVar5;
  undefined auStack_9c [128];
  int local_1c;
  
  for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
    if ((&DAT_00086d50)[local_1c * 0x210] != '\0') {
      iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_display_devices",0x77);
      if (iVar4 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"Dev:%d",local_1c);
      }
      iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_display_devices",0x7e);
      if (iVar4 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"\tBdaddr:%02x:%02x:%02x:%02x:%02x:%02x",
                       (&DAT_00086d54)[local_1c * 0x210],(&DAT_00086d55)[local_1c * 0x210],
                       (&DAT_00086d56)[local_1c * 0x210],(&DAT_00086d57)[local_1c * 0x210],
                       (&DAT_00086d58)[local_1c * 0x210],(&DAT_00086d59)[local_1c * 0x210]);
      }
      iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_display_devices",0x7f);
      if (iVar4 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"\tName:%s",local_1c * 0x210 + 0x86d5d);
      }
      iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_display_devices",0x85);
      if (iVar4 != 0) {
        uVar1 = (&DAT_00086d5a)[local_1c * 0x210];
        uVar2 = (&DAT_00086d5b)[local_1c * 0x210];
        uVar3 = (&DAT_00086d5c)[local_1c * 0x210];
        pcVar5 = FUN_0002f16c((int)(&DAT_00086d5a + local_1c * 0x210));
        duss_log_print(0x5c,3,auStack_9c,"\tClassOfDevice:%02x:%02x:%02x => %s",uVar1,uVar2,uVar3,
                       pcVar5);
      }
      iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_display_devices",0x86);
      if (iVar4 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"\tRssi:%d",
                       *(undefined4 *)(&DAT_00086e58 + local_1c * 0x210));
      }
      if ((&DAT_00086e60)[local_1c * 0x210] != '\0') {
        iVar4 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                  ,"app_disc_display_devices",0x8d);
        if (iVar4 != 0) {
          duss_log_print(0x5c,3,auStack_9c,"\tVidSrc:%d Vid:0x%04X Pid:0x%04X Version:0x%04X",
                         *(undefined2 *)(&DAT_00086e62 + local_1c * 0x210),
                         *(undefined2 *)(&DAT_00086e64 + local_1c * 0x210),
                         *(undefined2 *)(&DAT_00086e66 + local_1c * 0x210),
                         *(undefined2 *)(&DAT_00086e68 + local_1c * 0x210));
        }
      }
    }
  }
  return;
}



int FUN_000240bc(int param_1,int param_2,int param_3,char *param_4)

{
  int iVar1;
  undefined auStack_90 [128];
  char *local_10;
  char *local_c;
  
  if (((param_2 < param_3) || (param_2 < 0)) || (param_3 < 0)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_strncat",0xa5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"app_disc_strncat ERROR index %d out of range %d",param_3,
                     param_2);
    }
    iVar1 = 0;
  }
  else {
    local_10 = param_4;
    local_c = (char *)(param_3 + param_1);
    while ((*local_10 != '\0' && ((int)local_c - param_1 < param_2))) {
      *local_c = *local_10;
      local_10 = local_10 + 1;
      local_c = local_c + 1;
    }
    if (param_2 <= (int)local_c - param_1) {
      local_c = (char *)(param_2 + -1 + param_1);
    }
    *local_c = '\0';
    iVar1 = (int)local_c - param_1;
  }
  return iVar1;
}



void FUN_0002419e(byte *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined auStack_158 [128];
  undefined4 auStack_d8 [2];
  undefined4 uStack_d0;
  undefined4 uStack_cc;
  undefined4 uStack_c8;
  undefined2 auStack_c4 [89];
  undefined local_11;
  
  snprintf((char *)auStack_d8,200,"\t    Flags:0x%x [",(uint)*param_1);
  if ((*param_1 & 1) != 0) {
    sVar1 = strlen((char *)auStack_d8);
    *(undefined4 *)((int)auStack_d8 + sVar1) = 0x4c5f454c;
    *(undefined4 *)((int)auStack_d8 + sVar1 + 4) = 0x74696d69;
    *(undefined4 *)((int)&uStack_d0 + sVar1) = 0x206465;
  }
  if ((*param_1 & 2) != 0) {
    sVar1 = strlen((char *)auStack_d8);
    *(undefined4 *)((int)auStack_d8 + sVar1) = 0x475f454c;
    *(undefined4 *)((int)auStack_d8 + sVar1 + 4) = 0x72656e65;
    *(undefined4 *)((int)&uStack_d0 + sVar1) = 0x206c61;
  }
  if ((*param_1 & 4) != 0) {
    sVar1 = strlen((char *)auStack_d8);
    *(undefined4 *)((int)auStack_d8 + sVar1) = 0x425f6f4e;
    *(undefined4 *)((int)auStack_d8 + sVar1 + 4) = 0x44452f52;
    *(undefined2 *)((int)&uStack_d0 + sVar1) = 0x2052;
    *(undefined *)((int)&uStack_d0 + sVar1 + 2) = 0;
  }
  if ((*param_1 & 8) != 0) {
    sVar1 = strlen((char *)auStack_d8);
    *(undefined4 *)((int)auStack_d8 + sVar1) = 0x746e6f43;
    *(undefined4 *)((int)auStack_d8 + sVar1 + 4) = 0x6c6c6f72;
    *(undefined4 *)((int)&uStack_d0 + sVar1) = 0x4c5f7265;
    *(undefined4 *)((int)&uStack_d0 + sVar1 + 4) = 0x52422f45;
    *(undefined4 *)((int)&uStack_d0 + sVar1 + 8) = 0x5244452f;
    *(undefined2 *)((int)auStack_c4 + sVar1) = 0x20;
  }
  if ((*param_1 & 0x10) != 0) {
    sVar1 = strlen((char *)auStack_d8);
    *(undefined4 *)((int)auStack_d8 + sVar1) = 0x74736f48;
    *(undefined4 *)((int)auStack_d8 + sVar1 + 4) = 0x2f454c5f;
    *(undefined4 *)((int)&uStack_d0 + sVar1) = 0x452f5242;
    *(undefined2 *)((int)&uStack_d0 + sVar1 + 4) = 0x5244;
    *(char *)((int)&uStack_d0 + sVar1 + 6) = '\0';
  }
  sVar1 = strlen((char *)auStack_d8);
  *(undefined2 *)((int)auStack_d8 + sVar1) = 0x5d;
  local_11 = 0;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_158,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_flags",0xd7);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_158,&DAT_00061e78,auStack_d8);
  }
  return;
}



undefined4 FUN_00024358(short param_1)

{
  short *local_10;
  int local_c;
  
  local_10 = &DAT_00083550;
  local_c = 0;
  while( true ) {
    if (500 < local_c) {
      return 0;
    }
    if (param_1 == *local_10) break;
    local_c = local_c + 1;
    local_10 = local_10 + 4;
  }
  return *(undefined4 *)(local_10 + 2);
}



void FUN_000243aa(undefined4 param_1,byte *param_2,byte param_3)

{
  int iVar1;
  byte local_99;
  byte *local_98;
  undefined auStack_90 [128];
  int local_10;
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_uuid16",0x101);
  local_99 = param_3;
  local_98 = param_2;
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"\t    %s [UUID16]:",param_1);
  }
  while (1 < local_99) {
    local_a = (ushort)local_98[1] * 0x100 + (ushort)*local_98;
    local_98 = local_98 + 2;
    local_99 = local_99 - 2;
    local_10 = FUN_00024358(local_a);
    if (local_10 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_parse_eir_uuid16",0x10d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"\t        0x%04X [Unknown]",local_a);
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_parse_eir_uuid16",0x109);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"\t        0x%04X [%s]",local_a,local_10);
      }
    }
  }
  return;
}



void FUN_000244e2(undefined4 param_1,byte *param_2,byte param_3)

{
  int iVar1;
  byte local_99;
  byte *local_98;
  undefined auStack_8c [128];
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_uuid32",0x11f);
  local_99 = param_3;
  local_98 = param_2;
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_8c,"\t    %s [UUID32]:",param_1);
  }
  while (3 < local_99) {
    local_c = (uint)local_98[3] * 0x1000000 +
              (uint)*local_98 + (uint)local_98[1] * 0x100 + (uint)local_98[2] * 0x10000;
    local_98 = local_98 + 4;
    local_99 = local_99 - 4;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_uuid32",0x124);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_8c,"\t        0x%08X",local_c);
    }
  }
  return;
}



void FUN_000245c2(undefined4 param_1,byte *param_2,byte param_3)

{
  int iVar1;
  byte local_179;
  byte *local_178;
  undefined auStack_170 [128];
  byte local_f0 [220];
  
  memset(local_f0 + 0x10,0,200);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_170,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_uuid128",0x137);
  local_179 = param_3;
  local_178 = param_2;
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_170,"\t    %s [UUID128]:",param_1);
  }
  while (3 < local_179) {
    for (iVar1 = 0; iVar1 < 0x10; iVar1 = iVar1 + 1) {
      local_f0[iVar1] = *local_178;
      local_178 = local_178 + 1;
    }
    local_179 = local_179 - 0x10;
    snprintf((char *)(local_f0 + 0x10),200,
             "\t        0x%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X",
             (uint)local_f0[0],(uint)local_f0[1],(uint)local_f0[2],(uint)local_f0[3],
             (uint)local_f0[4],(uint)local_f0[5],(uint)local_f0[6],(uint)local_f0[7],
             (uint)local_f0[8],(uint)local_f0[9],(uint)local_f0[10],(uint)local_f0[11],
             (uint)local_f0[12],(uint)local_f0[13],(uint)local_f0[14],(uint)local_f0[15]);
    iVar1 = duss_log_gen_head(0x5c,3,auStack_170,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_uuid128",0x142);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_170,&DAT_00061e78,local_f0 + 0x10);
    }
  }
  return;
}



void FUN_00024768(byte *param_1)

{
  int iVar1;
  undefined auStack_98 [130];
  short local_16;
  undefined4 local_14;
  short *local_10;
  int local_c;
  
  local_14 = 0x30;
  local_16 = (ushort)param_1[1] * 0x100 + (ushort)*param_1;
  local_c = 0;
  for (local_10 = &DAT_000844f8; (local_c < 0x30 && (local_16 != *local_10));
      local_10 = local_10 + 6) {
    local_c = local_c + 1;
  }
  if (local_c < 0x30) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_ble_appearance",0x167);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\t    BLE Appearance:0x%04X [%s - %s]",local_16,
                     *(undefined4 *)(local_10 + 2),*(undefined4 *)(local_10 + 4));
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_ble_appearance",0x162);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\t    BLE Appearance:0x%04X [Unknown]",local_16);
    }
  }
  return;
}



void FUN_00024898(undefined4 param_1,char *param_2,char param_3)

{
  int iVar1;
  char local_161;
  char *local_160;
  undefined auStack_154 [128];
  char acStack_d4 [200];
  uint local_c;
  
  memset(acStack_d4,0,200);
  local_c = snprintf(acStack_d4,200,"\t    %s: ",param_1);
  local_160 = param_2;
  for (local_161 = param_3; (local_c < 200 && (local_161 != '\0')); local_161 = local_161 + -1) {
    acStack_d4[local_c] = *local_160;
    local_160 = local_160 + 1;
    local_c = local_c + 1;
  }
  acStack_d4[199] = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_154,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_name",0x183);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_154,&DAT_00061e78,acStack_d4);
  }
  return;
}



void FUN_00024972(byte *param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  uint local_c;
  
  local_c = (uint)*param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_tx_power",0x193);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_8c,"\t    TxPower:%d dB",local_c);
  }
  return;
}



void FUN_000249d6(undefined *param_1)

{
  char *pcVar1;
  undefined *puVar2;
  int iVar3;
  undefined *local_a4;
  undefined auStack_9c [128];
  undefined local_1c;
  undefined local_1b;
  undefined local_1a [6];
  
  puVar2 = local_1a;
  local_a4 = param_1;
  for (iVar3 = 0; iVar3 < 3; iVar3 = iVar3 + 1) {
    *puVar2 = *local_a4;
    puVar2 = puVar2 + -1;
    local_a4 = local_a4 + 1;
  }
  iVar3 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_cod",0x1a7);
  if (iVar3 != 0) {
    pcVar1 = FUN_0002f16c((int)&local_1c);
    duss_log_print(0x5c,3,auStack_9c,"\t    ClassOfDevice:%02x:%02x:%02x => %s",local_1c,local_1b,
                   local_1a[0],pcVar1);
  }
  return;
}



void FUN_00024a70(undefined *param_1)

{
  int iVar1;
  undefined auStack_8c [130];
  undefined local_a;
  undefined local_9;
  
  local_9 = *param_1;
  local_a = param_1[1];
  iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir_3d",0x1bb);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_8c,"\t    3D Sync: Flags:0x%02x PathLossThreshold:%ddBm",local_9,
                   local_a);
  }
  return;
}



void FUN_00024af0(byte *param_1,char param_2)

{
  int iVar1;
  byte local_17d;
  byte *local_17c;
  undefined auStack_174 [128];
  char acStack_f4 [4];
  undefined4 local_f0;
  undefined4 uStack_ec;
  undefined4 uStack_e8;
  undefined4 uStack_e4;
  byte local_27;
  short local_26;
  undefined4 local_24;
  uint local_20;
  int local_1c;
  short *local_18;
  int local_14;
  
  local_24 = 0x1b8;
  local_26 = (ushort)param_1[1] * 0x100 + (ushort)*param_1;
  local_17c = param_1 + 2;
  local_17d = param_2 - 2;
  local_14 = 0;
  for (local_18 = &DAT_00084738; (local_14 < 0x1b8 && (local_26 != *local_18));
      local_18 = local_18 + 4) {
    local_14 = local_14 + 1;
  }
  if (local_14 < 0x1b8) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_174,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_manuf_specific",0x1e5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_174,"\t    Manufacturer Specific CompanyId:0x%04X [%s]:",
                     local_26,*(undefined4 *)(local_18 + 2));
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_174,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_manuf_specific",0x1e0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_174,"\t    Manufacturer Specific CompanyId:0x%04X [Unknown]:",
                     local_26);
    }
  }
  while (local_17d != 0) {
    local_f0 = 0x20202009;
    uStack_ec = 0x20202020;
    uStack_e8 = 0x74614420;
    uStack_e4 = 0x203a61;
    local_1c = 0xf;
    if (local_17d < 0x11) {
      local_20 = (uint)local_17d;
    }
    else {
      local_20 = 0x10;
    }
    for (local_14 = 0; local_14 < (int)local_20; local_14 = local_14 + 1) {
      local_27 = *local_17c;
      local_17c = local_17c + 1;
      local_17d = local_17d - 1;
      sprintf(acStack_f4,"%02X ",(uint)local_27);
      local_1c = FUN_000240bc((int)&local_f0,200,local_1c,acStack_f4);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_174,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_manuf_specific",0x1f7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_174,&DAT_00061e78,&local_f0);
    }
  }
  return;
}



void FUN_00024d20(byte *param_1)

{
  int iVar1;
  undefined auStack_9c [128];
  short local_1c;
  short local_1a;
  short local_18;
  short local_16;
  undefined4 local_14;
  short *local_10;
  int local_c;
  
  local_14 = 0x1b8;
  local_16 = (ushort)param_1[1] * 0x100 + (ushort)*param_1;
  local_18 = (ushort)param_1[3] * 0x100 + (ushort)param_1[2];
  local_1a = (ushort)param_1[5] * 0x100 + (ushort)param_1[4];
  local_1c = (ushort)param_1[7] * 0x100 + (ushort)param_1[6];
  if (local_16 == 1) {
    local_c = 0;
    for (local_10 = &DAT_00084738; (local_c < 0x1b8 && (local_18 != *local_10));
        local_10 = local_10 + 4) {
      local_c = local_c + 1;
    }
    if (local_c < 0x1b8) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_parse_eir_device_id",0x224);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"\t    DeviceId: VendorId:0x%04X [%s]",local_18,
                       *(undefined4 *)(local_10 + 2));
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_disc_parse_eir_device_id",0x220);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"\t    DeviceId: VendorId:0x%04X [BT SIG Unknown]",local_18
                      );
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_device_id",0x226);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"\t            : ProductId:0x%04X Version:0x%04X",local_1a,
                     local_1c);
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_parse_eir_device_id",0x22b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,
                     "\t    DeviceId: VendorId:0x%04X [USB] ProductId:0x%04X Version:0x%04X",
                     local_18,local_1a,local_1c);
    }
  }
  return;
}



void FUN_00024f54(byte *param_1)

{
  int iVar1;
  undefined auStack_90 [130];
  byte local_e;
  byte local_d;
  byte *local_c;
  
  local_c = param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_parse_eir",0x23e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"\tExtended Information:");
  }
  while( true ) {
    if (*local_c == 0) break;
    local_d = *local_c - 1;
    local_e = local_c[1];
    local_c = local_c + 2;
    if (local_e == 10) {
      FUN_00024972(local_c);
    }
    else if (local_e < 0xb) {
      if (local_e == 5) {
        FUN_000244e2("Complete Service",local_c,local_d);
      }
      else if (local_e < 6) {
        if (local_e == 2) {
          FUN_000243aa("Incomplete Service",local_c,local_d);
        }
        else if (local_e < 3) {
          if (local_e == 1) {
            FUN_0002419e(local_c);
          }
        }
        else if (local_e == 3) {
          FUN_000243aa("Complete Service",local_c,local_d);
        }
        else if (local_e == 4) {
          FUN_000244e2("Incomplete Service",local_c,local_d);
        }
      }
      else if (local_e == 7) {
        FUN_000245c2("Complete Service",local_c,local_d);
      }
      else if (local_e < 7) {
        FUN_000245c2("Incomplete Service",local_c,local_d);
      }
      else if (local_e == 8) {
        FUN_00024898("ShortName",(char *)local_c,local_d);
      }
      else if (local_e == 9) {
        FUN_00024898("FullName",(char *)local_c,local_d);
      }
    }
    else if (local_e != 0x29) {
      if (local_e < 0x2a) {
        if (local_e == 0x10) {
          FUN_00024d20(local_c);
        }
        else if (local_e < 0x11) {
          if (local_e == 0xd) {
            FUN_000249d6(local_c);
          }
        }
        else if (local_e == 0x16) {
          FUN_000243aa("BLE Service",local_c,local_d);
        }
        else if (local_e == 0x19) {
          FUN_00024768(local_c);
        }
      }
      else if ((local_e != 0x2b) && (0x2a < local_e)) {
        if (local_e == 0x3d) {
          FUN_00024a70(local_c);
        }
        else if (local_e == 0xff) {
          FUN_00024af0(local_c,local_d);
        }
      }
    }
    local_c = local_c + local_d;
  }
  return;
}



char * FUN_000251ce(char param_1)

{
  char *pcVar1;
  
  if (param_1 == '\x02') {
    pcVar1 = "BLE";
  }
  else if (param_1 == '\x03') {
    pcVar1 = "BR/EDR/BLE";
  }
  else if (param_1 == '\x01') {
    pcVar1 = "BR/EDR";
  }
  else {
    pcVar1 = "Unknown";
  }
  return pcVar1;
}



char * FUN_00025218(char param_1)

{
  char *pcVar1;
  
  if (param_1 == '\x01') {
    pcVar1 = "BR";
  }
  else if (param_1 == '\x02') {
    pcVar1 = "BLE";
  }
  else {
    pcVar1 = "Unknown";
  }
  return pcVar1;
}



char * FUN_00025256(char param_1)

{
  char *pcVar1;
  
  if (param_1 == '\0') {
    pcVar1 = "Public";
  }
  else if (param_1 == '\x01') {
    pcVar1 = "Random";
  }
  else {
    pcVar1 = "Unknown";
  }
  return pcVar1;
}



void FUN_00025294(undefined4 param_1,short *param_2)

{
  undefined uVar1;
  undefined uVar2;
  undefined uVar3;
  char *pcVar4;
  undefined *puVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  undefined4 uVar9;
  undefined auStack_a4 [128];
  undefined auStack_24 [6];
  byte local_1e;
  byte local_1d;
  int local_1c;
  
  if (DAT_00089694 != (code *)0x0) {
    (*DAT_00089694)(param_1,param_2);
  }
  switch(param_1) {
  case 0:
    for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
      if (((&DAT_00086d50)[local_1c * 0x210] == '\x01') &&
         (iVar8 = bdcmp(&DAT_00086d54 + local_1c * 0x210,param_2), iVar8 == 0)) {
        iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                  ,"app_generic_disc_cback",0x2f0);
        if (iVar8 != 0) {
          duss_log_print(0x5c,3,auStack_a4,"Update device:%d",local_1c);
        }
        memcpy(&DAT_00086d54 + local_1c * 0x210,param_2,0x20c);
        break;
      }
    }
    if (0x13 < local_1c) {
      for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
        if ((&DAT_00086d50)[local_1c * 0x210] == '\0') {
          iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                    ,"app_generic_disc_cback",0x2fd);
          if (iVar8 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"New Discovered device:%d",local_1c);
          }
          (&DAT_00086d50)[local_1c * 0x210] = 1;
          memcpy(&DAT_00086d54 + local_1c * 0x210,param_2,0x20c);
          break;
        }
      }
    }
    if ((0x13 < local_1c) &&
       (iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                  ,"app_generic_disc_cback",0x308), iVar8 != 0)) {
      duss_log_print(0x5c,3,auStack_a4,"No room to save new discovered");
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x311);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"\tBdaddr:%02x:%02x:%02x:%02x:%02x:%02x",
                     *(undefined *)param_2,*(undefined *)((int)param_2 + 1),
                     *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),
                     *(undefined *)(param_2 + 2),*(undefined *)((int)param_2 + 5));
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x312);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"\tName:%s",(int)param_2 + 9);
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x317);
    if (iVar8 != 0) {
      uVar1 = *(undefined *)(param_2 + 3);
      uVar2 = *(undefined *)((int)param_2 + 7);
      uVar3 = *(undefined *)(param_2 + 4);
      pcVar4 = FUN_0002f16c((int)(param_2 + 3));
      duss_log_print(0x5c,3,auStack_a4,"\tClassOfDevice:%02x:%02x:%02x => %s",uVar1,uVar2,uVar3,
                     pcVar4);
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x31a);
    if (iVar8 != 0) {
      uVar9 = *(undefined4 *)(param_2 + 0x84);
      puVar5 = FUN_00028898(*(uint *)(param_2 + 0x84));
      duss_log_print(0x5c,3,auStack_a4,"\tServices:0x%08x (%s)",uVar9,puVar5);
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x31b);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"\tRssi:%d",*(undefined4 *)(param_2 + 0x82));
    }
    if ((*(char *)(param_2 + 0x86) != '\0') &&
       (iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                  ,"app_generic_disc_cback",0x322), iVar8 != 0)) {
      duss_log_print(0x5c,3,auStack_a4,"\tVidSrc:%d Vid:0x%04X Pid:0x%04X Version:0x%04X",
                     param_2[0x87],param_2[0x88],param_2[0x89],param_2[0x8a]);
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x329);
    if (iVar8 != 0) {
      pcVar4 = FUN_000251ce(*(char *)(param_2 + 0x104));
      pcVar6 = FUN_00025218(*(char *)(param_2 + 0x103));
      pcVar7 = FUN_00025256(*(char *)((int)param_2 + 0x207));
      duss_log_print(0x5c,3,auStack_a4,"\tDeviceType:%s InquiryType:%s AddressType:%s",pcVar4,pcVar6
                     ,pcVar7);
    }
    if (*(char *)(param_2 + 0x8b) != '\0') {
      FUN_00024f54((byte *)(param_2 + 0x8b));
    }
    break;
  case 1:
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x333);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"Discovery complete");
    }
    DAT_00089694 = (code *)0x0;
    FUN_00022b44();
    break;
  case 2:
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x339);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"Discover Device Info status:%d",*param_2);
    }
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x340);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"\tBdaddr:%02x:%02x:%02x:%02x:%02x:%02x",
                     *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),
                     *(undefined *)(param_2 + 2),*(undefined *)((int)param_2 + 5),
                     *(undefined *)(param_2 + 3),*(undefined *)((int)param_2 + 7));
    }
    if (*param_2 == 0) {
      local_1d = FUN_00026e4a(param_2[7],param_2[8]);
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x346);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"\tDevice VendorIdSource:0x%x",param_2[8]);
      }
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x347);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"\tDevice Vendor:0x%x",param_2[7]);
      }
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x348);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"\tDevice Product:0x%x",param_2[9]);
      }
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x349);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"\tDevice Version:0x%x",param_2[10]);
      }
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x34a);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"\tDevice SpecId:0x%x",param_2[5]);
      }
      if (local_1d == 1) {
        BSA_SecAddSiDevInit(auStack_24);
        bdcpy(auStack_24,param_2 + 1);
        local_1e = local_1d;
        BSA_SecAddSiDev(auStack_24);
        FUN_0002f006(0x89698,10,param_2 + 1,local_1d);
        FUN_0002ab4e();
      }
    }
    break;
  case 3:
    iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x35c);
    if (iVar8 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"BSA_DISC_REMOTE_NAME_EVT (status=%d)",*param_2);
    }
    if (*param_2 == 0) {
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x362);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"Read device name for %02x:%02x:%02x:%02x:%02x:%02x",
                       *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),
                       *(undefined *)(param_2 + 2),*(undefined *)((int)param_2 + 5),
                       *(undefined *)(param_2 + 3),*(undefined *)((int)param_2 + 7));
      }
      iVar8 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                                ,"app_generic_disc_cback",0x363);
      if (iVar8 != 0) {
        duss_log_print(0x5c,3,auStack_a4,"Name:%s",param_2 + 5);
      }
    }
    break;
  default:
    iVar8 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_generic_disc_cback",0x368);
    if (iVar8 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"app_generic_disc_cback unknown event:%d",param_1);
    }
  }
  return;
}



undefined4 FUN_00025bce(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_14;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_regular",0x37b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Regular Discovery");
  }
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_24 = DAT_00089690;
  local_2c = 4;
  local_14 = 0x11;
  DAT_00089694 = param_1;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_regular",0x38f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00025ce4(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  int local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_14;
  undefined local_11;
  undefined local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_ble_regular",0x3a5);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Regular BLE Discovery");
  }
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_24 = DAT_00089690;
  local_2c = param_2;
  if (param_2 < 0) {
    local_2c = 10;
  }
  local_14 = 0x10;
  local_10 = 1;
  local_11 = 1;
  DAT_00089694 = param_1;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_ble_regular",0x3bd);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00025e08(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_14;
  undefined local_11;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_ble_skip_name",0x3d3);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start BLE Discovery, Skip Name request");
  }
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_24 = DAT_00089690;
  local_2c = 4;
  local_14 = 0x10;
  local_11 = 1;
  DAT_00089694 = param_1;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_ble_skip_name",0x3e5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00025f16(uint param_1)

{
  int iVar1;
  undefined *puVar2;
  undefined4 uVar3;
  undefined auStack_ac [128];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  uint local_18;
  int local_c;
  
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_24 = 0;
  local_2c = 4;
  local_18 = param_1;
  memset(&DAT_00086d50,0,0x2940);
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_services",0x404);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Services filtered Discovery");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_services",0x405);
  if (iVar1 != 0) {
    puVar2 = FUN_00028898(param_1);
    duss_log_print(0x5c,3,auStack_ac,"Look for (%s) services",puVar2);
  }
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar3 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_services",0x409);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_00026056(undefined2 param_1,char param_2,char param_3,undefined4 param_4)

{
  undefined uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_b8 [128];
  undefined4 local_38;
  undefined local_34;
  char cStack_33;
  char local_32;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined local_24;
  undefined local_23;
  char cStack_22;
  char local_21;
  undefined2 local_20;
  undefined local_1e;
  undefined4 local_1c;
  int local_10;
  undefined2 local_c;
  undefined local_a;
  char local_9;
  
  iVar2 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_cod",0x424);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"Start COD filtered Discovery");
  }
  iVar2 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_cod",0x425);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"Look for COD service:%x major:%x minor:%x",param_1,param_2,
                   param_3);
  }
  BSA_DiscStartInit(&local_30);
  local_2c = 0x25295;
  local_28 = 0;
  local_30 = 4;
  local_1c = 0;
  memset(&DAT_00086d50,0,0x2940);
  local_24 = 1;
  cStack_33 = param_2 + ((byte)param_1 & 0xe0);
  uVar1 = (undefined)((ushort)param_1 >> 8);
  local_32 = param_3;
  local_34 = uVar1;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_cod",0x432);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"COD: 0x%02x 0x%02x 0x%02x",local_34,cStack_33,local_32);
  }
  local_23 = local_34;
  cStack_22 = cStack_33;
  local_21 = local_32;
  if (param_2 == '\0') {
    local_9 = '\0';
  }
  else {
    local_9 = '\x1f';
  }
  if (param_3 == '\0') {
    local_a = 0;
  }
  else {
    local_a = 0xfc;
  }
  local_38 = CONCAT31(CONCAT21(CONCAT11(local_38._3_1_,local_a),local_9 + ((byte)param_1 & 0xe0)),
                      uVar1);
  local_c = param_1;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_cod",0x449);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"COD Mask: 0x%02x 0x%02x 0x%02x",local_38 & 0xff,
                   local_38 >> 8 & 0xff,local_38 >> 0x10 & 0xff);
  }
  local_20 = (undefined2)local_38;
  local_1e = (undefined)(local_38 >> 0x10);
  DAT_00089694 = param_4;
  local_10 = BSA_DiscStart(&local_30);
  if (local_10 == 0) {
    uVar3 = 0;
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_cod",0x455);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"BSA_DiscStart failed status:%d",local_10);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_0002630e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [6];
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_abort",0x46a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Aborting Discovery");
  }
  BSA_DiscAbortInit(auStack_10);
  local_a = BSA_DiscAbort(auStack_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_abort",0x470);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_DiscAbort failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000263c8(undefined *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_bc [128];
  undefined auStack_3c [4];
  undefined4 local_38;
  undefined local_30;
  undefined auStack_2f [12];
  undefined local_23;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_bc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_dev_info",0x487);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_bc,"Start Device Info Discovery for %02x-%02x-%02x-%02x-%02x-%02x"
                   ,*param_1,param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
  }
  DAT_00089694 = param_2;
  BSA_DiscStartInit(auStack_3c);
  local_38 = 0x25295;
  local_23 = 1;
  local_30 = 2;
  bdcpy(auStack_2f,param_1);
  local_1c = BSA_DiscStart(auStack_3c);
  if (local_1c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_dev_info",0x498);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"BSA_DiscStart failed status:%d",local_1c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4
FUN_000264f8(undefined param_1,undefined2 param_2,char param_3,char param_4,undefined4 param_5)

{
  undefined uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_c0 [128];
  undefined4 local_40;
  undefined local_3c;
  char cStack_3b;
  char local_3a;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined local_2c;
  undefined local_2b;
  char cStack_2a;
  char local_29;
  undefined2 local_28;
  undefined local_26;
  undefined4 local_24;
  undefined local_1e;
  int local_18;
  undefined2 local_14;
  undefined local_12;
  char local_11;
  
  iVar2 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_brcm_filter_cod",0x4b4);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_c0,"Start COD and BRCM-specific filtered Discovery");
  }
  iVar2 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_brcm_filter_cod",0x4b6);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_c0,
                   "Look for COD service:%x major:%x minor:%x and BRCM filter:0x%x",param_2,param_3,
                   param_4,param_1);
  }
  DAT_00089694 = param_5;
  BSA_DiscStartInit(&local_38);
  local_34 = 0x25295;
  local_30 = 0;
  local_38 = 4;
  local_24 = 0;
  memset(&DAT_00086d50,0,0x2940);
  local_2c = 1;
  cStack_3b = param_3 + ((byte)param_2 & 0xe0);
  uVar1 = (undefined)((ushort)param_2 >> 8);
  local_3a = param_4;
  local_1e = param_1;
  local_3c = uVar1;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_brcm_filter_cod",0x4c9);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_c0,"COD: 0x%02x 0x%02x 0x%02x",local_3c,cStack_3b,local_3a);
  }
  local_2b = local_3c;
  cStack_2a = cStack_3b;
  local_29 = local_3a;
  if (param_3 == '\0') {
    local_11 = '\0';
  }
  else {
    local_11 = '\x1f';
  }
  if (param_4 == '\0') {
    local_12 = 0;
  }
  else {
    local_12 = 0xfc;
  }
  local_40 = CONCAT31(CONCAT21(CONCAT11(local_40._3_1_,local_12),local_11 + ((byte)param_2 & 0xe0)),
                      uVar1);
  local_14 = param_2;
  iVar2 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_brcm_filter_cod",0x4e0);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_c0,"COD Mask: 0x%02x 0x%02x 0x%02x",local_40 & 0xff,
                   local_40 >> 8 & 0xff,local_40 >> 0x10 & 0xff);
  }
  local_28 = (undefined2)local_40;
  local_26 = (undefined)(local_40 >> 0x10);
  local_18 = BSA_DiscStart(&local_38);
  if (local_18 == 0) {
    uVar3 = 0;
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_brcm_filter_cod",0x4e9);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"BSA_DiscStart failed status:%d",local_18);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_000267c6(undefined *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_bc [128];
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined local_30;
  undefined auStack_2f [7];
  undefined4 local_28;
  undefined local_21;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_bc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_bdaddr",0x4ff);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_bc,"Start BdAddr filtered Discovery");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_bc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_bdaddr",0x501);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_bc,"Look for BdAddr :%02X-%02X-%02X-%02X-%02X-%02X",*param_1,
                   param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
  }
  DAT_00089694 = param_3;
  BSA_DiscStartInit(&local_3c);
  local_38 = 0x25295;
  local_34 = 1;
  local_3c = 1;
  local_28 = 0;
  local_21 = 1;
  memset(&DAT_00086d50,0,0x2940);
  local_30 = 2;
  bdcpy(auStack_2f,param_1);
  local_1c = BSA_DiscStart(&local_3c);
  if (local_1c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_bdaddr",0x51b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"BSA_DiscStart failed status:%d",local_1c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00026960(undefined *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_bc [128];
  undefined auStack_3c [4];
  undefined4 local_38;
  undefined local_30;
  undefined auStack_2f [7];
  undefined4 local_28;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_bc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_bdaddr_services",0x531);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_bc,"Start Services search for one device");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_bc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_bdaddr_services",0x533);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_bc,"Device BdAddr :%02X-%02X-%02X-%02X-%02X-%02X",*param_1,
                   param_1[1],param_1[2],param_1[3],param_1[4],param_1[5]);
  }
  DAT_00089694 = param_3;
  BSA_DiscStartInit(auStack_3c);
  local_38 = 0x25295;
  local_30 = 2;
  bdcpy(auStack_2f,param_1);
  local_28 = param_2;
  memset(&DAT_00086d50,0,0x2940);
  local_1c = BSA_DiscStart(auStack_3c);
  if (local_1c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_bdaddr_services",0x54d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"BSA_DiscStart failed status:%d",local_1c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00026ae6(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_update",0x562);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Update mode specific Discovery");
  }
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_24 = 0;
  local_2c = 8;
  local_10 = param_1;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_update",0x570);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00026bdc(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined local_14;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_limited",0x585);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Limited Discovery");
  }
  BSA_DiscStartInit(&local_2c);
  local_28 = 0x25295;
  local_14 = 2;
  local_24 = 0;
  local_2c = 4;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(&local_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_limited",0x593);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00026cc6(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined auStack_2c [4];
  undefined4 local_28;
  undefined local_f;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                            ,"app_disc_start_power",0x5a8);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_ac,"Start Inquiry power specific Discovery");
  }
  BSA_DiscStartInit(auStack_2c);
  local_28 = 0x25295;
  local_f = param_1;
  memset(&DAT_00086d50,0,0x2940);
  local_c = BSA_DiscStart(auStack_2c);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_start_power",0x5b4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"BSA_DiscStart failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined * FUN_00026db0(undefined4 param_1)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (0x13 < local_c) {
      return (undefined *)0x0;
    }
    if (((&DAT_00086d50)[local_c * 0x210] != '\0') &&
       (iVar1 = bdcmp(&DAT_00086d54 + local_c * 0x210,param_1), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return &DAT_00086d50 + local_c * 0x210;
}



undefined FUN_00026e4a(short param_1,short param_2)

{
  int local_10;
  
  local_10 = 0;
  while( true ) {
    if (1 < local_10) {
      return 0;
    }
    if ((param_1 == *(short *)(&DAT_00083548 + local_10 * 4)) &&
       (param_2 == *(short *)(&DAT_0008354a + local_10 * 4))) break;
    local_10 = local_10 + 1;
  }
  return 1;
}



undefined4 FUN_00026eae(undefined4 param_1,undefined param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_9c [128];
  undefined auStack_1c [8];
  undefined4 local_14;
  undefined local_10;
  short local_a;
  
  BSA_ReadRemoteNameInit(auStack_1c);
  local_14 = 0x25295;
  local_10 = param_2;
  bdcpy(auStack_1c,param_1);
  local_a = BSA_ReadRemoteName(auStack_1c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_disc.c"
                              ,"app_disc_read_remote_device_name",0x619);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_9c,"BSA_ReadRemoteName failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_00026f52(undefined4 param_1)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while ((local_c < 0x14 &&
         (((&DAT_00086d50)[local_c * 0x210] != '\x01' ||
          (iVar1 = bdcmp(&DAT_00086d54 + local_c * 0x210,param_1), iVar1 != 0))))) {
    local_c = local_c + 1;
  }
  return local_c;
}



int FUN_00027272(undefined param_1)

{
  int iVar1;
  undefined auStack_744 [128];
  undefined uStack_6c4;
  undefined local_6c3;
  undefined local_6c2;
  undefined auStack_6c1 [6];
  char acStack_6bb [249];
  undefined2 local_5c2;
  undefined local_5c0;
  undefined auStack_3b4 [4];
  undefined local_3b0;
  undefined local_3af;
  undefined local_3ae;
  undefined local_3ad;
  undefined local_3ac;
  undefined local_3ab;
  undefined local_3aa;
  undefined local_3a9;
  undefined local_3a8;
  char acStack_3a7 [249];
  undefined2 local_2ae;
  undefined local_2ac;
  int local_20;
  size_t local_1c;
  
  memset(&uStack_6c4,0,0x30d);
  local_20 = FUN_0002a88e(&uStack_6c4);
  if (local_20 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x59);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_744,"Unable to Read XML config file");
    }
  }
  else {
    local_20 = BSA_DmSetConfigInit(auStack_3b4);
    local_3af = local_6c3;
    local_3ae = local_6c2;
    local_3b0 = param_1;
    bdcpy(&local_3ad,auStack_6c1);
    local_1c = strlen(acStack_6bb);
    if (0x12 < (int)local_1c) {
      local_1c = 0x12;
    }
    strncpy(acStack_3a7,acStack_6bb,local_1c);
    acStack_3a7[local_1c] = '\0';
    local_2ae = local_5c2;
    local_2ac = local_5c0;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x6e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"Set Local Bluetooth Config:");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x6f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tEnable:%d",local_3b0);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x70);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tDiscoverable:%d",local_3af);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x71);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tConnectable:%d",local_3ae);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x72);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tName:%s",acStack_3a7);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x76);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tBdaddr %02x:%02x:%02x:%02x:%02x:%02x",local_3ad,local_3ac
                     ,local_3ab,local_3aa,local_3a9,local_3a8);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_744,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_local_bt_config",0x78);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_744,"\tClassOfDevice:%02x:%02x:%02x",(undefined)local_2ae,
                     local_2ae._1_1_,local_2ac);
    }
    local_20 = BSA_DmSetConfig(auStack_3b4);
    if (local_20 == 0) {
      local_20 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_744,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_set_local_bt_config",0x7e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_744,"Unable to set BT config to server status:%d",local_20);
      }
      local_20 = -1;
    }
  }
  return local_20;
}



undefined4 FUN_00027640(undefined param_1,undefined param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0 [66];
  undefined local_297;
  undefined local_296;
  short local_a;
  
  BSA_DmSetConfigInit(local_3a0);
  local_3a0[0] = 0x10;
  local_297 = param_1;
  local_296 = param_2;
  local_a = BSA_DmSetConfig(local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_channel_map",0xa0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_000276ee(undefined param_1)

{
  int iVar1;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_280;
  int local_c;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x100;
  local_280 = param_1;
  local_c = BSA_DmSetConfig(&local_3a0);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_tx_class",0xc1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"Unable to change Tx power status:%d",local_c);
    }
  }
  return local_c;
}



undefined4 FUN_00027790(undefined2 param_1,undefined2 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined2 local_28e;
  undefined2 local_28c;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x40;
  local_28e = param_1;
  local_28c = param_2;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_page_scan_param",0xe8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027846(undefined2 param_1,undefined2 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined2 local_28a;
  undefined2 local_288;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x80;
  local_28a = param_1;
  local_288 = param_2;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_inquiry_scan_param",0x110);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000278fe(undefined2 param_1,undefined2 param_2,undefined param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_428 [128];
  undefined4 local_3a8;
  undefined local_3a4;
  undefined2 local_1ac;
  undefined2 local_1aa;
  undefined local_1a8;
  short local_12;
  
  BSA_DmSetConfigInit(&local_3a8);
  local_3a4 = 1;
  local_3a8 = 0x1000;
  local_1ac = param_1;
  local_1aa = param_2;
  local_1a8 = param_3;
  local_12 = BSA_DmSetConfig(&local_3a8);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_428,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_scan_param",0x13a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_428,"BSA_DmSetConfig failed status:%d ",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000279d0(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined auStack_19c [6];
  undefined2 local_196;
  undefined2 local_194;
  undefined2 local_192;
  undefined2 local_190;
  undefined local_18e;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x4000;
  bdcpy(auStack_19c,param_1);
  local_194 = *(undefined2 *)(param_1 + 8);
  local_196 = *(undefined2 *)(param_1 + 6);
  local_192 = *(undefined2 *)(param_1 + 10);
  local_190 = *(undefined2 *)(param_1 + 0xc);
  local_18e = *(undefined *)(param_1 + 0xe);
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_conn_param",0x16b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027ac4(undefined2 param_1,undefined2 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined2 local_18c;
  undefined2 local_18a;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x100000;
  local_18c = param_1;
  local_18a = param_2;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_conn_scan_param",0x194);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027b7e(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  byte local_188;
  byte local_187;
  undefined auStack_186 [34];
  undefined4 local_164;
  undefined2 local_160;
  byte local_15e;
  undefined auStack_15c [12];
  byte local_150;
  undefined2 local_14c;
  undefined2 local_148;
  undefined auStack_138 [31];
  byte local_119;
  undefined2 local_116;
  undefined2 local_114;
  byte local_45;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x8000;
  local_188 = *param_1;
  local_187 = param_1[1];
  local_164 = *(undefined4 *)(param_1 + 0x24);
  local_160 = *(undefined2 *)(param_1 + 0x28);
  local_15e = param_1[0x2a];
  local_119 = param_1[0x6f];
  local_45 = param_1[0x143];
  local_114 = *(undefined2 *)(param_1 + 0x74);
  local_116 = *(undefined2 *)(param_1 + 0x72);
  memcpy(auStack_15c,param_1 + 0x2c,(uint)param_1[0x2a] << 1);
  memcpy(auStack_186,param_1 + 2,(uint)*param_1);
  local_150 = param_1[0x38];
  local_14c = *(undefined2 *)(param_1 + 0x3c);
  local_148 = *(undefined2 *)(param_1 + 0x40);
  memcpy(auStack_138,param_1 + 0x50,(uint)param_1[0x38]);
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_adv_data",0x1c9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027d2a(undefined2 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined2 local_44;
  undefined2 local_42;
  undefined auStack_3f [9];
  undefined local_36;
  undefined local_35;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x10000;
  bdcpy(auStack_3f,(int)param_1 + 5);
  local_44 = *param_1;
  local_42 = param_1[1];
  local_35 = *(undefined *)((int)param_1 + 0xf);
  local_36 = *(undefined *)(param_1 + 7);
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_adv_param",0x1f8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027e12(undefined2 param_1,char param_2,undefined param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_428 [128];
  undefined4 local_3a8;
  undefined local_3a4;
  undefined local_2a2;
  char local_2a1;
  undefined local_2a0;
  short local_12;
  
  BSA_DmSetConfigInit(&local_3a8);
  local_3a4 = 1;
  local_3a8 = 8;
  local_2a1 = param_2 + ((byte)param_1 & 0xe0);
  local_2a2 = (undefined)((ushort)param_1 >> 8);
  local_2a0 = param_3;
  local_12 = BSA_DmSetConfig(&local_3a8);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_428,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_device_class",0x21f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_428,"BSA_DmSetConfig failed status:%d ",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027ef8(undefined param_1,undefined param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_39b;
  undefined local_39a;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 1;
  local_39b = param_1;
  local_39a = param_2;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_visibility",0x246);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00027fac(undefined param_1,undefined param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_19f;
  undefined local_19e;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x2000;
  local_19f = param_1;
  local_19e = param_2;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_visibility",0x26e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00028066(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_19d;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x20000;
  local_19d = param_1;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_local_privacy",0x292);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0002810e(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_1b3;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x400;
  local_1b3 = param_1;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_dual_stack_mode",0x2b8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



uint FUN_000281b6(void)

{
  int iVar1;
  uint uVar2;
  undefined auStack_420 [128];
  undefined auStack_3a0 [493];
  byte local_1b3;
  short local_a;
  
  BSA_DmGetConfigInit(auStack_3a0);
  local_a = BSA_DmGetConfig(auStack_3a0);
  if (local_a == 0) {
    uVar2 = (uint)local_1b3;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_get_dual_stack_mode",0x2d6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmGetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



uint FUN_0002823c(void)

{
  int iVar1;
  undefined auStack_420 [128];
  undefined auStack_3a0 [876];
  byte local_34;
  short local_a;
  
  BSA_DmGetConfigInit(auStack_3a0);
  local_a = BSA_DmGetConfig(auStack_3a0);
  if (local_a != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_get_chip_id",0x2f5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmGetConfig failed status:%d ",local_a);
    }
    return 0xffffffff;
  }
  if (local_34 == 0x55) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_get_chip_id",0x308);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_420,"ChipId:BCM43242A1:%d",local_34);
    }
    goto LAB_0002855c;
  }
  if (local_34 < 0x56) {
    if (local_34 == 0x3f) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x300);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM20702A1:%d",local_34);
      }
      goto LAB_0002855c;
    }
    if (local_34 == 0x49) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x304);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM20702B0:%d",local_34);
      }
      goto LAB_0002855c;
    }
    if (local_34 == 0xc) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x2fc);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM2046B1:%d",local_34);
      }
      goto LAB_0002855c;
    }
  }
  else {
    if (local_34 == 0x6c) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x30c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM43569A2:%d",local_34);
      }
      goto LAB_0002855c;
    }
    if (local_34 == 0x7e) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x314);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM20704A2:%d",local_34);
      }
      goto LAB_0002855c;
    }
    if (local_34 == 0x66) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                                ,"app_dm_get_chip_id",0x310);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_420,"ChipId:BCM20704A1:%d",local_34);
      }
      goto LAB_0002855c;
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_420,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                            ,"app_dm_get_chip_id",0x318);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_420,"Unsupported ChipId:%d",local_34);
  }
LAB_0002855c:
  return (uint)local_34;
}



undefined4 FUN_0002856e(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  undefined local_1a6;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x800;
  local_1a6 = param_1;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_set_ble_bg_conn_type",0x33f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00028616(char param_1,undefined2 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0;
  undefined local_39c;
  char local_28;
  undefined2 local_26;
  short local_a;
  
  BSA_DmSetConfigInit(&local_3a0);
  local_39c = 1;
  local_3a0 = 0x80000;
  if (param_1 != '\0') {
    local_26 = param_2;
  }
  local_28 = param_1;
  local_a = BSA_DmSetConfig(&local_3a0);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_dm.c"
                              ,"app_dm_monitor_rssi",0x36d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed status:%d ",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



char * FUN_000286dc(undefined param_1)

{
  char *pcVar1;
  
  switch(param_1) {
  case 0:
    pcVar1 = "Reserved !!!";
    break;
  case 1:
    pcVar1 = "SPP";
    break;
  case 2:
    pcVar1 = "DUN";
    break;
  case 3:
    pcVar1 = "A2DP_SRC";
    break;
  case 4:
    pcVar1 = "AVRCP_TG";
    break;
  case 5:
    pcVar1 = "HSP";
    break;
  case 6:
    pcVar1 = "HFP";
    break;
  case 7:
    pcVar1 = "OPP";
    break;
  case 8:
    pcVar1 = "FTP";
    break;
  case 9:
    pcVar1 = "SYNC";
    break;
  case 10:
    pcVar1 = "BPP";
    break;
  case 0xb:
    pcVar1 = "BIP";
    break;
  case 0xc:
    pcVar1 = "PANU";
    break;
  case 0xd:
    pcVar1 = "NAP";
    break;
  case 0xe:
    pcVar1 = "GN";
    break;
  case 0xf:
    pcVar1 = "SAP";
    break;
  case 0x10:
    pcVar1 = "A2DP";
    break;
  case 0x11:
    pcVar1 = "AVRCP";
    break;
  case 0x12:
    pcVar1 = "HID_HOST";
    break;
  case 0x13:
    pcVar1 = "VDP";
    break;
  case 0x14:
    pcVar1 = "PBAP";
    break;
  case 0x15:
    pcVar1 = "HSP_HS";
    break;
  case 0x16:
    pcVar1 = "HFP_HS";
    break;
  case 0x17:
    pcVar1 = "MAP";
    break;
  default:
    pcVar1 = "BAD Service !!!";
    break;
  case 0x19:
    pcVar1 = "HL";
    break;
  case 0x1e:
    pcVar1 = "HID_DEVICE";
    break;
  case 0x1f:
    pcVar1 = "BLE";
  }
  return pcVar1;
}



undefined * FUN_00028898(uint param_1)

{
  size_t sVar1;
  
  memset(&DAT_000859d0,0,0xe0);
  if ((param_1 & 1) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"RESERVED!!! ",0xdf - sVar1);
  }
  if ((param_1 & 2) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"SPP ",0xdf - sVar1);
  }
  if ((param_1 & 4) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"DUN ",0xdf - sVar1);
  }
  if ((param_1 & 8) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"A2DP_SRC ",0xdf - sVar1);
  }
  if ((param_1 & 0x10) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"AVRCP_TG ",0xdf - sVar1);
  }
  if ((param_1 & 0x20) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HSP ",0xdf - sVar1);
  }
  if ((param_1 & 0x40) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HFP ",0xdf - sVar1);
  }
  if ((param_1 & 0x80) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"OPP ",0xdf - sVar1);
  }
  if ((param_1 & 0x100) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"FTP ",0xdf - sVar1);
  }
  if ((param_1 & 0x200) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"SYNC ",0xdf - sVar1);
  }
  if ((param_1 & 0x400) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"BPP ",0xdf - sVar1);
  }
  if ((param_1 & 0x800) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"BIP ",0xdf - sVar1);
  }
  if ((param_1 & 0x1000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"PANU ",0xdf - sVar1);
  }
  if ((param_1 & 0x2000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"NAP ",0xdf - sVar1);
  }
  if ((param_1 & 0x4000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"GN ",0xdf - sVar1);
  }
  if ((param_1 & 0x8000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"SAP ",0xdf - sVar1);
  }
  if ((param_1 & 0x10000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"A2DP ",0xdf - sVar1);
  }
  if ((param_1 & 0x20000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"AVRCP ",0xdf - sVar1);
  }
  if ((param_1 & 0x40000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HID ",0xdf - sVar1);
  }
  if ((int)param_1 < 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HID_DEVICE ",0xdf - sVar1);
  }
  if ((param_1 & 0x80000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"VDP ",0xdf - sVar1);
  }
  if ((param_1 & 0x100000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"PBAP ",0xdf - sVar1);
  }
  if ((param_1 & 0x200000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HSP_HS ",0xdf - sVar1);
  }
  if ((param_1 & 0x400000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HFP_HS ",0xdf - sVar1);
  }
  if ((param_1 & 0x800000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"MAS ",0xdf - sVar1);
  }
  if ((param_1 & 0x1000000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"NN ",0xdf - sVar1);
  }
  if ((param_1 & 0x2000000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"HL ",0xdf - sVar1);
  }
  if ((param_1 & 0x40000000) != 0) {
    sVar1 = strlen(&DAT_000859d0);
    strncat(&DAT_000859d0,"BLE ",0xdf - sVar1);
  }
  return &DAT_000859d0;
}



undefined4 FUN_00028e34(char *param_1,int param_2)

{
  char *pcVar1;
  undefined4 uVar2;
  
  pcVar1 = FUN_00033042(param_1,(int)(param_1 + param_2),"BEGIN:VCARD\r\nVERSION:2.1\r\n");
  if (pcVar1 == (char *)0x0) {
    pcVar1 = FUN_00033042(param_1,(int)(param_1 + param_2),"BEGIN:VCARD\r\nVERSION:3.0\r\n");
    if (pcVar1 == (char *)0x0) {
      uVar2 = 0xff;
    }
    else {
      uVar2 = 2;
    }
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}



undefined4 FUN_00028e84(char *param_1,ushort *param_2,char param_3,int param_4,char param_5)

{
  undefined4 uVar1;
  
  if (param_3 == '\x01') {
    uVar1 = FUN_00032b72((int *)&DAT_00063664,param_1,param_2,param_4,param_5);
  }
  else if (param_3 == '\x02') {
    uVar1 = FUN_00032b72((int *)&DAT_0006367c,param_1,param_2,param_4,param_5);
  }
  else {
    *param_2 = 0;
    uVar1 = 1;
  }
  return uVar1;
}



undefined4 FUN_00028f1a(int param_1,char param_2)

{
  char cVar1;
  undefined4 uVar2;
  byte local_11;
  
  if ((DAT_00085ab0 | DAT_00085ab4) == 0) {
    uVar2 = 0;
  }
  else if (DAT_00085ab8 == '\x01') {
    for (local_11 = 0; local_11 < 0x20; local_11 = local_11 + 1) {
      if (((DAT_00085ab0 & *(uint *)(&DAT_000635dc + (uint)local_11 * 4)) != 0) &&
         (cVar1 = FUN_000329a0(0x6345c,*(byte **)(&DAT_0006345c + (uint)local_11 * 0xc),param_1,
                               param_2), cVar1 == '\x01')) {
        return 1;
      }
    }
    uVar2 = 0;
  }
  else {
    for (local_11 = 0; local_11 < 0x20; local_11 = local_11 + 1) {
      if (((DAT_00085ab0 & *(uint *)(&DAT_000635dc + (uint)local_11 * 4)) != 0) &&
         (cVar1 = FUN_000329a0(0x6345c,*(byte **)(&DAT_0006345c + (uint)local_11 * 0xc),param_1,
                               param_2), cVar1 == '\0')) {
        return 0;
      }
    }
    uVar2 = 1;
  }
  return uVar2;
}



char * FUN_00029044(char *param_1,int param_2)

{
  char *pcVar1;
  char *local_c;
  
  if (param_2 - (int)param_1 < 4) {
LAB_000290a6:
    local_c = (char *)0x0;
  }
  else {
    pcVar1 = param_1;
    do {
      local_c = pcVar1;
      if ((char *)(param_2 + -3) <= local_c) goto LAB_000290a6;
      pcVar1 = local_c + 1;
    } while ((((*pcVar1 != '\r') || (*local_c == '=')) || (local_c[2] != '\n')) ||
            ((local_c[3] == ' ' || (local_c[3] == '\t'))));
    local_c = local_c + 3;
  }
  return local_c;
}



char * FUN_000290b4(char *param_1,int param_2,char *param_3)

{
  size_t __n;
  int iVar1;
  char *local_14;
  
  __n = strlen(param_3);
  local_14 = param_1;
  do {
    iVar1 = strncmp(local_14,param_3,__n);
    if (iVar1 == 0) {
      return local_14 + __n;
    }
    local_14 = FUN_00029044(local_14,param_2);
  } while (local_14 != (char *)0x0);
  return (char *)0x0;
}



void FUN_00029104(char *param_1,int param_2,short *param_3)

{
  char *pcVar1;
  char *pcVar2;
  byte local_15;
  char *local_14;
  
  *param_3 = 0;
  local_14 = param_1;
  do {
    local_14 = FUN_000290b4(local_14,param_2,"BEGIN:VCARD\r\n");
    if (local_14 == (char *)0x0) {
      return;
    }
    pcVar1 = FUN_000290b4(local_14,param_2,"END:VCARD\r\n");
    if ((DAT_00085ab0 | DAT_00085ab4) == 0) {
      *param_3 = *param_3 + 1;
    }
    else if (DAT_00085ab8 == '\0') {
      for (local_15 = 0; local_15 < 0x20; local_15 = local_15 + 1) {
        if ((((DAT_00085ab0 & *(uint *)(&DAT_000635dc + (uint)local_15 * 4)) != 0) &&
            (pcVar2 = FUN_000290b4(local_14,param_2,*(char **)(&DAT_0006345c + (uint)local_15 * 0xc)
                                  ), pcVar2 < pcVar1)) && (pcVar2 != (char *)0x0)) {
          *param_3 = *param_3 + 1;
          break;
        }
      }
    }
    else {
      local_15 = 0;
      while ((local_15 < 0x20 &&
             (((DAT_00085ab0 & *(uint *)(&DAT_000635dc + (uint)local_15 * 4)) == 0 ||
              ((pcVar2 = FUN_000290b4(local_14,param_2,
                                      *(char **)(&DAT_0006345c + (uint)local_15 * 0xc)),
               pcVar2 <= pcVar1 && (pcVar2 != (char *)0x0))))))) {
        local_15 = local_15 + 1;
      }
      if (local_15 == 0x20) {
        *param_3 = *param_3 + 1;
      }
    }
    if (local_14 == (char *)0x0) {
      return;
    }
  } while( true );
}



void FUN_00029296(undefined4 param_1,undefined4 param_2)

{
  FUN_00032416(param_1,param_2);
  return;
}



undefined4 FUN_000292b0(int param_1,byte *param_2,char *param_3,uint param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00028e34(param_3,param_4);
  if ((char)uVar1 == '\x01') {
    uVar1 = FUN_00033100((int *)&DAT_00063694,param_1,param_2,param_3,param_4);
  }
  else if ((char)uVar1 == '\x02') {
    uVar1 = FUN_00033100((int *)&DAT_000636ac,param_1,param_2,param_3,param_4);
  }
  else {
    *param_2 = 0;
    uVar1 = 1;
  }
  return uVar1;
}



undefined4 FUN_0002931a(void *param_1,undefined2 *param_2,int param_3,char param_4,byte *param_5)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00032a5a(0x6345c,param_5,param_3,param_4,param_1,param_2);
  return uVar1;
}



undefined4 FUN_0002934e(char *param_1)

{
  char *pcVar1;
  int iVar2;
  undefined auStack_a4 [128];
  byte local_24 [9];
  undefined local_1b;
  char acStack_18 [12];
  byte *local_c;
  
  pcVar1 = strrchr(param_1,0x2e);
  if (pcVar1 != (char *)0x0) {
    local_c = (byte *)(pcVar1 + 1);
    strncpy((char *)local_24,(char *)local_c,10);
    local_1b = 0;
    for (local_c = local_24; *local_c != 0; local_c = local_c + 1) {
      iVar2 = tolower((uint)*local_c);
      *local_c = (byte)iVar2;
    }
    iVar2 = strcmp((char *)local_24,"wav");
    if (iVar2 == 0) {
      iVar2 = FUN_00029762(param_1,acStack_18);
      if (iVar2 == 0) {
        return 1;
      }
      iVar2 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_playlist.c"
                                ,"app_playlist_file_supported",0x40);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_a4,"Unable to extract WAV format from:%s",param_1);
      }
    }
  }
  return 0;
}



int FUN_0002943a(char *param_1,void **param_2)

{
  int iVar1;
  int *piVar2;
  void *pvVar3;
  long __pos;
  void **ppvVar4;
  undefined auStack_48c [128];
  char acStack_40c [1000];
  size_t local_24;
  dirent *local_20;
  DIR *local_1c;
  int local_18;
  void *local_14;
  
  local_14 = (void *)0x0;
  local_18 = 0;
  if (param_2 == (void **)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_48c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_playlist.c"
                              ,"app_playlist_create",0x5d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_48c,"app_create_play_list ppp_playlist NULL");
    }
    local_18 = -1;
  }
  else {
    local_1c = opendir(param_1);
    if (local_1c == (DIR *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_48c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_playlist.c"
                                ,"app_playlist_create",100);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        duss_log_print(0x5c,1,auStack_48c,"opendir(%s) failed: %d",param_1,*piVar2);
      }
      perror("app_create_play_list:");
      local_18 = -1;
    }
    else {
      do {
        local_20 = readdir(local_1c);
        if (local_20 != (dirent *)0x0) {
          snprintf(acStack_40c,1000,"%s/%s",param_1,local_20->d_name + 8);
          iVar1 = FUN_0002934e(acStack_40c);
          if (iVar1 != 0) {
            local_14 = realloc(local_14,(local_18 + 1) * 4);
            if (local_14 == (void *)0x0) {
              iVar1 = duss_log_gen_head(0x5c,1,auStack_48c,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_playlist.c"
                                        ,"app_playlist_create",0x77);
              if (iVar1 != 0) {
                piVar2 = __errno_location();
                duss_log_print(0x5c,1,auStack_48c,"realloc failed: %d",*piVar2);
              }
              closedir(local_1c);
              return -1;
            }
            local_24 = strlen(acStack_40c);
            ppvVar4 = (void **)((int)local_14 + local_18 * 4);
            pvVar3 = malloc(local_24 + 1);
            *ppvVar4 = pvVar3;
            strncpy(*(char **)(local_18 * 4 + (int)local_14),acStack_40c,local_24);
            *(undefined *)(local_24 + *(int *)(local_18 * 4 + (int)local_14)) = 0;
            local_18 = local_18 + 1;
          }
          __pos = telldir(local_1c);
          seekdir(local_1c,__pos);
        }
      } while (local_20 != (dirent *)0x0);
      closedir(local_1c);
      FUN_000296d2((int)local_14,local_18);
      *param_2 = local_14;
    }
  }
  return local_18;
}



void FUN_0002968c(void *param_1)

{
  int local_c;
  
  if (param_1 != (void *)0x0) {
    for (local_c = 0; *(int *)(local_c * 4 + (int)param_1) != 0; local_c = local_c + 1) {
      free(*(void **)(local_c * 4 + (int)param_1));
    }
  }
  free(param_1);
  return;
}



void FUN_000296d2(int param_1,int param_2)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  int local_10;
  
  if (param_1 != 0) {
    do {
      bVar1 = false;
      for (local_10 = 0; local_10 < param_2 + -1; local_10 = local_10 + 1) {
        iVar2 = strcmp(*(char **)(local_10 * 4 + param_1),*(char **)((local_10 + 1) * 4 + param_1));
        if (0 < iVar2) {
          uVar3 = *(undefined4 *)(local_10 * 4 + param_1);
          *(undefined4 *)(local_10 * 4 + param_1) = *(undefined4 *)((local_10 + 1) * 4 + param_1);
          *(undefined4 *)((local_10 + 1) * 4 + param_1) = uVar3;
          bVar1 = true;
        }
      }
    } while (bVar1);
  }
  return;
}



undefined4 FUN_00029762(char *param_1,char *param_2)

{
  int __fd;
  undefined4 uVar1;
  
  __fd = FUN_00029932(param_1,param_2);
  if (__fd < 0) {
    uVar1 = 0xffffffff;
  }
  else {
    close(__fd);
    uVar1 = 0;
  }
  return uVar1;
}



// WARNING: Removing unreachable block (ram,0x000297ac)

ssize_t FUN_00029792(int param_1,char *param_2,uint *param_3,size_t param_4)

{
  int iVar1;
  uint uVar2;
  undefined auStack_a4 [136];
  ssize_t local_1c;
  int local_18;
  uint *local_14;
  uint *local_10;
  int local_c;
  
  local_18 = (int)(*(ushort *)(param_2 + 8) + 7) >> 3;
  local_1c = read(param_1,param_3,param_4);
  if ((0 < local_1c) && (*param_2 == '\x05')) {
    if (local_18 == 2) {
      if (DAT_00085abc != '\0') {
        local_10 = param_3;
        for (local_c = 0; local_c < local_1c; local_c = local_c + 2) {
          *(ushort *)local_10 = *(ushort *)local_10 >> 8 | *(ushort *)local_10 << 8;
          local_10 = (uint *)((int)local_10 + 2);
        }
      }
    }
    else if (local_18 == 4) {
      if (DAT_00085abc != '\0') {
        local_14 = param_3;
        for (local_c = 0; local_c < local_1c; local_c = local_c + 4) {
          uVar2 = *local_14;
          *local_14 = uVar2 >> 0x18 | uVar2 >> 8 & 0xff00 | (uVar2 & 0xff00) << 8 | uVar2 << 0x18;
          local_14 = local_14 + 1;
        }
      }
    }
    else if ((local_18 != 1) &&
            (iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                       "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                       ,"app_wav_read_data",0x9c), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_a4,"Sample size is not supported (%d)",local_18);
    }
  }
  return local_1c;
}



// WARNING: Removing unreachable block (ram,0x0002a13e)
// WARNING: Removing unreachable block (ram,0x00029950)

int FUN_00029932(char *param_1,char *param_2)

{
  int iVar1;
  int *piVar2;
  __off_t _Var3;
  __off_t extraout_r1;
  __off_t extraout_r1_00;
  int extraout_r1_01;
  undefined auStack_154 [128];
  size_t local_d4;
  stat sStack_d0;
  undefined local_68;
  undefined local_67;
  undefined local_66;
  undefined local_65;
  undefined local_64;
  undefined local_63;
  undefined local_62;
  undefined local_61;
  undefined local_60;
  undefined local_5f;
  char local_5e;
  undefined local_5d;
  undefined local_5c;
  undefined local_5b;
  undefined local_5a;
  undefined local_59;
  undefined local_58;
  undefined local_57;
  undefined local_56;
  undefined local_55;
  undefined local_54;
  undefined local_53;
  undefined local_52;
  undefined local_51;
  undefined auStack_38 [4];
  undefined local_34;
  undefined local_33;
  undefined local_32;
  undefined local_31;
  undefined auStack_30 [4];
  size_t local_2c;
  __blksize_t local_28;
  __blkcnt_t _Stack_24;
  int local_1c;
  ushort local_16;
  int local_14;
  
  local_d4 = 1;
  if (param_2 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                              ,"app_wav_open_file",0xc2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_154,"format is NULL");
    }
  }
  else if (param_1 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                              ,"app_wav_open_file",199);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_154,"no filename");
    }
  }
  else {
    local_1c = open(param_1,0);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                ,"app_wav_open_file",0xcc);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        duss_log_print(0x5c,1,auStack_154,"open(%s) failed: %d",param_1,*piVar2);
      }
    }
    else {
      iVar1 = fstat(local_1c,&sStack_d0);
      if (iVar1 < 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                  ,"app_wav_open_file",0xd1);
        if (iVar1 != 0) {
          piVar2 = __errno_location();
          duss_log_print(0x5c,1,auStack_154,"stat(%s) failed: %d",param_1,*piVar2);
        }
      }
      else {
        local_28 = sStack_d0.st_blksize;
        _Stack_24 = sStack_d0.st_blocks;
        local_2c = read(local_1c,auStack_38,0xc);
        if ((int)local_2c < 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                    ,"app_wav_open_file",0xdb);
          if (iVar1 != 0) {
            piVar2 = __errno_location();
            duss_log_print(0x5c,1,auStack_154,"read(%s) failed: %d",param_1,*piVar2);
          }
        }
        else if (local_2c == 0xc) {
          iVar1 = memcmp(auStack_38,&DAT_00063968,4);
          if (iVar1 == 0) {
            local_d4 = CONCAT13(local_31,CONCAT12(local_32,CONCAT11(local_33,local_34)));
            iVar1 = memcmp(auStack_30,&DAT_00063980,4);
            if (iVar1 == 0) {
              local_14 = 0xc;
              *(undefined4 *)(param_2 + 4) = 0;
              do {
                local_2c = read(local_1c,&local_68,8);
                if ((int)local_2c < 0) {
                  iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                            ,"app_wav_open_file",0x10c);
                  if (iVar1 != 0) {
                    piVar2 = __errno_location();
                    duss_log_print(0x5c,1,auStack_154,"read(%s) failed: %d",param_1,*piVar2);
                  }
                  goto LAB_0002a542;
                }
                if (local_2c != 8) {
                  iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                            ,"app_wav_open_file",0x111);
                  if (iVar1 != 0) {
                    duss_log_print(0x5c,1,auStack_154,"Length read does not match header (%d != %d)"
                                   ,local_2c,8);
                  }
                  goto LAB_0002a542;
                }
                local_d4 = CONCAT13(local_61,CONCAT12(local_62,CONCAT11(local_63,local_64)));
                local_14 = local_14 + local_d4 + 8;
                iVar1 = memcmp(&local_68,&DAT_000639c8,4);
                if (iVar1 == 0) {
                  if (((local_d4 != 0x10) && (local_d4 != 0x12)) && (local_d4 != 0x28))
                  goto LAB_0002a542;
                  local_2c = read(local_1c,&local_60,local_d4);
                  if ((int)local_2c < 0) {
                    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                              ,"app_wav_open_file",0x12a);
                    if (iVar1 != 0) {
                      piVar2 = __errno_location();
                      duss_log_print(0x5c,1,auStack_154,"read(%s) failed: %d",param_1,*piVar2);
                    }
                    goto LAB_0002a542;
                  }
                  if (local_2c != local_d4) {
                    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                              ,"app_wav_open_file",0x12f);
                    if (iVar1 != 0) {
                      duss_log_print(0x5c,1,auStack_154,
                                     "Length read does not match FMT params (%d != %d)",local_2c,
                                     local_d4);
                    }
                    goto LAB_0002a542;
                  }
                  local_16 = CONCAT11(local_5f,local_60);
                  if (local_16 == 1) {
                    *param_2 = '\x05';
                  }
                  else {
                    if (local_16 != 0x25) {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                ,"app_wav_open_file",0x142);
                      if (iVar1 != 0) {
                        duss_log_print(0x5c,1,auStack_154,"WAV audio format is not supported (%u)",
                                       local_16);
                      }
                      goto LAB_0002a542;
                    }
                    *param_2 = '\x06';
                  }
                  local_16 = CONCAT11(local_5d,local_5e);
                  if (*param_2 == '\x06') {
                    if (3 < local_16) {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                ,"app_wav_open_file",0x14f);
                      if (iVar1 != 0) {
                        duss_log_print(0x5c,1,auStack_154,
                                       "number of channels not supported in apt-X (%u)",local_16);
                      }
                      goto LAB_0002a542;
                    }
                    if (1 < local_16) {
                      param_2[2] = local_5e;
                      local_16 = 2;
                    }
                  }
                  else if (2 < local_16) {
                    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                              ,"app_wav_open_file",0x15a);
                    if (iVar1 != 0) {
                      duss_log_print(0x5c,1,auStack_154,"bad number of channels not supported (%u)",
                                     local_16);
                    }
                    goto LAB_0002a542;
                  }
                  param_2[1] = (char)local_16;
                  *(uint *)(param_2 + 4) =
                       CONCAT13(local_59,CONCAT12(local_5a,CONCAT11(local_5b,local_5c)));
                  *(ushort *)(param_2 + 8) = CONCAT11(local_51,local_52);
                  local_d4 = CONCAT13(local_55,CONCAT12(local_56,CONCAT11(local_57,local_58)));
                  local_16 = CONCAT11(local_53,local_54);
                  if ((uint)local_16 !=
                      (int)((uint)*(ushort *)(param_2 + 8) * (uint)(byte)param_2[1]) >> 3) {
                    iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                              ,"app_wav_open_file",0x17e);
                    if (iVar1 != 0) {
                      duss_log_print(0x5c,1,auStack_154,
                                     "Block alignment does not match calculation (%u != (%u * %u / 8))"
                                     ,local_16,param_2[1],*(undefined2 *)(param_2 + 8));
                    }
                    goto LAB_0002a542;
                  }
                }
                else {
                  iVar1 = memcmp(&local_68,&DAT_00063acc,4);
                  if (iVar1 == 0) {
                    if (8 < local_d4) {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                ,"app_wav_open_file",0x186);
                      if (iVar1 != 0) {
                        duss_log_print(0x5c,1,auStack_154,"FACT chunk size is not supported (%d)",
                                       local_d4);
                      }
                      goto LAB_0002a542;
                    }
                    local_2c = read(local_1c,&local_68,local_d4);
                    if ((int)local_2c < 0) {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                ,"app_wav_open_file",0x18e);
                      if (iVar1 != 0) {
                        piVar2 = __errno_location();
                        duss_log_print(0x5c,1,auStack_154,"read(%s) failed: %d",param_1,*piVar2);
                      }
                      goto LAB_0002a542;
                    }
                    if (local_2c != local_d4) {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                ,"app_wav_open_file",0x193);
                      if (iVar1 != 0) {
                        duss_log_print(0x5c,1,auStack_154,
                                       "Length read does not match FACT chunk (%d != %d)",local_2c,8
                                      );
                      }
                      goto LAB_0002a542;
                    }
                  }
                  else {
                    iVar1 = memcmp(&local_68,&DAT_00063b30,4);
                    _Var3 = extraout_r1;
                    if ((iVar1 == 0) ||
                       (iVar1 = memcmp(&local_68,&DAT_00063b38,4), _Var3 = extraout_r1_00,
                       iVar1 == 0)) {
                      _Var3 = lseek(local_1c,_Var3,local_d4);
                      if (extraout_r1_01 == -1 && _Var3 == -1) {
                        iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                  ,"app_wav_open_file",0x19d);
                        if (iVar1 != 0) {
                          duss_log_print(0x5c,1,auStack_154,"Failed bypassing the LIST chunk (%lu)",
                                         local_d4);
                        }
                        goto LAB_0002a542;
                      }
                      if (local_2c != 8) {
                        iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                  ,"app_wav_open_file",0x1a2);
                        if (iVar1 != 0) {
                          duss_log_print(0x5c,1,auStack_154,
                                         "Length read does not match LIST chunk (%d != %d)",local_2c
                                         ,8);
                        }
                        goto LAB_0002a542;
                      }
                    }
                    else {
                      iVar1 = memcmp(&local_68,&DAT_00063b9c,4);
                      if (iVar1 != 0) {
                        iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                                  ,"app_wav_open_file",0x1b6);
                        if (iVar1 != 0) {
                          duss_log_print(0x5c,1,auStack_154,"unsupported chunk (%c%c%c%c)",local_68,
                                         local_67,local_66,local_65);
                        }
                        goto LAB_0002a542;
                      }
                      if ((local_d4 & 1) != 0) {
                        local_14 = local_14 + 1;
                      }
                    }
                  }
                }
                iVar1 = memcmp(&local_68,&DAT_00063b9c,4);
              } while (iVar1 != 0);
              if (*(int *)(param_2 + 4) != 0) {
                return local_1c;
              }
              iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                        ,"app_wav_open_file",0x1bd);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_154,"Format chunk was not found in WAV file");
              }
            }
            else {
              iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                        ,"app_wav_open_file",0xfb);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_154,"WAVE not found");
              }
            }
          }
          else {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                      ,"app_wav_open_file",0xe8);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_154,"RIFF not found");
            }
          }
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_154,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                    ,"app_wav_open_file",0xe1);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_154,"Length read does not match RIFF header (%d != %d)",
                           local_2c,0xc);
          }
        }
      }
LAB_0002a542:
      close(local_1c);
    }
  }
  return -1;
}



int FUN_0002a558(char *param_1,uint param_2)

{
  int iVar1;
  int *piVar2;
  undefined auStack_90 [132];
  int local_c;
  
  local_c = open(param_1,param_2 | 0x242,0x1b6);
  if (local_c < 0) {
    if ((param_2 & 0x80) == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                ,"app_wav_create_file",0x1e2);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        duss_log_print(0x5c,1,auStack_90,"open(%s) failed: %d",param_1,*piVar2);
      }
    }
  }
  else {
    write(local_c,&WAVE_00063814,0x2c);
  }
  return local_c;
}



void FUN_0002a604(int param_1,int param_2)

{
  int iVar1;
  __off_t extraout_r1;
  __off_t extraout_r1_00;
  __off_t __offset;
  undefined8 uVar2;
  undefined auStack_d0 [128];
  undefined4 local_50;
  int local_4c;
  undefined4 uStack_48;
  undefined4 uStack_44;
  undefined4 local_40;
  uint uStack_3c;
  undefined4 local_38;
  int local_34;
  undefined4 local_30;
  undefined4 uStack_2c;
  int local_28;
  ssize_t local_24;
  int local_20;
  ushort local_1a;
  int local_18;
  int local_14;
  
  if (param_1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_d0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                              ,"app_wav_close_file",0x204);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_d0,"Bad file descriptor");
    }
  }
  else {
    local_50 = 0x46464952;
    local_4c = 0;
    uStack_48 = 0x45564157;
    uStack_44 = 0x20746d66;
    local_40 = 0x10;
    uStack_3c = 1;
    local_38 = 0;
    local_34 = 0;
    local_30 = 0;
    uStack_2c = 0x61746164;
    local_28 = 0;
    local_14 = lseek(param_1,0x61746164,0);
    __offset = extraout_r1;
    if (local_14 < 0) {
      uVar2 = duss_log_gen_head(0x5c,1,auStack_d0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_wav.c"
                                ,"app_wav_close_file",0x20f);
      __offset = (__off_t)((ulonglong)uVar2 >> 0x20);
      if ((int)uVar2 != 0) {
        duss_log_print(0x5c,1,auStack_d0,"Read current pointer failed");
        __offset = extraout_r1_00;
      }
      local_14 = 0x2c;
    }
    local_28 = local_14 + -0x2c;
    local_4c = local_14 + -8;
    if (*(short *)(param_2 + 8) == 8) {
      local_18 = *(int *)(param_2 + 4) * (uint)*(byte *)(param_2 + 1);
      local_1a = (ushort)*(byte *)(param_2 + 1);
    }
    else {
      local_18 = *(int *)(param_2 + 4) * (uint)*(byte *)(param_2 + 1) * 2;
      local_1a = (ushort)*(byte *)(param_2 + 1) << 1;
    }
    uStack_3c = (uint)CONCAT12(*(undefined *)(param_2 + 1),(undefined2)uStack_3c);
    local_38 = CONCAT13((char)((uint)*(undefined4 *)(param_2 + 4) >> 0x18),
                        CONCAT12((char)((uint)*(undefined4 *)(param_2 + 4) >> 0x10),
                                 CONCAT11((char)((uint)*(undefined4 *)(param_2 + 4) >> 8),
                                          (char)*(undefined4 *)(param_2 + 4))));
    local_34 = local_18;
    local_30 = CONCAT13((char)((ushort)*(undefined2 *)(param_2 + 8) >> 8),
                        CONCAT12((char)*(undefined2 *)(param_2 + 8),local_1a));
    local_20 = local_4c;
    local_14 = local_28;
    lseek(param_1,__offset,0);
    local_24 = write(param_1,&local_50,0x2c);
    close(param_1);
  }
  return;
}



undefined4 FUN_0002a866(int param_1)

{
  undefined4 uVar1;
  
  if ((param_1 == 0x20) || (param_1 - 9U < 5)) {
    uVar1 = 1;
  }
  else {
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 FUN_0002a88e(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002b4a4("/tmp/EMMC/wireless/bluetooth/bt_config.xml",param_1);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_read_xml_config",0x3a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_read_cfg failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002a906(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002bdb2("/tmp/EMMC/wireless/bluetooth/bt_config.xml",param_1);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_write_xml_config",99);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_write_cfg failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002a97e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  memset(&DAT_000896e8,0,0x10e0);
  local_c = FUN_0002b742("/tmp/EMMC/wireless/bluetooth/bt_devices.xml",&DAT_000896e8,10);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_read_xml_remote_devices",0x8d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_read_db failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002aa0a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002c158("/tmp/EMMC/wireless/bluetooth/bt_devices.xml",&DAT_000896e8,10);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_write_xml_remote_devices",0xa8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_write_db failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002aac4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  memset(&DAT_00089698,0,0x50);
  local_c = FUN_0002ba7a("/tmp/EMMC/wireless/bluetooth/si_devices.xml",&DAT_00089698,10);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_read_xml_si_devices",0xde);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_read_si_db failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002ab4e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002ca86("/tmp/EMMC/wireless/bluetooth/si_devices.xml",&DAT_00089698,10);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_write_xml_si_devices",0xfc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_write_si_db failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002abc8(int param_1,char *param_2,char param_3)

{
  size_t __n;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (DAT_00085ac0 <= local_c) break;
    write(param_1,&DAT_00063e28,2);
    local_c = local_c + 1;
  }
  dprintf(param_1,"<");
  __n = strlen(param_2);
  write(param_1,param_2,__n);
  dprintf(param_1,">");
  if (param_3 == '\x01') {
    dprintf(param_1,"\n");
  }
  DAT_00085ac0 = DAT_00085ac0 + 1;
  return 0;
}



undefined4 FUN_0002ac68(int param_1,char *param_2,char param_3)

{
  size_t __n;
  int local_c;
  
  DAT_00085ac0 = DAT_00085ac0 + -1;
  if (param_3 != '\0') {
    local_c = 0;
    while( true ) {
      if (DAT_00085ac0 <= local_c) break;
      write(param_1,&DAT_00063e28,2);
      local_c = local_c + 1;
    }
  }
  dprintf(param_1,"</");
  __n = strlen(param_2);
  write(param_1,param_2,__n);
  dprintf(param_1,">\n");
  return 0;
}



undefined4 FUN_0002acfa(int param_1,undefined4 param_2,undefined4 param_3)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (DAT_00085ac0 <= local_c) break;
    write(param_1,&DAT_00063e28,2);
    local_c = local_c + 1;
  }
  dprintf(param_1,"<");
  dprintf(param_1,"%s value = \"%d\"",param_2,param_3);
  dprintf(param_1,">\n");
  DAT_00085ac0 = DAT_00085ac0 + 1;
  return 0;
}



undefined4 FUN_0002ad82(int param_1,undefined4 param_2,undefined4 param_3)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (DAT_00085ac0 <= local_c) break;
    write(param_1,&DAT_00063e28,2);
    local_c = local_c + 1;
  }
  dprintf(param_1,"<");
  dprintf(param_1,"%s value = \"%d\"",param_2,param_3);
  dprintf(param_1,"/>\n");
  return 0;
}



undefined4 FUN_0002adf4(int param_1,int param_2,uint param_3,char param_4)

{
  uint local_c;
  
  for (local_c = 0; local_c < param_3; local_c = local_c + 1) {
    dprintf(param_1,"%02X",(uint)*(byte *)(local_c + param_2));
    if ((local_c & 0x1f) == 0x1f) {
      write(param_1,&DAT_00063e34,1);
    }
    else if (param_3 - 1 != local_c) {
      write(param_1,&DAT_00063e5c,1);
    }
  }
  if ((param_4 != '\0') && ((param_3 & 0x1f) != 0)) {
    write(param_1,&DAT_00063e34,1);
  }
  return 0;
}



void * FUN_0002ae98(size_t *param_1,int param_2,uint param_3)

{
  int iVar1;
  undefined auStack_a0 [128];
  char *local_20;
  uint local_1c;
  size_t local_18;
  int local_14;
  char *local_10;
  char *local_c;
  
  local_18 = 0x400;
  *param_1 = 0;
  local_10 = (char *)malloc(0x400);
  local_c = local_10;
  if (local_10 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_xml_read_data",0x1e3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a0,"Failed allocating buffer");
    }
    local_20 = (char *)0x0;
  }
  else {
    local_14 = 0;
    *local_10 = '\0';
    for (local_1c = 0; local_1c < param_3; local_1c = local_1c + 1) {
      if ((*(char *)(local_1c + param_2) == ':') ||
         ((local_14 != 0 &&
          ((*(char *)(local_1c + param_2) == '\n' ||
           (iVar1 = FUN_0002a866((uint)*(byte *)(local_1c + param_2)), iVar1 != 0)))))) {
        local_10 = local_10 + 1;
        if ((int)local_10 - (int)local_c == local_18) {
          local_18 = local_18 + 0x400;
          local_20 = (char *)realloc(local_c,local_18);
          if (local_20 == (char *)0x0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                                      ,"app_xml_read_data",0x1fc);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_a0,"Failed reallocating buffer");
            }
            free(local_c);
            return (void *)0x0;
          }
          local_10 = local_20 + ((int)local_10 - (int)local_c);
          local_c = local_20;
        }
        local_14 = 0;
        *local_10 = '\0';
      }
      else {
        iVar1 = isxdigit((uint)*(byte *)(local_1c + param_2));
        if (iVar1 == 0) {
          iVar1 = FUN_0002a866((uint)*(byte *)(local_1c + param_2));
          if ((iVar1 == 0) &&
             (iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                                        ,"app_xml_read_data",0x21d), iVar1 != 0)) {
            duss_log_print(0x5c,1,auStack_a0,"Unsupported character in data : x%x",
                           *(undefined *)(local_1c + param_2));
          }
        }
        else {
          *local_10 = *local_10 << 4;
          if (*(byte *)(local_1c + param_2) < 0x3a) {
            *local_10 = *(char *)(local_1c + param_2) + *local_10 + -0x30;
          }
          else if (*(byte *)(local_1c + param_2) < 0x47) {
            *local_10 = *(char *)(local_1c + param_2) + *local_10 + -0x37;
          }
          else {
            *local_10 = *(char *)(local_1c + param_2) + *local_10 + -0x57;
          }
          local_14 = 1;
        }
      }
    }
    if (local_14 != 0) {
      local_10 = local_10 + 1;
    }
    *param_1 = (int)local_10 - (int)local_c;
    if (*param_1 == 0) {
      free(local_c);
      local_20 = (char *)0x0;
    }
    else {
      local_20 = (char *)realloc(local_c,*param_1);
      if (local_20 == (char *)0x0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                                  ,"app_xml_read_data",0x235);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a0,"Failed resizing buffer");
        }
        *param_1 = 0;
        free(local_c);
        local_20 = (char *)0x0;
      }
    }
  }
  return local_20;
}



undefined FUN_0002b1f8(void *param_1,size_t param_2,int param_3,uint param_4)

{
  size_t local_14;
  void *local_10;
  undefined local_9;
  
  local_9 = 0;
  local_10 = FUN_0002ae98(&local_14,param_3,param_4);
  if (local_14 == param_2) {
    memcpy(param_1,local_10,param_2);
    local_9 = 1;
  }
  free(local_10);
  return local_9;
}



undefined4 FUN_0002b240(void *param_1,int param_2,void *param_3,size_t param_4)

{
  if ((int)(param_2 - 1U) <= (int)param_4) {
    param_4 = param_2 - 1U;
  }
  memcpy(param_1,param_3,param_4);
  *(undefined *)(param_4 + (int)param_1) = 0;
  return 0;
}



ulong FUN_0002b280(char *param_1,int param_2)

{
  int iVar1;
  undefined auStack_90 [128];
  char *local_10;
  ulong local_c;
  
  local_c = strtoul(param_1,&local_10,0);
  if ((int)local_10 - (int)param_1 != param_2) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_utils.c"
                              ,"app_xml_read_value",0x291);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Value parsed did not use all buffer (%s)",param_1);
    }
  }
  return local_c;
}



undefined4 FUN_0002b300(undefined4 param_1,void *param_2)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (9 < local_c) {
      return 0xffffffff;
    }
    if (((&DAT_000896e8)[local_c * 0x1b0] == '\x01') &&
       (iVar1 = bdcmp(param_1,&DAT_000896e9 + local_c * 0x1b0), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  memcpy(param_2,&DAT_000897e8 + local_c * 0x1b0,3);
  return 0;
}



undefined4
FUN_0002b38c(__start_routine *param_1,undefined4 param_2,undefined4 param_3,pthread_t *param_4)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined auStack_ac [128];
  pthread_attr_t pStack_2c;
  
  pthread_attr_init(&pStack_2c);
  pthread_attr_setdetachstate(&pStack_2c,1);
  iVar1 = pthread_create(param_4,&pStack_2c,param_1,(void *)0x0);
  if (iVar1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_thread.c"
                              ,"app_create_thread",0x32);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_ac,"pthread_create failed:%d",*piVar2);
    }
    uVar3 = 0xffffffff;
  }
  else {
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_0002b420(pthread_t param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined auStack_88 [128];
  
  if ((param_1 == 0) || (iVar1 = pthread_cancel(param_1), -1 < iVar1)) {
    uVar3 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_thread.c"
                              ,"app_stop_thread",0x48);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_88,"pthread_cancel failed:%d",*piVar2);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_0002b494(void)

{
  return 0;
}



undefined4 FUN_0002b4a4(char *param_1,undefined4 param_2)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_b8 [128];
  char *local_38;
  undefined4 local_34;
  undefined *local_30;
  undefined *local_2c;
  undefined4 local_28;
  undefined *local_24;
  undefined **local_20;
  uint local_1c;
  size_t local_18;
  char *local_14;
  size_t local_10;
  int local_c;
  
  local_38 = (char *)0x0;
  local_c = open(param_1,0);
  if (local_c < 0) {
    uVar3 = 0xffffffff;
  }
  else {
    local_10 = FUN_0002f63a(local_c);
    if ((int)local_10 < 1) {
      close(local_c);
      uVar3 = 0xffffffff;
    }
    else {
      local_14 = (char *)malloc(local_10 + 1);
      if (local_14 == (char *)0x0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_read_cfg",0x108);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_b8,"cannot alloc:%d bytes",local_10);
        }
        close(local_c);
        uVar3 = 0xffffffff;
      }
      else {
        local_18 = read(local_c,local_14,local_10);
        local_14[local_10] = '\0';
        close(local_c);
        if (local_18 == local_10) {
          local_34 = 0x2cc21;
          local_30 = &LAB_0002cde2_1;
          local_2c = &LAB_0002cdfa_1;
          local_28 = 0x2ce15;
          local_24 = &LAB_0002d0a8_1;
          bVar1 = FUN_0002fa16(&local_20,&local_34);
          local_1c = (uint)bVar1;
          if (local_1c == 0) {
            free(local_14);
            iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                      ,"app_xml_read_cfg",0x128);
            if (iVar2 != 0) {
              duss_log_print(0x5c,1,auStack_b8,"cannot xml :%d",local_1c);
            }
            uVar3 = 0xffffffff;
          }
          else {
            DAT_0008a7dc = param_2;
            local_1c = FUN_0002fb2c(local_20,local_14,local_10,&local_38);
            if (local_1c == 1) {
              free(local_14);
              FUN_0002fa7e(local_20);
              uVar3 = 0;
            }
            else {
              free(local_14);
              iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                        ,"app_xml_read_cfg",0x133);
              if (iVar2 != 0) {
                duss_log_print(0x5c,1,auStack_b8,"xmlWrite returns :%d",local_1c);
              }
              uVar3 = 0xffffffff;
            }
          }
        }
        else {
          free(local_14);
          iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                    ,"app_xml_read_cfg",0x115);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_b8,"not able to read complete file:%d/%d",local_18,
                           local_10);
          }
          uVar3 = 0xffffffff;
        }
      }
    }
  }
  return uVar3;
}



undefined4 FUN_0002b742(char *param_1,undefined4 param_2,undefined4 param_3)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_b8 [128];
  char *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined *local_24;
  undefined **local_20;
  uint local_1c;
  size_t local_18;
  char *local_14;
  size_t local_10;
  int local_c;
  
  local_38 = (char *)0x0;
  local_c = open(param_1,0);
  if (local_c < 0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_read_db",0x175);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"open(%s) failed",param_1);
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_10 = FUN_0002f63a(local_c);
    if ((int)local_10 < 1) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                ,"app_xml_read_db",0x159);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_b8,"app_fs_file_size(%s) failed",param_1);
      }
      close(local_c);
      uVar3 = 0xffffffff;
    }
    else {
      local_14 = (char *)malloc(local_10 + 1);
      if (local_14 == (char *)0x0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_read_db",0x161);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_b8,"cannot alloc:%d bytes",local_10);
        }
        close(local_c);
        uVar3 = 0xffffffff;
      }
      else {
        local_18 = read(local_c,local_14,local_10);
        local_14[local_10] = '\0';
        close(local_c);
        if (local_18 == local_10) {
          local_34 = 0x2d0c1;
          local_30 = 0x2d5bf;
          local_2c = 0x2d5f5;
          local_28 = 0x2d6df;
          local_24 = &LAB_0002de8a_1;
          bVar1 = FUN_0002fa16(&local_20,&local_34);
          local_1c = (uint)bVar1;
          if (local_1c == 0) {
            free(local_14);
            iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                      ,"app_xml_read_db",0x183);
            if (iVar2 != 0) {
              duss_log_print(0x5c,1,auStack_b8,"xmlOpen failed: %d",local_1c);
            }
            uVar3 = 0xffffffff;
          }
          else {
            DAT_0008a7e0 = param_2;
            DAT_0008a7e8 = param_3;
            local_1c = FUN_0002fb2c(local_20,local_14,local_10,&local_38);
            if (local_1c == 1) {
              FUN_0002fa7e(local_20);
              free(local_14);
              uVar3 = 0;
            }
            else {
              free(local_14);
              iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                        ,"app_xml_read_db",399);
              if (iVar2 != 0) {
                duss_log_print(0x5c,1,auStack_b8,"xmlWrite failed: %d",local_1c);
              }
              uVar3 = 0xffffffff;
            }
          }
        }
        else {
          free(local_14);
          iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                    ,"app_xml_read_db",0x16f);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_b8,"not able to read complete file: %d/%d",local_18,
                           local_10);
          }
          uVar3 = 0xffffffff;
        }
      }
    }
  }
  return uVar3;
}



undefined4 FUN_0002ba7a(char *param_1,undefined4 param_2,undefined4 param_3)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_b8 [128];
  char *local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined *local_24;
  undefined **local_20;
  uint local_1c;
  size_t local_18;
  char *local_14;
  size_t local_10;
  int local_c;
  
  local_38 = (char *)0x0;
  local_c = open(param_1,0);
  if (local_c < 0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_read_si_db",0x1d1);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"open(%s) failed",param_1);
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_10 = FUN_0002f63a(local_c);
    if ((int)local_10 < 1) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                ,"app_xml_read_si_db",0x1b5);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_b8,"app_fs_file_size(%s) failed",param_1);
      }
      close(local_c);
      uVar3 = 0xffffffff;
    }
    else {
      local_14 = (char *)malloc(local_10 + 1);
      if (local_14 == (char *)0x0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_read_si_db",0x1bd);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_b8,"cannot alloc:%d bytes",local_10);
        }
        close(local_c);
        uVar3 = 0xffffffff;
      }
      else {
        local_18 = read(local_c,local_14,local_10);
        local_14[local_10] = '\0';
        close(local_c);
        if (local_18 == local_10) {
          local_34 = 0x2dea3;
          local_30 = 0x2defd;
          local_2c = 0x2df33;
          local_28 = 0x2e01d;
          local_24 = &LAB_0002e126_1;
          bVar1 = FUN_0002fa16(&local_20,&local_34);
          local_1c = (uint)bVar1;
          if (local_1c == 0) {
            free(local_14);
            iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                      ,"app_xml_read_si_db",0x1df);
            if (iVar2 != 0) {
              duss_log_print(0x5c,1,auStack_b8,"xmlOpen failed: %d",local_1c);
            }
            uVar3 = 0xffffffff;
          }
          else {
            DAT_0008a7e4 = param_2;
            DAT_0008a7ec = param_3;
            local_1c = FUN_0002fb2c(local_20,local_14,local_10,&local_38);
            if (local_1c == 1) {
              FUN_0002fa7e(local_20);
              free(local_14);
              uVar3 = 0;
            }
            else {
              free(local_14);
              iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                        ,"app_xml_read_si_db",0x1eb);
              if (iVar2 != 0) {
                duss_log_print(0x5c,1,auStack_b8,"xmlWrite failed: %d",local_1c);
              }
              uVar3 = 0xffffffff;
            }
          }
        }
        else {
          free(local_14);
          iVar2 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                    ,"app_xml_read_si_db",0x1cb);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_b8,"not able to read complete file: %d/%d",local_18,
                           local_10);
          }
          uVar3 = 0xffffffff;
        }
      }
    }
  }
  return uVar3;
}



undefined4 FUN_0002bdb2(char *param_1,byte *param_2)

{
  int iVar1;
  size_t sVar2;
  undefined4 uVar3;
  undefined auStack_98 [128];
  ssize_t local_18;
  int local_14;
  
  local_14 = open(param_1,0x42,0x1b6);
  if (local_14 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_write_cfg",0x205);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"Error opening/creating %s file",param_1);
    }
    uVar3 = 0xffffffff;
  }
  else {
    FUN_0002abc8(local_14,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    FUN_0002abc8(local_14,"bt_config",'\x01');
    FUN_0002abc8(local_14,"enable",'\0');
    dprintf(local_14,"%d",(uint)*param_2);
    FUN_0002ac68(local_14,"enable",'\0');
    FUN_0002abc8(local_14,"visible",'\0');
    dprintf(local_14,"%d",(uint)param_2[1]);
    FUN_0002ac68(local_14,"visible",'\0');
    FUN_0002abc8(local_14,"connectable",'\0');
    dprintf(local_14,"%d",(uint)param_2[2]);
    FUN_0002ac68(local_14,"connectable",'\0');
    FUN_0002abc8(local_14,"local_name",'\0');
    sVar2 = strlen((char *)(param_2 + 9));
    local_18 = write(local_14,param_2 + 9,sVar2);
    FUN_0002ac68(local_14,"local_name",'\0');
    FUN_0002abc8(local_14,"bd_addr",'\0');
    FUN_0002adf4(local_14,(int)(param_2 + 3),6,'\0');
    FUN_0002ac68(local_14,"bd_addr",'\0');
    FUN_0002abc8(local_14,"class_of_device",'\0');
    FUN_0002adf4(local_14,(int)(param_2 + 0x102),3,'\0');
    FUN_0002ac68(local_14,"class_of_device",'\0');
    FUN_0002abc8(local_14,"pin_code",'\0');
    sVar2 = strlen((char *)(param_2 + 0x2f9));
    local_18 = write(local_14,param_2 + 0x2f9,sVar2);
    FUN_0002ac68(local_14,"pin_code",'\0');
    FUN_0002abc8(local_14,"pin_len",'\0');
    dprintf(local_14,"%d",(uint)param_2[0x309]);
    FUN_0002ac68(local_14,"pin_len",'\0');
    FUN_0002abc8(local_14,"io_capabilities",'\0');
    dprintf(local_14,"%d",(uint)param_2[0x30a]);
    FUN_0002ac68(local_14,"io_capabilities",'\0');
    FUN_0002abc8(local_14,"auth",'\0');
    dprintf(local_14,"%d",(uint)param_2[0x30b]);
    FUN_0002ac68(local_14,"auth",'\0');
    FUN_0002abc8(local_14,"le_auth",'\0');
    dprintf(local_14,"%d",(uint)param_2[0x30c]);
    FUN_0002ac68(local_14,"le_auth",'\0');
    FUN_0002abc8(local_14,"root_path",'\0');
    sVar2 = strlen((char *)(param_2 + 0x105));
    local_18 = write(local_14,param_2 + 0x105,sVar2);
    FUN_0002ac68(local_14,"root_path",'\0');
    FUN_0002ac68(local_14,"bt_config",'\x01');
    FUN_0002ac68(local_14,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    close(local_14);
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_0002c158(char *param_1,char *param_2,int param_3)

{
  int iVar1;
  size_t __n;
  undefined4 uVar2;
  char *local_a8;
  undefined auStack_a0 [128];
  ssize_t local_20;
  int local_1c;
  int local_18;
  int local_14;
  
  local_1c = open(param_1,0x241,0x1b6);
  if (local_1c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_write_db",0x25b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a0,"Error opening/creating %s file",param_1);
    }
    uVar2 = 0xffffffff;
  }
  else {
    FUN_0002abc8(local_1c,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    FUN_0002abc8(local_1c,"bt_devices",'\x01');
    local_18 = 0;
    local_a8 = param_2;
    for (local_14 = 0; local_14 < param_3; local_14 = local_14 + 1) {
      if (*local_a8 != '\0') {
        FUN_0002acfa(local_1c,"device",local_18);
        FUN_0002abc8(local_1c,"bd_addr",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 1),6,'\0');
        FUN_0002ac68(local_1c,"bd_addr",'\0');
        FUN_0002abc8(local_1c,"device_name",'\0');
        __n = strlen(local_a8 + 7);
        local_20 = write(local_1c,local_a8 + 7,__n);
        FUN_0002ac68(local_1c,"device_name",'\0');
        FUN_0002abc8(local_1c,"class_of_device",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x100),3,'\0');
        FUN_0002ac68(local_1c,"class_of_device",'\0');
        FUN_0002abc8(local_1c,"link_key",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x10f),0x10,'\0');
        FUN_0002ac68(local_1c,"link_key",'\0');
        FUN_0002abc8(local_1c,"Link_key_present",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x10e]);
        FUN_0002ac68(local_1c,"Link_key_present",'\0');
        FUN_0002abc8(local_1c,"key_type",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x11f]);
        FUN_0002ac68(local_1c,"key_type",'\0');
        FUN_0002abc8(local_1c,"trusted_services",'\0');
        dprintf(local_1c,"0x%08X",*(undefined4 *)(local_a8 + 0x108));
        FUN_0002ac68(local_1c,"trusted_services",'\0');
        FUN_0002abc8(local_1c,"vid",'\0');
        dprintf(local_1c,"0x%04X",(uint)*(ushort *)(local_a8 + 0x124));
        FUN_0002ac68(local_1c,"vid",'\0');
        FUN_0002abc8(local_1c,"pid",'\0');
        dprintf(local_1c,"0x%04X",(uint)*(ushort *)(local_a8 + 0x122));
        FUN_0002ac68(local_1c,"pid",'\0');
        FUN_0002abc8(local_1c,"version",'\0');
        dprintf(local_1c,"0x%04X",(uint)*(ushort *)(local_a8 + 0x126));
        FUN_0002ac68(local_1c,"version",'\0');
        FUN_0002abc8(local_1c,"features",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x128),8,'\0');
        FUN_0002ac68(local_1c,"features",'\0');
        FUN_0002abc8(local_1c,"lmp_version",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x130]);
        FUN_0002ac68(local_1c,"lmp_version",'\0');
        FUN_0002abc8(local_1c,"ble_addr_type",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x131]);
        FUN_0002ac68(local_1c,"ble_addr_type",'\0');
        FUN_0002abc8(local_1c,"device_type",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x132]);
        FUN_0002ac68(local_1c,"device_type",'\0');
        FUN_0002abc8(local_1c,"inq_result_type",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x133]);
        FUN_0002ac68(local_1c,"inq_result_type",'\0');
        FUN_0002abc8(local_1c,"ble_Link_key_present",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x134]);
        FUN_0002ac68(local_1c,"ble_Link_key_present",'\0');
        FUN_0002abc8(local_1c,"penc_ltk",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x135),0x10,'\0');
        FUN_0002ac68(local_1c,"penc_ltk",'\0');
        FUN_0002abc8(local_1c,"penc_rand",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x145),8,'\0');
        FUN_0002ac68(local_1c,"penc_rand",'\0');
        FUN_0002abc8(local_1c,"penc_ediv",'\0');
        dprintf(local_1c,"%d",(uint)*(ushort *)(local_a8 + 0x14e));
        FUN_0002ac68(local_1c,"penc_ediv",'\0');
        FUN_0002abc8(local_1c,"penc_sec_level",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x150]);
        FUN_0002ac68(local_1c,"penc_sec_level",'\0');
        FUN_0002abc8(local_1c,"penc_key_size",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x151]);
        FUN_0002ac68(local_1c,"penc_key_size",'\0');
        FUN_0002abc8(local_1c,"prid_irk",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x152),0x10,'\0');
        FUN_0002ac68(local_1c,"prid_irk",'\0');
        FUN_0002abc8(local_1c,"prid_addr_type",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x162]);
        FUN_0002ac68(local_1c,"prid_addr_type",'\0');
        FUN_0002abc8(local_1c,"prid_static_addr",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x163),6,'\0');
        FUN_0002ac68(local_1c,"prid_static_addr",'\0');
        FUN_0002abc8(local_1c,"pcsrk_counter",'\0');
        dprintf(local_1c,"%d",*(undefined4 *)(local_a8 + 0x16c));
        FUN_0002ac68(local_1c,"pcsrk_counter",'\0');
        FUN_0002abc8(local_1c,"pcsrk_csrk",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x170),0x10,'\0');
        FUN_0002ac68(local_1c,"pcsrk_csrk",'\0');
        FUN_0002abc8(local_1c,"pcsrk_sec_level",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x180]);
        FUN_0002ac68(local_1c,"pcsrk_sec_level",'\0');
        FUN_0002abc8(local_1c,"lcsrk_counter",'\0');
        dprintf(local_1c,"%d",*(undefined4 *)(local_a8 + 0x184));
        FUN_0002ac68(local_1c,"lcsrk_counter",'\0');
        FUN_0002abc8(local_1c,"lcsrk_csrk",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x188),0x10,'\0');
        FUN_0002ac68(local_1c,"lcsrk_csrk",'\0');
        FUN_0002abc8(local_1c,"lcsrk_dis",'\0');
        dprintf(local_1c,"%d",(uint)*(ushort *)(local_a8 + 0x198));
        FUN_0002ac68(local_1c,"lcsrk_dis",'\0');
        FUN_0002abc8(local_1c,"lcsrk_sec_level",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x19a]);
        FUN_0002ac68(local_1c,"lcsrk_sec_level",'\0');
        FUN_0002abc8(local_1c,"lenc_ltk",'\0');
        FUN_0002adf4(local_1c,(int)(local_a8 + 0x19b),0x10,'\0');
        FUN_0002ac68(local_1c,"lenc_ltk",'\0');
        FUN_0002abc8(local_1c,"lenc_div",'\0');
        dprintf(local_1c,"%d",(uint)*(ushort *)(local_a8 + 0x1ac));
        FUN_0002ac68(local_1c,"lenc_div",'\0');
        FUN_0002abc8(local_1c,"lenc_key_size",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x1ae]);
        FUN_0002ac68(local_1c,"lenc_key_size",'\0');
        FUN_0002abc8(local_1c,"lenc_sec_level",'\0');
        dprintf(local_1c,"%d",(uint)(byte)local_a8[0x1af]);
        FUN_0002ac68(local_1c,"lenc_sec_level",'\0');
        FUN_0002ac68(local_1c,"device",'\x01');
        local_18 = local_18 + 1;
      }
      local_a8 = local_a8 + 0x1b0;
    }
    FUN_0002ac68(local_1c,"bt_devices",'\x01');
    FUN_0002ac68(local_1c,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    close(local_1c);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002ca86(char *param_1,char *param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  char *local_a0;
  undefined auStack_94 [128];
  int local_14;
  int local_10;
  int local_c;
  
  local_14 = open(param_1,0x241,0x1b6);
  if (local_14 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_write_si_db",0x31c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Error opening/creating %s file",param_1);
    }
    uVar2 = 0xffffffff;
  }
  else {
    FUN_0002abc8(local_14,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    FUN_0002abc8(local_14,"si_devices",'\x01');
    local_10 = 0;
    local_a0 = param_2;
    for (local_c = 0; local_c < param_3; local_c = local_c + 1) {
      if (*local_a0 != '\0') {
        FUN_0002acfa(local_14,"device",local_10);
        FUN_0002abc8(local_14,"bd_addr",'\0');
        FUN_0002adf4(local_14,(int)(local_a0 + 1),6,'\0');
        FUN_0002ac68(local_14,"bd_addr",'\0');
        FUN_0002abc8(local_14,"platform",'\0');
        dprintf(local_14,"%d",(uint)(byte)local_a0[7]);
        FUN_0002ac68(local_14,"platform",'\0');
        FUN_0002ac68(local_14,"device",'\x01');
        local_10 = local_10 + 1;
      }
      local_a0 = local_a0 + 8;
    }
    FUN_0002ac68(local_14,"si_devices",'\x01');
    FUN_0002ac68(local_14,"X_CYPRESS_COM_BluetoothAdapter",'\x01');
    close(local_14);
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_0002cc20(undefined4 param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = strncmp(param_2,"enable",6);
  if (iVar1 == 0) {
    DAT_0008a7c8 = 0;
  }
  else {
    iVar1 = strncmp(param_2,"visible",7);
    if (iVar1 == 0) {
      DAT_0008a7c8 = 1;
    }
    else {
      iVar1 = strncmp(param_2,"connectable",0xb);
      if (iVar1 == 0) {
        DAT_0008a7c8 = 2;
      }
      else {
        iVar1 = strncmp(param_2,"local_name",10);
        if (iVar1 == 0) {
          DAT_0008a7c8 = 3;
        }
        else {
          iVar1 = strncmp(param_2,"bd_addr",7);
          if (iVar1 == 0) {
            DAT_0008a7c8 = 5;
          }
          else {
            iVar1 = strncmp(param_2,"class_of_device",0xf);
            if (iVar1 == 0) {
              DAT_0008a7c8 = 4;
            }
            else {
              iVar1 = strncmp(param_2,"pin_code",8);
              if (iVar1 == 0) {
                DAT_0008a7c8 = 6;
              }
              else {
                iVar1 = strncmp(param_2,"pin_len",7);
                if (iVar1 == 0) {
                  DAT_0008a7c8 = 7;
                }
                else {
                  iVar1 = strncmp(param_2,"io_capabilities",0xf);
                  if (iVar1 == 0) {
                    DAT_0008a7c8 = 8;
                  }
                  else {
                    iVar1 = strncmp(param_2,"auth",4);
                    if (iVar1 == 0) {
                      DAT_0008a7c8 = 9;
                    }
                    else {
                      iVar1 = strncmp(param_2,"root_path",9);
                      if (iVar1 == 0) {
                        DAT_0008a7c8 = 10;
                      }
                      else {
                        iVar1 = strncmp(param_2,"le_auth",7);
                        if (iVar1 == 0) {
                          DAT_0008a7c8 = 0xb;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return;
}



void FUN_0002ce14(undefined4 param_1,char *param_2,size_t param_3,int param_4)

{
  undefined *puVar1;
  int iVar2;
  ulong uVar3;
  undefined auStack_90 [132];
  
  if ((param_4 != 0) &&
     (iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                ,"app_xml_conf_dataCallbackFunc",0x3b8), iVar2 != 0)) {
    duss_log_print(0x5c,1,auStack_90,"Non complete data, probably malformed XML file: %s",param_2);
  }
  puVar1 = DAT_0008a7dc;
  switch(DAT_0008a7c8) {
  case 0:
    uVar3 = FUN_0002b280(param_2,param_3);
    *puVar1 = (char)uVar3;
    break;
  case 1:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[1] = (char)uVar3;
    break;
  case 2:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[2] = (char)uVar3;
    break;
  case 3:
    FUN_0002b240(DAT_0008a7dc + 9,0xf9,param_2,param_3);
    break;
  case 4:
    iVar2 = FUN_0002b1f8(DAT_0008a7dc + 0x102,3,(int)param_2,param_3);
    if ((iVar2 == 0) &&
       (iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_conf_dataCallbackFunc",0x3da), iVar2 != 0)) {
      duss_log_print(0x5c,1,auStack_90,"Failed reading BD address in XML");
    }
    break;
  case 5:
    iVar2 = FUN_0002b1f8(DAT_0008a7dc + 3,6,(int)param_2,param_3);
    if ((iVar2 == 0) &&
       (iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_conf_dataCallbackFunc",0x3d2), iVar2 != 0)) {
      duss_log_print(0x5c,1,auStack_90,"Failed reading BD address in XML");
    }
    break;
  case 6:
    FUN_0002b240(DAT_0008a7dc + 0x2f9,0x10,param_2,param_3);
    break;
  case 7:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[0x309] = (char)uVar3;
    break;
  case 8:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[0x30a] = (char)uVar3;
    break;
  case 9:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[0x30b] = (char)uVar3;
    break;
  case 10:
    FUN_0002b240(DAT_0008a7dc + 0x105,500,param_2,param_3);
    break;
  case 0xb:
    uVar3 = FUN_0002b280(param_2,param_3);
    puVar1[0x30c] = (char)uVar3;
  }
  return;
}



void FUN_0002d0c0(undefined4 param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = strncmp(param_2,"bd_addr",6);
  if (iVar1 == 0) {
    DAT_0008a7cc = 0xf;
  }
  else {
    iVar1 = strncmp(param_2,"device_name",0xb);
    if (iVar1 == 0) {
      DAT_0008a7cc = 0x10;
    }
    else {
      iVar1 = strncmp(param_2,"class_of_device",0xf);
      if (iVar1 == 0) {
        DAT_0008a7cc = 0x11;
      }
      else {
        iVar1 = strncmp(param_2,"link_key",8);
        if (iVar1 == 0) {
          DAT_0008a7cc = 0x12;
        }
        else {
          iVar1 = strncmp(param_2,"Link_key_present",0x10);
          if (iVar1 == 0) {
            DAT_0008a7cc = 0x13;
          }
          else {
            iVar1 = strncmp(param_2,"key_type",8);
            if (iVar1 == 0) {
              DAT_0008a7cc = 0x14;
            }
            else {
              iVar1 = strncmp(param_2,"trusted_services",0x10);
              if (iVar1 == 0) {
                DAT_0008a7cc = 0x15;
              }
              else {
                iVar1 = strncmp(param_2,"pid",3);
                if (iVar1 == 0) {
                  DAT_0008a7cc = 0x16;
                }
                else {
                  iVar1 = strncmp(param_2,"vid",3);
                  if (iVar1 == 0) {
                    DAT_0008a7cc = 0x17;
                  }
                  else {
                    iVar1 = strncmp(param_2,"version",7);
                    if (iVar1 == 0) {
                      DAT_0008a7cc = 0x18;
                    }
                    else {
                      iVar1 = strncmp(param_2,"features",8);
                      if (iVar1 == 0) {
                        DAT_0008a7cc = 0x19;
                      }
                      else {
                        iVar1 = strncmp(param_2,"lmp_version",0xb);
                        if (iVar1 == 0) {
                          DAT_0008a7cc = 0x1a;
                        }
                        else {
                          iVar1 = strncmp(param_2,"ble_addr_type",0xd);
                          if (iVar1 == 0) {
                            DAT_0008a7cc = 0x1b;
                          }
                          else {
                            iVar1 = strncmp(param_2,"device_type",0xb);
                            if (iVar1 == 0) {
                              DAT_0008a7cc = 0x1c;
                            }
                            else {
                              iVar1 = strncmp(param_2,"inq_result_type",0xb);
                              if (iVar1 == 0) {
                                DAT_0008a7cc = 0x1d;
                              }
                              else {
                                iVar1 = strncmp(param_2,"ble_Link_key_present",0x14);
                                if (iVar1 == 0) {
                                  DAT_0008a7cc = 0x1e;
                                }
                                else {
                                  iVar1 = strncmp(param_2,"penc_ltk",8);
                                  if (iVar1 == 0) {
                                    DAT_0008a7cc = 0x1f;
                                  }
                                  else {
                                    iVar1 = strncmp(param_2,"penc_rand",9);
                                    if (iVar1 == 0) {
                                      DAT_0008a7cc = 0x20;
                                    }
                                    else {
                                      iVar1 = strncmp(param_2,"penc_ediv",9);
                                      if (iVar1 == 0) {
                                        DAT_0008a7cc = 0x21;
                                      }
                                      else {
                                        iVar1 = strncmp(param_2,"penc_sec_level",0xe);
                                        if (iVar1 == 0) {
                                          DAT_0008a7cc = 0x22;
                                        }
                                        else {
                                          iVar1 = strncmp(param_2,"penc_key_size",0xd);
                                          if (iVar1 == 0) {
                                            DAT_0008a7cc = 0x23;
                                          }
                                          else {
                                            iVar1 = strncmp(param_2,"prid_irk",8);
                                            if (iVar1 == 0) {
                                              DAT_0008a7cc = 0x24;
                                            }
                                            else {
                                              iVar1 = strncmp(param_2,"prid_addr_type",0xe);
                                              if (iVar1 == 0) {
                                                DAT_0008a7cc = 0x25;
                                              }
                                              else {
                                                iVar1 = strncmp(param_2,"prid_static_addr",0x10);
                                                if (iVar1 == 0) {
                                                  DAT_0008a7cc = 0x26;
                                                }
                                                else {
                                                  iVar1 = strncmp(param_2,"pcsrk_counter",0xd);
                                                  if (iVar1 == 0) {
                                                    DAT_0008a7cc = 0x27;
                                                  }
                                                  else {
                                                    iVar1 = strncmp(param_2,"pcsrk_csrk",10);
                                                    if (iVar1 == 0) {
                                                      DAT_0008a7cc = 0x28;
                                                    }
                                                    else {
                                                      iVar1 = strncmp(param_2,"pcsrk_sec_level",0xf)
                                                      ;
                                                      if (iVar1 == 0) {
                                                        DAT_0008a7cc = 0x29;
                                                      }
                                                      else {
                                                        iVar1 = strncmp(param_2,"lcsrk_counter",0xd)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          DAT_0008a7cc = 0x2a;
                                                        }
                                                        else {
                                                          iVar1 = strncmp(param_2,"lcsrk_csrk",10);
                                                          if (iVar1 == 0) {
                                                            DAT_0008a7cc = 0x2b;
                                                          }
                                                          else {
                                                            iVar1 = strncmp(param_2,"lcsrk_dis",9);
                                                            if (iVar1 == 0) {
                                                              DAT_0008a7cc = 0x2c;
                                                            }
                                                            else {
                                                              iVar1 = strncmp(param_2,
                                                  "lcsrk_sec_level",0xf);
                                                  if (iVar1 == 0) {
                                                    DAT_0008a7cc = 0x2d;
                                                  }
                                                  else {
                                                    iVar1 = strncmp(param_2,"lenc_ltk",8);
                                                    if (iVar1 == 0) {
                                                      DAT_0008a7cc = 0x2e;
                                                    }
                                                    else {
                                                      iVar1 = strncmp(param_2,"lenc_div",8);
                                                      if (iVar1 == 0) {
                                                        DAT_0008a7cc = 0x2f;
                                                      }
                                                      else {
                                                        iVar1 = strncmp(param_2,"lenc_key_size",0xd)
                                                        ;
                                                        if (iVar1 == 0) {
                                                          DAT_0008a7cc = 0x30;
                                                        }
                                                        else {
                                                          iVar1 = strncmp(param_2,"lenc_sec_level",
                                                                          0xe);
                                                          if (iVar1 == 0) {
                                                            DAT_0008a7cc = 0x31;
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return;
}



void FUN_0002d5be(undefined4 param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = strncmp(param_2,"instance",8);
  if (iVar1 == 0) {
    DAT_0008a7cc = 0xe;
  }
  return;
}



void FUN_0002d5f4(undefined4 param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_4 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_dev_db_attrValueCallbackFunc",0x4ee);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,
                     "Non complete attribute value, probably malformed XML file: %s",param_2);
    }
  }
  DAT_0008a7d4 = FUN_0002b280(param_2,param_3);
  if (DAT_0008a7e8 <= (int)DAT_0008a7d4) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_dev_db_attrValueCallbackFunc",0x4f5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"bad instance number found:%d",DAT_0008a7d4);
    }
    DAT_0008a7d4 = 0;
  }
  return;
}



void FUN_0002d6de(undefined4 param_1,char *param_2,uint param_3,int param_4)

{
  int iVar1;
  ulong uVar2;
  undefined auStack_8c [128];
  undefined *local_c;
  
  if ((param_4 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                ,"app_xml_dev_db_dataCallbackFunc",0x50b), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_8c,"Non complete data, probably malformed XML file: %s",param_2);
  }
  local_c = (undefined *)(DAT_0008a7d4 * 0x1b0 + DAT_0008a7e0);
  switch(DAT_0008a7cc) {
  case 0xf:
    iVar1 = FUN_0002b1f8(local_c + 1,6,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x516), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance BD address in XML");
    }
    *local_c = 1;
    break;
  case 0x10:
    FUN_0002b240(local_c + 7,0xf9,param_2,param_3);
    break;
  case 0x11:
    iVar1 = FUN_0002b1f8(local_c + 0x100,3,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x525), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance class of device in XML");
    }
    break;
  case 0x12:
    iVar1 = FUN_0002b1f8(local_c + 0x10f,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x52d), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance link key in XML");
    }
    break;
  case 0x13:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x10e] = (char)uVar2;
    break;
  case 0x14:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x11f] = (char)uVar2;
    break;
  case 0x15:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(ulong *)(local_c + 0x108) = uVar2;
    break;
  case 0x16:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x122) = (short)uVar2;
    break;
  case 0x17:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x124) = (short)uVar2;
    break;
  case 0x18:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x126) = (short)uVar2;
    break;
  case 0x19:
    iVar1 = FUN_0002b1f8(local_c + 0x128,8,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x54d), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance features in XML");
    }
    break;
  case 0x1a:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x130] = (char)uVar2;
    break;
  case 0x1b:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x131] = (char)uVar2;
    break;
  case 0x1c:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x132] = (char)uVar2;
    break;
  case 0x1d:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x133] = (char)uVar2;
    break;
  case 0x1e:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x134] = (char)uVar2;
    break;
  case 0x1f:
    iVar1 = FUN_0002b1f8(local_c + 0x135,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x56a), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance penc ltk in XML");
    }
    break;
  case 0x20:
    iVar1 = FUN_0002b1f8(local_c + 0x145,8,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x572), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance penc rand in XML");
    }
    break;
  case 0x21:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x14e) = (short)uVar2;
    break;
  case 0x22:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x150] = (char)uVar2;
    break;
  case 0x23:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x151] = (char)uVar2;
    break;
  case 0x24:
    iVar1 = FUN_0002b1f8(local_c + 0x152,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x586), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance pid irk in XML");
    }
    break;
  case 0x25:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x162] = (char)uVar2;
    break;
  case 0x26:
    iVar1 = FUN_0002b1f8(local_c + 0x163,6,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x592), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance pid static addr in XML");
    }
    break;
  case 0x27:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(ulong *)(local_c + 0x16c) = uVar2;
    break;
  case 0x28:
    iVar1 = FUN_0002b1f8(local_c + 0x170,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x59e), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance pcsrk csrk in XML");
    }
    break;
  case 0x29:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x180] = (char)uVar2;
    break;
  case 0x2a:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(ulong *)(local_c + 0x184) = uVar2;
    break;
  case 0x2b:
    iVar1 = FUN_0002b1f8(local_c + 0x188,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x5ae), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance lcsrk csrk in XML");
    }
    break;
  case 0x2c:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x198) = (short)uVar2;
    break;
  case 0x2d:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x19a] = (char)uVar2;
    break;
  case 0x2e:
    iVar1 = FUN_0002b1f8(local_c + 0x19b,0x10,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_dev_db_dataCallbackFunc",0x5be), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance lenc ltk in XML");
    }
    break;
  case 0x2f:
    uVar2 = FUN_0002b280(param_2,param_3);
    *(short *)(local_c + 0x1ac) = (short)uVar2;
    break;
  case 0x30:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x1ae] = (char)uVar2;
    break;
  case 0x31:
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[0x1af] = (char)uVar2;
  }
  return;
}



void FUN_0002dea2(undefined4 param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = strncmp(param_2,"bd_addr",7);
  if (iVar1 == 0) {
    DAT_0008a7d0 = 0x35;
  }
  else {
    iVar1 = strncmp(param_2,"platform",8);
    if (iVar1 == 0) {
      DAT_0008a7d0 = 0x36;
    }
  }
  return;
}



void FUN_0002defc(undefined4 param_1,char *param_2)

{
  int iVar1;
  
  iVar1 = strncmp(param_2,"instance",8);
  if (iVar1 == 0) {
    DAT_0008a7d0 = 0x34;
  }
  return;
}



void FUN_0002df32(undefined4 param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_4 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_si_dev_db_attrValueCallbackFunc",0x61c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,
                     "Non complete attribute value, probably malformed XML file: %s",param_2);
    }
  }
  DAT_0008a7d8 = FUN_0002b280(param_2,param_3);
  if (DAT_0008a7ec <= (int)DAT_0008a7d8) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                              ,"app_xml_si_dev_db_attrValueCallbackFunc",0x623);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"bad instance number found:%d",DAT_0008a7d8);
    }
    DAT_0008a7d8 = 0;
  }
  return;
}



void FUN_0002e01c(undefined4 param_1,char *param_2,uint param_3,int param_4)

{
  int iVar1;
  ulong uVar2;
  undefined auStack_8c [128];
  undefined *local_c;
  
  if ((param_4 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                ,"app_xml_si_dev_db_dataCallbackFunc",0x639), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_8c,"Non complete data, probably malformed XML file: %s",param_2);
  }
  local_c = (undefined *)(DAT_0008a7d8 * 8 + DAT_0008a7e4);
  if (DAT_0008a7d0 == 0x35) {
    iVar1 = FUN_0002b1f8(local_c + 1,6,(int)param_2,param_3);
    if ((iVar1 == 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_xml_param.c"
                                  ,"app_xml_si_dev_db_dataCallbackFunc",0x644), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"Failed reading instance BD address in XML");
    }
    *local_c = 1;
  }
  else if (DAT_0008a7d0 == 0x36) {
    uVar2 = FUN_0002b280(param_2,param_3);
    local_c[7] = (char)uVar2;
  }
  return;
}



undefined4 FUN_0002e13e(int param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      local_c = 0;
      while( true ) {
        if (param_2 <= local_c) {
          return 0xffffffff;
        }
        if (*(char *)(local_c * 0x1b0 + param_1) == '\0') break;
        local_c = local_c + 1;
      }
      memset((void *)(local_c * 0x1b0 + param_1),0,0x1b0);
      *(undefined *)(local_c * 0x1b0 + param_1) = 1;
      bdcpy(local_c * 0x1b0 + param_1 + 1,param_3);
      return 0;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return 0;
}



int FUN_0002e210(int param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return local_c * 0x1b0 + param_1;
}



undefined4 FUN_0002e27c(int param_1,int param_2,undefined4 param_3,void *param_4,undefined param_5)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  puts("Update link key");
  memcpy((void *)(local_c * 0x1b0 + param_1 + 0x10f),param_4,0x10);
  *(undefined *)(local_c * 0x1b0 + param_1 + 0x10e) = 1;
  *(undefined *)(local_c * 0x1b0 + param_1 + 0x11f) = param_5;
  return 0;
}


/*
Unable to decompile 'FUN_0002e342'
Cause: 
Low-level Error: Cannot properly adjust input varnodes
*/


undefined4 FUN_0002e666(int param_1,int param_2,undefined4 param_3,uint param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  puts("Added trusted services");
  *(uint *)(local_c * 0x1b0 + param_1 + 0x108) =
       param_4 | *(uint *)(local_c * 0x1b0 + param_1 + 0x108);
  return 0;
}



undefined4 FUN_0002e708(int param_1,int param_2,undefined4 param_3,char *param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update name with %s\n",param_4);
  strncpy((char *)(local_c * 0x1b0 + param_1 + 7),param_4,0xf8);
  *(undefined *)(local_c * 0x1b0 + param_1 + 0xff) = 0;
  return 0;
}



undefined4 FUN_0002e7b2(int param_1,int param_2,undefined4 param_3,byte *param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update class-of-device [0x%02X-0x%02X-0x%02X]\n",(uint)*param_4,(uint)param_4[1],
         (uint)param_4[2]);
  *(byte *)(local_c * 0x1b0 + param_1 + 0x100) = *param_4;
  *(byte *)(local_c * 0x1b0 + param_1 + 0x101) = param_4[1];
  *(byte *)(local_c * 0x1b0 + param_1 + 0x102) = param_4[2];
  return 0;
}



undefined4 FUN_0002e882(int param_1,int param_2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  char *pcVar4;
  uint uVar5;
  int local_1c;
  
  for (local_1c = 0; local_1c < param_2; local_1c = local_1c + 1) {
    if (*(char *)(local_1c * 0x1b0 + param_1) != '\0') {
      printf("Dev:%d\n",local_1c);
      printf("\tBdaddr:%02x:%02x:%02x:%02x:%02x:%02x\n",
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 1),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 2),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 3),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 4),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 5),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 6));
      printf("\tIdentity Bdaddr:%02x:%02x:%02x:%02x:%02x:%02x\n",
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x163),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x164),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x165),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x166),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x167),
             (uint)*(byte *)(local_1c * 0x1b0 + param_1 + 0x168));
      printf("\tName:%s\n",local_1c * 0x1b0 + param_1 + 7);
      bVar1 = *(byte *)(local_1c * 0x1b0 + param_1 + 0x100);
      bVar2 = *(byte *)(local_1c * 0x1b0 + param_1 + 0x101);
      bVar3 = *(byte *)(local_1c * 0x1b0 + param_1 + 0x102);
      pcVar4 = FUN_0002f16c(local_1c * 0x1b0 + param_1 + 0x100);
      printf("\tClassOfDevice:%02x:%02x:%02x => %s\n",(uint)bVar1,(uint)bVar2,(uint)bVar3,pcVar4);
      printf("\tTrusted Services:%x\n",*(undefined4 *)(local_1c * 0x1b0 + param_1 + 0x108));
      if (*(char *)(local_1c * 0x1b0 + param_1 + 0x10e) == '\0') {
        puts("\tLink Key present:FALSE");
      }
      else {
        puts("\tLink Key present:TRUE");
      }
      uVar5 = (uint)*(ushort *)(local_1c * 0x1b0 + param_1 + 0x124);
      printf("\tPid:%x Vid:%d\n",(uint)*(ushort *)(local_1c * 0x1b0 + param_1 + 0x122),uVar5,uVar5,
             pcVar4);
    }
  }
  return 0;
}



undefined4 FUN_0002eaec(int param_1,int param_2,undefined4 param_3,ushort param_4,ushort param_5)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update Pid:0x%x Vid:0x%x\n",(uint)param_4,(uint)param_5);
  *(ushort *)(local_c * 0x1b0 + param_1 + 0x122) = param_4;
  *(ushort *)(local_c * 0x1b0 + param_1 + 0x124) = param_5;
  return 0;
}



undefined4 FUN_0002eb94(int param_1,int param_2,undefined4 param_3,ushort param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update Version:0x%04X\n",(uint)param_4);
  *(ushort *)(local_c * 0x1b0 + param_1 + 0x126) = param_4;
  return 0;
}



undefined4 FUN_0002ec26(int param_1,int param_2,undefined4 param_3,byte *param_4)

{
  int iVar1;
  int local_1c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_1c = 0;
  while( true ) {
    if (param_2 <= local_1c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_1c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_1c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_1c = local_1c + 1;
  }
  printf("Update features:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X\n",(uint)*param_4,(uint)param_4[1]
         ,(uint)param_4[2],(uint)param_4[3],(uint)param_4[3],(uint)param_4[4],(uint)param_4[5],
         (uint)param_4[6]);
  memcpy((void *)(local_1c * 0x1b0 + param_1 + 0x128),param_4,8);
  return 0;
}



undefined4 FUN_0002ed08(int param_1,int param_2,undefined4 param_3,byte param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update lmp_version:%d\n",(uint)param_4);
  *(byte *)(local_c * 0x1b0 + param_1 + 0x130) = param_4;
  return 0;
}



undefined4 FUN_0002ed9a(int param_1,int param_2,undefined4 param_3,byte param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update ble_addr_type:%d\n",(uint)param_4);
  *(byte *)(local_c * 0x1b0 + param_1 + 0x131) = param_4;
  return 0;
}



undefined4 FUN_0002ee2c(int param_1,int param_2,undefined4 param_3,byte param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update device_type:%d\n",(uint)param_4);
  *(byte *)(local_c * 0x1b0 + param_1 + 0x132) = param_4;
  return 0;
}



undefined4 FUN_0002eebe(int param_1,int param_2,undefined4 param_3,byte param_4)

{
  int iVar1;
  int local_c;
  
  FUN_0002e13e(param_1,param_2,param_3);
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      return 0xffffffff;
    }
    if ((*(char *)(local_c * 0x1b0 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 0x1b0 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  printf("Update inquiry result type :%d\n",(uint)param_4);
  *(byte *)(local_c * 0x1b0 + param_1 + 0x133) = param_4;
  return 0;
}



int FUN_0002ef50(int param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (param_2 <= local_c) {
      local_c = 0;
      while( true ) {
        if (param_2 <= local_c) {
          return 0;
        }
        if (*(char *)(local_c * 8 + param_1) == '\0') break;
        local_c = local_c + 1;
      }
      memset((void *)(local_c * 8 + param_1),0,8);
      *(undefined *)(local_c * 8 + param_1) = 1;
      bdcpy(local_c * 8 + param_1 + 1,param_3);
      return local_c * 8 + param_1;
    }
    if ((*(char *)(local_c * 8 + param_1) != '\0') &&
       (iVar1 = bdcmp(local_c * 8 + param_1 + 1,param_3), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return local_c * 8 + param_1;
}



undefined4 FUN_0002f006(int param_1,int param_2,undefined4 param_3,byte param_4)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_0002ef50(param_1,param_2,param_3);
  if (iVar1 == 0) {
    uVar2 = 0xffffffff;
  }
  else {
    printf("Update platform:%d\n",(uint)param_4);
    *(byte *)(iVar1 + 7) = param_4;
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0002f04c(char *param_1,ushort *param_2,int param_3,char param_4,char param_5)

{
  undefined4 uVar1;
  int *local_c;
  
  if (param_5 == '\0') {
    local_c = (int *)&DAT_00064d58;
  }
  else {
    local_c = (int *)&DAT_00064d40;
  }
  uVar1 = FUN_00032b72(local_c,param_1,param_2,param_3,param_4);
  return uVar1;
}



undefined4 FUN_0002f092(int param_1,byte *param_2,char *param_3,uint param_4,undefined *param_5)

{
  char *pcVar1;
  undefined4 uVar2;
  
  pcVar1 = FUN_00033042(param_3,(int)(param_3 + param_4),"BEGIN:VTODO\r\n");
  if (pcVar1 == (char *)0x0) {
    pcVar1 = FUN_00033042(param_3,(int)(param_3 + param_4),"BEGIN:VEVENT\r\n");
    if (pcVar1 == (char *)0x0) {
      *param_2 = 0;
      return 1;
    }
    *param_5 = 0;
  }
  else {
    *param_5 = 1;
  }
  uVar2 = FUN_00033100((int *)&DAT_00064d70,param_1,param_2,param_3,param_4);
  return uVar2;
}



undefined4 FUN_0002f110(char *param_1,ushort *param_2,int param_3,char param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00032b72((int *)&DAT_00064df8,param_1,param_2,param_3,param_4);
  return uVar1;
}



undefined4 FUN_0002f13e(int param_1,byte *param_2,char *param_3,uint param_4)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00033100((int *)&DAT_00064e10,param_1,param_2,param_3,param_4);
  return uVar1;
}



char * FUN_0002f16c(int param_1)

{
  char *pcVar1;
  
  switch(*(byte *)(param_1 + 1) & 0x1f) {
  case 0:
    pcVar1 = "Misc device";
    break;
  case 1:
    pcVar1 = "Computer";
    break;
  case 2:
    pcVar1 = "Phone";
    break;
  case 3:
    pcVar1 = "Access Point";
    break;
  case 4:
    pcVar1 = "Audio/Video";
    break;
  case 5:
    pcVar1 = "Peripheral";
    break;
  case 6:
    pcVar1 = "Imaging";
    break;
  case 7:
    pcVar1 = "Wearable";
    break;
  case 8:
    pcVar1 = "Toy";
    break;
  case 9:
    pcVar1 = "Health";
    break;
  default:
    pcVar1 = "Unknown device type";
  }
  return pcVar1;
}



int FUN_0002f22c(undefined4 param_1)

{
  int iVar1;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  
  local_18 = 0;
  local_14 = 10;
  local_c = 1;
  printf("%s => ",param_1);
  local_10 = 0;
  do {
    iVar1 = getchar();
    if ((local_18 == 0) && (iVar1 == 10)) {
      return -1;
    }
    local_18 = local_18 + 1;
    if ((iVar1 < 0x30) || (0x39 < iVar1)) {
      if ((iVar1 < 0x61) || (0x66 < iVar1)) {
        if ((iVar1 < 0x41) || (0x46 < iVar1)) {
          if (iVar1 == 0x2d) {
            local_c = -local_c;
          }
          else if (iVar1 == 0x78) {
            local_14 = 0x10;
          }
        }
        else {
          local_10 = iVar1 + -0x37 + local_14 * local_10;
        }
      }
      else {
        local_10 = iVar1 + -0x57 + local_14 * local_10;
      }
    }
    else {
      local_10 = iVar1 + -0x30 + local_14 * local_10;
    }
  } while ((iVar1 != -1) && (iVar1 != 10));
  return local_c * local_10;
}



int FUN_0002f300(int param_1,int param_2,int param_3)

{
  int iVar1;
  int local_c;
  
  if (param_1 != 0) {
    printf("%s => ",param_1);
  }
  local_c = 0;
  do {
    iVar1 = getchar();
    if (iVar1 == -1) {
      return -1;
    }
    if ((iVar1 != 10) && (local_c < param_3 + -1)) {
      *(char *)(local_c + param_2) = (char)iVar1;
      local_c = local_c + 1;
    }
  } while (iVar1 != 10);
  *(undefined *)(local_c + param_2) = 0;
  return local_c;
}



int FUN_0002f374(int param_1,int param_2,int param_3)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined auStack_160 [128];
  byte local_e0 [203];
  byte local_15;
  byte *local_14;
  int local_10;
  int local_c;
  
  iVar3 = FUN_0002f300(param_1,(int)local_e0,200);
  local_c = 0;
  local_14 = local_e0;
  while( true ) {
    local_10 = iVar3;
    if ((local_10 < 2) || (param_3 <= local_c)) {
      if (0 < local_10) {
        iVar3 = duss_log_gen_head(0x5c,1,auStack_160,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                                  ,"app_get_hex_data",0x123);
        if (iVar3 != 0) {
          duss_log_print(0x5c,1,auStack_160,"strlen>0 %d %x\n",local_10,*local_14);
        }
        local_c = -1;
      }
      return local_c;
    }
    iVar3 = isxdigit((uint)*local_14);
    if (iVar3 == 0) {
      iVar3 = duss_log_gen_head(0x5c,1,auStack_160,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                                ,"app_get_hex_data",0x10b);
      if (iVar3 != 0) {
        duss_log_print(0x5c,1,auStack_160,"bad Hex char 0x%02X\n",*local_14);
      }
      return -1;
    }
    bVar2 = *local_14;
    local_14 = local_14 + 1;
    cVar1 = FUN_0002f6be(bVar2);
    local_15 = (byte)((int)cVar1 << 4);
    local_10 = local_10 + -1;
    iVar3 = isxdigit((uint)*local_14);
    if (iVar3 == 0) break;
    bVar2 = *local_14;
    local_14 = local_14 + 1;
    bVar2 = FUN_0002f6be(bVar2);
    local_15 = local_15 | bVar2;
    iVar3 = local_10 + -1;
    iVar4 = local_c + 1;
    *(byte *)(param_2 + local_c) = local_15;
    local_c = iVar4;
    if ((0 < iVar3) &&
       ((((*local_14 == 0x20 || (*local_14 == 0x2e)) || (*local_14 == 0x2d)) ||
        (((*local_14 == 0x3a || (*local_14 == 0xd)) || (*local_14 == 10)))))) {
      local_14 = local_14 + 1;
      iVar3 = local_10 + -2;
    }
  }
  iVar3 = duss_log_gen_head(0x5c,1,auStack_160,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                            ,"app_get_hex_data",0x104);
  if (iVar3 != 0) {
    duss_log_print(0x5c,1,auStack_160,"bad Hex char 0x%02X\n",*local_14);
  }
  return -1;
}



void FUN_0002f5b6(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uStack_c;
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  uStack_c = param_2;
  uStack_8 = param_3;
  uStack_4 = param_4;
  vprintf(param_1,&uStack_c);
  return;
}



int FUN_0002f63a(int param_1)

{
  int iVar1;
  undefined auStack_100 [128];
  stat sStack_80;
  int local_14;
  
  local_14 = 0xffffffff;
  local_14 = fstat(param_1,&sStack_80);
  if (local_14 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_100,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                              ,"app_file_size",0x1e7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_100,"could not fstat(fd=%d)",param_1);
    }
  }
  else {
    local_14 = sStack_80.st_blksize;
  }
  return local_14;
}



char FUN_0002f6be(byte param_1)

{
  char cVar1;
  
  if (param_1 < 0x61) {
    if (param_1 < 0x41) {
      cVar1 = param_1 - 0x30;
    }
    else {
      cVar1 = param_1 - 0x37;
    }
  }
  else {
    cVar1 = param_1 + 0xa9;
  }
  return cVar1;
}



undefined4 FUN_0002f6f6(byte *param_1,short *param_2,byte *param_3,ushort *param_4)

{
  char cVar1;
  size_t sVar2;
  int iVar3;
  undefined4 uVar4;
  byte *pbVar5;
  undefined auStack_a4 [128];
  int local_24;
  size_t local_20;
  char local_19;
  int local_18;
  uint local_14;
  
  sVar2 = strlen((char *)param_3);
  if (sVar2 < *param_4) {
    local_20 = strlen((char *)param_3);
  }
  else {
    local_20 = (size_t)*param_4;
  }
  if (local_20 < 0xb) {
    iVar3 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                              ,"app_hex_convert",0x220);
    if (iVar3 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"Record too short");
    }
    uVar4 = 0xffffffff;
  }
  else if (*param_3 == 0x3a) {
    local_18 = 0;
    for (local_14 = 1; param_3[local_14] != 0; local_14 = local_14 + 1) {
      if ((local_14 & 1) == 0) {
        pbVar5 = param_3 + local_18;
        cVar1 = FUN_0002f6be(param_3[local_14 - 1]);
        *pbVar5 = (byte)((int)cVar1 << 4);
        cVar1 = FUN_0002f6be(param_3[local_14]);
        param_3[local_18] = param_3[local_18] + cVar1;
        local_18 = local_18 + 1;
      }
    }
    local_24 = *param_3 + 5;
    if (local_18 < local_24) {
      iVar3 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                                ,"app_hex_convert",0x23c);
      if (iVar3 != 0) {
        duss_log_print(0x5c,1,auStack_a4,"Line length (%d) is smaller than record data size (%d)",
                       local_18,local_24);
      }
      uVar4 = 0xffffffff;
    }
    else {
      *param_4 = (ushort)*param_3;
      *param_2 = (ushort)param_3[2] + (ushort)param_3[1] * 0x100;
      *param_1 = param_3[3];
      local_19 = '\0';
      local_18 = 0;
      for (local_14 = 0; (int)local_14 < local_24; local_14 = local_14 + 1) {
        local_19 = local_19 + param_3[local_14];
        if (3 < (int)local_14) {
          param_3[local_18] = param_3[local_14];
          local_18 = local_18 + 1;
        }
      }
      if (local_19 == '\0') {
        uVar4 = 0;
      }
      else {
        iVar3 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                                  ,"app_hex_convert",0x24f);
        if (iVar3 != 0) {
          duss_log_print(0x5c,1,auStack_a4,"record CRC failed");
        }
        uVar4 = 0xffffffff;
      }
    }
  }
  else {
    iVar3 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_utils.c"
                              ,"app_hex_convert",0x225);
    if (iVar3 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"Record does not start with colon character");
    }
    uVar4 = 0xffffffff;
  }
  return uVar4;
}



undefined4 FUN_0002f9a4(FILE *param_1,byte *param_2,short *param_3,byte *param_4,ushort *param_5)

{
  char *pcVar1;
  undefined4 uVar2;
  
  pcVar1 = fgets((char *)param_4,(uint)*param_5,param_1);
  if (pcVar1 == (char *)0x0) {
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = FUN_0002f6f6(param_2,param_3,param_4,param_5);
  }
  return uVar2;
}



void * FUN_0002f9e4(size_t param_1)

{
  void *pvVar1;
  
  pvVar1 = malloc(param_1);
  return pvVar1;
}



void FUN_0002fa00(void *param_1)

{
  free(param_1);
  return;
}



bool FUN_0002fa16(void **param_1,undefined4 *param_2)

{
  void *pvVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  
  pvVar1 = FUN_0002f9e4(0x1f0);
  *param_1 = pvVar1;
  pvVar1 = *param_1;
  if (pvVar1 != (void *)0x0) {
    puVar3 = (undefined4 *)*param_1;
    uVar2 = param_2[1];
    uVar4 = param_2[2];
    uVar5 = param_2[3];
    *puVar3 = *param_2;
    puVar3[1] = uVar2;
    puVar3[2] = uVar4;
    puVar3[3] = uVar5;
    puVar3[4] = param_2[4];
    *(undefined4 *)((int)*param_1 + 0x98) = 0;
    *(undefined4 *)((int)*param_1 + 0xa0) = 0;
    *(undefined4 *)((int)*param_1 + 0x9c) = 1;
    *(undefined4 *)((int)*param_1 + 0x14) = 0;
  }
  return pvVar1 != (void *)0x0;
}



void FUN_0002fa7e(void *param_1)

{
  FUN_0002fa00(param_1);
  return;
}



void FUN_0002fa94(int param_1,char *param_2,size_t param_3,char **param_4,size_t *param_5)

{
  size_t local_14;
  
  if ((param_4 == (char **)0x0) || (*(int *)(param_1 + 0x98) != 0)) {
    local_14 = param_3;
    if (0x80 - *(int *)(param_1 + 0x98) < (int)param_3) {
      local_14 = 0x80 - *(int *)(param_1 + 0x98);
    }
    if (local_14 != 0) {
      strncpy((char *)(*(int *)(param_1 + 0x98) + 0x18 + param_1),param_2,local_14);
      *(size_t *)(param_1 + 0x98) = *(int *)(param_1 + 0x98) + local_14;
    }
    if (param_4 != (char **)0x0) {
      *param_4 = (char *)(param_1 + 0x18);
      *param_5 = *(size_t *)(param_1 + 0x98);
    }
  }
  else {
    *param_4 = param_2;
    *param_5 = param_3;
  }
  return;
}



undefined FUN_0002fb2c(undefined **param_1,char *param_2,int param_3,char **param_4)

{
  char *pcVar1;
  size_t sVar2;
  int iVar3;
  undefined uVar4;
  bool bVar5;
  char *local_38;
  size_t local_30;
  char *local_2c;
  size_t local_28;
  char *local_24;
  char *local_20;
  char *local_1c;
  char *local_18;
  int local_14;
  
  local_14 = 0;
  local_18 = param_2 + param_3;
  pcVar1 = param_2;
  if (param_1[5] == (undefined *)0x0) {
    sVar2 = strspn(param_2," \t\r\n");
    local_1c = param_2 + sVar2;
    iVar3 = strncmp(local_1c,"<?",2);
    local_38 = param_2;
    if ((iVar3 == 0) && (local_1c = strstr(local_1c,"?>"), local_1c != (char *)0x0)) {
      local_38 = local_1c + 2;
    }
    param_1[5] = (undefined *)0x1;
    pcVar1 = local_38;
  }
LAB_0002ff06:
  local_38 = pcVar1;
  if ((local_18 <= local_38) || (local_14 != 0)) {
    *param_4 = local_38;
    bVar5 = local_14 != 0;
    if (bVar5) {
      local_14 = 1;
    }
    uVar4 = (undefined)local_14;
    if (!bVar5) {
      uVar4 = 0;
    }
    return uVar4;
  }
  if (param_1[0x27] != (undefined *)0x0) goto code_r0x0002fbaa;
  goto LAB_0002fbce;
code_r0x0002fbaa:
  sVar2 = strspn(local_38," \t\r\n");
  local_20 = local_38 + sVar2;
  pcVar1 = local_20;
  if (local_20 != local_38) goto LAB_0002ff06;
LAB_0002fbce:
  switch(param_1[5]) {
  case (undefined *)0x1:
    local_20 = strchr(local_38,0x3c);
    if (local_20 == (char *)0x0) {
      if (param_1[3] != (undefined *)0x0) {
        (*(code *)param_1[3])(param_1,local_38,(int)local_18 - (int)local_38,1);
      }
      *param_4 = local_38;
      return 0;
    }
    if ((local_38 != local_20) && (param_1[3] != (undefined *)0x0)) {
      (*(code *)param_1[3])(param_1,local_38,(int)local_20 - (int)local_38,0);
    }
    local_38 = local_20 + 1;
    param_1[5] = (undefined *)0x2;
    param_1[0x26] = (undefined *)0x0;
    param_1[0x28] = param_1[0x28] + 1;
    break;
  case (undefined *)0x2:
  case (undefined *)0x4:
    if (*local_38 == '/') {
      if ((param_1[5] == (undefined *)0x2) && (param_1[0x26] == (undefined *)0x0)) {
        param_1[5] = (undefined *)0x3;
        local_38 = local_38 + 1;
        break;
      }
      if (param_1[5] == (undefined *)0x4) {
        (*(code *)param_1[4])(param_1,param_1 + 6,param_1[0x26]);
        param_1[5] = (undefined *)0x8;
        local_38 = local_38 + 1;
        break;
      }
    }
    else if (*local_38 == '>') {
      param_1[5] = (undefined *)0x1;
      local_38 = local_38 + 1;
      break;
    }
    local_20 = strpbrk(local_38," \t\r\n=/>");
    if (local_20 == (char *)0x0) {
      FUN_0002fa94((int)param_1,local_38,(int)local_18 - (int)local_38,(char **)0x0,(size_t *)0x0);
      param_1[0x27] = (undefined *)0x0;
      *param_4 = local_38;
      return 0;
    }
    FUN_0002fa94((int)param_1,local_38,(int)local_20 - (int)local_38,&local_2c,&local_30);
    if (param_1[5] == (undefined *)0x2) {
      (*(code *)*param_1)(param_1,local_2c,local_30);
      param_1[5] = (undefined *)0x4;
    }
    else {
      (*(code *)param_1[1])(param_1,local_2c,local_30);
      param_1[5] = (undefined *)0x5;
    }
    param_1[0x26] = (undefined *)0x0;
    local_38 = local_20;
    break;
  case (undefined *)0x3:
    local_20 = strpbrk(local_38," \t\r\n>");
    if (local_20 == (char *)0x0) {
      FUN_0002fa94((int)param_1,local_38,(int)local_18 - (int)local_38,(char **)0x0,(size_t *)0x0);
      param_1[0x27] = (undefined *)0x0;
      *param_4 = local_38;
      return 0;
    }
    FUN_0002fa94((int)param_1,local_38,(int)local_20 - (int)local_38,&local_24,&local_28);
    (*(code *)param_1[4])(param_1,local_24,local_28);
    param_1[5] = (undefined *)0x8;
    local_38 = local_20;
    param_1[0x28] = param_1[0x28] + -1;
    if ((int)param_1[0x28] < 1) {
      local_14 = 1;
    }
    break;
  case (undefined *)0x5:
    if (*local_38 == '>') {
      param_1[5] = (undefined *)0x1;
      local_38 = local_38 + 1;
    }
    else if (*local_38 == '=') {
      param_1[5] = (undefined *)0x6;
      local_38 = local_38 + 1;
    }
    else {
      param_1[5] = (undefined *)0x4;
    }
    break;
  case (undefined *)0x6:
    if (*local_38 == '\"') {
      local_38 = local_38 + 1;
    }
    param_1[5] = (undefined *)0x7;
    break;
  case (undefined *)0x7:
    local_20 = strchr(local_38,0x22);
    if (local_20 == (char *)0x0) {
      (*(code *)param_1[2])(param_1,local_38,(int)local_18 - (int)local_38,1);
      param_1[0x27] = (undefined *)0x0;
      *param_4 = local_38;
      return 0;
    }
    (*(code *)param_1[2])(param_1,local_38,(int)local_20 - (int)local_38,0);
    local_38 = local_20 + 1;
    param_1[5] = (undefined *)0x4;
    param_1[0x26] = (undefined *)0x0;
    break;
  case (undefined *)0x8:
    local_20 = strchr(local_38,0x3e);
    if (local_20 == (char *)0x0) {
      *param_4 = local_38;
      return 0;
    }
    local_38 = local_20 + 1;
    param_1[5] = (undefined *)0x1;
    param_1[0x28] = param_1[0x28] + -1;
    if ((int)param_1[0x28] < 1) {
      local_14 = 1;
    }
  }
  param_1[0x27] = (undefined *)0x1;
  pcVar1 = local_38;
  goto LAB_0002ff06;
}



undefined4 FUN_0002ff30(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [6];
  short local_a;
  
  BSA_SecBondInit(auStack_10);
  bdcpy(auStack_10,param_1);
  local_a = BSA_SecBond(auStack_10);
  if (local_a == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_bond",0x37);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"bonding ongoing...");
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_bond",0x32);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Unable to Bond status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0002fffc(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [6];
  short local_a;
  
  BSA_SecBondCancelInit(auStack_10);
  bdcpy(auStack_10,param_1);
  local_a = BSA_SecBondCancel(auStack_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_bond_cancel",0x53);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_SecBondCancel failed:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00030088(undefined param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined auStack_14 [6];
  undefined local_e;
  undefined local_d;
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                            ,"app_sec_sp_cfm_reply",0x6c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Reply to Simple Pairing");
  }
  BSA_SecSpCfmReplyInit(auStack_14);
  local_e = param_1;
  bdcpy(auStack_14,param_2);
  local_d = DAT_0008a80e;
  local_a = BSA_SecSpCfmReply(auStack_14);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_sp_cfm_reply",0x75);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Unable to Reply to SP Req status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003016c(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_3ac [128];
  undefined auStack_32c [761];
  char acStack_33 [16];
  undefined local_23;
  undefined local_22;
  undefined local_21;
  undefined local_20;
  undefined local_1c;
  undefined local_1b;
  undefined local_1a;
  undefined *local_18;
  undefined local_14;
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_3ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                            ,"app_sec_set_security",0x8f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_3ac,"Set Bluetooth Security");
  }
  local_c = FUN_0002a88e(auStack_32c);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_3ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_set_security",0x95);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_3ac,"app_read_xml_config failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    strncpy(&DAT_0008a7f1,acStack_33,0x10);
    DAT_0008a800 = 0;
    DAT_0008a801 = local_23;
    BSA_SecSetSecurityInit(&local_1c);
    local_1c = local_22;
    local_1b = local_21;
    local_1a = local_20;
    local_18 = &LAB_000307f0_1;
    if (param_1 != 0) {
      DAT_0008a808 = param_1;
    }
    local_14 = DAT_0008a80c;
    local_e = BSA_SecSetSecurity(&local_1c);
    if (local_e == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_3ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                                ,"app_sec_set_security",0xaf);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_3ac,
                       "BSA_SecSetSecurity failed: Unable to Set Security status:%d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0003031c(char param_1)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_1 == '\x01') {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_set_ssp_debug_mode",0xc6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_88,"Enable SPP debug mode");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_set_ssp_debug_mode",0xca);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_88,"Disable SPP debug mode");
    }
  }
  DAT_0008a80c = param_1;
  return 0;
}



undefined4 FUN_000303c4(char *param_1,undefined param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_39c [128];
  byte abStack_31c [761];
  char acStack_23 [15];
  undefined local_14;
  undefined local_13;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_39c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                            ,"app_sec_set_default_pin",0xe5);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_39c,"Set Bluetooth Security");
  }
  local_c = FUN_0002a88e(abStack_31c);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_39c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_set_default_pin",0xeb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_39c,"app_read_xml_config failed: %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    strncpy(acStack_23,param_1,0x10);
    local_14 = 0;
    local_13 = param_2;
    iVar1 = FUN_0002a906(abStack_31c);
    if (iVar1 < 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_39c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                                ,"app_sec_set_default_pin",0xf6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_39c,
                       "app_write_xml_config failed: Unable to Write XML config file");
      }
      uVar2 = 0xffffffff;
    }
    else {
      strncpy(&DAT_0008a7f1,acStack_23,0x10);
      DAT_0008a800 = 0;
      DAT_0008a801 = local_13;
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_00030538(char *param_1,undefined *param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c4 [128];
  char acStack_44 [52];
  size_t local_10;
  int local_c;
  
  local_c = 0;
  do {
    if (2 < local_c) {
LAB_0003067e:
      if (local_c < 3) {
        uVar2 = 0;
      }
      else {
        uVar2 = 0xffffffff;
      }
      return uVar2;
    }
    local_10 = FUN_0002f300(0x65244,(int)acStack_44,0x32);
    if ((int)local_10 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                                ,"app_sec_get_pin",0x11e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c4,"app_get_string failed");
      }
      return 0xffffffff;
    }
    if ((int)local_10 < 0x11) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                                ,"app_sec_get_pin",0x128);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c4,"PIN Code = %s",acStack_44);
      }
      strncpy(param_1,acStack_44,local_10);
      param_1[0xf] = '\0';
      *param_2 = (char)local_10;
      goto LAB_0003067e;
    }
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_get_pin",0x123);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c4,"pin length must be 16 digits long maximum");
    }
    local_c = local_c + 1;
  } while( true );
}



undefined4 FUN_00030696(int param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  undefined4 local_c;
  
  local_c = 0;
  if (param_1 == 0) {
    DAT_0008a7f0 = 1;
  }
  else if (param_1 == 1) {
    DAT_0008a7f0 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_set_pairing_mode",0x154);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Bad pairing mode value %d",param_1);
    }
    local_c = 0xffffffff;
  }
  return local_c;
}



undefined4 FUN_00030728(void)

{
  short sVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_ac [128];
  undefined auStack_2c [6];
  char acStack_26 [15];
  undefined local_17;
  undefined local_16;
  
  iVar2 = FUN_00030538(&DAT_0008a7f1,&DAT_0008a801);
  if (iVar2 < 0) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_sec.c"
                              ,"app_sec_pin_reply",0x16e);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"app_sec_get_pin failed");
    }
    uVar3 = 0xffffffff;
  }
  else {
    BSA_SecPinCodeReplyInit(auStack_2c);
    bdcpy(auStack_2c,&DAT_0008a802);
    local_16 = DAT_0008a801;
    strncpy(acStack_26,&DAT_0008a7f1,0x10);
    local_17 = 0;
    sVar1 = BSA_SecPinCodeReply(auStack_2c);
    if (sVar1 == 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = 0xffffffff;
    }
  }
  return uVar3;
}



int FUN_000323a8(byte *param_1,byte *param_2,int param_3)

{
  byte bVar1;
  byte bVar2;
  short sVar3;
  int iVar4;
  int iVar5;
  int local_24;
  byte *local_20;
  byte *local_1c;
  
  local_24 = param_3;
  local_20 = param_2;
  local_1c = param_1;
  if (param_3 == 0) {
    iVar5 = 0;
  }
  else {
    do {
      bVar1 = *local_1c;
      bVar2 = *local_20;
      iVar5 = tolower((uint)bVar1);
      iVar4 = tolower((uint)bVar2);
      sVar3 = (short)iVar5 - (short)iVar4;
      if ((sVar3 != 0) || (bVar1 == 0)) break;
      local_24 = local_24 + -1;
      local_20 = local_20 + 1;
      local_1c = local_1c + 1;
    } while (local_24 != 0);
    iVar5 = (int)sVar3;
  }
  return iVar5;
}



void FUN_00032416(undefined4 param_1,undefined4 param_2)

{
  DAT_00085ac8 = param_1;
  DAT_00085acc = param_2;
  return;
}



short FUN_0003243c(int param_1,int param_2)

{
  int local_10;
  byte local_a;
  byte local_9;
  
  local_a = 0;
  local_9 = (byte)((uint)*(undefined4 *)(param_2 + 4) >> 8);
  if (*(int *)(param_1 + (uint)*(ushort *)(param_2 + 8) * 0xc + 4) != 0) {
    for (local_10 = 1;
        (local_9 != 0 &&
        (local_10 <=
         (int)(uint)*(byte *)(*(int *)(param_1 + (uint)*(ushort *)(param_2 + 8) * 0xc + 4) + 4)));
        local_10 = local_10 + 1) {
      if ((local_9 & 1) != 0) {
        local_a = local_a + *(char *)(local_10 * 8 +
                                      *(int *)(param_1 + (uint)*(ushort *)(param_2 + 8) * 0xc + 4) +
                                     4);
      }
      local_9 = local_9 >> 1;
    }
  }
  return *(short *)(param_2 + 10) +
         (ushort)(byte)(&DAT_00065bf4)[(uint)((byte)*(undefined4 *)(param_2 + 4) & 0xf) * 8] +
         (ushort)(byte)(&DAT_00065ce0)[(uint)((byte)(*(uint *)(param_2 + 4) >> 3) & 0x1f) * 8] +
         (ushort)local_a + (ushort)*(byte *)(param_1 + (uint)*(ushort *)(param_2 + 8) * 0xc + 8);
}



bool FUN_0003254c(char param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  bool local_9;
  
  local_9 = false;
  if (*(int *)(param_2 + 4) != 0) {
    bVar1 = (byte)*(undefined4 *)(param_2 + 4) & 0xf;
    if (((param_1 == '\x02') &&
        (local_9 = *(int *)(&DAT_00065cdc + (uint)((byte)(*(uint *)(param_2 + 4) >> 3) & 0x1f) * 8)
                   != 0, *(int *)(&DAT_00065bf0 + (uint)bVar1 * 8) != 0)) &&
       (iVar2 = strcmp(*(char **)(&DAT_00065bf0 + (uint)bVar1 * 8),"b"), iVar2 != 0)) {
      local_9 = true;
    }
  }
  return local_9;
}



char * FUN_000325dc(char param_1,int param_2,char *param_3,int param_4)

{
  byte bVar1;
  byte bVar2;
  bool bVar3;
  undefined4 *puVar4;
  undefined4 *local_24;
  int local_10;
  byte local_9;
  
  bVar3 = false;
  local_24 = (undefined4 *)param_3;
  if (*(int *)(param_4 + 4) == 0) {
    if (*(int *)(param_4 + 0xc) != 0) {
      *param_3 = ';';
      memcpy(param_3 + 1,*(void **)(param_4 + 0xc),(uint)*(ushort *)(param_4 + 0x10));
      local_24 = (undefined4 *)(param_3 + 1 + *(ushort *)(param_4 + 0x10));
    }
  }
  else {
    bVar1 = (byte)*(undefined4 *)(param_4 + 4) & 0xf;
    bVar2 = (byte)(*(uint *)(param_4 + 4) >> 3) & 0x1f;
    local_9 = (byte)((uint)*(undefined4 *)(param_4 + 4) >> 8);
    if (*(int *)(&DAT_00065bf0 + (uint)bVar1 * 8) != 0) {
      *param_3 = ';';
      *(undefined4 *)(param_3 + 1) = 0x4f434e45;
      *(undefined4 *)(param_3 + 5) = 0x474e4944;
      *(undefined2 *)(param_3 + 9) = 0x3d;
      strcpy(param_3 + 10,*(char **)(&DAT_00065bf0 + (uint)bVar1 * 8));
      local_24 = (undefined4 *)(param_3 + 10 + ((byte)(&DAT_00065bf4)[(uint)bVar1 * 8] - 10));
    }
    if (*(int *)(&DAT_00065cdc + (uint)bVar2 * 8) != 0) {
      *(char *)local_24 = ';';
      *(undefined4 *)((int)local_24 + 1) = 0x52414843;
      *(undefined4 *)((int)local_24 + 5) = 0x3d544553;
      *(char *)((int)local_24 + 9) = '\0';
      strcpy((char *)((int)local_24 + 9),*(char **)(&DAT_00065cdc + (uint)bVar2 * 8));
      local_24 = (undefined4 *)
                 ((char *)((int)local_24 + 9) + ((byte)(&DAT_00065ce0)[(uint)bVar2 * 8] - 9));
    }
    if (*(int *)(param_2 + (uint)*(ushort *)(param_4 + 8) * 0xc + 4) != 0) {
      for (local_10 = 1;
          (local_9 != 0 &&
          (local_10 <=
           (int)(uint)*(byte *)(*(int *)(param_2 + (uint)*(ushort *)(param_4 + 8) * 0xc + 4) + 4)));
          local_10 = local_10 + 1) {
        if ((local_9 & 1) != 0) {
          if (bVar3) {
            *(char *)local_24 = ',';
            puVar4 = (undefined4 *)((int)local_24 + 1);
          }
          else {
            *(char *)local_24 = ';';
            puVar4 = (undefined4 *)((int)local_24 + 1);
            if (param_1 == '\x02') {
              *(undefined4 *)((int)local_24 + 1) = 0x45505954;
              *(char *)((int)local_24 + 5) = '=';
              bVar3 = true;
              puVar4 = (undefined4 *)((int)local_24 + 6);
            }
          }
          local_24 = puVar4;
          strcpy((char *)local_24,
                 *(char **)(local_10 * 8 +
                           *(int *)(param_2 + (uint)*(ushort *)(param_4 + 8) * 0xc + 4)));
          local_24 = (undefined4 *)
                     ((*(byte *)(local_10 * 8 +
                                 *(int *)(param_2 + (uint)*(ushort *)(param_4 + 8) * 0xc + 4) + 4) -
                      1) + (int)local_24);
        }
        local_9 = local_9 >> 1;
      }
    }
  }
  return (char *)local_24;
}



char * FUN_00032806(int param_1,char *param_2,int param_3)

{
  byte bVar1;
  undefined4 *puVar2;
  undefined4 *local_20;
  int local_10;
  byte local_9;
  
  local_20 = (undefined4 *)param_2;
  if (*(int *)(param_3 + 4) == 0) {
    if (*(int *)(param_3 + 0xc) != 0) {
      *param_2 = ';';
      memcpy(param_2 + 1,*(void **)(param_3 + 0xc),(uint)*(ushort *)(param_3 + 0x10));
      local_20 = (undefined4 *)(param_2 + 1 + *(ushort *)(param_3 + 0x10));
    }
  }
  else {
    bVar1 = (byte)*(undefined4 *)(param_3 + 4) & 0xf;
    local_9 = (byte)((uint)*(undefined4 *)(param_3 + 4) >> 8);
    if (*(int *)(&DAT_00065bf0 + (uint)bVar1 * 8) != 0) {
      *param_2 = ';';
      *(undefined4 *)(param_2 + 1) = 0x4f434e45;
      *(undefined4 *)(param_2 + 5) = 0x474e4944;
      *(undefined2 *)(param_2 + 9) = 0x3d;
      strcpy(param_2 + 10,*(char **)(&DAT_00065bf0 + (uint)bVar1 * 8));
      local_20 = (undefined4 *)(param_2 + 10 + ((byte)(&DAT_00065bf4)[(uint)bVar1 * 8] - 10));
    }
    if (*(int *)(param_1 + (uint)*(ushort *)(param_3 + 8) * 0xc + 4) != 0) {
      local_10 = 1;
      while( true ) {
        if (local_9 == 0) {
          return (char *)local_20;
        }
        if ((int)(uint)*(byte *)(*(int *)(param_1 + (uint)*(ushort *)(param_3 + 8) * 0xc + 4) + 4) <
            local_10) {
          return (char *)local_20;
        }
        if ((local_9 & 1) != 0) break;
        local_9 = local_9 >> 1;
        local_10 = local_10 + 1;
      }
      *(char *)local_20 = ';';
      puVar2 = (undefined4 *)((int)local_20 + 1);
      if (2 < local_10) {
        *(undefined4 *)((int)local_20 + 1) = 0x45505954;
        *(char *)((int)local_20 + 5) = '=';
        puVar2 = (undefined4 *)((int)local_20 + 6);
      }
      local_20 = puVar2;
      strcpy((char *)local_20,
             *(char **)(local_10 * 8 + *(int *)(param_1 + (uint)*(ushort *)(param_3 + 8) * 0xc + 4))
            );
      local_20 = (undefined4 *)
                 ((*(byte *)(local_10 * 8 +
                             *(int *)(param_1 + (uint)*(ushort *)(param_3 + 8) * 0xc + 4) + 4) - 1)
                 + (int)local_20);
    }
  }
  return (char *)local_20;
}



undefined FUN_000329a0(int param_1,byte *param_2,int param_3,char param_4)

{
  int iVar1;
  uint uVar2;
  char local_25;
  int local_c;
  
  local_c = 0;
  local_25 = param_4;
  while( true ) {
    if (local_25 == '\0') {
      return 1;
    }
    if ((*(short *)(param_3 + local_c * 0x14 + 8) == 0) ||
       ((ushort)*(byte *)(param_1 + 8) < *(ushort *)(param_3 + local_c * 0x14 + 8))) break;
    uVar2 = (uint)*(ushort *)(param_3 + local_c * 0x14 + 8);
    iVar1 = FUN_000323a8(*(byte **)(param_1 + uVar2 * 0xc),param_2,
                         *(byte *)(param_1 + uVar2 * 0xc + 8) - 3);
    if (iVar1 == 0) {
      return 0;
    }
    local_25 = local_25 + -1;
    local_c = local_c + 1;
  }
  return 1;
}



undefined FUN_00032a5a(int param_1,byte *param_2,int param_3,char param_4,void *param_5,
                      undefined2 *param_6)

{
  int iVar1;
  uint uVar2;
  char local_25;
  int local_c;
  
  local_c = 0;
  local_25 = param_4;
  while( true ) {
    if (local_25 == '\0') {
      return 1;
    }
    if ((*(short *)(param_3 + local_c * 0x14 + 8) == 0) ||
       ((ushort)*(byte *)(param_1 + 8) < *(ushort *)(param_3 + local_c * 0x14 + 8))) break;
    uVar2 = (uint)*(ushort *)(param_3 + local_c * 0x14 + 8);
    iVar1 = FUN_000323a8(*(byte **)(param_1 + uVar2 * 0xc),param_2,
                         *(byte *)(param_1 + uVar2 * 0xc + 8) - 3);
    if (iVar1 == 0) {
      memcpy(param_5,*(void **)(param_3 + local_c * 0x14),
             (uint)*(ushort *)(param_3 + local_c * 0x14 + 10));
      *(undefined *)((int)param_5 + (uint)*(ushort *)(param_3 + local_c * 0x14 + 10)) = 0;
      *param_6 = *(undefined2 *)(param_3 + local_c * 0x14 + 10);
      return 0;
    }
    local_25 = local_25 + -1;
    local_c = local_c + 1;
  }
  return 1;
}



undefined FUN_00032b72(int *param_1,char *param_2,ushort *param_3,int param_4,char param_5)

{
  bool bVar1;
  short sVar2;
  int iVar3;
  char *pcVar4;
  char *local_20;
  undefined local_19;
  int local_18;
  int local_14;
  
  local_19 = 0;
  if (*param_3 < (ushort)*(byte *)((int)param_1 + 0x12)) {
    local_19 = 2;
    local_20 = param_2;
  }
  else {
    *param_3 = *param_3 - (ushort)*(byte *)((int)param_1 + 0x12);
    strcpy(param_2,(char *)param_1[2]);
    local_20 = param_2 + *(byte *)(param_1 + 4);
    local_14 = 0;
    for (; param_5 != '\0'; param_5 = param_5 + -1) {
      if ((*(short *)(param_4 + local_14 * 0x14 + 8) == 0) ||
         ((ushort)*(byte *)(*param_1 + 8) < *(ushort *)(param_4 + local_14 * 0x14 + 8))) {
        local_19 = 1;
        break;
      }
      sVar2 = FUN_0003243c(*param_1,param_4 + local_14 * 0x14);
      if ((int)(param_2 + (((uint)*param_3 + (uint)*(byte *)(param_1 + 4)) - (int)local_20)) <
          (int)sVar2) {
        local_19 = 2;
        break;
      }
      if ((((((DAT_00085ac8 | DAT_00085acc) == 0) || (param_1[5] == 0)) ||
           ((ushort)*(byte *)(param_1[5] + 4) < *(ushort *)(param_4 + local_14 * 0x14 + 8))) ||
          ((DAT_00085ac8 &
           *(uint *)((uint)*(ushort *)(param_4 + local_14 * 0x14 + 8) * 4 + *(int *)param_1[5])) !=
           0)) && ((bVar1 = FUN_0003254c(*(char *)(param_1 + 1),param_4 + local_14 * 0x14), !bVar1
                   && (*(short *)(param_4 + local_14 * 0x14 + 10) != 0)))) {
        strcpy(local_20,*(char **)((uint)*(ushort *)(param_4 + local_14 * 0x14 + 8) * 0xc + *param_1
                                  ));
        local_20 = local_20 +
                   (*(byte *)((uint)*(ushort *)(param_4 + local_14 * 0x14 + 8) * 0xc + *param_1 + 8)
                   - 3);
        for (local_18 = 2; 0 < local_18; local_18 = local_18 + -1) {
          iVar3 = FUN_000323a8(*(byte **)(&UNK_00065d74 + local_18 * 8),
                               *(byte **)((uint)*(ushort *)(param_4 + local_14 * 0x14 + 8) * 0xc +
                                         *param_1),(uint)(byte)(&UNK_00065d78)[local_18 * 8]);
          if (iVar3 == 0) {
            local_20 = FUN_00032806(*param_1,local_20,param_4 + local_14 * 0x14);
            break;
          }
        }
        if (local_18 == 0) {
          local_20 = FUN_000325dc(*(char *)(param_1 + 1),*param_1,local_20,param_4 + local_14 * 0x14
                                 );
        }
        *local_20 = ':';
        memcpy(local_20 + 1,*(void **)(param_4 + local_14 * 0x14),
               (uint)*(ushort *)(param_4 + local_14 * 0x14 + 10));
        pcVar4 = local_20 + 1 + *(ushort *)(param_4 + local_14 * 0x14 + 10);
        *pcVar4 = '\r';
        local_20 = pcVar4 + 2;
        pcVar4[1] = '\n';
      }
      local_14 = local_14 + 1;
    }
    memcpy(local_20,(void *)param_1[3],(uint)*(byte *)((int)param_1 + 0x11));
    local_20 = local_20 + *(byte *)((int)param_1 + 0x11);
  }
  *param_3 = (short)local_20 - (short)param_2;
  return local_19;
}



char * FUN_00032eac(char *param_1,int param_2,char param_3)

{
  char *pcVar1;
  char *local_c;
  
  if ((*param_1 == '\r') && (param_1[1] == '\n')) {
    local_c = param_1 + 2;
  }
  else if (param_2 - (int)param_1 < 4) {
LAB_00032f30:
    local_c = (char *)0x0;
  }
  else {
    pcVar1 = param_1;
    do {
      local_c = pcVar1;
      if ((char *)(param_2 + -3) <= local_c) goto LAB_00032f30;
      pcVar1 = local_c + 1;
    } while ((((*pcVar1 != '\r') || (local_c[2] != '\n')) ||
             ((param_3 != '\0' && (*local_c == '=')))) ||
            ((local_c[3] == ' ' || (local_c[3] == '\t'))));
    local_c = local_c + 3;
  }
  return local_c;
}



char * FUN_00032f3e(char *param_1,char *param_2,char *param_3)

{
  size_t sVar1;
  char *local_14;
  int local_c;
  
  sVar1 = strlen(param_3);
  local_14 = param_1;
  do {
    if (param_2 <= local_14) {
      return (char *)0x0;
    }
    for (local_c = 0; local_c < (int)(sVar1 & 0xff); local_c = local_c + 1) {
      if (*local_14 == param_3[local_c]) {
        return local_14;
      }
    }
    local_14 = local_14 + 1;
  } while( true );
}



char * FUN_00032f96(char *param_1,char *param_2)

{
  char *local_1c;
  int local_10;
  int local_c;
  
  local_c = 0;
  local_10 = 0;
  local_1c = param_1;
  while( true ) {
    if (param_2 <= local_1c) {
      return (char *)0x0;
    }
    if (((*local_1c == ';') || (*local_1c == ':')) || (*local_1c == '.')) break;
    if (((*local_1c == '\r') && (local_1c[1] == '\n')) &&
       ((local_1c[2] != ' ' && (local_1c[2] != '\t')))) {
      local_1c = local_1c + 1;
      local_10 = local_c + 2;
      if (1 < appl_trace_level) {
        LogMsg_0(0x501,"Skip one line");
      }
      local_c = local_c + 1;
    }
    local_c = local_c + 1;
    local_1c = local_1c + 1;
  }
  return param_1 + local_10;
}



char * FUN_00033042(char *param_1,int param_2,char *param_3)

{
  size_t __n;
  int iVar1;
  char *local_14;
  
  __n = strlen(param_3);
  local_14 = param_1;
  do {
    iVar1 = strncmp(local_14,param_3,__n);
    if (iVar1 == 0) {
      return local_14 + __n;
    }
    local_14 = FUN_00032eac(local_14,param_2,'\0');
  } while (local_14 != (char *)0x0);
  return (char *)0x0;
}



short FUN_00033094(char *param_1,char *param_2)

{
  char *local_14;
  short local_a;
  
  local_a = 1;
  local_14 = param_1;
  while( true ) {
    if (param_2 <= local_14) {
      return local_a;
    }
    if ((((*local_14 == '\r') && (local_14[1] == '\n')) && (local_14[2] != ' ')) &&
       ((local_14[2] != '\t' && (local_14[2] != '\r')))) break;
    local_a = local_a + 1;
    local_14 = local_14 + 1;
  }
  return local_a + 1;
}



undefined FUN_00033100(int *param_1,int param_2,byte *param_3,char *param_4,uint param_5)

{
  byte bVar1;
  byte bVar2;
  short sVar3;
  char *pcVar4;
  int iVar5;
  undefined uVar6;
  char *pcVar7;
  byte *pbVar8;
  bool local_1e;
  byte local_1d;
  char *local_1c;
  byte *local_18;
  uint local_14;
  
  bVar1 = *param_3;
  pcVar7 = param_4 + param_5;
  local_1d = 0;
  local_1e = false;
  *param_3 = 0;
  if (param_5 < *(byte *)((int)param_1 + 0x12)) {
    uVar6 = 1;
  }
  else {
    local_18 = (byte *)FUN_00033042(param_4,(int)pcVar7,(char *)param_1[2]);
    if (local_18 == (byte *)0x0) {
      uVar6 = 1;
    }
    else {
LAB_00033634:
      do {
        if (((bVar1 <= *param_3) ||
            (local_18 = (byte *)FUN_00032f96((char *)local_18,pcVar7), local_18 == (byte *)0x0)) ||
           (local_1c = FUN_00032f3e((char *)local_18,pcVar7,".;:"), local_1c == (char *)0x0)) break;
        if (*local_1c == '.') {
          local_18 = (byte *)(local_1c + 1);
          local_1c = FUN_00032f3e((char *)local_18,pcVar7,";:");
          if (local_1c == (char *)0x0) break;
        }
        for (local_14 = 1; local_14 <= *(byte *)(*param_1 + 8); local_14 = local_14 + 1) {
          iVar5 = FUN_000323a8(*(byte **)(local_14 * 0xc + *param_1),local_18,
                               *(byte *)(local_14 * 0xc + *param_1 + 8) - 3);
          if (iVar5 == 0) {
            local_1d = (byte)local_14;
            *(ushort *)(param_2 + (uint)*param_3 * 0x14 + 8) = (ushort)local_1d;
            *(undefined4 *)(param_2 + (uint)*param_3 * 0x14 + 4) = 0;
            break;
          }
        }
        if (local_14 <= *(byte *)(*param_1 + 8)) {
          pcVar4 = local_1c;
          if (*local_1c == ';') {
LAB_0003353a:
            if ((*local_1c == ';') || (pcVar4 = local_1c, *local_1c == ',')) {
              local_18 = (byte *)(local_1c + 1);
              pcVar4 = FUN_00032f3e((char *)local_18,pcVar7,",;:");
              if (pcVar4 == (char *)0x0) goto LAB_00033552;
              local_1e = false;
              iVar5 = FUN_000323a8((byte *)"ENCODING=",local_18,9);
              if (iVar5 == 0) {
                pbVar8 = (byte *)(local_1c + 10);
                for (local_14 = 1; local_1c = pcVar4, local_14 < 5; local_14 = local_14 + 1) {
                  iVar5 = FUN_000323a8(*(byte **)(&DAT_00065bf0 + local_14 * 8),pbVar8,
                                       (byte)(&DAT_00065bf4)[local_14 * 8] - 10);
                  if (iVar5 == 0) {
                    local_1e = local_14 == 1;
                    *(uint *)((uint)*param_3 * 0x14 + param_2 + 4) =
                         local_14 | *(uint *)(param_2 + (uint)*param_3 * 0x14 + 4);
                    break;
                  }
                }
              }
              else {
                iVar5 = FUN_000323a8((byte *)"CHARSET=",local_18,8);
                if (iVar5 == 0) {
                  pbVar8 = (byte *)(local_1c + 9);
                  for (local_14 = 1; local_1c = pcVar4, local_14 < 0x11; local_14 = local_14 + 1) {
                    iVar5 = FUN_000323a8(*(byte **)(&DAT_00065cdc + local_14 * 8),pbVar8,
                                         (byte)(&DAT_00065ce0)[local_14 * 8] - 9);
                    if (iVar5 == 0) {
                      *(uint *)((uint)*param_3 * 0x14 + param_2 + 4) =
                           local_14 << 3 | *(uint *)(param_2 + (uint)*param_3 * 0x14 + 4);
                      break;
                    }
                  }
                }
                else if (*(int *)((uint)local_1d * 0xc + *param_1 + 4) == 0) {
                  if (*(int *)(param_2 + (uint)*param_3 * 0x14 + 0xc) == 0) {
                    *(byte **)(param_2 + (uint)*param_3 * 0x14 + 0xc) = local_18;
                  }
                  if (*pcVar4 == ':') {
                    *(short *)((uint)*param_3 * 0x14 + param_2 + 0x10) =
                         ((short)pcVar4 - (short)local_18) +
                         *(short *)(param_2 + (uint)*param_3 * 0x14 + 0x10);
                    local_1c = pcVar4;
                  }
                  else {
                    *(short *)((uint)*param_3 * 0x14 + param_2 + 0x10) =
                         ((short)pcVar4 - (short)local_18) +
                         *(short *)(param_2 + (uint)*param_3 * 0x14 + 0x10) + 1;
                    local_1c = pcVar4;
                  }
                }
                else {
                  iVar5 = FUN_000323a8(local_18,(byte *)"TYPE=",5);
                  if (iVar5 == 0) {
                    local_18 = (byte *)(local_1c + 6);
                  }
                  for (local_14 = (uint)*(byte *)(*(int *)((uint)local_1d * 0xc + *param_1 + 4) + 4)
                      ; local_1c = pcVar4, local_14 != 0; local_14 = local_14 - 1) {
                    iVar5 = FUN_000323a8(*(byte **)(local_14 * 8 +
                                                   *(int *)((uint)local_1d * 0xc + *param_1 + 4)),
                                         local_18,*(byte *)(local_14 * 8 +
                                                            *(int *)((uint)local_1d * 0xc + *param_1
                                                                    + 4) + 4) - 1);
                    if (iVar5 == 0) {
                      *(uint *)((uint)*param_3 * 0x14 + param_2 + 4) =
                           1 << (local_14 + 7 & 0xff) |
                           *(uint *)(param_2 + (uint)*param_3 * 0x14 + 4);
                      break;
                    }
                  }
                }
              }
              goto LAB_0003353a;
            }
          }
LAB_00033552:
          local_1c = pcVar4;
          if (local_1c == (char *)0x0) break;
          local_1c = local_1c + 1;
          local_18 = (byte *)FUN_00032eac(local_1c,(int)pcVar7,local_1e);
          if (local_18 == (byte *)0x0) break;
          *(char **)(param_2 + (uint)*param_3 * 0x14) = local_1c;
          *(short *)(param_2 + (uint)*param_3 * 0x14 + 10) =
               ((short)local_18 - (short)local_1c) + -2;
          bVar2 = (byte)*(undefined4 *)(param_2 + (uint)*param_3 * 0x14 + 4) & 0xf;
          if (((*(int *)(&DAT_00065bf0 + (uint)bVar2 * 8) != 0) &&
              (iVar5 = strcmp(*(char **)(&DAT_00065bf0 + (uint)bVar2 * 8),"BASE64"), iVar5 == 0)) &&
             (local_1d == 0x11)) {
            bVar2 = *param_3;
            sVar3 = FUN_00033094((char *)local_18,pcVar7);
            *(short *)(param_2 + (uint)bVar2 * 0x14 + 10) = sVar3;
          }
          *param_3 = *param_3 + 1;
          goto LAB_00033634;
        }
        local_18 = (byte *)FUN_00032eac(local_1c,(int)pcVar7,'\0');
      } while (local_18 != (byte *)0x0);
      uVar6 = 0;
    }
  }
  return uVar6;
}



int FUN_00033662(pthread_mutex_t *param_1)

{
  int iVar1;
  
  iVar1 = pthread_mutex_init(param_1,(pthread_mutexattr_t *)0x0);
  if (iVar1 != 0) {
    perror("app_init_mutex pthread_mutex_init failed Reason:");
  }
  return iVar1;
}



undefined4 FUN_00033694(pthread_mutex_t *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = pthread_mutex_destroy(param_1);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    perror("app_delete_mutex pthread_mutex_destroy failure while destroying Reason:");
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_000336c6(pthread_mutex_t *param_1)

{
  int iVar1;
  
  iVar1 = pthread_mutex_lock(param_1);
  if (iVar1 != 0) {
    perror("app_lock_mutex pthread_mutex_lock failure Reason:");
  }
  return iVar1;
}



int FUN_000336f2(pthread_mutex_t *param_1)

{
  int iVar1;
  
  iVar1 = pthread_mutex_unlock(param_1);
  if (iVar1 != 0) {
    perror("app_unlock_mutex pthread_mutex_unlock failure Reason:");
  }
  return iVar1;
}



void FUN_0003371e(int param_1,undefined *param_2)

{
  int iVar1;
  undefined auStack_98 [132];
  
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_callback",0x37);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,
                     "BSA_DM_3D_ANNOUCEMENT_EVT BdAddr:%02X-%02X-%02X-%02X-%02X-%02X",*param_2,
                     param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    if ((param_2[6] & 1) == 0) {
      if ((param_2[6] & 2) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                  ,"app_3dtv_callback",0x42);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_98,"\t3DG Connection Announcement Type:0x%X",param_2[6]);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                  ,"app_3dtv_callback",0x3e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_98,"\t3DG Battery Report Type:0x%X",param_2[6]);
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_callback",0x3a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_98,"\t3DG Association Notification Type:0x%X",param_2[6]);
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_callback",0x46);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tBattery Level:0x%X(%d)",param_2[7],param_2[7]);
    }
    if ((*(short *)(param_2 + 8) != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                  ,"app_3dtv_callback",0x49), iVar1 != 0)) {
      duss_log_print(0x5c,3,auStack_98,"\tAdditionnal Data Length:%d",*(undefined2 *)(param_2 + 8));
    }
  }
  return;
}



undefined4 FUN_0003397e(undefined *param_1)

{
  memset(param_1,0,1);
  *param_1 = 1;
  return 0;
}



undefined4 FUN_000339a0(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  byte local_112;
  undefined auStack_111 [257];
  undefined *local_10;
  short local_c;
  byte local_9;
  
  local_9 = 0;
  local_c = BSA_TmVscInit(&local_118);
  local_118 = 0xf4;
  local_116 = 1;
  if (*param_1 != '\0') {
    local_9 = local_9 | 1;
  }
  local_10 = auStack_111;
  local_112 = local_9;
  local_c = BSA_TmVsc(&local_118);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_set_dual_mode",0xb3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"BSA_TmVsc failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00033a70(void *param_1)

{
  memset(param_1,0,4);
  *(undefined *)((int)param_1 + 2) = DAT_0008a810;
  return 0;
}



undefined4 FUN_00033a9a(ushort *param_1)

{
  int iVar1;
  undefined auStack_424 [128];
  uint local_3a4;
  undefined local_3a0;
  char acStack_397 [248];
  undefined local_29f;
  undefined local_293;
  undefined4 local_288;
  ushort local_282;
  short local_e;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  if (param_1 == (ushort *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_set_idle_mode",0xdf);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"Null p_req parameter");
    }
  }
  else {
    BSA_DmSetConfigInit(&local_3a4);
    local_3a0 = 1;
    local_3a4 = 4;
    strncpy(acStack_397,"BSA IdleTV",0xf8);
    local_29f = 0;
    local_3a4 = local_3a4 | 0x20;
    local_293 = *(undefined *)(param_1 + 1);
    local_282 = *param_1 & 0xfffc;
    local_288 = 0x3371f;
    local_e = BSA_DmSetConfig(&local_3a4);
    if (local_e == 0) {
      DAT_0008a814 = 0;
      local_c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_set_idle_mode",0x104);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed status:%d ",local_e);
      }
      local_c = 0xffffffff;
    }
  }
  return local_c;
}



undefined4 FUN_00033c2c(void *param_1)

{
  memset(param_1,0,4);
  *(undefined *)((int)param_1 + 2) = DAT_0008a810;
  return 0;
}



undefined4 FUN_00033c56(ushort *param_1)

{
  int iVar1;
  undefined auStack_424 [128];
  uint local_3a4;
  undefined local_3a0;
  char acStack_397 [248];
  undefined local_29f;
  undefined local_293;
  undefined4 local_288;
  ushort local_282;
  short local_e;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  if (param_1 == (ushort *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_set_master_mode",0x133);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"Null p_req parameter");
    }
  }
  else {
    BSA_DmSetConfigInit(&local_3a4);
    local_3a0 = 1;
    local_3a4 = 4;
    strncpy(acStack_397,"BSA MasterTV",0xf8);
    local_29f = 0;
    local_3a4 = local_3a4 | 0x20;
    local_293 = *(undefined *)(param_1 + 1);
    local_282 = *param_1 & 0xfffd | 1;
    local_288 = 0x3371f;
    local_e = BSA_DmSetConfig(&local_3a4);
    if (local_e == 0) {
      DAT_0008a814 = 1;
      local_c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_set_master_mode",0x158);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed status:%d ",local_e);
      }
      local_c = 0xffffffff;
    }
  }
  return local_c;
}



undefined4 FUN_00033dea(void *param_1)

{
  memset(param_1,0,10);
  *(undefined *)((int)param_1 + 8) = DAT_0008a810;
  return 0;
}



undefined4 FUN_00033e14(ushort *param_1)

{
  int iVar1;
  undefined auStack_424 [128];
  uint local_3a4;
  undefined local_3a0;
  char acStack_397 [248];
  undefined local_29f;
  undefined auStack_299 [6];
  undefined local_293;
  undefined4 local_288;
  ushort local_282;
  short local_e;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  if (param_1 == (ushort *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_set_slave_mode",0x187);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"Null p_req parameter");
    }
  }
  else {
    BSA_DmSetConfigInit(&local_3a4);
    local_3a0 = 1;
    local_3a4 = 4;
    strncpy(acStack_397,"BSA SlaveTV",0xf8);
    local_29f = 0;
    local_3a4 = local_3a4 | 0x20;
    local_293 = *(undefined *)(param_1 + 4);
    local_282 = *param_1 & 0xfffe | 2;
    bdcpy(auStack_299,param_1 + 1);
    local_288 = 0x3371f;
    local_e = BSA_DmSetConfig(&local_3a4);
    if (local_e == 0) {
      DAT_0008a814 = 2;
      local_c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_set_slave_mode",0x1b2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed status:%d ",local_e);
      }
      local_c = 0xffffffff;
    }
  }
  return local_c;
}



undefined4 FUN_00033fbe(void *param_1)

{
  memset(param_1,0,0xc);
  return 0;
}



undefined4 FUN_00033fda(undefined2 *param_1)

{
  int iVar1;
  undefined auStack_424 [128];
  undefined4 local_3a4;
  undefined local_3a0;
  undefined4 local_288;
  undefined2 local_282;
  undefined2 local_1b6;
  undefined2 local_1b4;
  undefined2 local_1b2;
  undefined2 local_1b0;
  undefined2 local_1ae;
  undefined local_1ac;
  short local_e;
  undefined4 local_c;
  
  local_c = 0xffffffff;
  if (param_1 == (undefined2 *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_send_tx_data",0x1e0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"Null p_req parameter");
    }
  }
  else {
    BSA_DmSetConfigInit(&local_3a4);
    local_3a0 = 1;
    local_3a4 = 0x20;
    local_282 = 0x100;
    local_1b6 = *param_1;
    local_1b4 = param_1[1];
    local_1b2 = param_1[2];
    local_1b0 = param_1[3];
    local_1ae = param_1[4];
    local_1ac = *(undefined *)(param_1 + 5);
    local_288 = 0x3371f;
    local_e = BSA_DmSetConfig(&local_3a4);
    if (local_e == 0) {
      local_c = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_send_tx_data",0x202);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed status:%d ",local_e);
      }
      local_c = 0xffffffff;
    }
  }
  return local_c;
}



undefined4 FUN_0003413a(void *param_1)

{
  memset(param_1,0,0xc);
  *(undefined *)((int)param_1 + 0xb) = 0x11;
  return 0;
}



undefined4 FUN_0003415c(undefined2 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  short local_114;
  char local_112;
  undefined local_111;
  undefined local_110;
  undefined local_10f;
  undefined local_10e;
  undefined local_10d;
  undefined local_10c;
  undefined local_10b;
  undefined local_10a;
  undefined local_109;
  undefined local_108;
  undefined local_107;
  undefined auStack_106 [246];
  undefined *local_10;
  short local_a;
  
  if (param_1 == (undefined2 *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_set_beacon",0x22f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"Null p_req parameter");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_a = BSA_TmVscInit(&local_118);
    local_118 = 0xd6;
    local_116 = 0xc;
    local_112 = *(char *)((int)param_1 + 0xb);
    local_111 = (undefined)*param_1;
    local_110 = (undefined)((ushort)*param_1 >> 8);
    local_10f = (undefined)param_1[1];
    local_10e = (undefined)((ushort)param_1[1] >> 8);
    local_10d = (undefined)param_1[2];
    local_10c = (undefined)((ushort)param_1[2] >> 8);
    local_10b = (undefined)param_1[3];
    local_10a = (undefined)((ushort)param_1[3] >> 8);
    local_109 = (undefined)param_1[4];
    local_108 = (undefined)((ushort)param_1[4] >> 8);
    local_10 = auStack_106;
    local_107 = *(undefined *)(param_1 + 5);
    local_a = BSA_TmVsc(&local_118);
    if (local_a == 0) {
      if ((local_114 == 0) && (local_112 == '\0')) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                  ,"app_3dtv_set_beacon",0x268);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_198,"Unable to Set 3D offsets status:%d hic_status:%d",
                         local_114,local_112);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_set_beacon",0x261);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_198,"BSA_TmVsc failed status:%d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000343c0(char param_1)

{
  char *pcVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_194 [128];
  undefined2 local_114;
  undefined2 local_112;
  short local_110;
  char local_10e [256];
  short local_e;
  char *local_c;
  
  local_c = local_10e;
  local_e = BSA_TmVscInit(&local_114);
  local_114 = 0xe3;
  local_112 = 1;
  if (param_1 == '\0') {
    pcVar1 = local_c + 1;
    *local_c = '\0';
    local_c = pcVar1;
  }
  else {
    pcVar1 = local_c + 1;
    *local_c = '\x01';
    local_c = pcVar1;
  }
  local_e = BSA_TmVsc(&local_114);
  if (local_e == 0) {
    if ((local_110 == 0) && (local_10e[0] == '\0')) {
      uVar3 = 0;
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_194,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                                ,"app_3dtv_enable_vsync_detection",0x29d);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_194,"Bad HCI Return code");
      }
      uVar3 = 0xffffffff;
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_194,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_3dtv.c"
                              ,"app_3dtv_enable_vsync_detection",0x297);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_194,"Unable to Send VSC status:%d",local_e);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



uint FUN_000344ea(char param_1)

{
  int iVar1;
  uint uVar2;
  char local_191;
  undefined auStack_190 [128];
  undefined2 local_110;
  undefined2 local_10e;
  short local_10c;
  char local_10a;
  char local_109;
  byte local_108;
  short local_a;
  
  local_191 = param_1;
  if (param_1 == -1) {
    iVar1 = FUN_0002f22c("Enter GPIO Number");
    local_191 = (char)iVar1;
  }
  local_a = BSA_TmVscInit(&local_110);
  local_110 = 0x1a;
  local_10e = 1;
  local_10a = local_191;
  local_a = BSA_TmVsc(&local_110);
  if (local_a == 0) {
    if (local_10c == 0) {
      if (local_191 == local_109) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_190,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_gpio.c"
                                  ,"app_gpio_read",0x4e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_190,"GPIO Value:%d",local_108);
        }
        uVar2 = (uint)local_108;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_gpio.c"
                                  ,"app_gpio_read",0x4b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_190,"Bad GPIO number returned:%d",local_109);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_gpio.c"
                                ,"app_gpio_read",0x46);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_190,"Bad HCI Return code");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_gpio.c"
                              ,"app_gpio_read",0x34);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_190,"Unable to Send VSC status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_000346a2(int param_1,undefined2 *param_2)

{
  int iVar1;
  undefined auStack_8c [131];
  char local_9;
  
  local_9 = '\0';
  if (DAT_0008a818 != (code *)0x0) {
    local_9 = (*DAT_0008a818)(param_1,param_2);
  }
  if (local_9 == '\0') {
    if (param_1 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                                ,"app_mgt_generic_callback",0x4d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_8c,"app_mgt_generic_callback BSA_MGT_DISCONNECT_EVT reason:%d"
                       ,*param_2);
      }
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                                ,"app_mgt_generic_callback",0x4e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"Bluetooth disconnect with server, %d",*param_2);
      }
    }
    else if (param_1 == 1) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                                ,"app_mgt_generic_callback",0x40);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_8c,"app_mgt_generic_callback BSA_MGT_STATUS_EVT");
      }
      if (*(char *)param_2 == '\0') {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                                  ,"app_mgt_generic_callback",0x43);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"Bluetooth Stopped");
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                                  ,"app_mgt_generic_callback",0x47);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"Bluetooth restarted");
        }
      }
    }
  }
  return;
}



undefined4 FUN_00034858(void)

{
  memset(&DAT_0008a818,0,4);
  return 0;
}



undefined4 FUN_00034872(char *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_f8 [128];
  char acStack_78 [99];
  undefined local_15;
  undefined4 local_14;
  int local_10;
  short local_a;
  
  BSA_MgtOpenInit(acStack_78);
  if (param_1 == (char *)0x0) {
    strncpy(acStack_78,"/tmp/EMMC/wireless/bluetooth/",99);
  }
  else {
    strncpy(acStack_78,param_1,99);
  }
  local_15 = 0;
  local_14 = 0x346a3;
  local_10 = 0;
  DAT_0008a818 = param_2;
  while ((local_10 < 0xf && (local_a = BSA_MgtOpen(acStack_78), local_a != 0))) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                              ,"app_mgt_open",0x94);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_f8,
                     "Connection to server unsuccessful (%d), bsa_status: %d retrying...",local_10,
                     local_a);
    }
    GKI_delay(300);
    local_10 = local_10 + 1;
  }
  if (local_a == 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                              ,"app_mgt_open",0x9d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_f8,"Connect to bsa_server success");
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                              ,"app_mgt_open",0x99);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_f8,"Unable to connect to server %d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000349fc(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [6];
  short local_a;
  
  BSA_MgtCloseInit(auStack_10);
  local_a = BSA_MgtClose(auStack_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_mgt.c"
                              ,"app_mgt_close",0xb7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_MgtClose failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00034a76(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c [4];
  
  iVar1 = BSA_MgtKillServerInit(auStack_c);
  if ((iVar1 == 0) && (iVar1 = BSA_MgtKillServer(auStack_c), iVar1 == 0)) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined * FUN_00034aa8(undefined4 param_1)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (9 < local_c) {
      return (undefined *)0x0;
    }
    if (((&DAT_0008a81c)[local_c * 0xb] != '\0') &&
       (iVar1 = bdcmp(local_c * 0xb + 0x8a820,param_1), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return &DAT_0008a81c + local_c * 0xb;
}



undefined4 FUN_00034bf6(undefined4 param_1,undefined *param_2)

{
  undefined *puVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_8c [128];
  int local_c;
  
  puVar1 = FUN_00034aa8(param_1);
  if (puVar1 == (undefined *)0x0) {
    for (local_c = 0; (local_c < 10 && ((&DAT_0008a81c)[local_c * 0xb] != '\0'));
        local_c = local_c + 1) {
    }
    if (local_c < 10) {
      (&DAT_0008a81c)[local_c * 0xb] = 1;
      (&DAT_0008a826)[local_c * 0xb] = 0;
      bdcpy(local_c * 0xb + 0x8a820,param_1);
      (&DAT_0008a81d)[local_c * 0xb] = *param_2;
      (&DAT_0008a81e)[local_c * 0xb] = param_2[1];
      (&DAT_0008a81f)[local_c * 0xb] = param_2[2];
      FUN_00034e22();
      uVar3 = 0;
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                                ,"app_link_add",0x81);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"Database full");
      }
      uVar3 = 0xffffffff;
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                              ,"app_link_add",0x73);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"This device is already in the database");
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_00034dac(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined *local_c;
  
  local_c = FUN_00034aa8(param_1);
  if (local_c == (undefined *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                              ,"app_link_remove",0xa9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"This device is not in the database");
    }
    uVar2 = 0xffffffff;
  }
  else {
    *local_c = 0;
    FUN_00034e22();
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_00034e22(void)

{
  int local_c;
  
  for (local_c = 0; local_c < 10; local_c = local_c + 1) {
  }
  return;
}



undefined4 FUN_00034e6a(undefined4 param_1,undefined *param_2)

{
  undefined *puVar1;
  undefined4 uVar2;
  
  puVar1 = FUN_00034aa8(param_1);
  if (puVar1 == (undefined *)0x0) {
    *param_2 = 0;
    param_2[1] = 0;
    param_2[2] = 0;
    FUN_00034e22();
    uVar2 = 0xffffffff;
  }
  else {
    *param_2 = puVar1[1];
    param_2[1] = puVar1[2];
    param_2[2] = puVar1[3];
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_00034ec8(undefined4 param_1,undefined param_2)

{
  undefined *puVar1;
  undefined4 uVar2;
  
  puVar1 = FUN_00034aa8(param_1);
  if (puVar1 == (undefined *)0x0) {
    uVar2 = 0xffffffff;
  }
  else {
    puVar1[10] = param_2;
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_00034ef8(undefined4 param_1)

{
  undefined *puVar1;
  undefined4 uVar2;
  
  puVar1 = FUN_00034aa8(param_1);
  if (puVar1 == (undefined *)0x0) {
    uVar2 = 0xffffffff;
  }
  else if (puVar1[10] == '\0') {
    uVar2 = 0;
  }
  else {
    uVar2 = 1;
  }
  return uVar2;
}



undefined4 FUN_00034f2a(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  char *local_c;
  
  if (param_2 == 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                              ,"app_link_get_bd_addr_from_index",0x160);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Null BdAddr pointer");
    }
    uVar2 = 0xffffffff;
  }
  else if ((param_1 < 0) || (9 < param_1)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                              ,"app_link_get_bd_addr_from_index",0x166);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Bad Index:%d",param_1);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_c = &DAT_0008a81c + param_1 * 0xb;
    if (*local_c == '\0') {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_common/source/app_link.c"
                                ,"app_link_get_bd_addr_from_index",0x16e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"Device Index:%d is not connected",param_1);
      }
      uVar2 = 0xffffffff;
    }
    else {
      bdcpy(param_2,param_1 * 0xb + 0x8a820);
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 FUN_000350b0(void)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined auStack_90 [128];
  int local_10;
  char *local_c;
  
  local_c = "/tmp/EMMC/wireless/bluetooth/bt_config.xml";
  iVar1 = access("/tmp/EMMC/wireless/bluetooth/bt_config.xml",0);
  if (iVar1 != 0) {
    local_c = "/etc/bt_config.xml";
  }
  while( true ) {
    local_10 = FUN_0002b4a4(local_c,&DAT_0008a8c8);
    if (local_10 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_read_config",0x6c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"app_xml_read_cfg failed:%d",local_10);
      }
      return 0xffffffff;
    }
    if (DAT_0008a8c8 != '\0') break;
    pcVar2 = (char *)duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                       "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                       ,"app_mgr_read_config",0x72);
    if (pcVar2 != (char *)0x0) {
      pcVar2 = "not enable, assert on config";
      duss_log_print(0x5c,1,auStack_90);
    }
    FUN_0001ef6a('\0',"rm %s","/tmp/EMMC/wireless/bluetooth/bt_config.xml",pcVar2);
    local_c = "/etc/bt_config.xml";
  }
  uVar3 = FUN_000351be();
  return uVar3;
}



undefined4 FUN_000351be(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  FUN_00039728((undefined4 *)&DAT_0008a8d1);
  FUN_00039712(&DAT_0008a8cb);
  local_c = FUN_0002bdb2("/tmp/EMMC/wireless/bluetooth/bt_config.xml",&DAT_0008a8c8);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_write_config",0xa2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_write_cfg failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_0003524c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int local_10;
  int local_c;
  
  for (local_c = 0; local_c < 10; local_c = local_c + 1) {
    (&DAT_000896e8)[local_c * 0x1b0] = 0;
  }
  local_10 = FUN_0002b742("/tmp/EMMC/wireless/bluetooth/bt_devices.xml",&DAT_000896e8,10);
  if (local_10 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_remote_devices",0xce);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"app_xml_read_db failed:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_000352fa(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0002c158("/tmp/EMMC/wireless/bluetooth/bt_devices.xml",&DAT_000896e8,10);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_write_remote_devices",0xe6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_xml_write_db failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_00035374(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_424 [128];
  undefined auStack_3a4 [4];
  undefined local_3a0;
  undefined local_39f;
  undefined local_39e;
  undefined auStack_39d [6];
  char acStack_397 [249];
  undefined2 local_29e;
  undefined local_29c;
  int local_10;
  size_t local_c;
  
  local_10 = BSA_DmSetConfigInit(auStack_3a4);
  local_39f = DAT_0008a8c9;
  local_39e = DAT_0008a8ca;
  local_3a0 = param_1;
  bdcpy(auStack_39d,&DAT_0008a8cb);
  local_c = strlen(&DAT_0008a8d1);
  if (0x12 < (int)local_c) {
    local_c = 0x12;
  }
  strncpy(acStack_397,&DAT_0008a8d1,local_c);
  acStack_397[local_c] = '\0';
  local_29e = DAT_0008a9ca;
  local_29c = DAT_0008a9cc;
  local_10 = BSA_DmSetConfig(auStack_3a4);
  if (local_10 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_bt_config",0x126);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003549c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined auStack_3a0 [916];
  int local_c;
  
  local_c = BSA_DmGetConfigInit(auStack_3a0);
  local_c = BSA_DmGetConfig(auStack_3a0);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_bt_config",0x144);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmGetConfig failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_00035522(void)

{
  int iVar1;
  undefined auStack_8c [128];
  undefined auStack_c [4];
  
  iVar1 = BSA_SecReadOOBInit(auStack_c);
  if (iVar1 == 0) {
    iVar1 = BSA_SecReadOOB(auStack_c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_read_oob_data",0x16e), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_8c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_oob_data",0x168);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_000355d4(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  char acStack_98 [132];
  
  uVar1 = *(uint *)(param_1 + 1);
  uVar3 = *(uint *)(param_1 + 5);
  uVar5 = *(uint *)(param_1 + 9);
  uVar7 = *(uint *)(param_1 + 0xd);
  uVar2 = *(uint *)(param_1 + 0x11);
  uVar4 = *(uint *)(param_1 + 0x15);
  uVar6 = *(uint *)(param_1 + 0x19);
  uVar8 = *(uint *)(param_1 + 0x1d);
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x",uVar1 & 0xff
          ,uVar1 >> 8 & 0xff,uVar1 >> 0x10 & 0xff,uVar1 >> 0x18,uVar3 & 0xff,uVar3 >> 8 & 0xff,
          uVar3 >> 0x10 & 0xff,uVar3 >> 0x18,uVar5 & 0xff,uVar5 >> 8 & 0xff,uVar5 >> 0x10 & 0xff,
          uVar5 >> 0x18,uVar7 & 0xff,uVar7 >> 8 & 0xff,uVar7 >> 0x10 & 0xff,uVar7 >> 0x18);
  memset(acStack_98,0,0x80);
  sprintf(acStack_98,"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x",uVar2 & 0xff
          ,uVar2 >> 8 & 0xff,uVar2 >> 0x10 & 0xff,uVar2 >> 0x18,uVar4 & 0xff,uVar4 >> 8 & 0xff,
          uVar4 >> 0x10 & 0xff,uVar4 >> 0x18,uVar6 & 0xff,uVar6 >> 8 & 0xff,uVar6 >> 0x10 & 0xff,
          uVar6 >> 0x18,uVar8 & 0xff,uVar8 >> 8 & 0xff,uVar8 >> 0x10 & 0xff,uVar8 >> 0x18);
  return;
}



void FUN_00035760(void)

{
  int iVar1;
  undefined auStack_10c [128];
  char acStack_8c [64];
  undefined4 uStack_4c;
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [4];
  undefined auStack_14 [4];
  undefined auStack_10 [4];
  int local_c;
  
  iVar1 = BSA_SecSetRemoteOOBInit(&DAT_0008a890);
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_10c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_remote_oob",0x1b0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_10c,"Enter BDA of Peer device: AABBCCDDEEFF");
    }
    memset(acStack_8c,0,0x40);
    FUN_0002f300(0x668c4,(int)acStack_8c,0x40);
    sscanf(acStack_8c,"%02x%02x%02x%02x%02x%02x",&uStack_4c,auStack_48,auStack_44,auStack_40,
           auStack_3c,auStack_38);
    for (local_c = 0; local_c < 6; local_c = local_c + 1) {
      (&DAT_0008a890)[local_c] = (char)*(undefined4 *)(auStack_48 + local_c * 4 + -4);
    }
    DAT_0008a8b6 = 1;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_10c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_remote_oob",0x1bb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_10c,
                     "Enter 16 byte C Hash in this format: FA87C0D0AFAC11DE8A390800200C9A66");
    }
    memset(acStack_8c,0,0x40);
    FUN_0002f300(0x66934,(int)acStack_8c,0x40);
    sscanf(acStack_8c,"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x",&uStack_4c,
           auStack_48,auStack_44,auStack_40,auStack_3c,auStack_38,auStack_34,auStack_30,auStack_2c,
           auStack_28,auStack_24,auStack_20,auStack_1c,auStack_18,auStack_14,auStack_10);
    for (local_c = 0; local_c < 0x10; local_c = local_c + 1) {
      (&DAT_0008a896)[local_c] = (char)*(undefined4 *)(auStack_48 + local_c * 4 + -4);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_10c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_remote_oob",0x1c5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_10c,
                     "Enter 16 byte R Randomizer in this format: FA87C0D0AFAC11DE8A390800200C9A66");
    }
    memset(acStack_8c,0,0x40);
    FUN_0002f300(0x6698c,(int)acStack_8c,0x40);
    sscanf(acStack_8c,"%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x",&uStack_4c,
           auStack_48,auStack_44,auStack_40,auStack_3c,auStack_38,auStack_34,auStack_30,auStack_2c,
           auStack_28,auStack_24,auStack_20,auStack_1c,auStack_18,auStack_14,auStack_10);
    for (local_c = 0; local_c < 0x10; local_c = local_c + 1) {
      (&DAT_0008a8a6)[local_c] = (char)*(undefined4 *)(auStack_48 + local_c * 4 + -4);
    }
    iVar1 = BSA_SecSetRemoteOOB(&DAT_0008a890);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_10c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_remote_oob",0x1d1), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_10c,"BSA_SecSetRemoteOOB failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_10c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_remote_oob",0x1ac);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_10c,"app_mgr_set_remote_oob failed");
    }
  }
  return;
}



void FUN_00035b5a(undefined4 param_1,undefined *param_2)

{
  int iVar1;
  undefined auStack_c8 [128];
  undefined auStack_48 [6];
  undefined local_42;
  undefined local_41;
  undefined auStack_40 [6];
  char acStack_3a [15];
  undefined local_2b;
  byte local_2a;
  int local_20;
  int local_1c;
  
  switch(param_1) {
  case 0:
    FUN_000225e6("app_mgr_security_callback",'\0');
    DAT_00083545 = 0x81;
    DAT_00086d4c = 1;
    break;
  case 1:
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x205);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c8,
                     "BSA_SEC_LINK_DOWN_EVT bd_addr: %02x:%02x:%02x:%02x:%02x:%02x",*param_2,
                     param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    DAT_00086d4c = 0;
    DAT_00083545 = 0x81;
    FUN_000225e6("app_mgr_security_callback",'\x01');
    break;
  case 2:
    BSA_SecPinCodeReplyInit(auStack_40);
    bdcpy(auStack_40,param_2);
    local_2a = DAT_0008abd1;
    strncpy(acStack_3a,(char *)&DAT_0008abc1,(uint)DAT_0008abd1);
    local_2b = 0;
    BSA_SecPinCodeReply(auStack_40);
    break;
  case 3:
    if (param_2[0x111] != '\0') {
      FUN_0003524c();
      FUN_0002e708(0x896e8,10,param_2,param_2 + 6);
      if (param_2[0xff] != '\0') {
        FUN_0002e27c(0x896e8,10,param_2,param_2 + 0x100,param_2[0x110]);
      }
      for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
        if (((&DAT_00086d50)[local_1c * 0x210] != '\0') &&
           (iVar1 = bdcmp(&DAT_00086d54 + local_1c * 0x210,param_2), iVar1 == 0)) {
          FUN_0002e7b2(0x896e8,10,param_2,&DAT_00086d5a + local_1c * 0x210);
        }
      }
      local_20 = FUN_000352fa();
      if ((local_20 < 0) &&
         (iVar1 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                    ,"app_mgr_security_callback",600), iVar1 != 0)) {
        duss_log_print(0x5c,1,auStack_c8,"app_mgr_write_remote_devices failed:%d",local_20);
      }
    }
    break;
  case 4:
  case 7:
  case 9:
  case 0xb:
    break;
  case 5:
    local_20 = BSA_SecAuthorizeReplyInit(auStack_48);
    bdcpy(auStack_48,param_2);
    local_42 = param_2[0xff];
    local_41 = 0;
    local_20 = BSA_SecAuthorizeReply(auStack_48);
    FUN_0003524c();
    FUN_0002e666(0x896e8,10,param_2,1 << param_2[0xff]);
    if (param_2[6] != '\0') {
      FUN_0002e708(0x896e8,10,param_2,param_2 + 6);
    }
    local_20 = FUN_000352fa();
    if ((local_20 < 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x28a), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_c8,"app_mgr_write_remote_devices failed:%d",local_20);
    }
    break;
  case 6:
    bdcpy(&DAT_0008abd8,param_2);
    DAT_0008a88c = param_2[0x109];
    break;
  case 8:
    memset(&DAT_0008a8b8,0,0xc);
    bdcpy(&DAT_0008a8b8,param_2);
    break;
  case 10:
    FUN_000355d4((int)param_2);
    break;
  case 0xc:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x2e1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,"BSA_SEC_BLE_KEY_EVT");
    }
    FUN_0003524c();
    FUN_0002ee2c(0x896e8,10,param_2,2);
    FUN_0002e342(&DAT_000896e8,10,param_2,*(undefined4 *)(param_2 + 8),
                 *(undefined4 *)(param_2 + 0xc),*(undefined4 *)(param_2 + 0x10),
                 *(undefined4 *)(param_2 + 0x14),*(undefined4 *)(param_2 + 0x18),
                 *(undefined4 *)(param_2 + 0x1c),*(undefined4 *)(param_2 + 0x20),param_2[6]);
    local_20 = FUN_000352fa();
    if ((local_20 < 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x322), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_c8,"app_mgr_write_remote_devices failed:%d",local_20);
    }
    break;
  case 0xd:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x327);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,
                     "BSA_SEC_BLE_PASSKEY_REQ_EVT (Passkey Request) received from:");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x32b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,"\tbd_addr: %02x:%02x:%02x:%02x:%02x:%02x",*param_2,
                     param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    memset(&DAT_00085ad0,0,0x20);
    bdcpy(&DAT_00085ad0,param_2);
    break;
  case 0xe:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x2d5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,
                     "BSA_SEC_SUSPENDED_EVT bd_addr: %02x:%02x:%02x:%02x:%02x:%02x",*param_2,
                     param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    break;
  case 0xf:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x2dc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,"BSA_SEC_RESUMED_EVT bd_addr: %02x:%02x:%02x:%02x:%02x:%02x",
                     *param_2,param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    break;
  case 0x10:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x336);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,
                     "BSA_SEC_RSSI_EVT received for BdAddr: %02x:%02x:%02x:%02x:%02x:%02x",*param_2,
                     param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    if ((param_2[6] & 1) != 0) {
      if (param_2[10] == '\x01') {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x33c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c8,"\tRSSI: %d (dB)",(int)(char)param_2[7]);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x341);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c8,"\tRSSI: %d (dBm)",(int)(char)param_2[7]);
        }
      }
      DAT_00083545 = param_2[7];
    }
    if (((param_2[6] & 4) != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x349), iVar1 != 0)) {
      duss_log_print(0x5c,3,auStack_c8,"\tRaw RSSI: %d (dBm)",(int)(char)param_2[8]);
    }
    if (((param_2[6] & 2) != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_security_callback",0x34e), iVar1 != 0)) {
      duss_log_print(0x5c,3,auStack_c8,"\tLink Quality: %d",param_2[9]);
    }
    break;
  case 0x11:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x356);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c8,
                     "BSA_SEC_UNKNOWN_LINKKEY_EVT received for BdAddr: %02x:%02x:%02x:%02x:%02x:%02x"
                     ,*param_2,param_2[1],param_2[2],param_2[3],param_2[4],param_2[5]);
    }
    break;
  default:
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_security_callback",0x359);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c8,"unknown event:%d",param_1);
    }
  }
  return;
}



uint FUN_000364e0(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined auStack_9c [128];
  uint local_1c;
  undefined4 local_10;
  undefined4 uStack_c;
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  local_10 = param_1;
  uStack_c = param_2;
  uStack_8 = param_3;
  uStack_4 = param_4;
  bdcpy(&local_10,&DAT_00085ad0);
  local_1c = BSA_SecPinCodeReply(&local_10);
  if (local_1c != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_send_pincode",0x372);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_9c,"BSA_SecPinCodeReply ERROR: %d",local_1c);
    }
  }
  return local_1c & 0xffff;
}



void FUN_0003656e(undefined4 param_1)

{
  DAT_0008a8c0 = param_1;
  BSA_SecSpPasskeyReply(&DAT_0008a8b8);
  return;
}



undefined4 FUN_00036596(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined local_18;
  undefined local_17;
  undefined local_16;
  undefined4 local_14;
  int local_c;
  
  BSA_SecSetSecurityInit(&local_18);
  local_17 = DAT_0008abd3;
  local_16 = DAT_0008abd4;
  local_14 = 0x35b5b;
  local_18 = param_1;
  local_c = BSA_SecSetSecurity(&local_18);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sec_set_sp_cap",0x3a3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"BSA_SecSetSecurity failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003664c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined local_18;
  undefined local_17;
  undefined local_16;
  undefined4 local_14;
  int local_c;
  
  BSA_SecSetSecurityInit(&local_18);
  local_18 = DAT_0008abd2;
  local_17 = DAT_0008abd3;
  local_16 = DAT_0008abd4;
  local_14 = 0x35b5b;
  local_c = BSA_SecSetSecurity(&local_18);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sec_set_security",0x3c5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"BSA_SecSetSecurity failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00036704(undefined param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined auStack_14 [6];
  undefined local_e;
  undefined local_d;
  int local_c;
  
  BSA_SecSpCfmReplyInit(auStack_14);
  local_e = param_1;
  bdcpy(auStack_14,param_2);
  local_d = DAT_0008a88c;
  local_c = BSA_SecSpCfmReply(auStack_14);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sp_cfm_reply",0x3e5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_SecSpCfmReply failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000367aa(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined auStack_18 [8];
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_sec_bond",0x3fc);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"Bluetooth Bond menu:");
  }
  FUN_00023ce4();
  local_c = FUN_0002f22c("Select device");
  if (((local_c < 0) || (0x13 < local_c)) || ((&DAT_00086d50)[local_c * 0x210] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sec_bond",0x40f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"Bad device number:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    BSA_SecBondInit(auStack_18);
    bdcpy(auStack_18,&DAT_00086d54 + local_c * 0x210);
    local_10 = BSA_SecBond(auStack_18);
    if (local_10 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_sec_bond",0x409);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_98,"BSA_SecBond failed:%d",local_10);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00036912(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined auStack_18 [8];
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_sec_bond_cancel",0x427);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"Bluetooth Bond Cancel menu:");
  }
  FUN_00023ce4();
  local_c = FUN_0002f22c("Select device");
  if (((local_c < 0) || (0x13 < local_c)) || ((&DAT_00086d50)[local_c * 0x210] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sec_bond_cancel",0x43a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"Bad device number:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    BSA_SecBondCancelInit(auStack_18);
    bdcpy(auStack_18,&DAT_00086d54 + local_c * 0x210);
    local_10 = BSA_SecBondCancel(auStack_18);
    if (local_10 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_sec_bond_cancel",0x434);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_98,"BSA_SecBondCancel failed:%d",local_10);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00036a7a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined auStack_18 [8];
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_sec_unpair",0x452);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"app_mgr_sec_unpair");
  }
  BSA_SecRemoveDeviceInit(auStack_18);
  FUN_0002a97e();
  FUN_0002e882(0x896e8,10);
  local_c = FUN_0002f22c("Select device to unpair");
  if (((local_c < 0) || (9 < local_c)) || ((&DAT_000896e8)[local_c * 0x1b0] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_sec_unpair",0x468);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"Wrong index [%d]",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    bdcpy(auStack_18,&DAT_000896e9 + local_c * 0x1b0);
    local_10 = BSA_SecRemoveDevice(auStack_18);
    if (local_10 == 0) {
      (&DAT_000896e8)[local_c * 0x1b0] = 0;
      FUN_0002aa0a();
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_sec_unpair",0x46e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_98,"BSA_SecRemoveDevice Operation Failed with status [%d]",
                       local_10);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



void FUN_00036c10(undefined param_1,undefined4 *param_2)

{
  int iVar1;
  undefined auStack_424 [128];
  undefined4 local_3a4 [223];
  undefined local_28;
  undefined2 local_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  undefined4 uStack_18;
  undefined4 uStack_14;
  
  iVar1 = BSA_DmSetConfigInit(local_3a4);
  if (iVar1 == 0) {
    local_24 = 0x10;
    local_20 = *param_2;
    uStack_1c = param_2[1];
    uStack_18 = param_2[2];
    uStack_14 = param_2[3];
    local_3a4[0] = 0x200000;
    local_28 = param_1;
    iVar1 = BSA_DmSetConfig(local_3a4);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_use_128bits_uuid",0x495), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_424,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_use_128bits_uuid",0x48c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_424,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_00036d10(void)

{
  int iVar1;
  undefined auStack_41c [128];
  undefined4 local_39c;
  undefined local_397;
  
  iVar1 = BSA_DmSetConfigInit(&local_39c);
  if (iVar1 == 0) {
    local_397 = 1;
    local_39c = 1;
    iVar1 = BSA_DmSetConfig(&local_39c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_discoverable",0x4b1), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_discoverable",0x4aa);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_00036dd6(void)

{
  int iVar1;
  undefined auStack_41c [128];
  undefined4 local_39c;
  undefined local_397;
  
  iVar1 = BSA_DmSetConfigInit(&local_39c);
  if (iVar1 == 0) {
    local_397 = 0;
    local_39c = 1;
    iVar1 = BSA_DmSetConfig(&local_39c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_non_discoverable",0x4cd), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_non_discoverable",0x4c6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_00036e9c(void)

{
  int iVar1;
  undefined auStack_41c [128];
  undefined4 local_39c;
  undefined local_396;
  
  iVar1 = BSA_DmSetConfigInit(&local_39c);
  if (iVar1 == 0) {
    local_396 = 1;
    local_39c = 1;
    iVar1 = BSA_DmSetConfig(&local_39c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_connectable",0x4e9), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_connectable",0x4e2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_00036f62(void)

{
  int iVar1;
  undefined auStack_41c [128];
  undefined4 local_39c;
  undefined local_396;
  
  iVar1 = BSA_DmSetConfigInit(&local_39c);
  if (iVar1 == 0) {
    local_396 = 0;
    local_39c = 1;
    iVar1 = BSA_DmSetConfig(&local_39c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_non_connectable",0x505), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_non_connectable",0x4fe);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



undefined4 FUN_00037028(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined auStack_18 [12];
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_di_discovery",0x51c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"Bluetooth Manager DI Discovery menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_di_discovery",0x51d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"    0 Device from XML database (previously paired)");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_di_discovery",0x51e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,"    1 Device found in last discovery");
  }
  local_c = FUN_0002f22c("Select source");
  if (local_c == 0) {
    FUN_0003524c();
    FUN_0002e882(0x896e8,10);
    local_c = FUN_0002f22c("Select device");
    if (((-1 < local_c) && (local_c < 10)) && ((&DAT_000896e8)[local_c * 0x1b0] != '\0')) {
      bdcpy(auStack_18,&DAT_000896e9 + local_c * 0x1b0);
LAB_000371e0:
      uVar2 = FUN_000263c8(auStack_18,0);
      return uVar2;
    }
  }
  else if (local_c == 1) {
    FUN_00023ce4();
    local_c = FUN_0002f22c("Select device");
    if (((-1 < local_c) && (local_c < 0x14)) && ((&DAT_00086d50)[local_c * 0x210] != '\0')) {
      bdcpy(auStack_18,&DAT_00086d54 + local_c * 0x210);
      goto LAB_000371e0;
    }
  }
  iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_di_discovery",0x54c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,1,auStack_98,"Bad Device index:%d",local_c);
  }
  return 0xffffffff;
}



undefined4 FUN_00037248(char *param_1,size_t param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0 [3];
  char acStack_393 [248];
  undefined local_29b;
  int local_c;
  
  local_c = BSA_DmSetConfigInit(local_3a0);
  local_3a0[0] = 4;
  strncpy(acStack_393,param_1,param_2);
  local_29b = 0;
  local_c = BSA_DmSetConfig(local_3a0);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_local_name",0x56e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined2 FUN_00037300(void)

{
  undefined2 uVar1;
  undefined2 local_14;
  undefined2 local_12;
  undefined2 local_10;
  undefined local_e;
  undefined2 local_c;
  
  local_14 = 0x131;
  local_12 = 0x4356;
  local_e = 1;
  local_c = 1;
  local_10 = 0xb00;
  uVar1 = BSA_DmSetLocalDiRecord(&local_14);
  return uVar1;
}



undefined4 FUN_00037336(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined auStack_98 [128];
  undefined2 local_18;
  undefined2 local_16;
  ushort local_14;
  char local_12;
  short local_10;
  short local_e;
  char *local_c;
  
  local_e = BSA_DmGetLocalDiRecord(&local_18);
  if (local_e == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5a8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Local Primary Device ID --");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5a9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tVendor ID: 0x%04x",local_18);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5aa);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tProduct ID: 0x%04x",local_16);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5ab);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tMajor version: %d",local_14 >> 8);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5ac);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tMinor version: %d",(int)(uint)local_14 >> 4 & 0xf);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5ad);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tSub-minor version: %d",local_14 & 0xf);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5ae);
    if (iVar1 != 0) {
      if (local_12 == '\0') {
        puVar3 = &DAT_00066ec4;
      }
      else {
        puVar3 = &DAT_00066ec0;
      }
      duss_log_print(0x5c,3,auStack_98,"\t%s a primary record",puVar3);
    }
    if (local_10 == 1) {
      local_c = "Bluetooth SIG";
    }
    else if (local_10 == 2) {
      local_c = "USB Forum";
    }
    else {
      local_c = "unknown";
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5b5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"\tVendor ID source is %s",local_c);
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_get_local_di",0x5a4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"BSA_DmGetLocalDiRecord failed status:%d",local_e);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



short FUN_0003761e(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined auStack_b4 [128];
  undefined4 local_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  int local_1c;
  undefined4 local_18;
  short local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_reply_pincode",0x5bf);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b4,&DAT_00066f1c,"app_mgr_reply_pincode");
  }
  local_12 = BSA_SecPinCodeReplyInit(&local_34);
  if ((local_12 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_b4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_reply_pincode",0x5c4), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_b4,"BSA_SecPinCodeReplyInit ERROR: %d",local_12);
  }
  local_1c = param_1;
  if (param_1 < 0) {
    local_1c = FUN_0002f22c("Enter Passkey: ");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_reply_pincode",0x5d0);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b4,"BLE pass key = %d",local_1c);
  }
  local_18 = CONCAT22(local_18._2_2_,0x101);
  uVar3 = local_18;
  uVar2 = FUN_000364e0(local_34,uStack_30,uStack_2c,uStack_28);
  local_12 = (short)uVar2;
  if ((local_12 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_b4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_reply_pincode",0x5d7,uVar3), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_b4,"app_mgr_send_pincode ERROR: %d",local_12);
  }
  return local_12;
}



undefined4 FUN_000377be(undefined *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined local_4c [4];
  undefined local_48 [4];
  undefined local_44 [4];
  char acStack_40 [2];
  undefined auStack_3e [2];
  undefined auStack_3c [16];
  undefined4 local_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined4 uStack_20;
  undefined4 local_1c;
  undefined local_18;
  int local_14;
  
  local_2c = 0;
  uStack_28 = 0x1002404;
  uStack_24 = 0x40050000;
  uStack_20 = 0x800500;
  local_1c = 0x4000002;
  local_18 = 0x18;
  puts("Ener COD for local device:");
  puts("1 - Set top box (default) ");
  puts("2 - HID host");
  puts("3 - HID keyboard");
  puts("4 - HID mouse");
  puts("5 - Phone");
  puts("6 - Headset");
  puts("7 - Custom");
  local_14 = FUN_0002f22c("Select=>");
  if (local_14 == 7) {
    memset(acStack_40,0,0x14);
    puts("Enter 3 byte COD, 1 byte for each in hex format:");
    iVar1 = FUN_0002f300(0x67058,(int)acStack_40,3);
    if (iVar1 == 2) {
      iVar1 = FUN_0002f300(0x67068,(int)auStack_3e,3);
      if (iVar1 == 2) {
        iVar1 = FUN_0002f300(0x6707c,(int)auStack_3c,3);
        if (iVar1 == 2) {
          iVar1 = sscanf(acStack_40,"%02x%02x%02x",local_44,local_48,local_4c);
          if (iVar1 == 3) {
            *param_1 = local_44[0];
            param_1[1] = local_48[0];
            param_1[2] = local_4c[0];
            uVar2 = 0;
          }
          else {
            uVar2 = 0xffffffff;
          }
        }
        else {
          uVar2 = 0xffffffff;
        }
      }
      else {
        uVar2 = 0xffffffff;
      }
    }
    else {
      uVar2 = 0xffffffff;
    }
  }
  else if ((local_14 < 1) || (6 < local_14)) {
    uVar2 = 0xffffffff;
  }
  else {
    *param_1 = *(undefined *)((int)&local_2c + local_14 * 3);
    param_1[1] = *(undefined *)((int)&local_2c + local_14 * 3 + 1);
    param_1[2] = *(undefined *)((int)&local_2c + local_14 * 3 + 2);
    uVar2 = 0;
  }
  return uVar2;
}



int FUN_00037982(void)

{
  int iVar1;
  __pid_t _Var2;
  undefined auStack_258 [128];
  uint local_1d8;
  timeval local_1d4;
  undefined auStack_1cc [6];
  undefined local_1c6;
  undefined auStack_1c4 [6];
  undefined2 local_1be;
  undefined local_1bc;
  undefined4 local_1bb;
  undefined4 local_1b7;
  undefined4 local_1b3;
  undefined4 local_1af;
  undefined local_1ab;
  undefined4 local_1a8;
  undefined local_1a4;
  undefined local_1a3;
  undefined local_1a2;
  undefined local_a0;
  undefined local_9f;
  undefined local_9e;
  undefined local_9d;
  undefined4 local_9c;
  undefined4 uStack_98;
  undefined4 uStack_94;
  undefined4 uStack_90;
  undefined4 local_8c;
  undefined4 uStack_88;
  undefined2 local_84;
  undefined local_82;
  undefined local_81;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 uStack_78;
  undefined4 uStack_74;
  undefined4 uStack_70;
  undefined local_6c;
  undefined4 local_68;
  undefined2 local_64;
  undefined local_62;
  undefined4 local_61;
  undefined4 local_5d;
  undefined4 local_59;
  undefined4 local_55;
  undefined4 local_50;
  undefined4 uStack_4c;
  undefined4 uStack_48;
  undefined4 uStack_44;
  undefined local_40;
  undefined4 local_3f;
  undefined2 local_3b;
  undefined4 local_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined2 local_28;
  undefined local_26;
  undefined local_25;
  undefined2 local_24;
  undefined local_22;
  undefined4 local_20;
  undefined2 local_1c;
  int local_18;
  int local_14;
  
  local_20 = 0xef0101ac;
  local_1c = 0x100;
  local_24 = 0x400;
  local_22 = 0x24;
  local_18 = FUN_000350b0();
  if (local_18 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_258,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_config",0x63c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_258,"Creating default XML config file");
    }
    DAT_0008a8c8 = 1;
    DAT_0008a8c9 = 1;
    DAT_0008a8ca = 1;
    strncpy(&DAT_0008a8d1,"WM161-default",0xf9);
    DAT_0008a9c9 = 0;
    bdcpy(&DAT_0008a8cb,&local_20);
    gettimeofday(&local_1d4,(__timezone_ptr_t)0x0);
    _Var2 = getpid();
    local_1d8 = _Var2 * local_1d4.tv_usec * local_1d4.tv_sec;
    iVar1 = rand_r(&local_1d8);
    DAT_0008a8cf = (undefined)iVar1;
    iVar1 = rand_r(&local_1d8);
    DAT_0008a8d0 = (undefined)iVar1;
    DAT_0008a9ca = local_24;
    DAT_0008a9cc = local_22;
    strncpy(&DAT_0008a9cd,"/tmp/EMMC/wireless/bluetooth/pictures",500);
    DAT_0008abc0 = 0;
    DAT_0008abc1 = 0x30303030;
    DAT_0008abc5 = 0;
    DAT_0008abd1 = 4;
    DAT_0008abd2 = 1;
    DAT_0008abd3 = 3;
    DAT_0008abd4 = 0xd;
    local_18 = FUN_000351be();
    if (local_18 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_258,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_config",0x657);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_258,"Unable to Create default XML config file");
      }
      FUN_000349fc();
      return local_18;
    }
  }
  local_18 = FUN_0003524c();
  if (local_18 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_258,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_config",0x661);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_258,"No remote device database found");
    }
  }
  else {
    FUN_0002e882(0x896e8,10);
  }
  FUN_0003549c();
  local_18 = FUN_0003664c();
  if (local_18 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_258,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_config",0x670);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_258,"app_mgr_sec_set_security failed:%d",local_18);
    }
    FUN_000349fc();
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_258,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_config",0x677);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_258,"Add all devices found in database");
    }
    for (local_14 = 0; local_14 < 10; local_14 = local_14 + 1) {
      if ((&DAT_000896e8)[local_14 * 0x1b0] != '\0') {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_258,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_config",0x67c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_258,"Adding:%s",local_14 * 0x1b0 + 0x896ef);
        }
        BSA_SecAddDeviceInit(auStack_1c4);
        bdcpy(auStack_1c4,&DAT_000896e9 + local_14 * 0x1b0);
        local_1be = *(undefined2 *)(&DAT_000897e8 + local_14 * 0x1b0);
        local_1bc = (&DAT_000897ea)[local_14 * 0x1b0];
        iVar1 = local_14 * 0x1b0;
        local_1bb = *(undefined4 *)(&DAT_000897f7 + iVar1);
        local_1b7 = *(undefined4 *)(&DAT_000897fb + iVar1);
        local_1b3 = *(undefined4 *)(&DAT_000897ff + iVar1);
        local_1af = *(undefined4 *)(&DAT_00089803 + iVar1);
        local_1ab = (&DAT_000897f6)[local_14 * 0x1b0];
        local_1a8 = *(undefined4 *)(&DAT_000897f0 + local_14 * 0x1b0);
        local_1a4 = 1;
        local_1a3 = (&DAT_00089807)[local_14 * 0x1b0];
        local_1a2 = (&DAT_00089808)[local_14 * 0x1b0];
        local_a0 = (&DAT_00089819)[local_14 * 0x1b0];
        local_9f = (&DAT_0008981a)[local_14 * 0x1b0];
        local_9e = (&DAT_0008981b)[local_14 * 0x1b0];
        if ((&DAT_0008981c)[local_14 * 0x1b0] != '\0') {
          local_9d = 1;
          iVar1 = local_14 * 0x1b0;
          local_9c = *(undefined4 *)(&DAT_0008981d + iVar1);
          uStack_98 = *(undefined4 *)(&DAT_00089821 + iVar1);
          uStack_94 = *(undefined4 *)(&DAT_00089825 + iVar1);
          uStack_90 = *(undefined4 *)(&DAT_00089829 + iVar1);
          local_8c = *(undefined4 *)(&DAT_0008982d + local_14 * 0x1b0);
          uStack_88 = *(undefined4 *)(&DAT_00089831 + local_14 * 0x1b0);
          local_84 = *(undefined2 *)(&DAT_00089836 + local_14 * 0x1b0);
          local_82 = (&DAT_00089838)[local_14 * 0x1b0];
          local_81 = (&DAT_00089839)[local_14 * 0x1b0];
          iVar1 = local_14 * 0x1b0;
          local_50 = *(undefined4 *)(&DAT_0008983a + iVar1);
          uStack_4c = *(undefined4 *)(&DAT_0008983e + iVar1);
          uStack_48 = *(undefined4 *)(&DAT_00089842 + iVar1);
          uStack_44 = *(undefined4 *)(&DAT_00089846 + iVar1);
          local_40 = (&DAT_0008984a)[local_14 * 0x1b0];
          local_3f = *(undefined4 *)(&DAT_0008984b + local_14 * 0x1b0);
          local_3b = *(undefined2 *)(&DAT_0008984f + local_14 * 0x1b0);
          local_80 = *(undefined4 *)(&DAT_00089854 + local_14 * 0x1b0);
          iVar1 = local_14 * 0x1b0;
          local_7c = *(undefined4 *)(&DAT_00089858 + iVar1);
          uStack_78 = *(undefined4 *)(&DAT_0008985c + iVar1);
          uStack_74 = *(undefined4 *)(&DAT_00089860 + iVar1);
          uStack_70 = *(undefined4 *)(&DAT_00089864 + iVar1);
          local_6c = (&DAT_00089868)[local_14 * 0x1b0];
          local_68 = *(undefined4 *)(&DAT_0008986c + local_14 * 0x1b0);
          iVar1 = local_14 * 0x1b0;
          local_61 = *(undefined4 *)(&DAT_00089870 + iVar1);
          local_5d = *(undefined4 *)(&DAT_00089874 + iVar1);
          local_59 = *(undefined4 *)(&DAT_00089878 + iVar1);
          local_55 = *(undefined4 *)(&DAT_0008987c + iVar1);
          local_64 = *(undefined2 *)(&DAT_00089880 + local_14 * 0x1b0);
          local_62 = (&DAT_00089882)[local_14 * 0x1b0];
          local_28 = *(undefined2 *)(&DAT_00089894 + local_14 * 0x1b0);
          iVar1 = local_14 * 0x1b0;
          local_38 = *(undefined4 *)(&DAT_00089883 + iVar1);
          uStack_34 = *(undefined4 *)(&DAT_00089887 + iVar1);
          uStack_30 = *(undefined4 *)(&DAT_0008988b + iVar1);
          uStack_2c = *(undefined4 *)(&DAT_0008988f + iVar1);
          local_26 = (&DAT_00089896)[local_14 * 0x1b0];
          local_25 = (&DAT_00089897)[local_14 * 0x1b0];
        }
        BSA_SecAddDevice(auStack_1c4);
      }
    }
    FUN_0002aac4();
    for (local_14 = 0; local_14 < 10; local_14 = local_14 + 1) {
      if ((&DAT_00089698)[local_14 * 8] != '\0') {
        BSA_SecAddSiDevInit(auStack_1cc);
        bdcpy(auStack_1cc,local_14 * 8 + 0x89699);
        local_1c6 = (&DAT_0008969f)[local_14 * 8];
        BSA_SecAddSiDev(auStack_1cc);
      }
    }
    FUN_00035374(DAT_0008a8c8);
    local_18 = 0;
  }
  return local_18;
}



undefined4 FUN_00038288(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_420 [128];
  undefined4 local_3a0 [65];
  undefined2 local_29a;
  undefined local_298;
  undefined2 local_c;
  undefined local_a;
  
  local_c = 0x400;
  local_a = 0x24;
  iVar1 = FUN_000377be((undefined *)&local_c);
  if (iVar1 == -1) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgt_set_cod",0x6ea);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_420,"app_get_cod() failed");
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = BSA_DmSetConfigInit(local_3a0);
    if (iVar1 == 0) {
      local_29a = local_c;
      local_298 = local_a;
      local_3a0[0] = 8;
      iVar1 = BSA_DmSetConfig(local_3a0);
      if (iVar1 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgt_set_cod",0x6f9);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfig failed");
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_420,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgt_set_cod",0x6f1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_420,"BSA_DmSetConfigInit failed");
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000383ce(void)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined auStack_90 [128];
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_change_dual_stack_mode",0x710);
  if (iVar1 != 0) {
    pcVar2 = FUN_000386ba();
    duss_log_print(0x5c,3,auStack_90,"Current DualStack mode: %s",pcVar2);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_change_dual_stack_mode",0x711);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Select the new DualStack mode:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_change_dual_stack_mode",0x712);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"\t0: DUAL_STACK_MODE_BSA");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_change_dual_stack_mode",0x713);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,
                   "\t1: DUAL_STACK_MODE_MM/Kernel (requires specific BTUSB driver)");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_change_dual_stack_mode",0x714);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"\t2: DUAL_STACK_MODE_BTC (requires specific FW)");
  }
  local_10 = FUN_0002f22c("Choice");
  if (local_10 == 1) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_change_dual_stack_mode",0x71f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Switching Dual Stack to MM/Kernel");
    }
    local_9 = 1;
  }
  else if (local_10 == 2) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_change_dual_stack_mode",0x724);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Switching Dual Stack to BTC");
    }
    local_9 = 2;
  }
  else {
    if (local_10 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                ,"app_mgr_change_dual_stack_mode",0x729);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"Bad DualStack Mode=%d",local_10);
      }
      return 0xffffffff;
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_change_dual_stack_mode",0x71a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Switching Dual Stack to BSA");
    }
    local_9 = 0;
  }
  iVar1 = FUN_0002810e(local_9);
  if (iVar1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_change_dual_stack_mode",0x72f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"DualStack Switch Failed");
    }
    uVar3 = 0xffffffff;
  }
  else {
    DAT_0008a8c4 = local_9;
    uVar3 = 0;
  }
  return uVar3;
}



char * FUN_000386ba(void)

{
  char *pcVar1;
  
  if (DAT_0008a8c4 == '\x01') {
    pcVar1 = "DUAL_STACK_MODE_MM/Kernel";
  }
  else if (DAT_0008a8c4 == '\x02') {
    pcVar1 = "DUAL_STACK_MODE_BTC";
  }
  else if (DAT_0008a8c4 == '\0') {
    pcVar1 = "DUAL_STACK_MODE_BSA";
  }
  else {
    pcVar1 = "Unknown Dual Stack Mode";
  }
  return pcVar1;
}



undefined4 FUN_00038704(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_9c [128];
  undefined auStack_1c [8];
  undefined4 local_14;
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_discovery_test",0x764);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"Select the parameter to modify:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_discovery_test",0x765);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"\t0: Update type");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_discovery_test",0x766);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"\t1: Inquiry TX power");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                            ,"app_mgr_discovery_test",0x767);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"\t2: bd address and service discovery");
  }
  local_c = FUN_0002f22c("Choice");
  if (local_c == 1) {
    local_c = FUN_0002f22c("Enter new Inquiry TX power");
    uVar2 = FUN_00026cc6((char)local_c);
  }
  else if (local_c == 2) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x77e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"select device:");
    }
    FUN_00023ce4();
    local_10 = FUN_0002f22c("Select device");
    bdcpy(auStack_1c,&DAT_00086d54 + local_10 * 0x210);
    local_14 = 0x7ffffffe;
    uVar2 = FUN_00026960(auStack_1c,0x7ffffffe,0);
  }
  else if (local_c == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x76d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"Select which update is needed:");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x76e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"\t%d: End of discovery (default)",0);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x76f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"\t%d: Upon any modification",1);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x770);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"\t%d: Upon Name Reception",2);
    }
    local_c = FUN_0002f22c(&DAT_0006747c);
    uVar2 = FUN_00026ae6((char)local_c);
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_discovery_test",0x787);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_9c,"Unsupported choice value");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00038a4e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_cc [128];
  undefined2 local_4c;
  undefined local_4a;
  undefined local_49;
  undefined local_48;
  undefined2 local_46;
  undefined auStack_44 [50];
  short local_12;
  
  local_12 = BSA_TmReadVersionInit(&local_4c);
  local_12 = BSA_TmReadVersion(&local_4c);
  if (local_12 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_version",0x7a5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"Server status:%d",local_4c);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_version",0x7aa);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"FW Version:%d.%d.%d.%d",local_4a,local_49,local_48,local_46)
      ;
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_version",0x7ab);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"BSA Server Version:%s",auStack_44);
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_read_version",0x7a1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_cc,"BSA_TmReadVersion failed status:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_00038bb6(undefined4 param_1,undefined2 param_2,undefined param_3)

{
  int iVar1;
  undefined auStack_41c [128];
  undefined4 local_39c [219];
  undefined auStack_2e [6];
  undefined2 local_28;
  undefined local_26;
  
  iVar1 = BSA_DmSetConfigInit(local_39c);
  if (iVar1 == 0) {
    local_39c[0] = 0x40000;
    bdcpy(auStack_2e,param_1);
    local_28 = param_2;
    local_26 = param_3;
    iVar1 = BSA_DmSetConfig(local_39c);
    if ((iVar1 != 0) &&
       (iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                                  ,"app_mgr_set_link_policy",2000), iVar1 != 0)) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfig failed");
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_41c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager.c"
                              ,"app_mgr_set_link_policy",0x7c4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_41c,"BSA_DmSetConfigInit failed");
    }
  }
  return;
}



void FUN_00038cbc(void)

{
  int iVar1;
  char *pcVar2;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x6d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"Bluetooth Application Manager Main menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x6e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Abort Discovery",1);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x6f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Discovery",2);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x70);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Discovery test",3);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x71);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Bonding",4);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x72);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Cancel Bonding",5);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x73);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Remove device from security database",6);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x74);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Add or Remove 128bits UUID in EIR",7);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x75);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Services Discovery (all services)",8);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x76);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Device Id Discovery",9);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x77);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set local Name",10);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x78);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set local Device Id",0xb);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x79);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Get local Device Id",0xc);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x7a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Stop Bluetooth",0xd);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x7b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Restart Bluetooth",0xe);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x7c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Accept Simple Pairing",0xf);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x7d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Refuse Simple Pairing",0x10);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x7e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Enter BLE Passkey",0x11);
  }
  if (DAT_00085af0 == '\x02') {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                              ,"app_mgr_display_main_menu",0x80);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_88,"\t%d => Set Default Simple Pairing caps",0x12);
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                              ,"app_mgr_display_main_menu",0x82);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_88,"\t%d => Act As HID Keyboard (SP passkey entry)",0x12);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x84);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Read Device configuration",0x13);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x85);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Read Local Out Of Band data",0x14);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x86);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Enter remote Out Of Band data",0x15);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x87);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set device visibility",0x16);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x89);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set device BLE visibility",0x17);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x8a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Enable LE Privacy",0x18);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x8b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Disable LE Privacy",0x19);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x8d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set AFH Configuration",0x1a);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x8e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set Tx Power Class2 (specific FW needed)",0x1b);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x8f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set Tx Power Class1.5 (specific FW needed)",0x1c);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x91);
  if (iVar1 != 0) {
    pcVar2 = FUN_000386ba();
    duss_log_print(0x5c,3,auStack_88,"\t%d => Change Dual Stack Mode (currently:%s)",0x1d,pcVar2);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x92);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set Link Policy",0x1e);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x93);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Enter Passkey",0x1f);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x94);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Get Remote Device Name",0x20);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x95);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => RSSI Measurement",0x21);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x96);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set class of device",0x22);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x97);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Kill BSA server",0x60);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x98);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Connect to BSA server",0x61);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x99);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Disconnect from BSA server",0x62);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                            ,"app_mgr_display_main_menu",0x9a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Quit",99);
  }
  return;
}



undefined4 FUN_000396de(int param_1,char *param_2)

{
  if (((param_1 != 0) && (param_1 == 1)) && (*param_2 != '\0')) {
    FUN_00037982();
  }
  return 0;
}



void FUN_00039712(byte *param_1)

{
  FUN_00022522(param_1);
  return;
}



void FUN_00039728(undefined4 *param_1)

{
  FUN_0002196c(param_1);
  return;
}



void FUN_0003973e(void)

{
  FUN_00028616('\x01',1);
  FUN_000225e6("app_mgr_setup",'\x01');
  return;
}



void FUN_0003975c(void)

{
  FUN_000225e6("app_mgr_teardown",'\0');
  FUN_00028616('\0',0);
  FUN_00034a76();
  return;
}



undefined4 FUN_0003977e(void)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined auStack_8c [128];
  uint local_c;
  
  FUN_00034858();
  iVar1 = FUN_00034872((char *)0x0,0x396df);
  if (iVar1 < 0) {
    uVar3 = 0xffffffff;
  }
  else {
    FUN_0002b494();
    iVar1 = FUN_00037982();
    if (iVar1 == 0) {
      DAT_00085af0 = DAT_0008abd2;
      FUN_00038a4e();
      local_c = FUN_000281b6();
      if ((int)local_c < 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                                  ,"app_mgr_main",0xfe);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"app_dm_get_dual_stack_mode failed");
        }
        uVar3 = 0xffffffff;
      }
      else {
        DAT_0008a8c4 = (undefined)local_c;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                                  ,"app_mgr_main",0x105);
        if (iVar1 != 0) {
          pcVar2 = FUN_000386ba();
          duss_log_print(0x5c,3,auStack_8c,"Current DualStack mode:%s",pcVar2);
        }
        uVar3 = 0;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_manager/source/app_manager_main.c"
                                ,"app_mgr_main",0xf2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"Couldn\'t configure successfully, exiting");
      }
      uVar3 = 0xffffffff;
    }
  }
  return uVar3;
}



undefined4 FUN_000398be(int param_1,char *param_2)

{
  if (((param_1 != 0) && (param_1 == 1)) && (*param_2 != '\0')) {
    FUN_0003ec22();
  }
  return 0;
}



void FUN_000398f2(void)

{
  byte abStack_14c [36];
  undefined4 local_128;
  undefined local_dd;
  undefined2 local_da;
  undefined2 local_d8;
  
  memset(abStack_14c,0,0x144);
  local_dd = 0;
  local_128 = 0x21;
  local_da = 0xc;
  local_d8 = 0x14;
  FUN_00027b7e(abStack_14c);
  return;
}



void FUN_00039936(char param_1)

{
  byte local_150 [2];
  byte abStack_14e [34];
  undefined4 local_12c;
  undefined local_126;
  undefined2 local_124;
  undefined2 local_122;
  undefined2 local_120;
  undefined local_e1;
  undefined local_e0;
  char local_9;
  
  memset(local_150,0,0x144);
  local_e1 = 1;
  local_12c = 0x4c;
  local_e0 = 0;
  local_126 = 3;
  local_124 = 0xfff0;
  local_122 = 0x180f;
  local_120 = 0x1812;
  memcpy(abStack_14e,&DAT_000854f8,3);
  local_150[0] = 4;
  abStack_14e[3] = param_1;
  if (param_1 == '\0') {
    local_9 = FUN_00021892();
    abStack_14e[local_150[0]] = local_9 << 6;
    local_150[0] = local_150[0] + 1;
  }
  FUN_00022522(abStack_14e + local_150[0]);
  local_150[0] = local_150[0] + 6;
  FUN_00027b7e(local_150);
  return;
}



undefined4 FUN_00039a58(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c0 [128];
  int local_40;
  int local_3c;
  int local_38;
  int local_34;
  undefined4 local_30;
  undefined local_2c;
  undefined4 local_28;
  undefined4 local_24;
  int local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined local_14;
  int local_10;
  int local_c;
  
  local_c = 0;
  local_10 = 0;
  local_20 = FUN_0003a892(0x9999,0);
  local_c = local_20;
  if (local_20 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"app_ble_setup",0x10a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"server_register fail, server_if %d\n",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_1c = 0xfff0;
    local_18 = 0x10;
    local_14 = 1;
    FUN_0003ada4(&local_20);
    local_10 = FUN_0003acec(local_c,-0x10);
    GKI_delay(10);
    local_38 = local_c;
    local_34 = local_10;
    local_2c = 0;
    local_30 = 0xfff3;
    local_28 = 0x11;
    local_24 = 0x3a;
    FUN_0003b112(&local_38);
    local_2c = 1;
    local_30 = 0x2902;
    FUN_0003b112(&local_38);
    local_2c = 0;
    local_30 = 0xfff4;
    local_28 = 0x11;
    local_24 = 0x3a;
    FUN_0003b112(&local_38);
    local_2c = 1;
    local_30 = 0x2902;
    FUN_0003b112(&local_38);
    local_2c = 0;
    local_30 = 0xfff5;
    local_28 = 0x11;
    local_24 = 0x36;
    FUN_0003b112(&local_38);
    local_2c = 1;
    local_30 = 0x2902;
    FUN_0003b112(&local_38);
    local_40 = local_c;
    local_3c = local_10;
    FUN_0003b4b0(&local_40);
    FUN_00027272(1);
    FUN_000398f2();
    FUN_00039fc4(0x20,0x80);
    FUN_00039936('\0');
    FUN_0003a3e8();
    DAT_00085508 = local_c;
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"app_ble_setup",0x14b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"server_register succ, server_if %d\n",local_c);
    }
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_00039c5e(void)

{
  FUN_0003eb9c();
  return;
}



size_t FUN_00039c6a(char *param_1)

{
  size_t sVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined auStack_18c [128];
  byte abStack_10c [4];
  undefined local_108;
  undefined local_107;
  size_t local_14;
  char *local_10;
  int local_c;
  
  memset(abStack_10c,0,0xf8);
  abStack_10c[1] = 0x10;
  abStack_10c[2] = 0x11;
  abStack_10c[3] = 0xf1;
  local_108 = 0xff;
  local_107 = 0x12;
  local_10 = param_1;
  FUN_00022522(abStack_10c);
  sVar1 = strlen(local_10);
  sprintf(local_10 + sVar1,"%02X",0xaa);
  sVar1 = strlen(local_10);
  sprintf(local_10 + sVar1,"%02X",8);
  sVar1 = strlen(local_10);
  sprintf(local_10 + sVar1,"%02X",0x82);
  sVar1 = strlen(local_10);
  puVar3 = (undefined4 *)(local_10 + sVar1);
  *puVar3 = 0x454b4157;
  *(undefined2 *)(puVar3 + 1) = 0x5055;
  *(undefined *)((int)puVar3 + 6) = 0;
  for (local_c = 0; local_c < 6; local_c = local_c + 1) {
    sVar1 = strlen(local_10);
    sprintf(local_10 + sVar1,"%02X",(uint)abStack_10c[local_c]);
  }
  local_14 = strlen(local_10);
  iVar2 = duss_log_gen_head(0x5c,3,auStack_18c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                            ,"app_ble_makeup_lpm_wake_name",0x16a);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_18c,"wms: lpm wake name: %s(%d)\n",local_10,local_14);
  }
  return local_14;
}



void FUN_00039df0(void)

{
  int iVar1;
  size_t sVar2;
  undefined auStack_cc [128];
  byte local_4c;
  undefined local_4b;
  undefined local_4a;
  undefined2 local_48;
  undefined2 local_46;
  undefined local_44;
  undefined local_43;
  byte abStack_3e [20];
  undefined auStack_2a [30];
  int local_c;
  
  local_c = DAT_00085508;
  if ((DAT_00085508 < 0) || (3 < DAT_00085508)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"app_ble_cfg_lpm",0x174);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_cc,"wms: cfg_lpm: server_index err (%d)\n",local_c);
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"app_ble_cfg_lpm",0x178);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"wms: app_ble_cfg_lpm enter: server_index (%d)\n",local_c);
    }
    FUN_0003d788(local_c);
    memset(&local_4c,0,0x40);
    local_4c = 0;
    local_4b = 0;
    local_4a = 6;
    memcpy((void *)((int)&local_48 + 1),&DAT_000854fc,9);
    local_48._0_1_ = '\t';
    FUN_00022522(abStack_3e);
    local_48._0_1_ = (char)local_48 + '\x06';
    memset(auStack_2a,0xff,0x1d);
    FUN_0003f312(&local_4c);
    memset(&local_4c,0,0x40);
    local_4c = 0;
    local_4b = 0;
    local_4a = 5;
    sVar2 = FUN_00039c6a((char *)((int)&local_48 + 1));
    local_48 = CONCAT11(local_48._1_1_,(char)sVar2);
    FUN_0003f312(&local_4c);
    memset(&local_4c,0,0x40);
    local_4c = 0;
    local_4b = 0;
    local_4a = 1;
    local_48 = 0x30;
    local_46 = 0;
    local_44 = 0;
    local_43 = 0x80;
    FUN_0003f312(&local_4c);
    FUN_0003f032();
    FUN_000278fe(0x200,0x80,1);
    FUN_00025ce4(0,0);
  }
  return;
}



undefined4 FUN_00039fc4(undefined2 param_1,undefined2 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined2 local_18;
  undefined2 local_16;
  
  memset(&local_18,0,0x10);
  local_18 = param_1;
  local_16 = param_2;
  iVar1 = FUN_00027d2a(&local_18);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_0003a00a(int param_1,size_t param_2)

{
  int iVar1;
  undefined auStack_304 [128];
  int local_284;
  int local_280;
  size_t local_27c;
  undefined auStack_278 [600];
  size_t local_20;
  int local_1c;
  int local_18;
  int local_14;
  size_t local_10;
  size_t local_c;
  
  local_1c = 0;
  local_20 = 0x14;
  local_c = 0;
  local_14 = 0;
  local_18 = DAT_00085508;
  local_10 = param_2;
  if ((DAT_00085508 < 0) || (3 < DAT_00085508)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_304,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"bt_msg_send",0x1bc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_304,"wms: bt_msg_send: server_index err (%d)\n",local_18);
    }
    local_14 = -2;
  }
  else {
    local_280 = FUN_0003acec(DAT_00085508,-0xc);
    local_1c = local_280;
    if (local_280 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_304,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                                ,"bt_msg_send",0x1c4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_304,"attribute not found by %#x %#x",0x9999,0xfff4);
      }
      local_14 = -2;
    }
    else {
      local_284 = local_18;
      do {
        if ((int)local_10 < 1) {
          return local_14;
        }
        if ((int)local_20 < (int)local_10) {
          local_c = local_20;
        }
        else {
          local_c = local_10;
        }
        local_27c = local_c;
        memcpy(auStack_278,(void *)(param_1 + (param_2 - local_10)),local_c);
        local_10 = local_10 - local_c;
        local_14 = FUN_0003bc82(&local_284);
      } while (-1 < local_14);
      iVar1 = duss_log_gen_head(0x5c,1,auStack_304,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                                ,"bt_msg_send",0x1dc);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_304,"wms: server_send_notify: ret (%d), left %d\n",local_14,
                       local_10);
      }
    }
  }
  return local_14;
}



undefined4 FUN_0003a204(void *param_1,size_t param_2)

{
  undefined4 local_c;
  
  local_c = 0;
  pthread_mutex_lock((pthread_mutex_t *)&DAT_00085990);
  if (param_2 + DAT_00086d3c < 0x1001) {
    memcpy(&DAT_00085d3c + DAT_00086d3c,param_1,param_2);
    DAT_00086d3c = DAT_00086d3c + param_2;
  }
  else {
    local_c = 0xffffffff;
  }
  pthread_mutex_unlock((pthread_mutex_t *)&DAT_00085990);
  return local_c;
}



undefined4 FUN_0003a286(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = FUN_0003eae2();
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                              ,"app_ble_main",0x1ff);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Couldn\'t Initialize BLE app");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_c = FUN_0003ec22();
    if (local_c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_main.c"
                                ,"app_ble_main",0x207);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"Couldn\'t Start BLE app");
      }
      uVar2 = 0xffffffff;
    }
    else {
      FUN_0004018e(9000);
      uVar2 = 0;
    }
  }
  return uVar2;
}



int FUN_0003a348(void)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (3 < local_c) {
      return -1;
    }
    if ((&DAT_0008ac58)[local_c * 0x580] == '\0') break;
    local_c = local_c + 1;
  }
  return local_c;
}



int FUN_0003a390(ushort param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (0x31 < local_c) {
      return -1;
    }
    if (*(short *)(&DAT_0008ac64 + local_c * 0x1c + (uint)param_1 * 0x580) == 0) break;
    local_c = local_c + 1;
  }
  return local_c;
}



void FUN_0003a3e8(void)

{
  int iVar1;
  undefined auStack_a0 [128];
  int local_20;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_display",0x65);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"*************** BLE SERVER LIST *****************");
  }
  for (local_1c = 0; local_1c < 4; local_1c = local_1c + 1) {
    if ((&DAT_0008ac58)[local_1c * 0x580] != '\0') {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_display",0x6b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_a0,"%d:BLE Server server_if:%d",local_1c,
                       (&DAT_0008ac59)[local_1c * 0x580]);
      }
      for (local_20 = 0; local_20 < 0x32; local_20 = local_20 + 1) {
        if (*(short *)(&DAT_0008ac64 + local_20 * 0x1c + local_1c * 0x580) != 0) {
          if (((&DAT_0008ac78)[local_20 * 0x1c + local_1c * 0x580] == '\x03') ||
             ((&DAT_0008ac78)[local_20 * 0x1c + local_1c * 0x580] == '\0')) {
            iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                      ,"app_ble_server_display",0x78);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_a0,
                             "\t attr_num:%d:uuid:0x%04x, is_pri:%d, service_id:%d attr_id:%d",
                             local_20,*(undefined2 *)
                                       (&DAT_0008ac64 + local_20 * 0x1c + local_1c * 0x580),
                             (&DAT_0008ac7a)[local_20 * 0x1c + local_1c * 0x580],
                             *(undefined2 *)(&DAT_0008ac74 + local_20 * 0x1c + local_1c * 0x580),
                             *(undefined2 *)(&DAT_0008ac76 + local_20 * 0x1c + local_1c * 0x580));
            }
          }
          else {
            iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                      ,"app_ble_server_display",0x81);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_a0,
                             "\t\t attr_num:%d:uuid:0x%04x, is_pri:%d, service_id:%d attr_id:%d",
                             local_20,*(undefined2 *)
                                       (&DAT_0008ac64 + local_20 * 0x1c + local_1c * 0x580),
                             (&DAT_0008ac7a)[local_20 * 0x1c + local_1c * 0x580],
                             *(undefined2 *)(&DAT_0008ac74 + local_20 * 0x1c + local_1c * 0x580),
                             *(undefined2 *)(&DAT_0008ac76 + local_20 * 0x1c + local_1c * 0x580));
            }
          }
        }
      }
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_display",0x87);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"*************** BLE SERVER LIST END *************");
  }
  return;
}



int FUN_0003a7f6(char param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (3 < local_c) {
      return -1;
    }
    if (param_1 == (&DAT_0008ac59)[local_c * 0x580]) break;
    local_c = local_c + 1;
  }
  return local_c;
}



int FUN_0003a844(short param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (3 < local_c) {
      return -1;
    }
    if (param_1 == *(short *)(&DAT_0008ac5a + local_c * 0x580)) break;
    local_c = local_c + 1;
  }
  return local_c;
}



int FUN_0003a892(undefined2 param_1,int param_2)

{
  int iVar1;
  undefined auStack_ac [128];
  undefined2 local_2c [2];
  undefined2 local_28;
  undefined local_18;
  int local_14;
  short local_e;
  int local_c;
  
  local_c = FUN_0003a348();
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_register",0xed);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,"No more spaces!!");
    }
    local_c = -1;
  }
  else {
    local_e = BSA_BleSeAppRegisterInit(local_2c);
    if (local_e == 0) {
      local_2c[0] = 2;
      local_14 = param_2;
      if (param_2 == 0) {
        local_14 = 0x3bedd;
      }
      local_28 = param_1;
      local_e = BSA_BleSeAppRegister(local_2c);
      if (local_e == 0) {
        (&DAT_0008ac58)[local_c * 0x580] = 1;
        (&DAT_0008ac59)[local_c * 0x580] = local_18;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_register",0x10c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"enabled:%d, server_if:%d",
                         (&DAT_0008ac58)[local_c * 0x580],(&DAT_0008ac59)[local_c * 0x580]);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_register",0x106);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_ac,"BSA_BleSeAppRegister failed status = %d",local_e);
        }
        local_c = -1;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_register",0xf4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_ac,"BSA_BleSeAppRegisterInit failed status = %d",local_e);
      }
      local_c = -1;
    }
  }
  return local_c;
}



undefined4 FUN_0003aaa8(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined local_10 [2];
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_deregister",0x122);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Bluetooth BLE deregister menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_deregister",0x123);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Select Server:");
  }
  FUN_0003a3e8();
  local_c = FUN_0002f22c("Select");
  if ((local_c < 0) || (3 < local_c)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_deregister",0x128);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Wrong server number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else if ((&DAT_0008ac58)[local_c * 0x580] == '\x01') {
    local_e = BSA_BleSeAppDeregisterInit(local_10);
    if (local_e == 0) {
      local_10[0] = (&DAT_0008ac59)[local_c * 0x580];
      local_e = BSA_BleSeAppDeregister(local_10);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_deregister",0x13d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleSeAppDeregister failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_deregister",0x134);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"BSA_BleSeAppDeregisterInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_deregister",0x12d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Server was not registered! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_0003acec(int param_1,short param_2)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (3 < local_c) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_find_attribute_by_uuid",0x15b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_8c,"%s: attribute not found by %#x %#x",
                       "app_ble_server_find_attribute_by_uuid",param_1,param_2);
      }
      return -1;
    }
    if (param_2 == *(short *)(&DAT_0008ac64 + local_c * 0x1c + param_1 * 0x580)) break;
    local_c = local_c + 1;
  }
  return local_c;
}



undefined4 FUN_0003ada4(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c4 [128];
  undefined local_44 [4];
  undefined2 local_40;
  undefined2 local_3c;
  undefined2 local_2a;
  undefined local_28;
  short local_22;
  int local_20;
  char local_19;
  undefined2 local_18;
  undefined2 local_16;
  int local_14;
  
  local_14 = *param_1;
  if ((&DAT_0008ac58)[local_14 * 0x580] == '\x01') {
    local_16 = (undefined2)param_1[1];
    local_18 = (undefined2)param_1[2];
    local_19 = *(char *)(param_1 + 3);
    local_20 = FUN_0003a390((ushort)local_14);
    if (local_20 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_create_service",0x180);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c4,"Wrong attr number! = %d",local_20);
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_22 = BSA_BleSeCreateServiceInit(local_44);
      if (local_22 == 0) {
        local_3c = local_16;
        local_40 = 2;
        local_44[0] = (&DAT_0008ac59)[local_14 * 0x580];
        local_2a = local_18;
        local_28 = local_19 != '\0';
        (&DAT_0008ac7b)[local_20 * 0x1c + local_14 * 0x580] = 1;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_create_service",0x198);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c4,"%s: set attr %d wait_flag",
                         "app_ble_server_create_service",local_20);
        }
        local_22 = BSA_BleSeCreateService(local_44);
        if (local_22 == 0) {
          *(undefined2 *)(&DAT_0008ac60 + local_20 * 0x1c + local_14 * 0x580) = 2;
          *(undefined2 *)(&DAT_0008ac64 + local_20 * 0x1c + local_14 * 0x580) = local_16;
          (&DAT_0008ac7a)[local_20 * 0x1c + local_14 * 0x580] = local_28;
          (&DAT_0008ac78)[local_20 * 0x1c + local_14 * 0x580] = 3;
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_create_service",0x19d);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_c4,"BSA_BleSeCreateService failed status = %d",local_22);
          }
          (&DAT_0008ac7b)[local_20 * 0x1c + local_14 * 0x580] = 0;
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_create_service",0x186);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_c4,"BSA_BleSeCreateServiceInit failed status = %d",local_22)
          ;
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_create_service",0x176);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c4,"Server was not enabled! = %d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003b112(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined uVar3;
  undefined auStack_c0 [128];
  byte local_40 [2];
  undefined2 local_3e;
  undefined2 local_3c;
  undefined2 local_38;
  undefined2 local_28;
  undefined local_26;
  uint local_24;
  short local_20;
  undefined2 local_1e;
  int local_1c;
  int local_18;
  int local_14;
  
  local_14 = *param_1;
  if ((&DAT_0008ac58)[local_14 * 0x580] == '\x01') {
    local_18 = param_1[1];
    local_1c = FUN_0003a390((ushort)local_14);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_add_char",0x1c9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c0,"%s: Wrong attr number! = %d","app_ble_server_add_char",
                       local_1c);
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_1e = (undefined2)param_1[2];
      local_20 = BSA_BleSeAddCharInit(local_40);
      if (local_20 == 0) {
        local_3e = *(undefined2 *)(&DAT_0008ac74 + local_18 * 0x1c + local_14 * 0x580);
        local_3c = 2;
        local_38 = local_1e;
        local_40[0] = *(byte *)(param_1 + 3);
        local_24 = (uint)local_40[0];
        local_28 = (undefined2)param_1[4];
        if (local_24 == 0) {
          local_26 = (undefined)param_1[5];
        }
        (&DAT_0008ac7b)[local_1c * 0x1c + local_14 * 0x580] = 1;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_add_char",0x1e1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"%s: set attr %d wait_flag","app_ble_server_add_char",
                         local_1c);
        }
        local_20 = BSA_BleSeAddChar(local_40);
        if (local_20 == 0) {
          *(undefined2 *)(&DAT_0008ac60 + local_1c * 0x1c + local_14 * 0x580) = 2;
          *(undefined2 *)(&DAT_0008ac64 + local_1c * 0x1c + local_14 * 0x580) = local_1e;
          (&DAT_0008ac79)[local_1c * 0x1c + local_14 * 0x580] = (char)param_1[5];
          if (local_24 == 0) {
            uVar3 = 1;
          }
          else {
            uVar3 = 2;
          }
          (&DAT_0008ac78)[local_1c * 0x1c + local_14 * 0x580] = uVar3;
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_add_char",0x1e6);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_c0,"BSA_BleSeAddChar failed status = %d",local_20);
          }
          (&DAT_0008ac7b)[local_1c * 0x1c + local_14 * 0x580] = 0;
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_add_char",0x1d1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_c0,"BSA_BleSeAddCharInit failed status = %d",local_20);
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_add_char",0x1c1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"Server was not enabled! = %d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003b4b0(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [128];
  undefined2 local_18;
  undefined local_16;
  short local_12;
  int local_10;
  int local_c;
  
  local_c = *param_1;
  if ((&DAT_0008ac58)[local_c * 0x580] == '\x01') {
    local_10 = param_1[1];
    local_12 = BSA_BleSeStartServiceInit(&local_18);
    if (local_12 == 0) {
      local_18 = *(undefined2 *)(&DAT_0008ac74 + local_10 * 0x1c + local_c * 0x580);
      local_16 = 3;
      iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_start_service",0x217);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_98,"service_id:%d, num:%d",local_18,local_c);
      }
      local_12 = BSA_BleSeStartService(&local_18);
      if (local_12 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_start_service",0x21c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_98,"BSA_BleSeStartService failed status = %d",local_12);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_start_service",0x210);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_98,"BSA_BleSeStartServiceInit failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_start_service",0x208);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_98,"Server was not enabled! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003b68c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined2 local_14;
  short local_12;
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_stop_service",0x233);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Select Server:");
  }
  FUN_0003a3e8();
  local_c = FUN_0002f22c("Select");
  if ((local_c < 0) || (3 < local_c)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_stop_service",0x238);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Wrong server number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else if ((&DAT_0008ac58)[local_c * 0x580] == '\x01') {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_stop_service",0x241);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"Select Service\'s attribute number :");
    }
    local_10 = FUN_0002f22c("Select");
    if (local_10 < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_stop_service",0x246);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_94,"app_ble_server_stop_service : Invalid attr_num entered");
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_12 = BSA_BleSeStopServiceInit(&local_14);
      if (local_12 == 0) {
        local_14 = *(undefined2 *)(&DAT_0008ac74 + local_10 * 0x1c + local_c * 0x580);
        iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_stop_service",0x253);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_94,"service_id:%d, num:%d",local_14,local_c);
        }
        local_12 = BSA_BleSeStopService(&local_14);
        if (local_12 == 0) {
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_stop_service",600);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_94,"BSA_BleSeStopService failed status = %d",local_12);
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_stop_service",0x24d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_94,"BSA_BleSeStopServiceInit failed status = %d",local_12);
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_stop_service",0x23d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Server was not enabled! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003b986(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_2fc [128];
  undefined2 local_27c;
  undefined2 local_27a;
  undefined2 local_278;
  undefined auStack_276 [600];
  undefined local_1e;
  int local_1c;
  short local_16;
  int local_14;
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_2fc,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_send_indication",0x26f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_2fc,"Select Server:");
  }
  FUN_0003a3e8();
  local_10 = FUN_0002f22c("Select");
  if ((local_10 < 0) || (3 < local_10)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2fc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_send_indication",0x274);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2fc,"Wrong server number! = %d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  else if ((&DAT_0008ac58)[local_10 * 0x580] == '\x01') {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_2fc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_send_indication",0x27c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_2fc,"Select Service\'s attribute number :");
    }
    local_14 = FUN_0002f22c("Select");
    if (local_14 == -1) {
      uVar2 = 0xffffffff;
    }
    else {
      local_16 = BSA_BleSeSendIndInit(&local_27c);
      if (local_16 == 0) {
        local_27c = *(undefined2 *)(&DAT_0008ac5a + local_10 * 0x580);
        local_27a = *(undefined2 *)(&DAT_0008ac76 + local_14 * 0x1c + local_10 * 0x580);
        local_1c = FUN_0002f22c("Enter length of data");
        local_278 = (undefined2)local_1c;
        for (local_c = 0; local_c < local_1c; local_c = local_c + 1) {
          iVar1 = FUN_0002f22c("Enter data in byte");
          auStack_276[local_c] = (char)iVar1;
        }
        local_1e = 1;
        local_16 = BSA_BleSeSendInd(&local_27c);
        if (local_16 == 0) {
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_2fc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_send_indication",0x297);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_2fc,"BSA_BleSeSendInd failed status = %d",local_16);
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_2fc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_send_indication",0x283);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_2fc,"BSA_BleSeSendIndInit failed status = %d",local_16);
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2fc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_send_indication",0x279);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2fc,"Server was not enabled! = %d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003bc82(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_2f8 [128];
  undefined2 local_278;
  undefined2 local_276;
  undefined2 local_274;
  undefined auStack_272 [600];
  undefined local_1a;
  size_t local_18;
  short local_12;
  int local_10;
  int local_c;
  
  local_c = *param_1;
  if ((&DAT_0008ac58)[local_c * 0x580] == '\x01') {
    if (*(short *)(&DAT_0008ac5a + local_c * 0x580) == -1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_2f8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_send_notification",0x2b8);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_2f8,"server %d invalid conn_id",local_c);
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_10 = param_1[1];
      local_12 = BSA_BleSeSendIndInit(&local_278);
      if (local_12 == 0) {
        local_278 = *(undefined2 *)(&DAT_0008ac5a + local_c * 0x580);
        local_276 = *(undefined2 *)(&DAT_0008ac76 + local_10 * 0x1c + local_c * 0x580);
        local_18 = param_1[2];
        local_274 = (undefined2)local_18;
        memcpy(auStack_272,param_1 + 3,local_18);
        local_1a = 0;
        local_12 = BSA_BleSeSendInd(&local_278);
        if (local_12 == 0) {
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_2f8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_send_notification",0x2d0);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_2f8,"BSA_BleSeSendInd failed status = %d",local_12);
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_2f8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_send_notification",0x2c0);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_2f8,"BSA_BleSeSendIndInit failed status = %d",local_12);
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_send_notification",0x2b2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2f8,"Server was not enabled! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_0003bedc(undefined4 param_1,short *param_2)

{
  int iVar1;
  undefined auStack_308 [128];
  short local_288;
  undefined2 local_286;
  undefined local_284;
  short local_282;
  short local_280;
  ushort local_27e;
  undefined local_27c;
  undefined auStack_27b [603];
  int local_20;
  int local_1c;
  ushort local_16;
  int local_14;
  
  switch(param_1) {
  case 0xd:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x2ef);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_DEREGISTER_EVT server_if:%d status:%d",
                     *(undefined *)(param_2 + 1),*param_2);
    }
    local_1c = FUN_0003a7f6(*(char *)(param_2 + 1));
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x2f3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"no deregister pending!!");
      }
    }
    else {
      (&DAT_0008ac59)[local_1c * 0x580] = 0xff;
      (&DAT_0008ac58)[local_1c * 0x580] = 0;
      for (local_14 = 0; local_14 < 0x32; local_14 = local_14 + 1) {
        memset(&DAT_0008ac60 + local_14 * 0x1c + local_1c * 0x580,0,0x1c);
      }
    }
    break;
  case 0xe:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x302);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_CREATE_EVT server_if:%d status:%d service_id:%d"
                     ,*(undefined *)param_2,param_2[2],param_2[1]);
    }
    local_1c = FUN_0003a7f6(*(char *)param_2);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x309);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"no interface!!");
      }
    }
    else {
      for (local_14 = 0; local_14 < 0x32; local_14 = local_14 + 1) {
        if ((&DAT_0008ac7b)[local_14 * 0x1c + local_1c * 0x580] == '\x01') {
          iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_profile_cback",0x312);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_CREATE_EVT if_num:%d, attr_num:%d",
                           local_1c,local_14);
          }
          if (param_2[2] == 0) {
            iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                      ,"app_ble_server_profile_cback",0x315);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_308,"%s: clear attr %d wait_flag",
                             "app_ble_server_profile_cback",local_14);
            }
            *(short *)(&DAT_0008ac74 + local_14 * 0x1c + local_1c * 0x580) = param_2[1];
            (&DAT_0008ac7b)[local_14 * 0x1c + local_1c * 0x580] = 0;
          }
          else {
            memset(&DAT_0008ac60 + local_14 * 0x1c + local_1c * 0x580,0,0x1c);
          }
          break;
        }
      }
      if ((0x31 < local_14) &&
         (iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_profile_cback",0x323), iVar1 != 0)) {
        duss_log_print(0x5c,1,auStack_308,"BSA_BLE_SE_CREATE_EVT no waiting!!");
      }
    }
    break;
  case 0xf:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x329);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_ADDCHAR_EVT status:%d",param_2[3]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x32a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"attr_id:0x%x",param_2[2]);
    }
    local_1c = FUN_0003a7f6(*(char *)param_2);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x330);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"no interface!!");
      }
    }
    else {
      for (local_14 = 0; local_14 < 0x32; local_14 = local_14 + 1) {
        if ((&DAT_0008ac7b)[local_14 * 0x1c + local_1c * 0x580] == '\x01') {
          iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_profile_cback",0x338);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_308,"if_num:%d, attr_num:%d",local_1c,local_14);
          }
          if (param_2[3] == 0) {
            iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                      ,"app_ble_server_profile_cback",0x33b);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_308,"%s: clear attr %d wait_flag",
                             "app_ble_server_profile_cback",local_14);
            }
            *(short *)(&DAT_0008ac74 + local_14 * 0x1c + local_1c * 0x580) = param_2[1];
            *(short *)(&DAT_0008ac76 + local_14 * 0x1c + local_1c * 0x580) = param_2[2];
            (&DAT_0008ac7b)[local_14 * 0x1c + local_1c * 0x580] = 0;
          }
          else {
            memset(&DAT_0008ac60 + local_14 * 0x1c + local_1c * 0x580,0,0x1c);
          }
          break;
        }
      }
      if ((0x31 < local_14) &&
         (iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_profile_cback",0x34a), iVar1 != 0)) {
        duss_log_print(0x5c,1,auStack_308,"BSA_BLE_SE_ADDCHAR_EVT no waiting!!");
      }
    }
    break;
  case 0x10:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x350);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_START_EVT status:%d",param_2[2]);
    }
    break;
  case 0x11:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x354);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_STOP_EVT status:%d",*param_2);
    }
    break;
  case 0x12:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x38b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_WRITE_EVT status:%d",param_2[0x137]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x38e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_WRITE_EVT trans_id:%d, conn_id:%d, handle:%d",
                     *(undefined4 *)(param_2 + 4),param_2[6],param_2[7]);
    }
    if ((ushort)param_2[9] < 0x259) {
      DAT_0008550c = param_2[9];
      memcpy(&DAT_00085510,param_2 + 10,(uint)DAT_0008550c);
      FUN_0003a204(param_2 + 10,(uint)(ushort)param_2[9]);
    }
    else {
      param_2[0x137] = 0xd;
    }
    if (*(char *)(param_2 + 0x136) != '\0') {
      BSA_BleSeSendRspInit(&local_288);
      local_288 = param_2[6];
      local_286 = (undefined2)*(undefined4 *)(param_2 + 4);
      local_284 = (undefined)param_2[0x137];
      local_282 = param_2[7];
      local_27e = param_2[9];
      local_280 = param_2[8];
      memcpy(auStack_27b,param_2 + 10,(uint)(ushort)param_2[9]);
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3a7);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,
                       "BSA_BLE_SE_WRITE_EVT: send_server_resp.conn_id:%d, send_server_resp.trans_id:%d, status %d"
                       ,local_288,local_286,local_284);
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3a8);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,
                       "BSA_BLE_SE_WRITE_EVT: send_server_resp.status:%d,send_server_resp.auth_req:%d"
                       ,local_284,local_27c);
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3a9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,
                       "BSA_BLE_SE_WRITE_EVT: send_server_resp.handle:%d, send_server_resp.offset:%d, send_server_resp.len:%d"
                       ,local_282,local_280,local_27e);
      }
      BSA_BleSeSendRsp(&local_288);
    }
    break;
  case 0x13:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3b0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_EXEC_WRITE_EVT trans_id:%d, conn_id:%d",
                     *(undefined4 *)(param_2 + 4),param_2[6]);
    }
    BSA_BleSeSendRspInit(&local_288);
    local_288 = param_2[6];
    local_286 = (undefined2)*(undefined4 *)(param_2 + 4);
    local_284 = 0;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3b7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"conn_id:%d, trans_id:%d",local_288,local_286);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3b9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"status:%d, auth_req:%d",local_284,local_27c);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3bb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"handle:%d, offset:%d, len:%d",local_282,local_280,local_27e
                    );
    }
    BSA_BleSeSendRsp(&local_288);
    break;
  case 0x14:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3df);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_MTU_EVT  :conn_id:0x%x, mtu:%d",*param_2,
                     param_2[1]);
    }
    local_1c = FUN_0003a844(*param_2);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3e3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"Incorrect connection id : %d",*param_2);
      }
    }
    else {
      *(short *)(&DAT_0008ac5c + local_1c * 0x580) = param_2[1];
    }
    break;
  case 0x15:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3ed);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_CONGEST_EVT  :conn_id:0x%x, congested:%d",
                     *param_2,*(undefined *)(param_2 + 1));
    }
    break;
  case 0x16:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x359);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"BSA_BLE_SE_READ_EVT status:%d, is_long:%d, offset:%d",
                     param_2[10],*(undefined *)(param_2 + 9),param_2[8]);
    }
    if (*(char *)(param_2 + 9) == '\0') {
      if (param_2[8] != 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_profile_cback",0x35e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_308,"For Read Request, Offset should be 0!");
        }
        param_2[8] = 0;
      }
    }
    else {
      local_1c = FUN_0003a844(param_2[6]);
      if (local_1c < 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_profile_cback",0x367);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_308,"Incorrect connection id : %d",param_2[6]);
        }
      }
      else if (DAT_0008550c <= *(ushort *)(&DAT_0008ac5c + local_1c * 0x580)) {
        param_2[10] = 0xb;
      }
    }
    local_16 = DAT_0008550c;
    if (DAT_0008550c <= (ushort)param_2[8]) {
      local_27e = 0;
      local_16 = 0;
      param_2[10] = 7;
    }
    if (local_16 != 0) {
      local_16 = local_16 - param_2[8];
    }
    BSA_BleSeSendRspInit(&local_288);
    local_288 = param_2[6];
    local_286 = (undefined2)*(undefined4 *)(param_2 + 4);
    local_284 = (undefined)param_2[10];
    local_282 = param_2[7];
    local_280 = param_2[8];
    local_27e = local_16;
    local_27c = 0;
    memcpy(auStack_27b,&DAT_00085510 + (ushort)param_2[8],(uint)local_16);
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",899);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,
                     "BSA_BLE_SE_READ_EVT: send_server_resp.conn_id:%d, send_server_resp.trans_id:%d, status %d"
                     ,local_288,local_286,local_284);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",900);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,
                     "BSA_BLE_SE_READ_EVT: send_server_resp.status:%d,send_server_resp.auth_req:%d",
                     local_284,local_27c);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x385);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,
                     "BSA_BLE_SE_READ_EVT: send_server_resp.handle:%d, send_server_resp.offset:%d, send_server_resp.len:%d"
                     ,local_282,local_280,local_27e);
    }
    BSA_BleSeSendRsp(&local_288);
    break;
  case 0x17:
    iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3c1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_308,"BSA_BLE_SE_OPEN_EVT status:%d, conn_id %d, server_if %d",
                     param_2[5],param_2[4],*(undefined *)param_2);
    }
    if (param_2[5] == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3c4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"conn_id:0x%x",param_2[4]);
      }
      local_1c = FUN_0003a7f6(*(char *)param_2);
      if (local_1c < 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_profile_cback",0x3c9);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_308,"no interface!!");
        }
      }
      else {
        *(short *)(&DAT_0008ac5a + local_1c * 0x580) = param_2[4];
        FUN_0002a97e();
        FUN_0002e666(0x896e8,10,(int)param_2 + 1,0x40000000);
        local_20 = FUN_0002aa0a();
        if ((local_20 < 0) &&
           (iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                      ,"app_ble_server_profile_cback",0x3d8), iVar1 != 0)) {
          duss_log_print(0x5c,1,auStack_308,"app_ble_write_remote_devices failed: %d",local_20);
        }
      }
    }
    break;
  case 0x18:
    iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3f1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_308,"BSA_BLE_SE_CLOSE_EVT status:%d, conn_id %d",param_2[5],
                     param_2[4]);
    }
    local_1c = FUN_0003a7f6(*(char *)param_2);
    if (local_1c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_profile_cback",0x3f6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"no interface!!");
      }
    }
    else {
      *(undefined2 *)(&DAT_0008ac5a + local_1c * 0x580) = 0xffff;
    }
    break;
  case 0x19:
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_profile_cback",0x3ff);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,
                     "BSA_BLE_SE_CONFIRM_EVT:conn_id:0x%x, attr_id:0x%x, status:%d",*param_2,
                     param_2[2],param_2[1]);
    }
  }
  return;
}



undefined4 FUN_0003d27c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a8 [128];
  undefined auStack_28 [8];
  undefined local_20;
  undefined auStack_1f [6];
  undefined local_19;
  int local_18;
  short local_12;
  int local_10;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_open",0x41c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a8,"Bluetooth BLE connect menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_open",0x41d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a8,"    0 Device from XML database (already paired)");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_open",0x41e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a8,"    1 Device found in last discovery");
  }
  local_c = FUN_0002f22c("Select source");
  if (local_c == 0) {
    FUN_0002a97e();
    FUN_0002e882(0x896e8,10);
    local_c = FUN_0002f22c("Select device");
    if (((local_c < 0) || (9 < local_c)) || ((&DAT_000896e8)[local_c * 0x1b0] == '\0')) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_open",0x431);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"Bad Device Index:%d\n",local_c);
      }
      return 0xffffffff;
    }
    bdcpy(auStack_28,&DAT_000896e9 + local_c * 0x1b0);
  }
  else {
    if (local_c != 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_open",0x444);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"Bad choice [XML(0) or Disc(1) only]");
      }
      return 0xffffffff;
    }
    FUN_00023ce4();
    local_c = FUN_0002f22c("Select device");
    if (((-1 < local_c) && (local_c < 0x14)) && ((&DAT_00086d50)[local_c * 0x210] != '\0')) {
      bdcpy(auStack_28,&DAT_00086d54 + local_c * 0x210);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                            ,"app_ble_server_open",0x448);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a8,"Select Server:");
  }
  FUN_0003a3e8();
  local_10 = FUN_0002f22c("Select");
  if (((local_10 < 0) || (3 < local_10)) || ((&DAT_0008ac58)[local_10 * 0x580] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_open",0x450);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"Wrong server number! = %d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  else if (*(short *)(&DAT_0008ac5a + local_10 * 0x580) == -1) {
    local_12 = BSA_BleSeConnectInit(&local_20);
    if (local_12 == 0) {
      local_20 = (&DAT_0008ac59)[local_10 * 0x580];
      local_18 = FUN_0002f22c("Direct connection:1, Background connection:0");
      if (local_18 == 1) {
        local_19 = 1;
      }
      else {
        if (local_18 != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                    ,"app_ble_server_open",0x46e);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_a8,"Wrong selection! = %d",local_18);
          }
          return 0xffffffff;
        }
        local_19 = 0;
      }
      bdcpy(auStack_1f,auStack_28);
      local_12 = BSA_BleSeConnect(&local_20);
      if (local_12 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_open",0x476);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a8,"BSA_BleSeConnect failed status = %d",local_12);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_open",0x45e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"BSA_BleSeConnectInit failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_open",0x457);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"Connection already exist, conn_id = %d",
                     *(undefined2 *)(&DAT_0008ac5a + local_10 * 0x580));
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003d788(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined2 local_10;
  short local_e;
  int local_c;
  
  local_c = param_1;
  if (((param_1 < 0) || (3 < param_1)) || ((&DAT_0008ac58)[param_1 * 0x580] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                              ,"app_ble_server_close",0x493);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Wrong server number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleSeCloseInit(&local_10);
    if (local_e == 0) {
      local_10 = *(undefined2 *)(&DAT_0008ac5a + local_c * 0x580);
      local_e = BSA_BleSeClose(&local_10);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                  ,"app_ble_server_close",0x4a2);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleSeClose failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_server.c"
                                ,"app_ble_server_close",0x49a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"BSA_BleSeCloseInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0003d918(ushort **param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_bc [128];
  char *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined *local_28;
  undefined **local_24;
  uint local_20;
  size_t local_1c;
  int local_18;
  char local_11;
  char *local_10;
  size_t local_c;
  
  local_3c = (char *)0x0;
  local_11 = '\0';
  local_18 = open("/tmp/EMMC/wireless/bluetooth/./bt_ble_client_devices.xml",0);
  if (local_18 < 0) {
    local_11 = '\x01';
  }
  else {
    local_c = FUN_0002f63a(local_18);
    if (local_c == 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                ,"app_ble_client_xml_read",0x90);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_bc,"file: %s is empty",
                       "/tmp/EMMC/wireless/bluetooth/./bt_ble_client_devices.xml");
      }
      close(local_18);
      local_11 = '\x01';
    }
    else if ((int)local_c < 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                ,"app_ble_client_xml_read",0x96);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_bc,"cannot get file size of: %s",
                       "/tmp/EMMC/wireless/bluetooth/./bt_ble_client_devices.xml");
      }
      close(local_18);
      local_11 = '\x01';
    }
    if (local_11 == '\0') {
      local_10 = (char *)malloc(local_c + 1);
      if (local_10 == (char *)0x0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                  ,"app_ble_client_xml_read",0xa0);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"cannot alloc: %d bytes",local_c);
        }
        close(local_18);
        local_11 = '\x01';
      }
    }
    if (local_11 == '\0') {
      local_1c = read(local_18,local_10,local_c);
      local_10[local_c] = '\0';
      close(local_18);
      if (local_1c != local_c) {
        free(local_10);
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                  ,"app_ble_client_xml_read",0xb2);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"not able to read complete file:%d/%d",local_1c,local_c);
        }
        local_11 = '\x01';
      }
    }
  }
  if (local_11 == '\0') {
    local_38 = 0x3e1e7;
    local_28 = &LAB_0003e4b0_1;
    local_34 = 0x3e4c9;
    local_30 = 0x3e539;
    local_2c = 0x3e65f;
    bVar1 = FUN_0002fa16(&local_24,&local_38);
    local_20 = (uint)bVar1;
    if (local_20 == 0) {
      free(local_10);
      iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                ,"app_ble_client_xml_read",0xca);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_bc,"cannot open Nanoxml :%d",local_20);
      }
      local_11 = '\x01';
    }
    if (local_11 == '\0') {
      DAT_0008abe4 = param_1;
      local_20 = FUN_0002fb2c(local_24,local_10,local_c,&local_3c);
      if (local_20 != 1) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                  ,"app_ble_client_xml_read",0xd6);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"xmlWrite returns :%d",local_20);
        }
        local_11 = '\x01';
      }
      FUN_0002fa7e(local_24);
      free(local_10);
    }
  }
  if ((local_11 == '\0') || (iVar2 = FUN_0003dcda(param_1), -1 < iVar2)) {
    uVar3 = 0;
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                              ,"app_ble_client_xml_read",0xe6);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"Unable to create an empty BLE Client database");
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_0003dcda(ushort **param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a8 [128];
  int local_28;
  int local_24;
  ushort *local_20;
  ushort **local_1c;
  
  local_28 = open("/tmp/EMMC/wireless/bluetooth/./bt_ble_client_devices.xml",0x241,0x1b6);
  if (local_28 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                              ,"app_ble_client_xml_write",0x102);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"Error opening/creating %s file",
                     "/tmp/EMMC/wireless/bluetooth/./bt_ble_client_devices.xml");
    }
    uVar2 = 0xffffffff;
  }
  else {
    FUN_0002abc8(local_28,"Broadcom_Bluetooth_BLE_Devices",'\x01');
    FUN_0002abc8(local_28,"ble_devices",'\x01');
    for (local_1c = param_1; local_1c != (ushort **)0x0; local_1c = (ushort **)local_1c[3]) {
      if ((byte)(*(byte *)((int)local_1c + 9) |
                *(byte *)(local_1c + 2) |
                *(byte *)((int)local_1c + 7) |
                *(byte *)((int)local_1c + 6) |
                *(byte *)((int)local_1c + 5) | *(byte *)(local_1c + 1)) != 0) {
        FUN_0002abc8(local_28,"device",'\x01');
        iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                  ,"app_ble_client_xml_write",0x117);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_a8,
                         "save #2 BDA:%02X:%02X:%02X:%02X:%02X:%02X, client_if= %d ",
                         *(undefined *)(local_1c + 1),*(undefined *)((int)local_1c + 5),
                         *(undefined *)((int)local_1c + 6),*(undefined *)((int)local_1c + 7),
                         *(undefined *)(local_1c + 2),*(undefined *)((int)local_1c + 9),
                         *(undefined2 *)((int)local_1c + 10));
        }
        FUN_0002abc8(local_28,"bd_addr",'\0');
        FUN_0002adf4(local_28,(int)(local_1c + 1),6,'\0');
        FUN_0002ac68(local_28,"bd_addr",'\0');
        for (local_20 = *local_1c; local_20 != (ushort *)0x0;
            local_20 = *(ushort **)(local_20 + 0xe)) {
          iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                    ,"app_ble_client_xml_write",0x121);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_a8,
                           "attr save handle:0x%x type:0x%x uuid:0x%04X, len:%d id:0x%x, prop:0x%x, primary:%d"
                           ,local_20[10],*(undefined *)(local_20 + 0xb),local_20[2],*local_20,
                           *(undefined *)((int)local_20 + 0x17),*(undefined *)(local_20 + 0xc),
                           *(undefined *)((int)local_20 + 0x19));
          }
          FUN_0002abc8(local_28,"attribute",'\x01');
          FUN_0002abc8(local_28,"handle",'\0');
          dprintf(local_28,"%d",(uint)local_20[10]);
          FUN_0002ac68(local_28,"handle",'\0');
          FUN_0002abc8(local_28,"type",'\0');
          dprintf(local_28,"%d",(uint)*(byte *)(local_20 + 0xb));
          FUN_0002ac68(local_28,"type",'\0');
          FUN_0002abc8(local_28,"uuid",'\0');
          if (*local_20 == 2) {
            dprintf(local_28,"0x%04X",(uint)local_20[2]);
          }
          else if (*local_20 == 4) {
            dprintf(local_28,"0x%08X",*(undefined4 *)(local_20 + 2));
          }
          else if (*local_20 == 0x10) {
            dprintf(local_28,"0x%02X",(uint)*(byte *)((int)local_20 + 0x13));
            for (local_24 = 0xe; -1 < local_24; local_24 = local_24 + -1) {
              dprintf(local_28,"%02X",(uint)*(byte *)((int)local_20 + local_24 + 4));
            }
          }
          FUN_0002ac68(local_28,"uuid",'\0');
          FUN_0002abc8(local_28,"len_uuid",'\0');
          dprintf(local_28,"%d",(uint)*local_20);
          FUN_0002ac68(local_28,"len_uuid",'\0');
          FUN_0002abc8(local_28,"id",'\0');
          dprintf(local_28,"%d",(uint)*(byte *)((int)local_20 + 0x17));
          FUN_0002ac68(local_28,"id",'\0');
          FUN_0002abc8(local_28,"prop",'\0');
          dprintf(local_28,"%d",(uint)*(byte *)(local_20 + 0xc));
          FUN_0002ac68(local_28,"prop",'\0');
          FUN_0002abc8(local_28,"IsPrimary",'\0');
          dprintf(local_28,"%d",(uint)*(byte *)((int)local_20 + 0x19));
          FUN_0002ac68(local_28,"IsPrimary",'\0');
          FUN_0002ac68(local_28,"attribute",'\x01');
        }
        FUN_0002ac68(local_28,"device",'\x01');
      }
    }
    FUN_0002ac68(local_28,"ble_devices",'\x01');
    FUN_0002ac68(local_28,"Broadcom_Bluetooth_BLE_Devices",'\x01');
    close(local_28);
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_0003e1e6(undefined4 param_1,char *param_2)

{
  void *pvVar1;
  int iVar2;
  undefined auStack_90 [128];
  void *local_10;
  void **local_c;
  
  iVar2 = strncmp(param_2,"Broadcom_Bluetooth_BLE_Devices",0x1e);
  if ((iVar2 != 0) && (iVar2 = strncmp(param_2,"ble_devices",0xb), iVar2 != 0)) {
    iVar2 = strncmp(param_2,"device",6);
    if (iVar2 == 0) {
      local_c = (void **)FUN_00048910();
      if (local_c == (void **)0x0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                  ,"app_ble_client_xml_tagBeginCallbackFunc",0x179);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_90,"app_ble_db_alloc_element failed");
        }
      }
      else {
        FUN_00048992((int)local_c);
        DAT_0008abe4 = local_c;
      }
      DAT_0008abe0 = 0;
    }
    else {
      iVar2 = strncmp(param_2,"bd_addr",7);
      if (iVar2 == 0) {
        DAT_0008abe0 = 1;
      }
      else {
        iVar2 = strncmp(param_2,"attribute",9);
        if (iVar2 == 0) {
          local_10 = FUN_00048aec(DAT_0008abe4);
          pvVar1 = local_10;
          if ((local_10 == (void *)0x0) &&
             (iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                        ,"app_ble_client_xml_tagBeginCallbackFunc",0x18d),
             pvVar1 = DAT_0008abe8, iVar2 != 0)) {
            duss_log_print(0x5c,1,auStack_90,"app_ble_db_alloc_attr failed");
            pvVar1 = DAT_0008abe8;
          }
          DAT_0008abe8 = pvVar1;
          DAT_0008abe0 = 2;
        }
        else {
          iVar2 = strncmp(param_2,"handle",6);
          if (iVar2 == 0) {
            DAT_0008abe0 = 3;
          }
          else {
            iVar2 = strncmp(param_2,"type",4);
            if (iVar2 == 0) {
              DAT_0008abe0 = 4;
            }
            else {
              iVar2 = strncmp(param_2,"uuid",4);
              if (iVar2 == 0) {
                DAT_0008abe0 = 5;
              }
              else {
                iVar2 = strncmp(param_2,"len_uuid",8);
                if (iVar2 == 0) {
                  DAT_0008abe0 = 6;
                }
                else {
                  iVar2 = strncmp(param_2,"id",2);
                  if (iVar2 == 0) {
                    DAT_0008abe0 = 7;
                  }
                  else {
                    iVar2 = strncmp(param_2,"prop",4);
                    if (iVar2 == 0) {
                      DAT_0008abe0 = 8;
                    }
                    else {
                      iVar2 = strncmp(param_2,"IsPrimary",9);
                      if (iVar2 == 0) {
                        DAT_0008abe0 = 9;
                      }
                      else {
                        iVar2 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                                  ,"app_ble_client_xml_tagBeginCallbackFunc",0x1b4);
                        if (iVar2 != 0) {
                          duss_log_print(0x5c,1,auStack_90,"Unknown Tag:%s",param_2);
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return;
}



void FUN_0003e4c8(undefined4 param_1,char *param_2,size_t param_3)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = strncmp(param_2,"value",param_3);
  if (iVar1 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                              ,"app_ble_client_xml_attrBeginCallbackFunc",0x1d6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"Unsupported attribute (%s)",param_2);
    }
  }
  return;
}



void FUN_0003e538(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_4 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                              ,"app_ble_client_xml_attrValueCallbackFunc",0x1e9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,
                     "Non complete attribute value, probably malformed XML file: %s",param_2);
    }
  }
  return;
}



undefined4 FUN_0003e59c(undefined param_1)

{
  undefined4 uVar1;
  
  switch(param_1) {
  case 0x30:
    uVar1 = 0;
    break;
  case 0x31:
    uVar1 = 1;
    break;
  case 0x32:
    uVar1 = 2;
    break;
  case 0x33:
    uVar1 = 3;
    break;
  case 0x34:
    uVar1 = 4;
    break;
  case 0x35:
    uVar1 = 5;
    break;
  case 0x36:
    uVar1 = 6;
    break;
  case 0x37:
    uVar1 = 7;
    break;
  case 0x38:
    uVar1 = 8;
    break;
  case 0x39:
    uVar1 = 9;
    break;
  default:
    uVar1 = 0;
    break;
  case 0x41:
    uVar1 = 10;
    break;
  case 0x42:
    uVar1 = 0xb;
    break;
  case 0x43:
    uVar1 = 0xc;
    break;
  case 0x44:
    uVar1 = 0xd;
    break;
  case 0x45:
    uVar1 = 0xe;
    break;
  case 0x46:
    uVar1 = 0xf;
  }
  return uVar1;
}



void FUN_0003e65e(undefined4 param_1,char *param_2,uint param_3,int param_4)

{
  undefined2 *puVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  ulong uVar5;
  undefined auStack_98 [128];
  int local_18;
  uint local_14;
  
  if ((param_4 != 0) &&
     (iVar2 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                ,"app_ble_client_xml_dataCallbackFunc",0x223), iVar2 != 0)) {
    duss_log_print(0x5c,1,auStack_98,"Non complete data, probably malformed XML file: %s",param_2);
  }
  puVar1 = DAT_0008abe8;
  switch(DAT_0008abe0) {
  case 1:
    if (DAT_0008abe4 == 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_xml.c"
                                ,"app_ble_client_xml_dataCallbackFunc",0x231);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_98,"BLE_CLIENT_XML_TAG_BDADDR while no device instance");
      }
    }
    else {
      FUN_0002b1f8((void *)(DAT_0008abe4 + 4),6,(int)param_2,param_3);
    }
    break;
  case 3:
    uVar5 = FUN_0002b280(param_2,param_3);
    puVar1[10] = (short)uVar5;
    break;
  case 4:
    uVar5 = FUN_0002b280(param_2,param_3);
    *(char *)(puVar1 + 0xb) = (char)uVar5;
    break;
  case 5:
    if (param_3 == 0x22) {
      FUN_0002b240(auStack_98,0x28,param_2,0x22);
      local_18 = 0xf;
      for (local_14 = 2; puVar1 = DAT_0008abe8, local_14 < 0x22; local_14 = local_14 + 2) {
        uVar3 = FUN_0003e59c(auStack_98[local_14]);
        uVar4 = FUN_0003e59c(auStack_98[local_14 + 1]);
        *(char *)((int)puVar1 + local_18 + 4) = (char)uVar4 + (char)uVar3 * '\x10';
        local_18 = local_18 + -1;
      }
    }
    else if (param_3 == 6) {
      uVar5 = FUN_0002b280(param_2,6);
      puVar1[2] = (short)uVar5;
    }
    else if (param_3 == 10) {
      uVar5 = FUN_0002b280(param_2,10);
      *(ulong *)(puVar1 + 2) = uVar5;
    }
    break;
  case 6:
    uVar5 = FUN_0002b280(param_2,param_3);
    *puVar1 = (short)uVar5;
    break;
  case 7:
    uVar5 = FUN_0002b280(param_2,param_3);
    *(char *)((int)puVar1 + 0x17) = (char)uVar5;
    break;
  case 8:
    uVar5 = FUN_0002b280(param_2,param_3);
    *(char *)(puVar1 + 0xc) = (char)uVar5;
    break;
  case 9:
    uVar5 = FUN_0002b280(param_2,param_3);
    *(char *)((int)puVar1 + 0x19) = (char)uVar5;
  }
  return;
}



char * FUN_0003e8ec(ushort param_1)

{
  if (param_1 == 0x180a) {
    return "UUID_SERVCLASS_DEVICE_INFORMATION";
  }
  if (param_1 < 0x180b) {
    if (param_1 == 0x1804) {
      return "UUID_SERVCLASS_TX_POWER";
    }
    if (param_1 < 0x1805) {
      if (param_1 == 0x1801) {
        return "UUID_SERVCLASS_GATT_SERVER";
      }
      if (param_1 < 0x1802) {
        if (param_1 == 0x1800) {
          return "UUID_SERVCLASS_GAP_SERVER";
        }
      }
      else {
        if (param_1 == 0x1802) {
          return "UUID_SERVCLASS_IMMEDIATE_ALERT";
        }
        if (param_1 == 0x1803) {
          return "UUID_SERVCLASS_LINKLOSS";
        }
      }
    }
    else {
      if (param_1 == 0x1807) {
        return "UUID_SERVCLASS_REF_TIME_UPD";
      }
      if (param_1 < 0x1808) {
        if (param_1 == 0x1805) {
          return "UUID_SERVCLASS_CURRENT_TIME";
        }
        if (param_1 == 0x1806) {
          return "UUID_SERVCLASS_DST_CHG";
        }
      }
      else {
        if (param_1 == 0x1808) {
          return "UUID_SERVCLASS_GLUCOSE";
        }
        if (param_1 == 0x1809) {
          return "UUID_SERVCLASS_HEALTH_THERMOMETER";
        }
      }
    }
  }
  else {
    if (param_1 == 0x1811) {
      return "UUID_SERVCLASS_ALERT_NOTIFICATION_SERVICE";
    }
    if (param_1 < 0x1812) {
      if (param_1 == 0x180e) {
        return "UUID_SERVCLASS_PHALERT";
      }
      if (param_1 < 0x180f) {
        if (param_1 == 0x180b) {
          return "UUID_SERVCLASS_NWA";
        }
        if (param_1 == 0x180d) {
          return "UUID_SERVCLASS_HEART_RATE";
        }
      }
      else {
        if (param_1 == 0x180f) {
          return "UUID_SERVCLASS_BATTERY_SERVICE";
        }
        if (param_1 == 0x1810) {
          return "UUID_SERVCLASS_BLOOD_PRESSURE";
        }
      }
    }
    else {
      if (param_1 == 0x1814) {
        return "UUID_SERVCLASS_RUNNING_SPEED_AND_CADENCE";
      }
      if (param_1 < 0x1815) {
        if (param_1 == 0x1812) {
          return "UUID_SERVCLASS_HUMAN_INTERFACE_DEVICE";
        }
        if (param_1 == 0x1813) {
          return "UUID_SERVCLASS_SCAN_PARAMETERS";
        }
      }
      else {
        if (param_1 == 0x1816) {
          return "UUID_SERVCLASS_CYCLING_SPEED_AND_CADENCE";
        }
        if (param_1 == 0x9000) {
          return "UUID_SERVCLASS_TEST_SERVER";
        }
      }
    }
  }
  return "UNKNOWN";
}



undefined4 FUN_0003eae2(void)

{
  int local_c;
  
  memset(&DAT_0008abec,0,0x166c);
  for (local_c = 0; local_c < 3; local_c = local_c + 1) {
    (&DAT_0008ac01)[local_c * 0x24] = 0xff;
    *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24) = 0xffff;
  }
  for (local_c = 0; local_c < 4; local_c = local_c + 1) {
    (&DAT_0008ac59)[local_c * 0x580] = 0xff;
    *(undefined2 *)(&DAT_0008ac5a + local_c * 0x580) = 0xffff;
  }
  FUN_0002b494();
  FUN_000486d8();
  return 0;
}



undefined4 FUN_0003eb9c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined auStack_10 [6];
  short local_a;
  
  FUN_00027fac(0,0);
  FUN_00043786();
  BSA_BleDisableInit(auStack_10);
  local_a = BSA_BleDisable(auStack_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_exit",0xae);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Unable to disable BLE status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003ec22(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined4 local_10;
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_start",0xc5);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"app_ble_start");
  }
  BSA_BleEnableInit(&local_10);
  local_10 = 0x3f8c3;
  local_a = BSA_BleEnable(&local_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_start",0xce);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Unable to enable BLE status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003ece4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1e4 [128];
  undefined4 local_164;
  undefined2 local_160;
  undefined local_15e;
  undefined2 local_15c;
  undefined2 local_15a;
  undefined local_156;
  undefined local_54 [8];
  undefined4 local_4c;
  undefined2 local_48;
  undefined local_46;
  undefined4 local_45;
  undefined2 local_41;
  undefined local_3f;
  int local_14;
  int local_10;
  short local_a;
  
  local_164 = 0x454b4157;
  local_160 = 0x5055;
  local_15e = 0;
  local_a = BSA_BleWakeCfgInit(&local_4c);
  local_48 = 0xf;
  local_45 = local_164;
  local_41 = local_160;
  local_3f = local_15e;
  local_46 = 6;
  local_4c = 5;
  local_a = BSA_BleWakeCfg(&local_4c);
  if (local_a == 0) {
    do {
      local_10 = FUN_0002f22c("Configure a BLE BDADDR to wake-up Host? 0:No, 1:Yes");
      if (local_10 == 1) {
        FUN_0002a97e();
        FUN_0002e882(0x896e8,10);
        local_14 = FUN_0002f22c("Select device");
        if (((-1 < local_14) && (local_14 < 10)) && ((&DAT_000896e8)[local_14 * 0x1b0] != '\0')) {
          uVar2 = FUN_0003ef90((undefined4 *)(&DAT_000896e9 + local_14 * 0x1b0));
          local_a = (short)uVar2;
          if (local_a != 0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_1e4,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                      ,"app_ble_wake_configure",0x10c);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_1e4,"Config 2nd remote bdaddr failed status:%d",local_a)
              ;
            }
            return 0xffffffff;
          }
        }
      }
    } while (local_10 == 1);
    local_a = BSA_BleWakeEnableInit(local_54);
    local_54[0] = 1;
    local_a = BSA_BleWakeEnable(local_54);
    if (local_a == 0) {
      local_a = BSA_TmVscInit(&local_15c);
      local_15c = 0xfd60;
      local_15a = 1;
      local_156 = 1;
      local_a = BSA_TmVsc(&local_15c);
      if (local_a == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1e4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                  ,"app_ble_wake_configure",0x125);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1e4,"Unable to Send Enable Wake on BLE GPIO VSC status:%d",
                         local_a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1e4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                ,"app_ble_wake_configure",0x119);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1e4,"BSA_BleWake failed status:%d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1e4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_wake_configure",0xf5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1e4,"BSA_BleWakeCfg failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003ef90(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c4 [128];
  undefined4 local_44;
  undefined local_40;
  undefined4 local_3f;
  undefined2 local_3b;
  short local_a;
  
  local_a = BSA_BleWakeCfgInit(&local_44);
  local_3f = *param_1;
  local_3b = *(undefined2 *)(param_1 + 1);
  local_40 = 0;
  local_44 = 0;
  local_a = BSA_BleWakeCfg(&local_44);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_config_bdaddr_for_wakeup",0x144);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c4,
                     "app_ble_config_bdaddr_for_wakeup: BSA_BleWakeCfg failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003f032(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined local_c [2];
  short local_a;
  
  BSA_BleApcfEnableInit(local_c);
  local_c[0] = 1;
  local_a = BSA_BleApcfEnable(local_c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_apcf_enable",0x160);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Unable to Enable APCF status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0003f0b4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined local_c [2];
  short local_a;
  
  BSA_BleApcfEnableInit(local_c);
  local_c[0] = 0;
  local_a = BSA_BleApcfEnable(local_c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_apcf_disable",0x17c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Unable to Disable APCF status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_0003f136(void)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",0x18e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Set Filtering Parameters",1);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",399);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Broadcast Address",2);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",400);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Service UUID",3);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",0x191);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Solicitation UUID",4);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",0x192);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Local Name",5);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",0x193);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Manufacturer Data",6);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                            ,"app_ble_apcf_cond_type_menu",0x194);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"\t%d => Service Data",7);
  }
  return;
}



undefined4 FUN_0003f312(byte *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_d4 [128];
  byte local_54;
  byte local_53;
  byte local_52;
  undefined2 local_50;
  undefined2 local_4e;
  undefined2 local_4c;
  undefined auStack_4a [14];
  undefined2 local_3c;
  undefined auStack_32 [34];
  short local_10;
  byte local_e;
  byte local_d;
  int local_c;
  
  BSA_BleApcfCfgInit(&local_54);
  if (param_1 == (byte *)0x0) {
    iVar1 = FUN_0002f22c("Enter Filtering Index (0 - 15):");
    local_53 = (byte)iVar1;
  }
  else {
    local_53 = param_1[1];
  }
  if (local_53 < 0x10) {
    if (param_1 == (byte *)0x0) {
      FUN_0003f136();
      iVar1 = FUN_0002f22c("Select condition type:");
      local_d = (byte)iVar1;
      iVar1 = FUN_0002f22c("Enter Action(0:Add,1:Delete,2:Clear):");
      local_e = (byte)iVar1;
    }
    else {
      local_d = param_1[2];
      local_e = *param_1;
    }
    if (local_e < 3) {
      if ((local_e != 2) && ((local_e != 1 || (local_d != 1)))) {
        if (6 < local_d - 1) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                    ,"app_ble_apcf_cfg",0x254);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_d4,"Unknown condition type: %d",local_d);
          }
          return 0xffffffff;
        }
        switch(local_d) {
        case 1:
          if (param_1 == (byte *)0x0) {
            iVar1 = FUN_0002f22c("Enter Feature Selection:");
            local_50 = (undefined2)iVar1;
            iVar1 = FUN_0002f22c("Enter Feature Logic Type:");
            local_4e = (undefined2)iVar1;
            iVar1 = FUN_0002f22c("Enter Filter Logic Type:");
            local_4c = CONCAT11(local_4c._1_1_,(char)iVar1);
            iVar1 = FUN_0002f22c("Enter RSSI High Threshold:");
            local_4c = CONCAT11((char)iVar1,(undefined)local_4c);
          }
          else {
            local_50 = *(undefined2 *)(param_1 + 4);
            local_4e = *(undefined2 *)(param_1 + 6);
            local_4c = *(undefined2 *)(param_1 + 8);
          }
          break;
        case 2:
          iVar1 = FUN_0002f22c("Enter Broadcaster Address Type(0:Public,1:Random,2:NA):");
          local_50 = CONCAT11(local_50._1_1_,(byte)iVar1);
          if (2 < (byte)iVar1) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                      ,"app_ble_apcf_cfg",0x1ef);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_d4,"Incorrect  Broadcaster Address Type: %d",
                             (byte)local_50);
            }
            return 0xffffffff;
          }
          iVar1 = duss_log_gen_head(0x5c,3,auStack_d4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                    ,"app_ble_apcf_cfg",499);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_d4,"Enter the Broadcaster Address(AA.BB.CC.DD.EE.FF): ");
          }
          iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",(int)&local_50 + 1,&local_4e,
                        (int)&local_4e + 1,&local_4c,(int)&local_4c + 1,auStack_4a);
          if (iVar1 != 6) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                      ,"app_ble_apcf_cfg",0x1fc);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_d4,"BD address not entered correctly");
            }
            return 0xffffffff;
          }
          break;
        default:
          iVar1 = FUN_0002f22c("Enter UUID (eg. x180d, current sample app only support 16 bits)");
          local_4c = (undefined2)iVar1;
          local_50 = 2;
          if (local_e == 0) {
            iVar1 = FUN_0002f22c(
                                "Enter UUID mask (eg. xFFFF, current sample app only support 16 bits)"
                                );
            local_3c = (undefined2)iVar1;
          }
          break;
        case 5:
          if (param_1 == (byte *)0x0) {
            iVar1 = FUN_0002f22c("Enter Local Name Length(<=29):");
            local_50 = CONCAT11(local_50._1_1_,(char)iVar1);
          }
          else {
            local_50 = CONCAT11(local_50._1_1_,param_1[4]);
          }
          if (0x1d < (byte)local_50) {
            local_50 = CONCAT11(local_50._1_1_,0x1d);
          }
          if (param_1 == (byte *)0x0) {
            for (local_c = 0; local_c < (int)(uint)(byte)local_50; local_c = local_c + 1) {
              iVar1 = FUN_0002f22c("Enter local name in byte (eg. 1 or 2)");
              *(char *)((int)&local_50 + local_c + 1) = (char)iVar1;
            }
          }
          else {
            memcpy((void *)((int)&local_50 + 1),param_1 + 5,(uint)(byte)local_50);
          }
          break;
        case 6:
        case 7:
          if (param_1 == (byte *)0x0) {
            iVar1 = FUN_0002f22c("Enter Data Length(<=29):");
            local_50 = CONCAT11(local_50._1_1_,(char)iVar1);
          }
          else {
            local_50 = CONCAT11(local_50._1_1_,param_1[4]);
          }
          if (0x1d < (byte)local_50) {
            local_50 = CONCAT11(local_50._1_1_,0x1d);
          }
          if (param_1 == (byte *)0x0) {
            for (local_c = 0; local_c < (int)(uint)(byte)local_50; local_c = local_c + 1) {
              iVar1 = FUN_0002f22c("Enter data in byte (eg. 1 or 2)");
              *(char *)((int)&local_50 + local_c + 1) = (char)iVar1;
            }
          }
          else {
            memcpy((void *)((int)&local_50 + 1),param_1 + 5,(uint)(byte)local_50);
          }
          if (local_e == 0) {
            if (param_1 == (byte *)0x0) {
              for (local_c = 0; local_c < (int)(uint)(byte)local_50; local_c = local_c + 1) {
                iVar1 = FUN_0002f22c("Enter data mask in byte (eg. 1 or 2)");
                auStack_32[local_c] = (char)iVar1;
              }
            }
            else {
              memset(auStack_32,0xff,(uint)(byte)local_50);
            }
          }
        }
      }
      local_52 = local_d;
      local_54 = local_e;
      local_10 = BSA_BleApcfCfg(&local_54);
      if (local_10 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                  ,"app_ble_apcf_cfg",0x260);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_d4,"Unable to Config APCF status:%d",local_10);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                ,"app_ble_apcf_cfg",0x1c6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_d4,"Unknown action: %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_d4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_apcf_cfg",0x1b6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_d4,"Incorrect Filtering Index: %d",local_53);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void FUN_0003f8c2(int param_1,undefined2 *param_2)

{
  int iVar1;
  char *pcVar2;
  undefined auStack_98 [132];
  
  if (param_1 == 0x1b) {
    if (*(char *)param_2 == '\0') {
      if (*(char *)((int)param_2 + 1) == '\x01') {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                  ,"app_ble_common_cback",0x283);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_98,
                         "status : %d cond : %d action : %d the remainder filter is : %d",
                         *(undefined *)param_2,*(undefined *)((int)param_2 + 1),
                         *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3));
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                  ,"app_ble_common_cback",0x289);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_98,
                         "status : %d cond : %d action : %d the remainder condition is : %d",
                         *(undefined *)param_2,*(undefined *)((int)param_2 + 1),
                         *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3));
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                ,"app_ble_common_cback",0x290);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_98,"status : %d cond : %d action : %d",*(undefined *)param_2,
                       *(undefined *)((int)param_2 + 1),*(undefined *)(param_2 + 1));
      }
    }
  }
  else if (param_1 == 0x1e) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_common_cback",0x2af);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"BSA_BLE_CONN_PARAM_UPDATE_EVT");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_common_cback",0x2b3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"%02X:%02X:%02X:%02X:%02X:%02X",*(undefined *)(param_2 + 1),
                     *(undefined *)((int)param_2 + 3),*(undefined *)(param_2 + 2),
                     *(undefined *)((int)param_2 + 5),*(undefined *)(param_2 + 3),
                     *(undefined *)((int)param_2 + 7));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                              ,"app_ble_common_cback",0x2b8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,
                     "status:%d, conn_interval:%d, conn_latency:%d conn_timeout:%d",*param_2,
                     param_2[4],param_2[5],param_2[6]);
    }
  }
  else if ((param_1 == 0x1a) &&
          (iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                                     "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble.c"
                                     ,"app_ble_common_cback",0x279), iVar1 != 0)) {
    if (*(char *)((int)param_2 + 1) == '\0') {
      pcVar2 = "Disable";
    }
    else {
      pcVar2 = "Enable";
    }
    duss_log_print(0x5c,3,auStack_98,"APCF %s, status %d",pcVar2,*(undefined *)param_2);
  }
  return;
}



int FUN_0003fba4(void)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (2 < local_c) {
      return -1;
    }
    if ((&DAT_0008ac00)[local_c * 0x24] == '\0') break;
    local_c = local_c + 1;
  }
  return local_c;
}



void FUN_0003fbec(int *param_1)

{
  int iVar1;
  char *pcVar2;
  undefined auStack_9c [128];
  int local_1c;
  
  for (local_1c = *param_1; local_1c != 0; local_1c = *(int *)(local_1c + 0x1c)) {
    if (*(char *)(local_1c + 0x16) == '\x03') {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_display_attr",0x62);
      if (iVar1 != 0) {
        pcVar2 = FUN_0003e8ec(*(ushort *)(local_1c + 4));
        duss_log_print(0x5c,3,auStack_9c,
                       "    %s UUID:0x%04x handle:%d attr_type:%d id:%d prop:0x%x Is_Primary:%d",
                       pcVar2,*(undefined2 *)(local_1c + 4),*(undefined2 *)(local_1c + 0x14),
                       *(undefined *)(local_1c + 0x16),*(undefined *)(local_1c + 0x17),
                       *(undefined *)(local_1c + 0x18),*(undefined *)(local_1c + 0x19));
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_display_attr",0x68);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_9c,
                       "        UUID:0x%04x handle:%d attr_type:%d id:%d prop:0x%x",
                       *(undefined2 *)(local_1c + 4),*(undefined2 *)(local_1c + 0x14),
                       *(undefined *)(local_1c + 0x16),*(undefined *)(local_1c + 0x17),
                       *(undefined *)(local_1c + 0x18));
      }
    }
  }
  return;
}



void FUN_0003fd22(int param_1)

{
  int iVar1;
  undefined auStack_a0 [128];
  int *local_20;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_display",0x81);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"BLE CLIENT LIST...");
  }
  for (local_1c = 0; local_1c < 3; local_1c = local_1c + 1) {
    if ((&DAT_0008ac00)[local_1c * 0x24] != '\0') {
      if (*(short *)(&DAT_0008ac02 + local_1c * 0x24) == -1) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_display",0x88);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_a0,"Index:%d client_if:%d",local_1c,
                         (&DAT_0008ac01)[local_1c * 0x24]);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_display",0x95);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_a0,
                         "Index:%d client_if:%d conn_id:%d BDA:%02X:%02X:%02X:%02X:%02X:%02X",
                         local_1c,(&DAT_0008ac01)[local_1c * 0x24],
                         *(undefined2 *)(&DAT_0008ac02 + local_1c * 0x24),
                         (&DAT_0008ac04)[local_1c * 0x24],(&DAT_0008ac05)[local_1c * 0x24],
                         (&DAT_0008ac06)[local_1c * 0x24],(&DAT_0008ac07)[local_1c * 0x24],
                         (&DAT_0008ac08)[local_1c * 0x24],(&DAT_0008ac09)[local_1c * 0x24]);
        }
        if (param_1 != 0) {
          local_20 = (int *)FUN_00048a6e(&DAT_0008ac04 + local_1c * 0x24);
          if (local_20 != (int *)0x0) {
            FUN_0003fbec(local_20);
          }
        }
      }
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_display",0xa1);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"BLE CLIENT LIST END...");
  }
  return;
}



int FUN_00040050(char param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (2 < local_c) {
      return -1;
    }
    if (param_1 == (&DAT_0008ac01)[local_c * 0x24]) break;
    local_c = local_c + 1;
  }
  return local_c;
}



int FUN_0004009e(short param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (2 < local_c) {
      return -1;
    }
    if (param_1 == *(short *)(&DAT_0008ac02 + local_c * 0x24)) break;
    local_c = local_c + 1;
  }
  return local_c;
}



undefined4 FUN_0004018e(undefined2 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_ac [128];
  undefined2 local_2c [2];
  undefined2 local_28;
  undefined local_18;
  undefined4 local_14;
  short local_e;
  int local_c;
  
  local_c = FUN_0003fba4();
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_register",0x139);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_ac,
                     "app_ble_client_register maximum number of BLE client already registered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClAppRegisterInit(local_2c);
    if (local_e == 0) {
      local_2c[0] = 2;
      local_14 = 0x44461;
      local_28 = param_1;
      local_e = BSA_BleClAppRegister(local_2c);
      if (local_e == 0) {
        (&DAT_0008ac00)[local_c * 0x24] = 1;
        (&DAT_0008ac01)[local_c * 0x24] = local_18;
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_register",0x14a);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_ac,"BSA_BleClAppRegister failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_register",0x13f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_ac,"BLE client registration failed with status %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0004031a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [132];
  int local_10;
  short local_a;
  
  local_a = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_service_search",0x166);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth BLE service search menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_service_search",0x167);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"    0 Search all services");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_service_search",0x168);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"    1 Search a service");
  }
  local_10 = FUN_0002f22c("Select");
  if (local_10 == 0) {
    local_a = 0;
  }
  else {
    if (local_10 != 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_service_search",0x175);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_94,"Bad choice (0) or (1) only]");
      }
      return 0xffffffff;
    }
    iVar1 = FUN_0002f22c("Enter Service UUID to search(eg. x1800)");
    local_a = (short)iVar1;
  }
  uVar2 = FUN_00040488(local_a);
  if ((short)uVar2 == 0) {
    uVar2 = 0;
  }
  else {
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00040488(short param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a8 [128];
  undefined2 local_28 [2];
  undefined2 local_24;
  short local_20;
  int local_10;
  short local_a;
  
  local_a = BSA_BleClSearchInit(local_28);
  if (local_a != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_service_search_execute",0x196);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"BSA_BleClServiceSearchReqInit failed status = %d",local_a);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_service_search_execute",0x198);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a8,"Select Client:");
  }
  FUN_0003fd22(0);
  local_10 = FUN_0002f22c("Select");
  if ((local_10 < 0) || (2 < local_10)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_service_search_execute",0x19e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"BSA_BleClServiceSearchReq failed Invalid client_num:%d",
                     local_10);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_28[0] = *(undefined2 *)(&DAT_0008ac02 + local_10 * 0x24);
    if (param_1 != 0) {
      local_24 = 2;
      local_20 = param_1;
    }
    local_a = BSA_BleClSearch(local_28);
    if (local_a == 0) {
      DAT_00085af4 = 1;
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_service_search_execute",0x1ab);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,
                       "BSA_BleClServiceSearchReq failed for service:0x%x with status:%d",param_1,
                       local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4
FUN_0004065a(short param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,
            undefined4 param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_c0 [128];
  undefined2 local_40 [2];
  undefined2 local_3c;
  undefined4 local_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  int local_28;
  short local_22;
  undefined2 local_c;
  
  local_22 = BSA_BleClSearchInit(local_40);
  if (local_22 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_service_search_ex",0x1c6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"BSA_BleClServiceSearchReqInit failed status = %d",local_22);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_service_search_ex",0x1c8);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_c0,"Select Client:");
  }
  FUN_0003fd22(0);
  local_28 = FUN_0002f22c("Select");
  if ((local_28 < 0) || (2 < local_28)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_service_search_ex",0x1ce);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_c0,"BSA_BleClServiceSearchReq failed Invalid client_num:%d",
                     local_28);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_40[0] = *(undefined2 *)(&DAT_0008ac02 + local_28 * 0x24);
    if (param_1 == 2) {
      local_3c = 2;
      local_c = (undefined2)param_2;
      local_38 = CONCAT22(local_38._2_2_,local_c);
    }
    else if (param_1 == 4) {
      local_3c = 4;
      local_38 = param_2;
    }
    else if (param_1 == 0x10) {
      local_3c = 0x10;
      uStack_2c = param_5;
      local_38 = param_2;
      uStack_34 = param_3;
      uStack_30 = param_4;
    }
    local_22 = BSA_BleClSearch(local_40);
    if (local_22 == 0) {
      DAT_00085af4 = 1;
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_service_search_ex",0x1e7);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c0,"BSA_BleClServiceSearchReq failed with status:%d",local_22)
        ;
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0004085c(void)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined auStack_110 [128];
  undefined2 local_90 [2];
  undefined2 local_8c;
  undefined2 local_88;
  undefined local_78;
  undefined local_74;
  undefined2 local_70;
  ushort local_3c;
  undefined local_2c;
  undefined local_28;
  int local_24;
  int local_20;
  undefined2 local_1a;
  int local_18;
  short local_12;
  
  local_12 = BSA_BleClGetFirstCharInit(local_90);
  if (local_12 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_110,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_first_char",0x203);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_110,"BSA_BleClGetFirstCharInit failed status = %d",local_12);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_110,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_get_first_char",0x205);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_110,"Select Client:");
  }
  FUN_0003fd22(0);
  local_18 = FUN_0002f22c("Select");
  if ((local_18 < 0) || (2 < local_18)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_110,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_first_char",0x20b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_110,"BSA_BleClGetFirstChar failed Invalid client_num:%d",
                     local_18);
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_90[0] = *(undefined2 *)(&DAT_0008ac02 + local_18 * 0x24);
    iVar1 = FUN_0002f22c("Enter Service UUID of First Char(eg. x1800)");
    local_1a = (undefined2)iVar1;
    local_20 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
    local_24 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
    local_8c = 2;
    local_88 = local_1a;
    local_78 = (undefined)local_24;
    local_74 = (undefined)local_20;
    local_70 = 0;
    local_12 = BSA_BleClGetFirstChar(local_90);
    if (local_12 == 0x85) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_110,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char",0x21d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_110,"No more Characeristic found!!");
      }
      uVar3 = 0;
    }
    else if (local_12 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_110,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char",0x22a);
      if (iVar1 != 0) {
        pcVar2 = FUN_0003e8ec(local_3c);
        duss_log_print(0x5c,3,auStack_110,"GetFirstChar  %s  (uuid:0x%04x) id:%d prop:0x%X",pcVar2,
                       local_3c,local_2c,local_28);
      }
      uVar3 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_110,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char",0x223);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_110,"BSA_BleClGetFirstChar failed with status:%d",local_12);
      }
      uVar3 = 0xffffffff;
    }
  }
  return uVar3;
}



undefined4 FUN_00040b00(void)

{
  int iVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined auStack_130 [128];
  undefined2 local_b0 [2];
  undefined2 local_ac;
  undefined2 local_a8;
  undefined local_98;
  undefined local_94;
  undefined2 local_90;
  undefined2 local_8c;
  undefined local_7c;
  undefined2 local_78;
  ushort local_44;
  undefined local_34;
  undefined local_30;
  int local_2c;
  undefined2 local_26;
  int local_24;
  int local_20;
  undefined2 local_1a;
  int local_18;
  short local_12;
  
  local_12 = BSA_BleClGetNextCharInit(local_b0);
  if (local_12 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_130,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_next_char",0x243);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_130,"BSA_BleClGetNextCharInit failed status = %d",local_12);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_130,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_get_next_char",0x245);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_130,"Select Client:");
  }
  FUN_0003fd22(0);
  local_18 = FUN_0002f22c("Select");
  if ((local_18 < 0) || (2 < local_18)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_130,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_next_char",0x24b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_130,"BSA_BleClGetNextChar failed Invalid client_num:%d",local_18
                    );
    }
    uVar3 = 0xffffffff;
  }
  else {
    local_b0[0] = *(undefined2 *)(&DAT_0008ac02 + local_18 * 0x24);
    iVar1 = FUN_0002f22c("Enter Service UUID to read(eg. x1800)");
    local_1a = (undefined2)iVar1;
    local_20 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
    local_24 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
    local_ac = 2;
    local_a8 = local_1a;
    local_98 = (undefined)local_24;
    local_94 = (undefined)local_20;
    iVar1 = FUN_0002f22c("Enter the Start Char UUID(eg. x2a00)");
    local_26 = (undefined2)iVar1;
    local_2c = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
    local_90 = 2;
    local_8c = local_26;
    local_7c = (undefined)local_2c;
    local_78 = 0;
    local_12 = BSA_BleClGetNextChar(local_b0);
    if (local_12 == 0x85) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_130,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char",0x261);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_130,"No more Characeristic found!!");
      }
      uVar3 = 0;
    }
    else if (local_12 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_130,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char",0x26e);
      if (iVar1 != 0) {
        pcVar2 = FUN_0003e8ec(local_44);
        duss_log_print(0x5c,3,auStack_130,"GetNextChar  %s  (uuid:0x%04x) id:%d prop:0x%X",pcVar2,
                       local_44,local_34,local_30);
      }
      uVar3 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_130,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char",0x267);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_130,"BSA_BleClGetNextChar failed with status:%d",local_12);
      }
      uVar3 = 0xffffffff;
    }
  }
  return uVar3;
}



undefined4 FUN_00040dde(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_13c [128];
  undefined2 local_bc [2];
  undefined2 local_b8;
  undefined2 local_b4;
  undefined local_a4;
  undefined local_a0;
  undefined2 local_9c;
  undefined2 local_98;
  undefined local_88;
  undefined2 local_84;
  undefined2 local_38;
  undefined local_28;
  int local_24;
  undefined2 local_1e;
  int local_1c;
  int local_18;
  undefined2 local_12;
  int local_10;
  short local_a;
  
  local_a = BSA_BleClGetFirstCharDescrInit(local_bc);
  if (local_a != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_13c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_first_char_descr",0x287);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_13c,"BSA_BleClGetFirstCharDescrInit failed status = %d",local_a)
      ;
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_13c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_get_first_char_descr",0x289);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_13c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_10 = FUN_0002f22c("Select");
  if ((local_10 < 0) || (2 < local_10)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_13c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_first_char_descr",0x28f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_13c,"BSA_BleClGetFirstCharDescr failed Invalid client_num:%d",
                     local_10);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_bc[0] = *(undefined2 *)(&DAT_0008ac02 + local_10 * 0x24);
    iVar1 = FUN_0002f22c("Enter Service UUID of Char(eg. x1800)");
    local_12 = (undefined2)iVar1;
    local_18 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
    local_1c = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
    local_b4 = local_12;
    local_b8 = 2;
    local_a4 = (undefined)local_1c;
    local_a0 = (undefined)local_18;
    iVar1 = FUN_0002f22c("Enter Char UUID (eg. x2A00)");
    local_1e = (undefined2)iVar1;
    local_24 = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
    local_98 = local_1e;
    local_9c = 2;
    local_88 = (undefined)local_24;
    local_84 = 0;
    local_a = BSA_BleClGetFirstCharDescr(local_bc);
    if (local_a == 0x85) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_13c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char_descr",0x2a6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_13c,"No more Characeristic Descriptor found!!");
      }
      uVar2 = 0;
    }
    else if (local_a == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_13c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char_descr",0x2b1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_13c,"GetFirstCharDescr uuid:0x%04x id:%d ",local_38,local_28);
      }
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_13c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_first_char_descr",0x2ac);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_13c,"BSA_BleClGetFirstCharDescr failed with status:%d",local_a
                      );
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000410a4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_15c [128];
  undefined2 local_dc [2];
  undefined2 local_d8;
  undefined2 local_d4;
  undefined local_c4;
  undefined local_c0;
  undefined2 local_bc;
  undefined2 local_b8;
  undefined local_a8;
  undefined2 local_a4;
  undefined2 local_a0;
  undefined local_90;
  undefined2 local_8c;
  undefined2 local_40;
  undefined local_30;
  int local_2c;
  undefined2 local_26;
  int local_24;
  undefined2 local_1e;
  int local_1c;
  int local_18;
  undefined2 local_12;
  int local_10;
  short local_a;
  
  local_a = BSA_BleClGetNextCharDescrInit(local_dc);
  if (local_a != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_15c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_next_char_descr",0x2cb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_15c,"BSA_BleClGetNextCharDescrInit failed status = %d",local_a);
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_15c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_get_next_char_descr",0x2cd);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_15c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_10 = FUN_0002f22c("Select");
  if ((local_10 < 0) || (2 < local_10)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_15c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_get_next_char_descr",0x2d3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_15c,"BSA_BleClGetNextCharDescr failed Invalid client_num:%d",
                     local_10);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_dc[0] = *(undefined2 *)(&DAT_0008ac02 + local_10 * 0x24);
    iVar1 = FUN_0002f22c("Enter Service UUID of Char(eg. x1800)");
    local_12 = (undefined2)iVar1;
    local_18 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
    local_1c = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
    local_d4 = local_12;
    local_d8 = 2;
    local_c4 = (undefined)local_1c;
    local_c0 = (undefined)local_18;
    iVar1 = FUN_0002f22c("Enter Char UUID (eg. x2A00)");
    local_1e = (undefined2)iVar1;
    local_24 = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
    local_b8 = local_1e;
    local_bc = 2;
    local_a8 = (undefined)local_24;
    iVar1 = FUN_0002f22c("Enter Descr UUID (eg. x2A00)");
    local_26 = (undefined2)iVar1;
    local_2c = FUN_0002f22c("Enter Instance ID for Descr UUID(eg. 0,1,2..)");
    local_a0 = local_26;
    local_a4 = 2;
    local_90 = (undefined)local_2c;
    local_8c = 0;
    local_a = BSA_BleClGetNextCharDescr(local_dc);
    if (local_a == 0x85) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_15c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char_descr",0x2f0);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_15c,"No more Characeristic Descriptor found!!");
      }
      uVar2 = 0;
    }
    else if (local_a == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_15c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char_descr",0x2fb);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_15c,"GetNextCharDescr uuid:0x%04x id:%d ",local_40,local_30);
      }
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_15c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_get_next_char_descr",0x2f6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_15c,"BSA_BleClGetNextCharDescr failed with status:%d",local_a)
        ;
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000413a4(void)

{
  int iVar1;
  undefined4 uVar2;
  bool bVar3;
  undefined auStack_134 [128];
  undefined2 local_b4 [2];
  undefined2 local_b0;
  undefined2 local_ac;
  undefined local_9c;
  undefined local_98;
  undefined2 local_94;
  undefined2 local_90;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_64;
  undefined2 local_60;
  undefined2 local_5c;
  undefined local_4c;
  undefined2 local_48;
  undefined2 local_44;
  undefined local_30;
  undefined local_2f;
  undefined2 local_2a;
  int local_28;
  short local_22;
  int local_20;
  undefined2 local_1a;
  int local_18;
  int local_14;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_134,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read",0x315);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_134,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_134,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read",0x31d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_134,"app_ble_client_read client %d was not enabled yet",local_c)
      ;
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = FUN_0002f22c("Enter Service UUID to read(eg. x1800)");
    local_e = (undefined2)iVar1;
    local_14 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
    local_18 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
    iVar1 = FUN_0002f22c("Enter Char UUID to read(eg. x2a00)");
    local_1a = (undefined2)iVar1;
    local_20 = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
    local_22 = BSA_BleClReadInit(local_b4);
    if (local_22 == 0) {
      local_28 = FUN_0002f22c("Select descriptor? (yes=1 or no=0)");
      bVar3 = local_28 != 1;
      if (bVar3) {
        local_ac = local_e;
        local_b0 = 2;
        local_90 = local_1a;
        local_94 = 2;
        local_9c = (char)local_18;
        local_98 = (char)local_14;
        local_80 = (char)local_20;
      }
      else {
        local_60 = 2;
        local_5c = local_1a;
        local_7c = 2;
        local_78 = local_e;
        local_68 = (char)local_18;
        local_64 = (char)local_14;
        local_4c = (char)local_20;
        iVar1 = FUN_0002f22c("Enter Descriptor type UUID to read(eg. x2902)");
        local_44 = (undefined2)iVar1;
        local_48 = 2;
        local_2a = local_44;
      }
      local_2f = !bVar3;
      local_b4[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
      local_30 = 0;
      local_22 = BSA_BleClRead(local_b4);
      if (local_22 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_134,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_read",0x34e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_134,"app_ble_client_read failed status = %d",local_22);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_134,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read",0x329);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_134,"app_ble_client_read failed status = %d",local_22);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00041678(void)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined auStack_2ac [128];
  undefined auStack_22c [100];
  undefined2 local_1c8 [2];
  undefined2 local_1c4;
  undefined2 local_1c0;
  undefined local_1b0;
  undefined local_1ac;
  undefined2 local_1a8;
  undefined2 local_1a4;
  undefined local_194;
  undefined local_190;
  ushort local_18e;
  undefined auStack_18c [255];
  undefined local_8d;
  undefined2 local_8c;
  undefined2 local_88;
  undefined local_78;
  undefined local_74;
  undefined2 local_70;
  undefined2 local_6c;
  undefined local_5c;
  undefined2 local_58;
  undefined2 local_54;
  undefined local_44;
  undefined local_40;
  undefined local_3f;
  ushort local_3a;
  int local_38;
  undefined2 local_32;
  int local_30;
  int local_2c;
  undefined2 local_26;
  int local_24;
  int local_20;
  undefined2 local_1c;
  short local_1a;
  int local_18;
  char local_13;
  ushort local_12;
  
  local_13 = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_2ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_write",0x36a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_2ac,"Select Client:");
  }
  FUN_0003fd22(0);
  local_18 = FUN_0002f22c("Select");
  if (((local_18 < 0) || (2 < local_18)) || ((&DAT_0008ac00)[local_18 * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_write",0x371);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2ac,"Wrong client number! = %d",local_18);
    }
    uVar2 = 0xffffffff;
  }
  else if (((&DAT_0008ac0a)[local_18 * 0x24] == '\0') && ((&DAT_0008ac0c)[local_18 * 0x24] == '\0'))
  {
    local_1a = BSA_BleClWriteInit(local_1c8);
    if (local_1a == 0) {
      iVar1 = FUN_0002f22c("Enter Service UUID to write(eg. x180d)");
      local_1c = (undefined2)iVar1;
      local_20 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
      local_24 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
      iVar1 = FUN_0002f22c("Enter Char UUID to write(eg. x2902)");
      local_26 = (undefined2)iVar1;
      local_2c = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
      local_30 = FUN_0002f22c("select descriptor? (yes=1 or no=0)");
      local_3f = 0;
      if (local_30 == 1) {
        local_70 = 2;
        local_6c = local_26;
        local_5c = (undefined)local_2c;
        local_8c = 2;
        local_88 = local_1c;
        local_74 = (undefined)local_20;
        local_78 = (undefined)local_24;
        iVar1 = FUN_0002f22c("Enter Descriptor type UUID to write(eg. x2902)");
        local_54 = (undefined2)iVar1;
        local_32 = local_54;
        local_38 = FUN_0002f22c("Enter Instance ID for Desc UUID(eg. 0,1,2..)");
        local_44 = (undefined)local_38;
        local_58 = 2;
        iVar1 = FUN_0002f22c("Enter number of bytes to write (eg. 1 or 2)");
        local_3a = (ushort)iVar1;
        for (local_12 = 0; local_12 < local_3a; local_12 = local_12 + 1) {
          uVar3 = (uint)local_12;
          iVar1 = FUN_0002f22c("Enter data in byte (eg. 1 or 2)");
          auStack_22c[uVar3] = (char)iVar1;
          auStack_18c[local_12] = auStack_22c[local_12];
        }
        local_40 = 1;
      }
      else {
        iVar1 = FUN_0002f22c("Enter number of bytes to write (eg. 1 or 2)");
        local_3a = (ushort)iVar1;
        for (local_12 = 0; local_12 < local_3a; local_12 = local_12 + 1) {
          uVar3 = (uint)local_12;
          iVar1 = FUN_0002f22c("Enter data in byte (eg. 1 or 2)");
          auStack_22c[uVar3] = (char)iVar1;
          auStack_18c[local_12] = auStack_22c[local_12];
        }
        local_40 = 0;
        local_1b0 = (undefined)local_24;
        local_1c0 = local_1c;
        local_1c4 = 2;
        local_1ac = (undefined)local_20;
        local_194 = (undefined)local_2c;
        local_1a4 = local_26;
        local_1a8 = 2;
      }
      local_1c8[0] = *(undefined2 *)(&DAT_0008ac02 + local_18 * 0x24);
      local_8d = 0;
      local_18e = local_3a;
      iVar1 = FUN_0002f22c("Enter WRITE TYPE [i.e 1-GATT_WRITE_NO_RSP 2-GATT_WRITE]");
      local_13 = (char)iVar1;
      iVar1 = duss_log_gen_head(0x5c,3,auStack_2ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_write",0x3bf);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_2ac,"BSA_BleClWrite write_type:%d",local_13);
      }
      if (local_13 == '\x01') {
        local_190 = 1;
      }
      else {
        if (local_13 != '\x02') {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_write",0x3ca);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_2ac,"BSA_BleClWrite failed wrong write_type:%d",local_13);
          }
          return 0xffffffff;
        }
        local_190 = 2;
      }
      local_1a = BSA_BleClWrite(local_1c8);
      if (local_1a == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_write",0x3d1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_2ac,"BSA_BleClWrite failed status = %d",local_1a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_write",0x381);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_2ac,"BSA_BleClWriteInit failed status = %d",local_1a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_write",0x37a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2ac,"fail : write pending(%d), congested(%d)!",
                     (&DAT_0008ac0a)[local_18 * 0x24],(&DAT_0008ac0c)[local_18 * 0x24]);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00041c1e(void)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  bool bVar4;
  undefined auStack_2ac [128];
  undefined auStack_22c [100];
  undefined2 local_1c8 [2];
  undefined2 local_1c4;
  undefined2 local_1c0;
  undefined local_1b0;
  undefined local_1ac;
  undefined2 local_1a8;
  undefined2 local_1a4;
  undefined local_194;
  ushort local_18e;
  undefined auStack_18c [255];
  undefined local_8d;
  undefined2 local_8c;
  undefined2 local_88;
  undefined local_78;
  undefined local_74;
  undefined2 local_70;
  undefined2 local_6c;
  undefined local_5c;
  undefined2 local_58;
  undefined2 local_54;
  undefined local_44;
  undefined local_40;
  undefined local_3f;
  ushort local_3a;
  int local_38;
  undefined2 local_32;
  int local_30;
  int local_2c;
  undefined2 local_26;
  int local_24;
  int local_20;
  undefined2 local_1c;
  short local_1a;
  int local_18;
  ushort local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_2ac,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_prepare_write",0x3ec);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_2ac,"Select Client:");
  }
  FUN_0003fd22(0);
  local_18 = FUN_0002f22c("Select");
  if (((local_18 < 0) || (2 < local_18)) || ((&DAT_0008ac00)[local_18 * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_prepare_write",0x3f3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2ac,"Wrong client number! = %d",local_18);
    }
    uVar2 = 0xffffffff;
  }
  else if (((&DAT_0008ac0a)[local_18 * 0x24] == '\0') && ((&DAT_0008ac0c)[local_18 * 0x24] == '\0'))
  {
    local_1a = BSA_BleClWriteInit(local_1c8);
    if (local_1a == 0) {
      iVar1 = FUN_0002f22c("Enter Service UUID to write(eg. x180d)");
      local_1c = (undefined2)iVar1;
      local_20 = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
      local_24 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
      iVar1 = FUN_0002f22c("Enter Char UUID to write(eg. x2902)");
      local_26 = (undefined2)iVar1;
      local_2c = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
      local_3f = 1;
      local_30 = FUN_0002f22c("select descriptor? (yes=1 or no=0)");
      bVar4 = local_30 != 1;
      if (bVar4) {
        local_1c4 = 2;
        local_1c0 = local_1c;
        local_1a8 = 2;
        local_1a4 = local_26;
        local_1b0 = (char)local_24;
        local_1ac = (char)local_20;
        local_194 = (char)local_2c;
      }
      else {
        local_8c = 2;
        local_88 = local_1c;
        local_70 = 2;
        local_6c = local_26;
        local_78 = (char)local_24;
        local_74 = (char)local_20;
        local_5c = (char)local_2c;
        iVar1 = FUN_0002f22c("Enter Descriptor type UUID to write(eg. x2902)");
        local_32 = (undefined2)iVar1;
        local_38 = FUN_0002f22c("Enter Instance ID for Desc UUID(eg. 0,1,2..)");
        local_58 = 2;
        local_54 = local_32;
        local_44 = (undefined)local_38;
      }
      local_40 = !bVar4;
      iVar1 = FUN_0002f22c("Enter number of bytes to write (eg. 1 or 2)");
      local_3a = (ushort)iVar1;
      for (local_12 = 0; local_12 < local_3a; local_12 = local_12 + 1) {
        uVar3 = (uint)local_12;
        iVar1 = FUN_0002f22c("Enter data in byte (eg. 1 or 2)");
        auStack_22c[uVar3] = (char)iVar1;
        auStack_18c[local_12] = auStack_22c[local_12];
      }
      local_18e = local_3a;
      local_1c8[0] = *(undefined2 *)(&DAT_0008ac02 + local_18 * 0x24);
      local_8d = 0;
      local_1a = BSA_BleClWrite(local_1c8);
      if (local_1a == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_prepare_write",0x43c);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_2ac,"BSA_BleClWrite failed status = %d",local_1a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_prepare_write",0x403);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_2ac,"BSA_BleClWriteInit failed status = %d",local_1a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2ac,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_prepare_write",0x3fc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2ac,"fail : write pending(%d), congested(%d)!",
                     (&DAT_0008ac0a)[local_18 * 0x24],(&DAT_0008ac0c)[local_18 * 0x24]);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00042086(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_21c [128];
  undefined2 local_19c [197];
  undefined local_12;
  undefined local_11;
  undefined local_f;
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_21c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_execute_write",0x457);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_21c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_21c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_execute_write",0x45e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_21c,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else if (((&DAT_0008ac0a)[local_c * 0x24] == '\0') && ((&DAT_0008ac0c)[local_c * 0x24] == '\0')) {
    local_e = BSA_BleClWriteInit(local_19c);
    if (local_e == 0) {
      local_19c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
      local_12 = 1;
      iVar1 = FUN_0002f22c("Execute Write? (yes=1 or no=0)");
      local_11 = (undefined)iVar1;
      local_f = local_11;
      local_e = BSA_BleClWrite(local_19c);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_21c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_execute_write",0x47a);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_21c,"BSA_BleClWrite failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_21c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_execute_write",0x46e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_21c,"BSA_BleClWriteInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_21c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_execute_write",0x467);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_21c,"fail : write pending(%d), congested(%d)!",
                     (&DAT_0008ac0a)[local_c * 0x24],(&DAT_0008ac0c)[local_c * 0x24]);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004232c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_e4 [128];
  undefined local_64 [4];
  undefined2 local_60;
  undefined2 local_5c;
  undefined local_4c;
  undefined local_48;
  undefined2 local_44;
  undefined2 local_40;
  undefined local_30;
  undefined auStack_2c [8];
  int local_24;
  int local_20;
  int local_1c;
  undefined2 local_18;
  undefined2 local_16;
  int local_14;
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_e4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_register_notification",0x495);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_e4,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_register_notification",0x49c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_e4,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClNotifRegisterInit(local_64);
    if (local_e == 0) {
      local_14 = FUN_0002f22c("Enter Service UUID to register(eg. x1800)");
      if (local_14 < 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_register_notification",0x4a7);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_e4,"Invalid Service UUID = %d",local_14);
        }
        uVar2 = 0xffffffff;
      }
      else {
        local_16 = (undefined2)local_14;
        local_14 = FUN_0002f22c("Enter Char UUID to register(eg. x2a00)");
        if (local_14 < 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_register_notification",0x4b1);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_e4,"Invalid Char UUID = %d",local_14);
          }
          uVar2 = 0xffffffff;
        }
        else {
          local_18 = (undefined2)local_14;
          local_1c = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
          local_20 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
          local_24 = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
          local_60 = 2;
          local_5c = local_16;
          local_44 = 2;
          local_40 = local_18;
          local_4c = (undefined)local_20;
          local_48 = (undefined)local_1c;
          local_30 = (undefined)local_24;
          bdcpy(auStack_2c,&DAT_0008ac04 + local_c * 0x24);
          local_64[0] = (&DAT_0008ac01)[local_c * 0x24];
          local_e = BSA_BleClNotifRegister(local_64);
          if (local_e == 0) {
            uVar2 = 0;
          }
          else {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                      ,"app_ble_client_register_notification",0x4c9);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_e4,"BSA_BleClNotifRegister failed status = %d",local_e);
            }
            uVar2 = 0xffffffff;
          }
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_register_notification",0x4a2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_e4,"BSA_BleClNotifRegisterInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00042650(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a8 [128];
  undefined auStack_28 [8];
  undefined local_20;
  undefined auStack_1f [6];
  undefined local_19;
  int local_18;
  short local_12;
  int local_10;
  int local_c;
  
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x4ec);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_a8,"Bluetooth BLE connect menu:");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x4ed);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_a8,"    0 Device from XML database (already paired)");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x4ee);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_a8,"    1 Device found in last discovery");
    }
    local_c = FUN_0002f22c("Select source");
  }
  else {
    local_c = 1;
  }
  if (local_c == 0) {
    FUN_0002a97e();
    FUN_0002e882(0x896e8,10);
    local_c = FUN_0002f22c("Select device");
    if (((local_c < 0) || (9 < local_c)) || ((&DAT_000896e8)[local_c * 0x1b0] == '\0')) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_open",0x503);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"Bad Device Index:%d\n",local_c);
      }
      return 0xffffffff;
    }
    bdcpy(auStack_28,&DAT_000896e9 + local_c * 0x1b0);
  }
  else {
    if (local_c != 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_open",0x51c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"Bad choice [XML(0) or Disc(1) only]");
      }
      return 0xffffffff;
    }
    if (param_1 == 0) {
      FUN_00023ce4();
      local_c = FUN_0002f22c("Select device");
    }
    else {
      local_c = FUN_00026f52(param_1);
    }
    if (((-1 < local_c) && (local_c < 0x14)) && ((&DAT_00086d50)[local_c * 0x210] != '\0')) {
      bdcpy(auStack_28,&DAT_00086d54 + local_c * 0x210);
    }
  }
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x526);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_a8,"Select Client:");
    }
    FUN_0003fd22(0);
    local_10 = FUN_0002f22c("Select");
  }
  else {
    local_10 = 0;
  }
  if (((local_10 < 0) || (2 < local_10)) || ((&DAT_0008ac00)[local_10 * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x52f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"Wrong client number! = %d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  else if (*(short *)(&DAT_0008ac02 + local_10 * 0x24) == -1) {
    local_12 = BSA_BleClConnectInit(&local_20);
    if (local_12 == 0) {
      local_20 = (&DAT_0008ac01)[local_10 * 0x24];
      if (param_1 == 0) {
        local_18 = FUN_0002f22c("Direct connection:1, Background connection:0");
        if (local_18 == 1) {
          local_19 = 1;
        }
        else {
          if (local_18 != 0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                      ,"app_ble_client_open",0x553);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_a8,"Wrong selection! = %d",local_18);
            }
            return 0xffffffff;
          }
          local_19 = 0;
        }
      }
      else {
        local_19 = 1;
      }
      bdcpy(&DAT_0008ac04 + local_10 * 0x24,auStack_28);
      bdcpy(auStack_1f,auStack_28);
      local_12 = BSA_BleClConnect(&local_20);
      if (local_12 == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_open",0x55e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a8,"BSA_BleClConnect failed status = %d",local_12);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_open",0x53c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a8,"BSA_BleClConnectInit failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_open",0x535);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a8,"Connection already exist, conn_id = %d",
                     *(undefined2 *)(&DAT_0008ac02 + local_10 * 0x24));
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00042bee(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined2 local_10;
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_close",0x576);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_close",0x57e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClCloseInit(&local_10);
    if (local_e == 0) {
      local_10 = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
      local_e = BSA_BleClClose(&local_10);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_close",0x58b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleClClose failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_close",0x584);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"BSA_BleClCLoseInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00042dac(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined auStack_14 [6];
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_refresh",0x5a6);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_refresh",0x5ae);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClRefreshInit(auStack_14);
    if (local_e == 0) {
      bdcpy(auStack_14,&DAT_0008ac04 + local_c * 0x24);
      local_e = BSA_BleClRefresh(auStack_14);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_refresh",0x5bb);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_94,"BSA_BleClRefresh failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_refresh",0x5b4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_94,"BSA_BleClRefreshInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



void FUN_00042f72(int param_1)

{
  int iVar1;
  undefined auStack_a0 [128];
  int *local_20;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_paired_device_display",0x5d4);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"BLE PAIRED DEVICE LIST...");
  }
  for (local_1c = 0; local_1c < 10; local_1c = local_1c + 1) {
    if (((&DAT_0008981a)[local_1c * 0x1b0] == '\x02') &&
       ((&DAT_000896e8)[local_1c * 0x1b0] == '\x01')) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_paired_device_display",0x5e2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_a0,"Index:%d BDA:%02X:%02X:%02X:%02X:%02X:%02X",local_1c,
                       (&DAT_000896e9)[local_1c * 0x1b0],(&DAT_000896ea)[local_1c * 0x1b0],
                       (&DAT_000896eb)[local_1c * 0x1b0],(&DAT_000896ec)[local_1c * 0x1b0],
                       (&DAT_000896ed)[local_1c * 0x1b0],(&DAT_000896ee)[local_1c * 0x1b0]);
      }
      if (param_1 != 0) {
        local_20 = (int *)FUN_00048a6e(&DAT_000896e9 + local_1c * 0x1b0);
        if (local_20 != (int *)0x0) {
          FUN_0003fbec(local_20);
        }
      }
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_paired_device_display",0x5ee);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"BLE PAIRED DEVICE LIST END...");
  }
  return;
}



undefined4 FUN_00043196(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a4 [128];
  undefined2 local_24 [2];
  undefined auStack_20 [8];
  int local_18;
  int local_14;
  int local_10;
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_unpair",0x606);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a4,"app_ble_client_unpair");
  }
  FUN_0002a97e();
  FUN_00042f72(0);
  local_14 = FUN_0002f22c("Select");
  if ((local_14 < 0) || (9 < local_14)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_unpair",0x60f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"Wrong index number! = %d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  else if (((&DAT_0008981a)[local_14 * 0x1b0] == '\x02') &&
          ((&DAT_000896e8)[local_14 * 0x1b0] == '\x01')) {
    for (local_10 = 0; local_10 < 10; local_10 = local_10 + 1) {
      iVar1 = bdcmp(&DAT_000896e9 + local_14 * 0x1b0,&DAT_0008ac04 + local_10 * 0x24);
      if ((iVar1 == 0) && (*(short *)(&DAT_0008ac02 + local_10 * 0x24) != -1)) {
        local_a = BSA_BleClCloseInit(local_24);
        if (local_a != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_unpair",0x624);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_a4,"BSA_BleClCLoseInit failed status = %d",local_a);
          }
          return 0xffffffff;
        }
        local_24[0] = *(undefined2 *)(&DAT_0008ac02 + local_10 * 0x24);
        local_a = BSA_BleClClose(local_24);
        if (local_a != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_unpair",0x62b);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_a4,"BSA_BleClClose failed status = %d",local_a);
          }
          return 0xffffffff;
        }
      }
    }
    BSA_SecRemoveDeviceInit(auStack_20);
    if (local_a == 0) {
      bdcpy(auStack_20,&DAT_000896e9 + local_14 * 0x1b0);
      local_a = BSA_SecRemoveDevice(auStack_20);
      if (local_a == 0) {
        (&DAT_000896e8)[local_14 * 0x1b0] = 0;
        FUN_0002aa0a();
        iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_unpair",0x645);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_a4,"Remove device from BLE DB");
        }
        local_18 = FUN_00048a6e(&DAT_000896e9 + local_14 * 0x1b0);
        if (local_18 != 0) {
          FUN_00048770(&DAT_000896e9 + local_14 * 0x1b0);
          FUN_00048718();
        }
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_unpair",0x63d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_a4,"BSA_SecRemoveDevice Operation Failed with status = %d",
                         local_a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_unpair",0x635);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a4,"BSA_SecRemoveDeviceInit failed status = %d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_unpair",0x616);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a4,"Wrong device index! = %d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000435c8(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined local_10 [2];
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_deregister",0x66f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_deregister",0x677);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClAppDeregisterInit(local_10);
    if (local_e == 0) {
      local_10[0] = (&DAT_0008ac01)[local_c * 0x24];
      local_e = BSA_BleClAppDeregister(local_10);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_deregister",0x684);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleAppDeregister failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_deregister",0x67d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"BSA_BleClAppDeregisterInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00043786(void)

{
  int iVar1;
  undefined auStack_90 [128];
  undefined local_10 [2];
  short local_e;
  int local_c;
  
  local_c = 0;
  do {
    if (2 < local_c) {
      return 0;
    }
    if ((&DAT_0008ac00)[local_c * 0x24] != '\0') {
      local_e = BSA_BleClAppDeregisterInit(local_10);
      if (local_e != 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_deregister_all",0x6a4);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleClAppDeregisterInit failed status = %d",local_e);
        }
        return 0xffffffff;
      }
      local_10[0] = (&DAT_0008ac01)[local_c * 0x24];
      local_e = BSA_BleClAppDeregister(local_10);
      if (local_e != 0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_deregister_all",0x6ab);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_90,"BSA_BleAppDeregister failed status = %d",local_e);
        }
        return 0xffffffff;
      }
    }
    local_c = local_c + 1;
  } while( true );
}



undefined4 FUN_000438b2(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_e4 [128];
  undefined local_64 [4];
  undefined2 local_60;
  undefined2 local_5c;
  undefined local_4c;
  undefined local_48;
  undefined2 local_44;
  undefined2 local_40;
  undefined local_30;
  undefined auStack_2c [8];
  int local_24;
  int local_20;
  int local_1c;
  undefined2 local_18;
  undefined2 local_16;
  int local_14;
  short local_10;
  short local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_e4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_deregister_notification",0x6c8);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_e4,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (((local_c < 0) || (2 < local_c)) || ((&DAT_0008ac00)[local_c * 0x24] == '\0')) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_deregister_notification",0x6d0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_e4,"Wrong client number! = %d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = BSA_BleClNotifDeregisterInit(local_64);
    if (local_e == 0) {
      bdcpy(auStack_2c,&DAT_0008ac04 + local_c * 0x24);
      local_64[0] = (&DAT_0008ac01)[local_c * 0x24];
      iVar1 = FUN_0002f22c("0 = deregister all notifications, 1 = deregister a notification");
      local_10 = (short)iVar1;
      if (local_10 == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_e4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_deregister_notification",0x6df);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_e4,"Deregister all notifications");
        }
      }
      else {
        if (local_10 != 1) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_deregister_notification",0x709);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_e4,"wrong select = %d",local_10);
          }
          return 0xffffffff;
        }
        local_14 = FUN_0002f22c("Enter Service UUID to deregister(eg. x1800)");
        if (local_14 < 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_deregister_notification",0x6e5);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_e4,"Invalid Service UUID = %d",local_14);
          }
          return 0xffffffff;
        }
        local_16 = (undefined2)local_14;
        local_14 = FUN_0002f22c("Enter Char UUID to deregister(eg. x2a00)");
        if (local_14 < 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_deregister_notification",0x6ef);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_e4,"Invalid Char UUID = %d",local_14);
          }
          return 0xffffffff;
        }
        local_18 = (undefined2)local_14;
        local_1c = FUN_0002f22c("Enter Is_primary value(eg:0,1)");
        local_20 = FUN_0002f22c("Enter Instance ID for Service UUID(eg. 0,1,2..)");
        local_24 = FUN_0002f22c("Enter Instance ID for Char UUID(eg. 0,1,2..)");
        local_60 = 2;
        local_5c = local_16;
        local_44 = 2;
        local_40 = local_18;
        local_4c = (undefined)local_20;
        local_48 = (undefined)local_1c;
        local_30 = (undefined)local_24;
        bdcpy(auStack_2c,&DAT_0008ac04 + local_c * 0x24);
        local_64[0] = (&DAT_0008ac01)[local_c * 0x24];
      }
      local_e = BSA_BleClNotifDeregister(local_64);
      if (local_e == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_deregister_notification",0x70f);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_e4,"BSA_BleClNotifDeregister failed status = %d",local_e);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_e4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_deregister_notification",0x6d6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_e4,"BSA_BleClNotifDeregisterInit failed status = %d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00043cce(undefined4 *param_1,undefined4 param_2,undefined2 param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined auStack_1cc [128];
  undefined2 local_14c;
  short local_14a;
  undefined2 local_146;
  undefined auStack_144 [8];
  undefined4 auStack_13c [5];
  undefined2 auStack_128 [2];
  undefined auStack_124 [258];
  short local_22;
  undefined4 *local_20;
  int local_1c;
  int local_18;
  int local_14;
  
  local_14 = 0;
  local_18 = 0;
  local_1c = 0;
  BSA_BleClCacheLoadInit(&local_14c);
  if (param_1 == (undefined4 *)0x0) {
    bdcpy(auStack_144,param_2);
    local_14a = 0;
    local_14c = 0;
    local_146 = param_3;
    local_22 = BSA_BleClCacheLoad(&local_14c);
    if (local_22 == 0) {
      DAT_00085afc = 0;
      DAT_00085af8 = 0;
      uVar3 = 1;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_load_attr",0x739);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
      }
      uVar3 = 0xffffffff;
    }
  }
  else {
    local_20 = (undefined4 *)*param_1;
    if ((DAT_00085af8 == 0) && (DAT_00085afc == 0)) {
      DAT_00085afc = 1;
      if (local_20 == (undefined4 *)0x0) {
        bdcpy(auStack_144,param_2);
        local_14a = 0;
        local_14c = 0;
        local_146 = param_3;
        local_22 = BSA_BleClCacheLoad(&local_14c);
        if (local_22 != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_load_attr",0x74f);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
          }
          return 0xffffffff;
        }
        DAT_00085afc = 0;
        DAT_00085af8 = 0;
      }
      else {
        while ((iVar1 = local_14, local_20 != (undefined4 *)0x0 && (local_1c == 0))) {
          if (local_14 == 10) {
            bdcpy(auStack_144,param_2);
            local_14a = (short)local_14;
            local_14c = 1;
            DAT_00085afc = 1;
            DAT_00085af8 = local_14;
            local_146 = param_3;
            local_22 = BSA_BleClCacheLoad(&local_14c);
            if (local_22 != 0) {
              iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                        ,"app_ble_client_load_attr",0x765);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
              }
              return 0xffffffff;
            }
            local_1c = 1;
            local_22 = 0;
          }
          else {
            uVar3 = local_20[1];
            uVar2 = local_20[2];
            uVar4 = local_20[3];
            puVar5 = local_20 + 4;
            auStack_13c[local_14 * 7] = *local_20;
            auStack_13c[iVar1 * 7 + 1] = uVar3;
            auStack_13c[iVar1 * 7 + 2] = uVar2;
            auStack_13c[iVar1 * 7 + 3] = uVar4;
            auStack_13c[iVar1 * 7 + 4] = *puVar5;
            auStack_128[local_14 * 0xe] = *(undefined2 *)(local_20 + 5);
            auStack_124[local_14 * 0x1c] = *(undefined *)((int)local_20 + 0x16);
            auStack_124[local_14 * 0x1c + 1] = *(undefined *)((int)local_20 + 0x17);
            auStack_124[local_14 * 0x1c + 2] = *(undefined *)(local_20 + 6);
            auStack_124[local_14 * 0x1c + 3] = *(undefined *)((int)local_20 + 0x19);
            local_14 = local_14 + 1;
            local_20 = (undefined4 *)local_20[7];
          }
        }
        if ((local_14 != 0) && (local_1c == 0)) {
          bdcpy(auStack_144,param_2);
          local_14a = (short)local_14 + 1;
          local_14c = 0;
          local_146 = param_3;
          local_22 = BSA_BleClCacheLoad(&local_14c);
          if (local_22 != 0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                      ,"app_ble_client_load_attr",0x786);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
            }
            return 0xffffffff;
          }
          DAT_00085afc = 0;
          DAT_00085af8 = 0;
        }
      }
    }
    else if ((DAT_00085af8 == 0) || (DAT_00085afc != 1)) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_load_attr",0x7d4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1cc,
                       "Abnormal situation number_of_load_attr:%d, state_of_load_attr:%d",
                       DAT_00085af8,DAT_00085afc);
      }
    }
    else {
      for (; (local_18 < DAT_00085af8 && (local_20 != (undefined4 *)0x0));
          local_20 = (undefined4 *)local_20[7]) {
        local_18 = local_18 + 1;
      }
      while ((iVar1 = local_14, local_20 != (undefined4 *)0x0 && (local_1c == 0))) {
        if (local_14 == 10) {
          bdcpy(auStack_144,param_2);
          local_14a = (short)local_14;
          if (local_20 != (undefined4 *)0x0) {
            local_14c = 1;
            DAT_00085afc = 1;
            DAT_00085af8 = DAT_00085af8 + local_14;
          }
          local_146 = param_3;
          local_22 = BSA_BleClCacheLoad(&local_14c);
          if (local_22 != 0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                      ,"app_ble_client_load_attr",0x7a8);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
            }
            return 0xffffffff;
          }
          local_1c = 1;
          local_22 = 0;
        }
        else {
          uVar3 = local_20[1];
          uVar2 = local_20[2];
          uVar4 = local_20[3];
          puVar5 = local_20 + 4;
          auStack_13c[local_14 * 7] = *local_20;
          auStack_13c[iVar1 * 7 + 1] = uVar3;
          auStack_13c[iVar1 * 7 + 2] = uVar2;
          auStack_13c[iVar1 * 7 + 3] = uVar4;
          auStack_13c[iVar1 * 7 + 4] = *puVar5;
          auStack_128[local_14 * 0xe] = *(undefined2 *)(local_20 + 5);
          auStack_124[local_14 * 0x1c] = *(undefined *)((int)local_20 + 0x16);
          auStack_124[local_14 * 0x1c + 1] = *(undefined *)((int)local_20 + 0x17);
          auStack_124[local_14 * 0x1c + 2] = *(undefined *)(local_20 + 6);
          auStack_124[local_14 * 0x1c + 3] = *(undefined *)((int)local_20 + 0x19);
          local_14 = local_14 + 1;
          local_20 = (undefined4 *)local_20[7];
        }
      }
      if ((local_14 != 0) && (local_1c == 0)) {
        bdcpy(auStack_144,param_2);
        local_14a = (short)local_14;
        local_14c = 0;
        local_146 = param_3;
        local_22 = BSA_BleClCacheLoad(&local_14c);
        if (local_22 != 0) {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1cc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_load_attr",0x7c9);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1cc,"BSA_BleClCacheLoad failed status = %d",local_22);
          }
          return 0xffffffff;
        }
        DAT_00085afc = 0;
        DAT_00085af8 = 0;
      }
    }
    uVar3 = 1;
  }
  return uVar3;
}



void FUN_00044460(undefined4 param_1,short *param_2)

{
  char *pcVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined auStack_e8 [128];
  short local_68;
  undefined2 local_66;
  short local_64 [2];
  undefined auStack_60 [52];
  undefined4 *local_2c;
  int local_28;
  int local_24;
  void **local_20;
  int local_1c;
  
  switch(param_1) {
  case 0:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x7f0);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_DEREG_EVT cif=%d status=%d",
                     *(undefined *)(param_2 + 1),*param_2);
    }
    local_24 = FUN_00040050(*(char *)(param_2 + 1));
    if (local_24 < 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x7f4);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_e8,"No client!!");
      }
    }
    else {
      (&DAT_0008ac00)[local_24 * 0x24] = 0;
      (&DAT_0008ac01)[local_24 * 0x24] = 0xff;
      *(undefined2 *)(&DAT_0008ac02 + local_24 * 0x24) = 0xffff;
    }
    break;
  case 1:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x800);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_OPEN_EVT client_if=%d conn_id=%d status=%d",
                     *(undefined *)(param_2 + 2),param_2[1],*param_2);
    }
    if (*param_2 == 0) {
      local_24 = FUN_00040050(*(char *)(param_2 + 2));
      if (local_24 < 0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_profile_cback",0x806);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_e8,"No client!!");
        }
      }
      else {
        *(short *)(&DAT_0008ac02 + local_24 * 0x24) = param_2[1];
        FUN_0002a97e();
        FUN_0002e666(0x896e8,10,(int)param_2 + 5,0x40000000);
        for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
          iVar2 = bdcmp(&DAT_00086d54 + local_1c * 0x210,(int)param_2 + 5);
          if (iVar2 == 0) {
            FUN_0002e708(0x896e8,10,(int)param_2 + 5,(char *)(local_1c * 0x210 + 0x86d5d));
            FUN_0002ed9a(0x896e8,10,(int)param_2 + 5,(&DAT_00086f5b)[local_1c * 0x210]);
            FUN_0002ee2c(0x896e8,10,(int)param_2 + 5,(&DAT_00086f5c)[local_1c * 0x210]);
            FUN_0002eebe(0x896e8,10,(int)param_2 + 5,(&DAT_00086f5a)[local_1c * 0x210]);
            break;
          }
        }
        local_28 = FUN_0002aa0a();
        if ((local_28 < 0) &&
           (iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                      ,"app_ble_client_profile_cback",0x829), iVar2 != 0)) {
          duss_log_print(0x5c,1,auStack_e8,"app_ble_write_remote_devices failed: %d",local_28);
        }
        local_20 = (void **)FUN_00048a6e((int)param_2 + 5);
        if ((local_20 == (void **)0x0) &&
           (local_20 = (void **)FUN_00048910(), local_20 != (void **)0x0)) {
          bdcpy(local_20 + 1,(int)param_2 + 5);
          *(ushort *)((int)local_20 + 10) = (ushort)*(byte *)(param_2 + 2);
          FUN_00048992((int)local_20);
          FUN_00048718();
        }
        BSA_BleClCfgMtuInit(&local_68);
        local_68 = param_2[1];
        local_66 = 0xfb;
        BSA_BleClCfgMtu(&local_68);
      }
    }
    break;
  case 2:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x86a);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_READ_EVT: conn_id:%d len:%d",param_2[1],
                     param_2[0x28]);
    }
    local_24 = FUN_0004009e(param_2[1]);
    (&DAT_0008ac0b)[local_24 * 0x24] = 0;
    if (*param_2 == 0) {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x871);
      if (iVar2 != 0) {
        pcVar1 = FUN_0003e8ec(param_2[4]);
        duss_log_print(0x5c,3,auStack_e8,"srvc_id:%s (uuid:0x%04x)",pcVar1,param_2[4]);
      }
      FUN_000470ee((int)param_2);
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x877);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_e8,"BSA_BLE_CL_READ_EVT: status:%d",*param_2);
      }
    }
    break;
  case 3:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x88b);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_WRITE_EVT status:%d",param_2[1]);
    }
    iVar2 = FUN_0004009e(*param_2);
    if (-1 < iVar2) {
      (&DAT_0008ac0a)[iVar2 * 0x24] = 0;
    }
    break;
  case 4:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x895);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_EXEC_CMPL_EVT status:%d, conn:%d",*param_2,
                     param_2[1]);
    }
    iVar2 = FUN_0004009e(param_2[1]);
    if (-1 < iVar2) {
      (&DAT_0008ac0a)[iVar2 * 0x24] = 0;
    }
    break;
  case 5:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x87f);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_CLOSE_EVT, BDA:%02X:%02X:%02X:%02X:%02X:%02X  ",
                     *(undefined *)((int)param_2 + 5),*(undefined *)(param_2 + 3),
                     *(undefined *)((int)param_2 + 7),*(undefined *)(param_2 + 4),
                     *(undefined *)((int)param_2 + 9),*(undefined *)(param_2 + 5));
    }
    local_24 = FUN_00040050(*(char *)(param_2 + 2));
    if (local_24 < 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x883);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_e8,"No client!!");
      }
    }
    else {
      *(undefined2 *)(&DAT_0008ac02 + local_24 * 0x24) = 0xffff;
    }
    break;
  case 6:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x860);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_SEARCH_CMPL_EVT = %d",*param_2);
    }
    if (DAT_00085af4 == '\x01') {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x863);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_e8,"Searched service not found");
      }
      DAT_00085af4 = '\0';
    }
    break;
  case 7:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x84d);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_SEARCH_RES_EVT: conn_id = %d",*param_2);
    }
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x851);
    if (iVar2 != 0) {
      pcVar1 = FUN_0003e8ec(param_2[4]);
      duss_log_print(0x5c,3,auStack_e8," Searched Service name:%s(uuid:0x%04x)",pcVar1,param_2[4]);
    }
    if (param_2[2] == 0x10) {
      scru_dump_hex(param_2 + 4,"buffer UUID",0x10,0,5);
    }
    DAT_00085af4 = '\0';
    break;
  case 8:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x8ab);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_NOTIF_EVT BDA :%02X:%02X:%02X:%02X:%02X:%02X",
                     *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),
                     *(undefined *)(param_2 + 2),*(undefined *)((int)param_2 + 5),
                     *(undefined *)(param_2 + 3),*(undefined *)((int)param_2 + 7));
    }
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x8b1);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,
                     "conn_id:0x%x, svrc_id:0x%04x, char_id:0x%04x, descr_type:0x%04x, len:%d, is_notify:%d"
                     ,*param_2,param_2[6],param_2[0x14],param_2[0x20],param_2[0x2a],
                     *(undefined *)(param_2 + 0x157));
    }
    if (*(char *)(param_2 + 0x157) == '\x01') {
      FUN_000464cc((int)param_2);
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_profile_cback",0x8b6);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_e8,"Receive Indication! send Indication Confirmation!");
      }
      local_28 = BSA_BleClIndConfInit(local_64);
      if (local_28 < 0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_profile_cback",0x8ba);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_e8,"BSA_BleClIndConfInit failed: %d",local_28);
        }
      }
      else {
        local_64[0] = *param_2;
        memcpy(auStack_60,param_2 + 4,0x34);
        local_28 = BSA_BleClIndConf(local_64);
        if (local_28 < 0) {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_e8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                    ,"app_ble_client_profile_cback",0x8c2);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_e8,"BSA_BleClIndConf failed: %d",local_28);
          }
        }
        else {
          FUN_0004528e((int)param_2);
        }
      }
    }
    break;
  case 9:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x89f);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_CONGEST_EVT  :conn_id:0x%x, congested:%d",
                     *param_2,*(undefined *)(param_2 + 1));
    }
    iVar2 = FUN_0004009e(*param_2);
    if (-1 < iVar2) {
      (&DAT_0008ac0c)[iVar2 * 0x24] = *(undefined *)(param_2 + 1);
    }
    break;
  case 10:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x8ce);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_CACHE_SAVE_EVT");
    }
    if (*(char *)(param_2 + 0x94) != '\x01') {
      for (local_1c = 0; local_1c < (int)(uint)(ushort)param_2[1]; local_1c = local_1c + 1) {
      }
      local_20 = (void **)FUN_00048a6e(param_2 + 4);
      if ((local_20 == (void **)0x0) &&
         (local_20 = (void **)FUN_00048910(), local_20 != (void **)0x0)) {
        bdcpy(local_20 + 1,param_2 + 4);
        FUN_00048992((int)local_20);
        FUN_00048718();
      }
      if (local_20 != (void **)0x0) {
        for (local_1c = 0; local_1c < (int)(uint)(ushort)param_2[1]; local_1c = local_1c + 1) {
          iVar2 = FUN_00048ab0((int *)local_20,param_2[local_1c * 0xe + 0x12]);
          if (iVar2 == 0) {
            local_2c = (undefined4 *)FUN_00048aec(local_20);
            *(undefined *)((int)local_2c + 0x16) = *(undefined *)(param_2 + local_1c * 0xe + 0x14);
            uVar3 = *(undefined4 *)(param_2 + local_1c * 0xe + 10);
            uVar4 = *(undefined4 *)(param_2 + local_1c * 0xe + 0xc);
            uVar5 = *(undefined4 *)(param_2 + local_1c * 0xe + 0xe);
            *local_2c = *(undefined4 *)(param_2 + local_1c * 0xe + 8);
            local_2c[1] = uVar3;
            local_2c[2] = uVar4;
            local_2c[3] = uVar5;
            local_2c[4] = *(undefined4 *)(param_2 + local_1c * 0xe + 0x10);
            *(short *)(local_2c + 5) = param_2[local_1c * 0xe + 0x12];
            *(undefined *)((int)local_2c + 0x17) =
                 *(undefined *)((int)param_2 + local_1c * 0x1c + 0x29);
            *(undefined *)(local_2c + 6) = *(undefined *)(param_2 + local_1c * 0xe + 0x15);
            *(undefined *)((int)local_2c + 0x19) =
                 *(undefined *)((int)param_2 + local_1c * 0x1c + 0x2b);
          }
        }
        FUN_00048718();
      }
    }
    break;
  case 0xb:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x915);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_CACHE_LOAD_EVT");
    }
    local_20 = (void **)FUN_00048a6e(param_2 + 2);
    if (local_20 == (void **)0x0) {
      FUN_00043cce((undefined4 *)0x0,param_2 + 2,*param_2);
    }
    else {
      FUN_00043cce(local_20,param_2 + 2,*param_2);
    }
    break;
  case 0xc:
    iVar2 = duss_log_gen_head(0x5c,3,auStack_e8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_profile_cback",0x930);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_e8,"BSA_BLE_CL_CFG_MTU_EVT");
    }
  }
  return;
}



void FUN_0004528e(int param_1)

{
  int iVar1;
  undefined auStack_c0 [128];
  float local_40;
  byte local_39;
  byte local_38;
  byte local_37;
  byte local_36;
  byte local_35;
  byte local_34;
  byte local_33;
  short local_32;
  uint local_30;
  uint local_2c;
  short local_26;
  byte local_23;
  short local_22;
  byte local_1f;
  short local_1e;
  short local_1c;
  short local_1a;
  byte local_17;
  char local_16;
  char local_15;
  char local_14;
  char local_13;
  char local_12;
  char local_11;
  char local_10;
  char local_f;
  char local_e;
  char local_d;
  byte *local_c;
  
  local_17 = 0;
  local_d = '\0';
  local_e = '\0';
  local_f = '\0';
  local_10 = '\0';
  local_11 = '\0';
  local_12 = '\0';
  local_1a = 0;
  local_1c = 0;
  local_1e = 0;
  local_1f = 0;
  local_22 = 0;
  local_23 = 0;
  local_26 = 0;
  local_13 = '\0';
  local_14 = '\0';
  local_15 = '\0';
  local_16 = '\0';
  local_2c = 0;
  local_30 = 0;
  local_32 = 0;
  local_33 = 0;
  local_34 = 0;
  local_35 = 0;
  local_36 = 0;
  local_37 = 0;
  local_38 = 0;
  local_39 = 0;
  local_40 = 0.0;
  if (*(short *)(param_1 + 0x28) == 0x2a1c) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_handle_indication",0x9d3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c0,
                     "BSA_BLE_GATT_UUID_TEMPERATURE_MEASUREMENT, cli_notif->len %d",
                     *(undefined2 *)(param_1 + 0x54));
    }
    local_17 = *(byte *)(param_1 + 0x56);
    local_c = (byte *)(param_1 + 0x57);
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_handle_indication",0x9d6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c0,"Flags:0x%x",local_17);
    }
    if ((local_17 & 1) == 0) {
      local_14 = '\x01';
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9df);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value in units of Celsius");
      }
    }
    else {
      local_13 = '\x01';
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9da);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value in units of Fahrenheit");
      }
    }
    if ((local_17 >> 1 & 1) == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9e9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Time Stamp field not present");
      }
    }
    else {
      local_15 = '\x01';
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9e5);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Time Stamp field present");
      }
    }
    if ((local_17 >> 2 & 1) == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9f3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Temperature Type field not present");
      }
    }
    else {
      local_16 = '\x01';
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9ef);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Temperature Type field present");
      }
    }
    if (local_14 != '\0') {
      local_2c = (uint)local_c[2] * 0x10000 + (uint)*local_c + (uint)local_c[1] * 0x100;
      local_39 = local_c[3];
      local_c = local_c + 4;
      if (local_39 == 0xff) {
        local_40 = (float)(ulonglong)local_2c / 10.0;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9fe);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value (Celsius):%.1f",
                         (double)local_40);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa02);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value (Celsius):%d",local_2c);
        }
      }
    }
    if (local_13 != '\0') {
      local_30 = (uint)local_c[2] * 0x10000 + (uint)*local_c + (uint)local_c[1] * 0x100;
      local_39 = local_c[3];
      local_c = local_c + 4;
      if (local_39 == 0xff) {
        local_40 = (float)(ulonglong)local_30 / 10.0;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa0e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value (Fahrenheit):%.1f",
                         (double)local_40);
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa12);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Temperature Measurement Value (Fahrenheit):%d",local_30)
          ;
        }
      }
    }
    if (local_15 != '\0') {
      local_32 = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
      local_33 = local_c[2];
      local_34 = local_c[3];
      local_35 = local_c[4];
      local_36 = local_c[5];
      local_37 = local_c[6];
      local_c = local_c + 7;
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0xa1e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,
                       "Temperature Measurement Time stamp Date: Year-%d, Month-%d, Day-%d",local_32
                       ,local_33,local_34);
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0xa1f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Time: Hours-%d, Minutes-%d, Seconds-%d",local_35,local_36,
                       local_37);
      }
    }
    if (local_16 != '\0') {
      local_38 = *local_c;
      local_c = local_c + 1;
      if (local_38 == 1) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa25);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Armpit");
        }
      }
      else if (local_38 == 2) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa27);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Body (general)");
        }
      }
      else if (local_38 == 3) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa29);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Ear (usually ear lobe)");
        }
      }
      else if (local_38 == 4) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa2b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Finger");
        }
      }
      else if (local_38 == 5) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa2d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Gastro-intestinal Tract");
        }
      }
      else if (local_38 == 6) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa2f);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Mouth");
        }
      }
      else if (local_38 == 7) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa31);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Rectum");
        }
      }
      else if (local_38 == 8) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa33);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Toe");
        }
      }
      else if (local_38 == 9) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa35);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Tympanum (ear drum)");
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0xa37);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Location : Reserved");
        }
      }
    }
  }
  else if (*(short *)(param_1 + 0x28) == 0x2a35) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_handle_indication",0x96b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_c0,
                     "BSA_BLE_GATT_UUID_BLOOD_PRESSURE_MEASUREMENT, cli_notif->len %d",
                     *(undefined2 *)(param_1 + 0x54));
    }
    if (*(ushort *)(param_1 + 0x54) < 0xe) {
      local_17 = *(byte *)(param_1 + 0x56);
      local_c = (byte *)(param_1 + 0x57);
      iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x970);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_c0,"Flags:0x%x",local_17);
      }
      if ((local_17 & 1) == 0) {
        local_d = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x979);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood pressure for Systolic, Diastolic and MAP in units of mmHg");
        }
      }
      else {
        local_e = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x974);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood pressure for Systolic, Diastolic and MAP in units of kPa");
        }
      }
      if ((local_17 >> 1 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x982);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Time Stamp not present");
        }
      }
      else {
        local_f = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x97e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Time Stamp present");
        }
      }
      if ((local_17 >> 2 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x98b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Pulse Rate not present");
        }
      }
      else {
        local_10 = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x987);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Pulse Rate present");
        }
      }
      if ((local_17 >> 3 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x994);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"User ID not present");
        }
      }
      else {
        local_11 = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x990);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"User ID present");
        }
      }
      if ((local_17 >> 4 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x99d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Measurement Status not present");
        }
      }
      else {
        local_12 = '\x01';
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x999);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Measurement Status present");
        }
      }
      if (local_d != '\0') {
        local_1a = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9a3);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Systolic (mmHg):%d",local_1a);
        }
        local_1c = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9a5);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Diastolic (mmHg):%d",local_1c)
          ;
        }
        local_1e = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9a7);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Mean Arterial Pressure (mmHg):%d"
                         ,local_1e);
        }
      }
      if (local_e != '\0') {
        local_1a = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9ad);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Systolic (kPa):%d",local_1a);
        }
        local_1c = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9af);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Diastolic (kPa):%d",local_1c);
        }
        local_1e = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9b1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,
                         "Blood Pressure Measurement Compound Value - Mean Arterial Pressure (kPa):%d"
                         ,local_1e);
        }
      }
      if (local_f != '\0') {
        local_1f = *local_c;
        local_c = local_c + 1;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9b7);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Time Stamp:%d",local_1f);
        }
      }
      if (local_10 != '\0') {
        local_22 = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9bd);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Pulse Rate:%d",local_22);
        }
      }
      if (local_11 != '\0') {
        local_23 = *local_c;
        local_c = local_c + 1;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9c3);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"User Id:%d",local_23);
        }
      }
      if (local_12 != '\0') {
        local_26 = (ushort)local_c[1] * 0x100 + (ushort)*local_c;
        local_c = local_c + 2;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                  ,"app_ble_client_handle_indication",0x9c9);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_c0,"Measurement Status:%d",local_26);
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_indication",0x9ce);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_c0,"Wrong length:%d",*(undefined2 *)(param_1 + 0x54));
      }
    }
  }
  return;
}



void FUN_000464cc(int param_1)

{
  FUN_000464ea(param_1,FUN_0002f5b6 + 1);
  return;
}



void FUN_000464ea(int param_1,undefined *param_2)

{
  ushort uVar1;
  int iVar2;
  undefined auStack_dc [128];
  float local_5c;
  byte local_55;
  byte local_54;
  byte local_53;
  byte local_52;
  byte local_51;
  byte local_50;
  byte local_4f;
  short local_4e;
  uint local_4c;
  uint local_48;
  int local_44;
  short local_3e;
  byte local_3b;
  short local_3a;
  short local_38;
  byte local_35;
  short local_34;
  byte local_31;
  short local_30;
  short local_2e;
  short local_2c;
  short local_2a;
  short local_28;
  short local_26;
  int local_24;
  byte local_1f;
  char local_1e;
  char local_1d;
  char local_1c;
  char local_1b;
  char local_1a;
  char local_19;
  char local_18;
  char local_17;
  char local_16;
  char local_15;
  byte *local_14;
  
  local_1f = 0;
  local_24 = 0;
  local_26 = 0;
  local_28 = 0;
  local_2a = 0;
  local_15 = '\0';
  local_16 = '\0';
  local_17 = '\0';
  local_18 = '\0';
  local_19 = '\0';
  local_1a = '\0';
  local_2c = 0;
  local_2e = 0;
  local_30 = 0;
  local_31 = 0;
  local_34 = 0;
  local_35 = 0;
  local_38 = 0;
  local_3a = 0;
  local_3b = 0;
  local_3e = 0;
  local_44 = 0;
  local_1b = '\0';
  local_1c = '\0';
  local_1d = '\0';
  local_1e = '\0';
  local_48 = 0;
  local_4c = 0;
  local_4e = 0;
  local_4f = 0;
  local_50 = 0;
  local_51 = 0;
  local_52 = 0;
  local_53 = 0;
  local_54 = 0;
  local_55 = 0;
  local_5c = 0.0;
  uVar1 = *(ushort *)(param_1 + 0x28);
  if (uVar1 == 0x2a36) {
    (*(code *)param_2)("BSA_BLE_GATT_UUID_INTERMEDIATE_CUFF_PRESSURE, cli_notif->len %d",
                       *(undefined2 *)(param_1 + 0x54));
    if (*(ushort *)(param_1 + 0x54) < 0xe) {
      local_1f = *(byte *)(param_1 + 0x56);
      local_14 = (byte *)(param_1 + 0x57);
      (*(code *)param_2)("Flags:0x%x",local_1f);
      if ((local_1f & 1) == 0) {
        local_15 = '\x01';
        (*(code *)param_2)("Blood pressure for Systolic, Diastolic and MAP in units of mmHg");
      }
      else {
        local_16 = '\x01';
        (*(code *)param_2)("Blood pressure for Systolic, Diastolic and MAP in units of kPa");
      }
      if ((local_1f >> 1 & 1) == 0) {
        (*(code *)param_2)("Time Stamp not present");
      }
      else {
        local_17 = '\x01';
        (*(code *)param_2)("Time Stamp present");
      }
      if ((local_1f >> 2 & 1) == 0) {
        (*(code *)param_2)("Pulse Rate not present");
      }
      else {
        local_18 = '\x01';
        (*(code *)param_2)("Pulse Rate present");
      }
      if ((local_1f >> 3 & 1) == 0) {
        (*(code *)param_2)("User ID not present");
      }
      else {
        local_19 = '\x01';
        (*(code *)param_2)("User ID present");
      }
      if ((local_1f >> 4 & 1) == 0) {
        (*(code *)param_2)("Measurement Status not present");
      }
      else {
        local_1a = '\x01';
        (*(code *)param_2)("Measurement Status present");
      }
      if (local_15 != '\0') {
        local_2c = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Systolic (mmHg):%d",local_2c
                          );
        local_2e = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Diastolic (mmHg):%d",
                           local_2e);
        local_30 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Mean Arterial Pressure (mmHg):%d"
                           ,local_30);
      }
      if (local_16 != '\0') {
        local_2c = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Systolic (kPa):%d",local_2c)
        ;
        local_2e = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Diastolic (kPa):%d",local_2e
                          );
        local_30 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Blood Pressure Measurement Compound Value - Mean Arterial Pressure (kPa):%d"
                           ,local_30);
      }
      if (local_17 != '\0') {
        local_31 = *local_14;
        local_14 = local_14 + 1;
        (*(code *)param_2)("Time Stamp:%d",local_31);
      }
      if (local_18 != '\0') {
        local_34 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Pulse Rate:%d",local_34);
      }
      if (local_19 != '\0') {
        local_35 = *local_14;
        local_14 = local_14 + 1;
        (*(code *)param_2)("User Id:%d",local_35);
      }
      if (local_1a != '\0') {
        local_38 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_14 = local_14 + 2;
        (*(code *)param_2)("Measurement Status:%d",local_38);
      }
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_dc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_notification_ex",0xafd);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_dc,"Wrong length:%d",*(undefined2 *)(param_1 + 0x54));
      }
    }
  }
  else if (uVar1 < 0x2a37) {
    if (uVar1 == 0x2a1e) {
      (*(code *)param_2)("BSA_BLE_GATT_UUID_INTERMEDIATE_TEMPERATURE, cli_notif->len %d",
                         *(undefined2 *)(param_1 + 0x54));
      local_1f = *(byte *)(param_1 + 0x56);
      local_14 = (byte *)(param_1 + 0x57);
      (*(code *)param_2)("Flags:0x%x",local_1f);
      if ((local_1f & 1) == 0) {
        local_1c = '\x01';
        (*(code *)param_2)("Temperature Measurement Value in units of Celsius");
      }
      else {
        local_1b = '\x01';
        (*(code *)param_2)("Temperature Measurement Value in units of Fahrenheit");
      }
      if ((local_1f >> 1 & 1) == 0) {
        (*(code *)param_2)("Time Stamp field not present");
      }
      else {
        local_1d = '\x01';
        (*(code *)param_2)("Time Stamp field present");
      }
      if ((local_1f >> 2 & 1) == 0) {
        (*(code *)param_2)("Temperature Type field not present");
      }
      else {
        local_1e = '\x01';
        (*(code *)param_2)("Temperature Type field present");
      }
      if (local_1c != '\0') {
        local_48 = (uint)local_14[2] * 0x10000 + (uint)*local_14 + (uint)local_14[1] * 0x100;
        local_55 = local_14[3];
        local_14 = local_14 + 4;
        if (local_55 == 0xff) {
          local_5c = (float)(ulonglong)local_48 / 10.0;
          (*(code *)param_2)("Temperature Measurement Value (Celsius):%.1f",param_2,
                             SUB84((double)local_5c,0),(int)((ulonglong)(double)local_5c >> 0x20));
        }
        else {
          (*(code *)param_2)("Temperature Measurement Value (Celsius):%d",local_48);
        }
      }
      if (local_1b != '\0') {
        local_4c = (uint)local_14[2] * 0x10000 + (uint)*local_14 + (uint)local_14[1] * 0x100;
        local_55 = local_14[3];
        local_14 = local_14 + 4;
        if (local_55 == 0xff) {
          local_5c = (float)(ulonglong)local_4c / 10.0;
          (*(code *)param_2)("Temperature Measurement Value (Fahrenheit):%.1f",param_2,
                             SUB84((double)local_5c,0),(int)((ulonglong)(double)local_5c >> 0x20));
        }
        else {
          (*(code *)param_2)("Temperature Measurement Value (Fahrenheit):%d",local_4c);
        }
      }
      if (local_1d != '\0') {
        local_4e = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
        local_4f = local_14[2];
        local_50 = local_14[3];
        local_51 = local_14[4];
        local_52 = local_14[5];
        local_53 = local_14[6];
        local_14 = local_14 + 7;
        (*(code *)param_2)("Temperature Measurement Time stamp Date: Year-%d, Month-%d, Day-%d",
                           local_4e,local_4f,local_50);
        (*(code *)param_2)("Time: Hours-%d, Minutes-%d, Seconds-%d",local_51,local_52,local_53);
      }
      if (local_1e != '\0') {
        local_54 = *local_14;
        local_14 = local_14 + 1;
        if (local_54 == 1) {
          (*(code *)param_2)("Location : Armpit");
        }
        else if (local_54 == 2) {
          (*(code *)param_2)("Location : Body (general)");
        }
        else if (local_54 == 3) {
          (*(code *)param_2)("Location : Ear (usually ear lobe)");
        }
        else if (local_54 == 4) {
          (*(code *)param_2)("Location : Finger");
        }
        else if (local_54 == 5) {
          (*(code *)param_2)("Location : Gastro-intestinal Tract");
        }
        else if (local_54 == 6) {
          (*(code *)param_2)("Location : Mouth");
        }
        else if (local_54 == 7) {
          (*(code *)param_2)("Location : Rectum");
        }
        else if (local_54 == 8) {
          (*(code *)param_2)("Location : Toe");
        }
        else if (local_54 == 9) {
          (*(code *)param_2)("Location : Tympanum (ear drum)");
        }
        else {
          (*(code *)param_2)("Location : Reserved");
        }
      }
    }
  }
  else if (uVar1 == 0x2a53) {
    if (*(short *)(param_1 + 0x54) == 10) {
      local_1f = *(undefined *)(param_1 + 0x56);
      local_14 = (byte *)(param_1 + 0x57);
      (*(code *)param_2)("Flags:0x%x",local_1f);
      local_3a = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
      local_14 = local_14 + 2;
      (*(code *)param_2)("Instantaneous Speed:%d",local_3a);
      local_3b = *local_14;
      local_14 = local_14 + 1;
      (*(code *)param_2)("Instantaneous Cadence:%d",local_3b);
      local_3e = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
      local_14 = local_14 + 2;
      (*(code *)param_2)("Instantaneous Stride Length:%d",local_3e);
      local_44 = (uint)local_14[3] * 0x1000000 +
                 (uint)*local_14 + (uint)local_14[1] * 0x100 + (uint)local_14[2] * 0x10000;
      local_14 = local_14 + 4;
      (*(code *)param_2)("Total Distance: %d",local_44);
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_dc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_notification_ex",0xb12);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_dc,"Wrong length:%d",*(undefined2 *)(param_1 + 0x54));
      }
    }
  }
  else if (uVar1 == 0x2a5b) {
    if (*(short *)(param_1 + 0x54) == 0xb) {
      local_1f = *(undefined *)(param_1 + 0x56);
      local_14 = (byte *)(param_1 + 0x57);
      (*(code *)param_2)("Flags:0x%x",local_1f);
      local_24 = (uint)local_14[3] * 0x1000000 +
                 (uint)*local_14 + (uint)local_14[1] * 0x100 + (uint)local_14[2] * 0x10000;
      local_14 = local_14 + 4;
      (*(code *)param_2)("Cumulative Wheel Revolution:%d",local_24);
      local_26 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
      local_14 = local_14 + 2;
      (*(code *)param_2)("Last Wheel Event Time:%d",local_26);
      local_28 = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
      local_14 = local_14 + 2;
      (*(code *)param_2)("Cumulative Crank Revolution:%d",local_28);
      local_2a = (ushort)local_14[1] * 0x100 + (ushort)*local_14;
      local_14 = local_14 + 2;
      (*(code *)param_2)("Last Crank Event Time: %d",local_2a);
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_dc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_handle_notification_ex",0xa95);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_dc,"Wrong length:%d",*(undefined2 *)(param_1 + 0x54));
      }
    }
  }
  return;
}



void FUN_000470ee(int param_1)

{
  FUN_0004710c(param_1,&LAB_0004708e_1);
  return;
}



void FUN_0004710c(int param_1,undefined *param_2)

{
  char cVar1;
  byte bVar2;
  ushort uVar3;
  
  switch(*(undefined2 *)(param_1 + 0x24)) {
  case 0x2a19:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_BATTERY_LEVEL");
    (*(code *)param_2)("Battery level %d percentage left",*(undefined *)(param_1 + 0x52));
    break;
  case 0x2a1d:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_TEMPERATURE_TYPE");
    cVar1 = *(char *)(param_1 + 0x52);
    if (cVar1 == '\x01') {
      (*(code *)param_2)("Location : Armpit");
    }
    else if (cVar1 == '\x02') {
      (*(code *)param_2)("Location : Body (general)");
    }
    else if (cVar1 == '\x03') {
      (*(code *)param_2)("Location : Ear (usually ear lobe)");
    }
    else if (cVar1 == '\x04') {
      (*(code *)param_2)("Location : Finger");
    }
    else if (cVar1 == '\x05') {
      (*(code *)param_2)("Location : Gastro-intestinal Tract");
    }
    else if (cVar1 == '\x06') {
      (*(code *)param_2)("Location : Mouth");
    }
    else if (cVar1 == '\a') {
      (*(code *)param_2)("Location : Rectum");
    }
    else if (cVar1 == '\b') {
      (*(code *)param_2)("Location : Toe");
    }
    else if (cVar1 == '\t') {
      (*(code *)param_2)("Location : Tympanum (ear drum)");
    }
    else {
      (*(code *)param_2)("Location : Reserved");
    }
    break;
  case 0x2a21:
    if (*(short *)(param_1 + 0x3c) == 0x2906) {
      (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_CHAR_VALID_RANGE");
      (*(code *)param_2)("Lower Range:%d, Upper Range:%d",
                         (ushort)*(byte *)(param_1 + 0x53) * 0x100 +
                         (ushort)*(byte *)(param_1 + 0x52),
                         (ushort)*(byte *)(param_1 + 0x55) * 0x100 +
                         (ushort)*(byte *)(param_1 + 0x54));
    }
    else {
      (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_TEMPERATURE_MEASUREMENT_INTERVAL");
      uVar3 = (ushort)*(byte *)(param_1 + 0x53) * 0x100 + (ushort)*(byte *)(param_1 + 0x52);
      (*(code *)param_2)("Measurement Interval Seconds:%d, Minutes:%d, Hours:%d",uVar3,uVar3 / 0x3c,
                         uVar3 / 0xe10);
    }
    break;
  case 0x2a23:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_SYSTEM_ID ");
    (*(code *)param_2)("Model Number : %02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X",
                       *(undefined *)(param_1 + 0x52),*(undefined *)(param_1 + 0x53),
                       *(undefined *)(param_1 + 0x54),*(undefined *)(param_1 + 0x55),
                       *(undefined *)(param_1 + 0x56),*(undefined *)(param_1 + 0x57),
                       *(undefined *)(param_1 + 0x58),*(undefined *)(param_1 + 0x59));
    break;
  case 0x2a24:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_MODEL_NUMBER_STR ");
    (*(code *)param_2)("Model Number : %s",param_1 + 0x52);
    break;
  case 0x2a25:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_SERIAL_NUMBER_STR ");
    (*(code *)param_2)("Model Number : %s",param_1 + 0x52);
    break;
  case 0x2a26:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_FW_VERSION_STR ");
    (*(code *)param_2)("Model Number : %s",param_1 + 0x52);
    break;
  case 0x2a27:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_HW_VERSION_STR ");
    (*(code *)param_2)("Model Number : %s",param_1 + 0x52);
    break;
  case 0x2a28:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_SW_VERSION_STR ");
    (*(code *)param_2)("Model Number : %s",param_1 + 0x52);
    break;
  case 0x2a29:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_MANU_NAME");
    (*(code *)param_2)("Manufacturer name : %s",param_1 + 0x52);
    break;
  case 0x2a49:
    (*(code *)param_2)("char_id: BSA_BLE_GATT_UUID_BLOOD_PRESSURE_FEATURE");
    bVar2 = *(byte *)(param_1 + 0x52);
    if ((bVar2 & 1) != 0) {
      (*(code *)param_2)("Body Movement Detection feature supported!");
    }
    if ((bVar2 & 2) != 0) {
      (*(code *)param_2)("Cuff Fit Detection feature supported!");
    }
    if ((bVar2 & 4) != 0) {
      (*(code *)param_2)("Irregular Pulse Detection feature supported!");
    }
    if ((bVar2 & 8) != 0) {
      (*(code *)param_2)("Pulse Rate Range Detection feature supported!");
    }
    if ((bVar2 & 0x10) != 0) {
      (*(code *)param_2)("Measurement Position Detection feature supported!");
    }
    if ((bVar2 & 0x20) != 0) {
      (*(code *)param_2)("Multiple Bonds supported!");
    }
    break;
  case 0x2a54:
    (*(code *)param_2)("char_id:BSA_BLE_GATT_UUID_RSC_FEATURE");
    bVar2 = *(byte *)(param_1 + 0x52);
    if ((bVar2 & 1) != 0) {
      (*(code *)param_2)("Instantaneous Stride Length Measurement Supported!");
    }
    if ((bVar2 & 2) != 0) {
      (*(code *)param_2)("Walking or Running Status Supported!");
    }
    if ((bVar2 & 4) != 0) {
      (*(code *)param_2)("Calibration Procedure Supported!");
    }
    if ((bVar2 & 8) != 0) {
      (*(code *)param_2)("Multiple Sensor Locations Supported!");
    }
    break;
  case 0x2a5c:
    (*(code *)param_2)("char_id:BSA_BLE_GATT_UUID_CSC_FEATURE");
    bVar2 = *(byte *)(param_1 + 0x52);
    if ((bVar2 & 1) != 0) {
      (*(code *)param_2)("Wheel Revolution Data Supported!");
    }
    if ((bVar2 & 2) != 0) {
      (*(code *)param_2)("Crank Revolution Data Supported!");
    }
    if ((bVar2 & 4) != 0) {
      (*(code *)param_2)("Multiple Sensor Location Supported!");
    }
    break;
  case 0x2a5d:
    (*(code *)param_2)("char_id:BSA_BLE_GATT_UUID_SENSOR_LOCATION");
    cVar1 = *(char *)(param_1 + 0x52);
    if (cVar1 == '\0') {
      (*(code *)param_2)("Location : Other");
    }
    else if (cVar1 == '\x01') {
      (*(code *)param_2)("Location : Top of Shoe");
    }
    else if (cVar1 == '\x02') {
      (*(code *)param_2)("Location : In Shoe");
    }
    else if (cVar1 == '\x03') {
      (*(code *)param_2)("Location : Hip");
    }
    else if (cVar1 == '\x04') {
      (*(code *)param_2)("Location : Front Wheel");
    }
    else if (cVar1 == '\x05') {
      (*(code *)param_2)("Location : Left Crank");
    }
    else if (cVar1 == '\x06') {
      (*(code *)param_2)("Location : Right Crank");
    }
    else if (cVar1 == '\a') {
      (*(code *)param_2)("Location : Left Pedal");
    }
    else if (cVar1 == '\b') {
      (*(code *)param_2)("Location : Right Pedal");
    }
    else if (cVar1 == '\t') {
      (*(code *)param_2)("Location : Front Hub");
    }
    else if (cVar1 == '\n') {
      (*(code *)param_2)("Location : Real Dropout");
    }
    else if (cVar1 == '\v') {
      (*(code *)param_2)("Location : Chainstay");
    }
    else if (cVar1 == '\f') {
      (*(code *)param_2)("Location : Real Wheel");
    }
    else if (cVar1 == '\r') {
      (*(code *)param_2)("Location : Real Hub");
    }
    else if (cVar1 == '\x0e') {
      (*(code *)param_2)("Location : Chest");
    }
    else {
      (*(code *)param_2)("Location : Reserved");
    }
  }
  return;
}



undefined4 FUN_00047818(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_battery_level",0xc6e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_battery_level",0xc74);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_battery_level : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180f;
    local_10 = 0x2a19;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_battery_level",0xc7e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_battery_level",0xc90);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000479f0(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_mfr_name",0xca9);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_mfr_name",0xcaf);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_mfr_name : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a29;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_mfr_name",0xcb9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_mfr_name",0xccb);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00047bc8(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_model_number",0xce3);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_model_number",0xce9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_model_number : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a24;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_model_number",0xcf3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_model_number",0xd05);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00047da0(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_serial_number",0xd1d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_serial_number",0xd23);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_serial_number : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a25;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_serial_number",0xd2d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_serial_number",0xd3f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00047f78(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_hardware_revision",0xd58);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_hardware_revision",0xd5e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_hardware_revision : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a27;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_hardware_revision",0xd68);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_hardware_revision",0xd7a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00048150(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_firmware_revision",0xd93);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_firmware_revision",0xd99);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_firmware_revision : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a26;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_firmware_revision",0xda3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_firmware_revision",0xdb5);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00048328(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_software_revision",0xdce);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_software_revision",0xdd4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_software_revision : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a28;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_software_revision",0xdde);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_software_revision",0xdf0);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00048500(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_11c [128];
  undefined2 local_9c [2];
  undefined2 local_98;
  undefined2 local_94;
  undefined local_84;
  undefined local_80;
  undefined2 local_7c;
  undefined2 local_78;
  undefined local_68;
  undefined local_18;
  undefined local_17;
  short local_12;
  undefined2 local_10;
  undefined2 local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_11c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                            ,"app_ble_client_read_system_id",0xe08);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_11c,"Select Client:");
  }
  FUN_0003fd22(0);
  local_c = FUN_0002f22c("Select");
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                              ,"app_ble_client_read_system_id",0xe0e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_11c,
                     "app_ble_client_read_system_id : Invalid client number entered");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_e = 0x180a;
    local_10 = 0x2a23;
    local_12 = BSA_BleClReadInit(local_9c);
    if (local_12 != 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_system_id",0xe18);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
    }
    local_17 = 0;
    local_84 = 0;
    local_94 = local_e;
    local_98 = 2;
    local_80 = 1;
    local_68 = 0;
    local_78 = local_10;
    local_7c = 2;
    local_9c[0] = *(undefined2 *)(&DAT_0008ac02 + local_c * 0x24);
    local_18 = 0;
    local_12 = BSA_BleClRead(local_9c);
    if (local_12 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_11c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client.c"
                                ,"app_ble_client_read_system_id",0xe2a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_11c,"app_ble_client_read failed status = %d",local_12);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_000486d8(void)

{
  memset(&DAT_0008c258,0,4);
  FUN_000486fa();
  FUN_00048718();
  return 0;
}



undefined4 FUN_000486fa(void)

{
  undefined4 uVar1;
  
  FUN_00048732();
  uVar1 = FUN_0003d918(DAT_0008c258);
  return uVar1;
}



undefined4 FUN_00048718(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_0003dcda(DAT_0008c258);
  return uVar1;
}



void FUN_00048732(void)

{
  void **ppvVar1;
  void **local_c;
  
  local_c = DAT_0008c258;
  DAT_0008c258 = (void **)0x0;
  while (local_c != (void **)0x0) {
    ppvVar1 = (void **)local_c[3];
    FUN_00048940(local_c);
    local_c = ppvVar1;
  }
  return;
}



void FUN_00048770(undefined4 param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  void **local_10;
  void **local_c;
  
  local_10 = (void **)0x0;
  local_c = DAT_0008c258;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_db.c"
                            ,"app_ble_client_db_clear_by_bda",0x91);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"app_ble_client_db_clear_by_bda p_element");
  }
  while ((local_c != (void **)0x0 && (iVar1 = bdcmp(param_1,local_c + 1), iVar1 != 0))) {
    local_10 = local_c;
    local_c = (void **)local_c[3];
  }
  if (local_c == (void **)0x0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_db.c"
                              ,"app_ble_client_db_clear_by_bda",0x9e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Device not found");
    }
  }
  else {
    if (local_10 == (void **)0x0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_db.c"
                                ,"app_ble_client_db_clear_by_bda",0xa3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"Need to remove first item in DB");
      }
      DAT_0008c258 = (void **)local_c[3];
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_db.c"
                                ,"app_ble_client_db_clear_by_bda",0xa8);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"Delete the element");
      }
      local_10[3] = local_c[3];
    }
    FUN_00048940(local_c);
  }
  return;
}



undefined4 * FUN_00048910(void)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)calloc(1,0x10);
  *puVar1 = 0;
  *(undefined2 *)((int)puVar1 + 10) = 0xffff;
  puVar1[3] = 0;
  return puVar1;
}



void FUN_00048940(void **param_1)

{
  void *pvVar1;
  void *local_c;
  
  if (*param_1 != (void *)0x0) {
    local_c = *param_1;
    while (local_c != (void *)0x0) {
      pvVar1 = *(void **)((int)local_c + 0x1c);
      FUN_0004897c(local_c);
      local_c = pvVar1;
    }
  }
  free(param_1);
  return;
}



void FUN_0004897c(void *param_1)

{
  free(param_1);
  return;
}



void FUN_00048992(int param_1)

{
  int iVar1;
  undefined auStack_98 [132];
  
  *(int *)(param_1 + 0xc) = DAT_0008c258;
  DAT_0008c258 = param_1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_ble/source/app_ble_client_db.c"
                            ,"app_ble_client_db_add_element",0x109);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_98,
                   "added ele on db BDA:%02X:%02X:%02X:%02X:%02X:%02X, client_if= %d ",
                   *(undefined *)(DAT_0008c258 + 4),*(undefined *)(DAT_0008c258 + 5),
                   *(undefined *)(DAT_0008c258 + 6),*(undefined *)(DAT_0008c258 + 7),
                   *(undefined *)(DAT_0008c258 + 8),*(undefined *)(DAT_0008c258 + 9),
                   *(undefined2 *)(DAT_0008c258 + 10));
  }
  return;
}



int FUN_00048a6e(undefined4 param_1)

{
  int iVar1;
  int local_c;
  
  local_c = DAT_0008c258;
  while( true ) {
    if (local_c == 0) {
      return 0;
    }
    iVar1 = bdcmp(param_1,local_c + 4);
    if (iVar1 == 0) break;
    local_c = *(int *)(local_c + 0xc);
  }
  return local_c;
}



int FUN_00048ab0(int *param_1,short param_2)

{
  int local_c;
  
  local_c = *param_1;
  while( true ) {
    if (local_c == 0) {
      return 0;
    }
    if (param_2 == *(short *)(local_c + 0x14)) break;
    local_c = *(int *)(local_c + 0x1c);
  }
  return local_c;
}



void * FUN_00048aec(void **param_1)

{
  void *pvVar1;
  void *local_10;
  int local_c;
  
  local_10 = *param_1;
  if (local_10 == (void *)0x0) {
    pvVar1 = malloc(0x20);
    *(undefined4 *)((int)pvVar1 + 0x1c) = 0;
    *param_1 = pvVar1;
  }
  else {
    for (local_c = *(int *)((int)local_10 + 0x1c); local_c != 0; local_c = *(int *)(local_c + 0x1c))
    {
      local_10 = *(void **)((int)local_10 + 0x1c);
    }
    pvVar1 = malloc(0x20);
    *(void **)((int)local_10 + 0x1c) = pvVar1;
    *(undefined4 *)((int)pvVar1 + 0x1c) = 0;
  }
  return pvVar1;
}



void FUN_00048b58(void)

{
  puts("\nBluetooth HID Host menu:");
  printf("    %d => Discovery Abort\n",1);
  printf("    %d => COD Discovery (Peripheral Dev)\n",2);
  printf("    %d => COD Discovery (3DSG Dev)\n",3);
  printf("    %d => BLE Discovery\n",4);
  printf("    %d => BLE Discovery, Skip name request\n",5);
  printf("    %d => Limited Discovery (LIAC)\n",6);
  printf("    %d => HID Connect (Report mode)\n",7);
  printf("    %d => HID Connect (Boot mode)\n",8);
  printf("    %d => HID Disconnect\n",9);
  printf("    %d => HID Get DSCP Info\n",10);
  printf("    %d => HID Set Report (num lock)\n",0xb);
  printf("    %d => HID Get Report \n",0xc);
  printf("    %d => Send HID Control\n",0xd);
  printf("    %d => Send Set report to control channel\n",0xe);
  printf("    %d => Send Set report to interrupt channel\n",0xf);
  printf("    %d => Send Virtual Cable Unplug\n",0x10);
  printf("    %d => HID Set UCD/BRR mode (Old remotes)\n",0x11);
  printf("    %d => HID Configure UCD mode (New remotes)\n",0x12);
  printf("    %d => HID Start 3DSG mode\n",0x13);
  printf("    %d => HID Stop 3DSG mode\n",0x14);
  printf("    %d => HID Remove Device\n",0x15);
  printf("    %d => Enable Multicast Individual Poll\n",0x16);
  printf("    %d => Disable Multicast Individual Poll\n",0x17);
  printf("    %d => HID Set Protocol \n",0x18);
  printf("    %d => HID Get Protocol \n",0x19);
  printf("    %d => HID Set Idle \n",0x1a);
  printf("    %d => HID Get Idle \n",0x1b);
  printf("    %d => HID Set Priority for Audio\n",0x1c);
  printf("    %d => Quit\n",99);
  return;
}



void FUN_00048d18(void)

{
  FUN_0004db84();
  FUN_0004ea78(&LAB_00048d02_1);
  FUN_0004b788();
  return;
}



void FUN_00048d34(void)

{
  FUN_0004dbf2();
  return;
}



int FUN_00048d40(void)

{
  int iVar1;
  int *piVar2;
  undefined auStack_8c [128];
  int local_c;
  
  local_c = open("/dev/bthid",2);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_bthid.c"
                              ,"app_bthid_open",0x41);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_8c,"Failed to open %s : %d","/dev/bthid",*piVar2);
    }
    local_c = -1;
  }
  return local_c;
}



int FUN_00048dc2(int param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  int local_c;
  
  if (param_1 < 1) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_bthid.c"
                              ,"app_bthid_close",0x5f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"NULL bthid file descriptor");
    }
    local_c = -1;
  }
  else {
    local_c = close(param_1);
  }
  return local_c;
}



ssize_t FUN_00048e30(int param_1,void *param_2,size_t param_3)

{
  int iVar1;
  int *piVar2;
  undefined auStack_8c [128];
  ssize_t local_c;
  
  local_c = write(param_1,param_2,param_3);
  if (local_c < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_bthid.c"
                              ,"app_bthid_report_write",0x83);
    if (iVar1 != 0) {
      piVar2 = __errno_location();
      duss_log_print(0x5c,1,auStack_8c,"unable to write HID report:%d",*piVar2);
    }
  }
  return local_c;
}



int FUN_00048eaa(int param_1,char *param_2,undefined2 param_3,undefined2 param_4,undefined2 param_5,
                undefined2 param_6)

{
  char local_98 [127];
  undefined local_19;
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined2 local_12;
  int local_10;
  char *local_c;
  
  local_c = local_98;
  local_10 = ioctl(param_1,0x80887503,local_c);
  if (-1 < local_10) {
    if (param_2 == (char *)0x0) {
      local_98[0] = '\0';
    }
    else {
      strncpy(local_98,param_2,0x80);
      local_19 = 0;
    }
    local_14 = param_5;
    local_12 = param_6;
    local_18 = param_3;
    local_16 = param_4;
    local_10 = ioctl(param_1,0x40887502,local_c);
    if (-1 < local_10) {
      local_10 = ioctl(param_1,0x80887503,local_c);
    }
  }
  return local_10;
}



int FUN_00048f7c(int param_1,void *param_2,uint param_3)

{
  int iVar1;
  undefined auStack_3b4 [128];
  uint local_334;
  undefined auStack_330 [804];
  uint *local_c;
  
  if (((param_2 == (void *)0x0) || (800 < param_3)) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_3b4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_bthid.c"
                                ,"app_bthid_desc_write",0xdc), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_3b4,"bad parameter");
  }
  local_334 = param_3;
  memcpy(auStack_330,param_2,param_3);
  local_c = &local_334;
  iVar1 = ioctl(param_1,0x43247501,local_c);
  return iVar1;
}



undefined4 FUN_0004904c(void)

{
  return 0;
}



undefined4 FUN_0004905c(int *param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_bc [128];
  char *local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined *local_28;
  undefined **local_24;
  uint local_20;
  size_t local_1c;
  int local_18;
  char local_11;
  char *local_10;
  size_t local_c;
  
  local_3c = (char *)0x0;
  local_11 = '\0';
  if (*param_1 == 0) {
    local_18 = open("/tmp/EMMC/wireless/bluetooth/./bt_hh_devices.xml",0);
    if (local_18 < 0) {
      local_11 = '\x01';
    }
    else {
      local_c = FUN_0002f63a(local_18);
      if (local_c == 0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                  ,"app_hh_xml_read",0x83);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"file: %s is empty",
                         "/tmp/EMMC/wireless/bluetooth/./bt_hh_devices.xml");
        }
        close(local_18);
        local_11 = '\x01';
      }
      else if ((int)local_c < 0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                  ,"app_hh_xml_read",0x89);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"cannot get file size of:%s",
                         "/tmp/EMMC/wireless/bluetooth/./bt_hh_devices.xml");
        }
        close(local_18);
        local_11 = '\x01';
      }
      if (local_11 == '\0') {
        local_10 = (char *)malloc(local_c + 1);
        if (local_10 == (char *)0x0) {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                    ,"app_hh_xml_read",0x93);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_bc,"cannot alloc:%d bytes",local_c);
          }
          close(local_18);
          local_11 = '\x01';
        }
      }
      if (local_11 == '\0') {
        local_1c = read(local_18,local_10,local_c);
        local_10[local_c] = '\0';
        close(local_18);
        if (local_1c != local_c) {
          free(local_10);
          iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                    ,"app_hh_xml_read",0xa5);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_bc,"not able to read complete file:%d/%d",local_1c,local_c
                          );
          }
          local_11 = '\x01';
        }
      }
    }
    if (local_11 == '\0') {
      local_38 = 0x496ad;
      local_28 = &LAB_000498fa_1;
      local_34 = 0x49913;
      local_30 = 0x49983;
      local_2c = 0x49c5b;
      bVar1 = FUN_0002fa16(&local_24,&local_38);
      local_20 = (uint)bVar1;
      if (local_20 == 0) {
        free(local_10);
        iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                  ,"app_hh_xml_read",0xbd);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_bc,"cannot open Nanoxml :%d",local_20);
        }
        local_11 = '\x01';
      }
      if (local_11 == '\0') {
        DAT_0008c260 = param_1;
        local_20 = FUN_0002fb2c(local_24,local_10,local_c,&local_3c);
        if (local_20 != 1) {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                    ,"app_hh_xml_read",0xc9);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_bc,"xmlWrite returns :%d",local_20);
          }
          local_11 = '\x01';
        }
        FUN_0002fa7e(local_24);
        free(local_10);
      }
    }
    if ((local_11 == '\0') || (iVar2 = FUN_00049476((undefined4 *)*param_1), -1 < iVar2)) {
      uVar3 = 0;
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_read",0xd8);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_bc,"Unable to create an empty HL database");
      }
      uVar3 = 0xffffffff;
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_bc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                              ,"app_hh_xml_read",0x78);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_bc,"chained list is not empty (%p != NULL)",*param_1);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_00049476(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int local_10;
  undefined4 *local_c;
  
  local_c = param_1;
  local_10 = open("/tmp/EMMC/wireless/bluetooth/./bt_hh_devices.xml",0x241,0x1b6);
  if (local_10 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                              ,"app_hh_xml_write",0xf3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"Error opening/creating %s file",
                     "/tmp/EMMC/wireless/bluetooth/./bt_hh_devices.xml");
    }
    uVar2 = 0xffffffff;
  }
  else {
    FUN_0002abc8(local_10,"Broadcom_Bluetooth_HID_Devices",'\x01');
    FUN_0002abc8(local_10,"hh_devices",'\x01');
    for (; local_c != (undefined4 *)0x0; local_c = (undefined4 *)*local_c) {
      FUN_0002abc8(local_10,"device",'\x01');
      FUN_0002abc8(local_10,"bd_addr",'\0');
      FUN_0002adf4(local_10,(int)(local_c + 1),6,'\0');
      FUN_0002ac68(local_10,"bd_addr",'\0');
      FUN_0002ad82(local_10,"ssr_max_latency",(uint)*(ushort *)((int)local_c + 10));
      FUN_0002ad82(local_10,"ssr_min_timeout",(uint)*(ushort *)(local_c + 3));
      FUN_0002ad82(local_10,"supervision_timeout",(uint)*(ushort *)((int)local_c + 0xe));
      FUN_0002abc8(local_10,"brr",'\x01');
      FUN_0002adf4(local_10,local_c[7],local_c[6],'\x01');
      FUN_0002ac68(local_10,"brr",'\x01');
      FUN_0002ad82(local_10,"sub_class",(uint)*(byte *)(local_c + 8));
      FUN_0002ad82(local_10,"attribute_mask",(uint)*(ushort *)((int)local_c + 0x22));
      FUN_0002abc8(local_10,"descriptor",'\x01');
      FUN_0002adf4(local_10,local_c[5],local_c[4],'\x01');
      FUN_0002ac68(local_10,"descriptor",'\x01');
      FUN_0002ac68(local_10,"device",'\x01');
    }
    FUN_0002ac68(local_10,"hh_devices",'\x01');
    FUN_0002ac68(local_10,"Broadcom_Bluetooth_HID_Devices",'\x01');
    close(local_10);
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_000496ac(undefined4 param_1,char *param_2)

{
  int iVar1;
  undefined auStack_8c [128];
  void **local_c;
  
  iVar1 = strncmp(param_2,"Broadcom_Bluetooth_HID_Devices",0x1e);
  if ((iVar1 != 0) && (iVar1 = strncmp(param_2,"hh_devices",10), iVar1 != 0)) {
    iVar1 = strncmp(param_2,"device",6);
    if (iVar1 == 0) {
      local_c = (void **)FUN_0004a418();
      if (local_c == (void **)0x0) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                  ,"app_hh_xml_tagBeginCallbackFunc",0x143);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"app_hh_db_alloc_element failed");
        }
      }
      else {
        *DAT_0008c260 = local_c;
        DAT_0008c25c = local_c;
        DAT_0008c260 = local_c;
      }
      DAT_0008c264 = 0;
    }
    else {
      iVar1 = strncmp(param_2,"bd_addr",7);
      if (iVar1 == 0) {
        DAT_0008c264 = 1;
      }
      else {
        iVar1 = strncmp(param_2,"ssr_max_latency",0xf);
        if (iVar1 == 0) {
          DAT_0008c264 = 2;
        }
        else {
          iVar1 = strncmp(param_2,"ssr_min_timeout",0xf);
          if (iVar1 == 0) {
            DAT_0008c264 = 3;
          }
          else {
            iVar1 = strncmp(param_2,"supervision_timeout",0x13);
            if (iVar1 == 0) {
              DAT_0008c264 = 4;
            }
            else {
              iVar1 = strncmp(param_2,"brr",3);
              if (iVar1 == 0) {
                DAT_0008c264 = 5;
              }
              else {
                iVar1 = strncmp(param_2,"descriptor",10);
                if (iVar1 == 0) {
                  DAT_0008c264 = 6;
                }
                else {
                  iVar1 = strncmp(param_2,"sub_class",3);
                  if (iVar1 == 0) {
                    DAT_0008c264 = 7;
                  }
                  else {
                    iVar1 = strncmp(param_2,"attribute_mask",3);
                    if (iVar1 == 0) {
                      DAT_0008c264 = 8;
                    }
                    else {
                      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                                ,"app_hh_xml_tagBeginCallbackFunc",0x172);
                      if (iVar1 != 0) {
                        duss_log_print(0x5c,1,auStack_8c,"Unknown Tag:%s",param_2);
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return;
}



void FUN_00049912(undefined4 param_1,char *param_2,size_t param_3)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = strncmp(param_2,"value",param_3);
  if (iVar1 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                              ,"app_hh_xml_attrBeginCallbackFunc",0x193);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"Unsupported attribute (%s)",param_2);
    }
  }
  return;
}



void FUN_00049982(undefined4 param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  ulong uVar2;
  undefined auStack_90 [132];
  
  if ((param_4 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1a6), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_90,"Non complete attribute value, probably malformed XML file: %s"
                   ,param_2);
  }
  iVar1 = DAT_0008c25c;
  switch(DAT_0008c264) {
  case 2:
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1b2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_SSR_MAX_LATENCY while no device instance");
      }
    }
    else {
      uVar2 = FUN_0002b280(param_2,param_3);
      *(short *)(iVar1 + 10) = (short)uVar2;
    }
    break;
  case 3:
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1bd);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_SSR_MIN_TIMEOUT while no device instance");
      }
    }
    else {
      uVar2 = FUN_0002b280(param_2,param_3);
      *(short *)(iVar1 + 0xc) = (short)uVar2;
    }
    break;
  case 4:
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1c8);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_SUPERVISION_TIMEOUT while no device instance");
      }
    }
    else {
      uVar2 = FUN_0002b280(param_2,param_3);
      *(short *)(iVar1 + 0xe) = (short)uVar2;
    }
    break;
  case 7:
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1d3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_SUPERVISION_TIMEOUT while no device instance");
      }
    }
    else {
      uVar2 = FUN_0002b280(param_2,param_3);
      *(char *)(iVar1 + 0x20) = (char)uVar2;
    }
    break;
  case 8:
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_attrValueCallbackFunc",0x1de);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_SUPERVISION_TIMEOUT while no device instance");
      }
    }
    else {
      uVar2 = FUN_0002b280(param_2,param_3);
      *(short *)(iVar1 + 0x22) = (short)uVar2;
    }
  }
  return;
}



void FUN_00049c5a(undefined4 param_1,int param_2,uint param_3,int param_4)

{
  int iVar1;
  void *pvVar2;
  undefined auStack_90 [132];
  
  if ((param_4 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_dataCallbackFunc",0x1f6), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_90,"Non complete data, probably malformed XML file: %s",param_2);
  }
  iVar1 = DAT_0008c25c;
  if (DAT_0008c264 == 5) {
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_dataCallbackFunc",0x211);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_BRR while no device instance");
      }
    }
    else {
      pvVar2 = FUN_0002ae98((size_t *)(DAT_0008c25c + 0x18),param_2,param_3);
      *(void **)(iVar1 + 0x1c) = pvVar2;
    }
  }
  else if (DAT_0008c264 == 6) {
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_dataCallbackFunc",0x21e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_DESCRIPTOR while no device instance");
      }
    }
    else {
      pvVar2 = FUN_0002ae98((size_t *)(DAT_0008c25c + 0x10),param_2,param_3);
      *(void **)(iVar1 + 0x14) = pvVar2;
    }
  }
  else if (DAT_0008c264 == 1) {
    if (DAT_0008c25c == 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_xml.c"
                                ,"app_hh_xml_dataCallbackFunc",0x204);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"HH_XML_TAG_BDADDR while no device instance");
      }
    }
    else {
      FUN_0002b1f8((void *)(DAT_0008c25c + 4),6,param_2,param_3);
    }
  }
  return;
}



undefined4 FUN_00049e3c(void)

{
  memset(&DAT_0008c268,0,4);
  FUN_0004904c();
  FUN_00049eac();
  FUN_0004a20c();
  return 0;
}



void FUN_00049e62(void)

{
  FUN_00049e6e();
  return;
}



void FUN_00049e6e(void)

{
  undefined4 *puVar1;
  undefined4 *local_c;
  
  local_c = DAT_0008c268;
  DAT_0008c268 = (undefined4 *)0x0;
  while (local_c != (undefined4 *)0x0) {
    puVar1 = (undefined4 *)*local_c;
    FUN_0004a44a(local_c);
    local_c = puVar1;
  }
  return;
}



undefined4 FUN_00049eac(void)

{
  undefined4 uVar1;
  
  FUN_00049e6e();
  uVar1 = FUN_0004905c(&DAT_0008c268);
  return uVar1;
}



void FUN_00049ec6(void)

{
  int iVar1;
  undefined auStack_9c [128];
  undefined4 *local_1c;
  
  local_1c = DAT_0008c268;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                            ,"app_hh_db_display",0x86);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"HH database:");
  }
  for (; local_1c != (undefined4 *)0x0; local_1c = (undefined4 *)*local_1c) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x8b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"  - device : %02X:%02X:%02X:%02X:%02X:%02X",
                     *(undefined *)(local_1c + 1),*(undefined *)((int)local_1c + 5),
                     *(undefined *)((int)local_1c + 6),*(undefined *)((int)local_1c + 7),
                     *(undefined *)(local_1c + 2),*(undefined *)((int)local_1c + 9));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x8d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"    + ssr_max_latency : %d",
                     *(undefined2 *)((int)local_1c + 10));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x8e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"    + ssr_min_tout : %d",*(undefined2 *)(local_1c + 3));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x8f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"    + supervision_tout : %d",
                     *(undefined2 *)((int)local_1c + 0xe));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x90);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"    + brr : size=%d buf=%p",local_1c[6],local_1c[7]);
    }
    if (local_1c[7] != 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                                ,"app_hh_db_display",0x92);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"    + brr : data = %02X:%02X...",*(undefined *)local_1c[7]
                       ,*(undefined *)(local_1c[7] + 1));
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_display",0x93);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_9c,"    + descriptor : size=%d buf=%p",local_1c[4],local_1c[5]);
    }
    if (local_1c[5] != 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                                ,"app_hh_db_display",0x96);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_9c,"    + descriptor : data = %02X:%02X...",
                       *(undefined *)local_1c[5],*(undefined *)(local_1c[5] + 1));
      }
    }
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_9c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                            ,"app_hh_db_display",0x9a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_9c,"HH database end");
  }
  return;
}



undefined4 FUN_0004a20c(void)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00049476(DAT_0008c268);
  return uVar1;
}



undefined4 * FUN_0004a226(undefined4 param_1)

{
  int iVar1;
  undefined auStack_8c [128];
  undefined4 *local_c;
  
  iVar1 = FUN_00049eac();
  if (iVar1 == 0) {
    for (local_c = DAT_0008c268; local_c != (undefined4 *)0x0; local_c = (undefined4 *)*local_c) {
      iVar1 = bdcmp(param_1,local_c + 1);
      if (iVar1 == 0) {
        return local_c;
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_find_by_bda",0xbf);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_hh_db_reload failed");
    }
  }
  return (undefined4 *)0x0;
}



undefined4 FUN_0004a2c2(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int **local_10;
  int **local_c;
  
  iVar1 = FUN_00049eac();
  if (iVar1 == 0) {
    local_c = (int **)&DAT_0008c268;
    while (*local_c != (int *)0x0) {
      iVar1 = bdcmp(param_1,*local_c + 1);
      if (iVar1 == 0) {
        local_10 = (int **)*local_c;
        *local_c = *local_10;
        FUN_0004a44a(local_10);
      }
      else {
        local_c = (int **)*local_c;
      }
    }
    FUN_0004a20c();
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_remove_by_bda",0xe1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"app_hh_db_reload failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004a380(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  int **local_10;
  int **local_c;
  
  iVar1 = FUN_00049eac();
  if (iVar1 == 0) {
    local_c = (int **)&DAT_0008c268;
    while (*local_c != (int *)0x0) {
      local_10 = (int **)*local_c;
      *local_c = *local_10;
      FUN_0004a44a(local_10);
    }
    FUN_0004a20c();
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh_db.c"
                              ,"app_hh_db_remove_db",0x10a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"app_hh_db_reload failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



void * FUN_0004a418(void)

{
  void *pvVar1;
  
  pvVar1 = calloc(1,0x24);
  *(undefined2 *)((int)pvVar1 + 10) = 0xffff;
  *(undefined2 *)((int)pvVar1 + 0xc) = 0xffff;
  *(undefined2 *)((int)pvVar1 + 0xe) = 0;
  return pvVar1;
}



void FUN_0004a44a(void *param_1)

{
  if (*(int *)((int)param_1 + 0x1c) != 0) {
    free(*(void **)((int)param_1 + 0x1c));
  }
  if (*(int *)((int)param_1 + 0x14) != 0) {
    free(*(void **)((int)param_1 + 0x14));
  }
  free(param_1);
  return;
}



void FUN_0004a484(undefined4 *param_1)

{
  *param_1 = DAT_0008c268;
  DAT_0008c268 = param_1;
  return;
}



undefined1 * FUN_0004a4b4(char param_1)

{
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (9 < local_c) {
      return (undefined1 *)0x0;
    }
    if ((((&DAT_0008c26d)[local_c * 9] & 1) != 0) && (param_1 == (&DAT_0008c274)[local_c * 9]))
    break;
    local_c = local_c + 1;
  }
  return &DAT_0008c26d + local_c * 9;
}



undefined1 * FUN_0004a52e(undefined4 param_1)

{
  int iVar1;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (9 < local_c) {
      return (undefined1 *)0x0;
    }
    if ((((&DAT_0008c26d)[local_c * 9] & 1) != 0) &&
       (iVar1 = bdcmp(param_1,&DAT_0008c26e + local_c * 9), iVar1 == 0)) break;
    local_c = local_c + 1;
  }
  return &DAT_0008c26d + local_c * 9;
}



undefined1 * FUN_0004a5a8(undefined4 param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  undefined1 *local_10;
  int local_c;
  
  local_c = 0;
  while( true ) {
    if (9 < local_c) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_pdev_alloc",0xfc);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"Failed allocating new HH element");
      }
      return (undefined1 *)0x0;
    }
    if (((&DAT_0008c26d)[local_c * 9] & 1) == 0) break;
    local_c = local_c + 1;
  }
  local_10 = &DAT_0008c26d + local_c * 9;
  *local_10 = 1;
  bdcpy(&DAT_0008c26e + local_c * 9,param_1);
  local_10[7] = 0xff;
  return local_10;
}



void FUN_0004a672(undefined4 param_1)

{
  char cVar1;
  
  if ((DAT_0008c2d0 != (code *)0x0) && (cVar1 = (*DAT_0008c2d0)(param_1), cVar1 != '\0')) {
    GKI_freebuf(param_1);
    return;
  }
  GKI_freebuf(param_1);
  return;
}



void FUN_0004a6bc(undefined4 param_1,short *param_2)

{
  int iVar1;
  void *pvVar2;
  char *pcVar3;
  undefined auStack_ac [128];
  undefined local_2c [4];
  char *local_28;
  undefined4 *local_24;
  byte *local_20;
  int local_1c;
  
  if ((DAT_0008c2cc == (code *)0x0) || (iVar1 = (*DAT_0008c2cc)(param_1,param_2), iVar1 == 0)) {
    switch(param_1) {
    case 0:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x343);
      if (iVar1 != 0) {
        if (*(char *)((int)param_2 + 0x13) == '\0') {
          pcVar3 = "Report";
        }
        else {
          pcVar3 = "Boot";
        }
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_OPEN_EVT: status:%d, handle:%d mode:%s (%d)",
                       *param_2,*(undefined *)(param_2 + 4),pcVar3,
                       *(undefined *)((int)param_2 + 0x13));
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x346);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BdAddr :%02X-%02X-%02X-%02X-%02X-%02X",
                       *(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3),
                       *(undefined *)(param_2 + 2),*(undefined *)((int)param_2 + 5),
                       *(undefined *)(param_2 + 3),*(undefined *)((int)param_2 + 7));
      }
      if (*param_2 == 0) {
        if (*(char *)(param_2 + 4) == DAT_0008c2c7) {
          DAT_0008c2c8 = DAT_0008c2c8 + '\x01';
          iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_cback",0x34d);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_ac,"%d 3DG MIP device connected",DAT_0008c2c8);
          }
        }
        else {
          local_20 = FUN_0004a4b4(*(char *)(param_2 + 4));
          if (local_20 == (byte *)0x0) {
            local_20 = FUN_0004a5a8(param_2 + 1);
            if (local_20 == (byte *)0x0) {
              iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                        ,"app_hh_cback",0x359);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_ac,"Failed allocating HH element");
              }
              BSA_HhCloseInit(local_2c);
              local_2c[0] = *(undefined *)(param_2 + 4);
              BSA_HhClose(local_2c);
              return;
            }
            FUN_0004a2c2(param_2 + 1);
            local_24 = (undefined4 *)FUN_0004a418();
            if (local_24 == (undefined4 *)0x0) {
              iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                        ,"app_hh_cback",0x36b);
              if (iVar1 != 0) {
                duss_log_print(0x5c,1,auStack_ac,"Failed allocating HH database element");
              }
              BSA_HhCloseInit(local_2c);
              local_2c[0] = *(undefined *)(param_2 + 4);
              BSA_HhClose(local_2c);
              return;
            }
            bdcpy(local_24 + 1,param_2 + 1);
            FUN_0004a484(local_24);
            local_24[6] = 9;
            pvVar2 = malloc(local_24[6]);
            local_24[7] = pvVar2;
            if (local_24[7] == 0) {
              local_24[6] = 0;
            }
            else {
              memcpy((void *)local_24[7],param_2 + 5,local_24[6]);
            }
            *(undefined *)(local_24 + 8) = *(undefined *)(param_2 + 10);
            *(short *)((int)local_24 + 0x22) = param_2[0xb];
            FUN_0004a20c();
            FUN_0004b9d8(*(char *)(param_2 + 4));
          }
          local_20[7] = *(byte *)(param_2 + 4);
          local_20[8] = *(byte *)(param_2 + 0xc);
          *local_20 = *local_20 | 2;
        }
      }
      break;
    case 2:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x443);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_MIP_START_EVT");
      }
      DAT_0008c2c7 = *(char *)param_2;
      break;
    case 3:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x448);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_MIP_STOP_EVT");
      }
      DAT_0008c2c7 = *(char *)param_2;
      break;
    case 4:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x415);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_GET_REPORT_EVT: status:%d handle:%d len:%d",
                       *param_2,*(undefined *)(param_2 + 1),param_2[2]);
      }
      if (param_2[2] != 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x419);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"Report ID: [%02x]",*(undefined *)(param_2 + 3));
        }
        scru_dump_hex((int)param_2 + 7,&DAT_0006dd90,param_2[2] + -1,0,5);
      }
      break;
    case 5:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x422);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_SET_REPORT_EVT: status:%d handle:%d",*param_2,
                       *(undefined *)(param_2 + 1));
      }
      break;
    case 6:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x428);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_GET_PROTO_EVT: status:%d handle:%d mode:%d",
                       *param_2,*(undefined *)(param_2 + 1),*(undefined *)((int)param_2 + 3));
      }
      if (*param_2 == 0) {
        FUN_0004c9aa(*(undefined *)(param_2 + 1),1);
      }
      break;
    case 7:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x435);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_SET_PROTO_EVT: status:%d, handle:%d",*param_2,
                       *(undefined *)(param_2 + 1));
      }
      break;
    case 8:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x43a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_GET_IDLE_EVT: status:%d, handle:%d, idle:%d",
                       *param_2,*(undefined *)(param_2 + 1),param_2[2]);
      }
      break;
    case 9:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x43f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_SET_IDLE_EVT: status:%d, handle:%d",*param_2,
                       *(undefined *)(param_2 + 1));
      }
      break;
    case 10:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x3b9);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_GET_DSCPINFO_EVT: status:%d handle:%d",*param_2,
                       *(undefined *)(param_2 + 1));
      }
      if (*param_2 == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3bf);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"DscpInfo: VID/PID (hex) = %04X/%04X",param_2[2],
                         param_2[3]);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3c0);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"DscpInfo: version = %d",param_2[4]);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3c3);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"DscpInfo: ssr_max_latency = %d ssr_min_tout = %d",
                         param_2[5],param_2[6]);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3c4);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"DscpInfo: supervision_tout = %d",param_2[7]);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3c5);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"DscpInfo (descriptor len:%d):",param_2[8]);
        }
        scru_dump_hex(param_2 + 9,0,param_2[8],0,5);
        local_20 = FUN_0004a4b4(*(char *)(param_2 + 1));
        if (local_20 != (undefined1 *)0x0) {
          iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_cback",0x3cd);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_ac,"Update Remote Device XML file");
          }
          FUN_0002a97e();
          FUN_0002eaec(0x896e8,10,local_20 + 1,param_2[3],param_2[2]);
          FUN_0002eb94(0x896e8,10,local_20 + 1,param_2[4]);
          FUN_0002aa0a();
          local_24 = FUN_0004a226(local_20 + 1);
          if (local_24 == (undefined4 *)0x0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                      ,"app_hh_cback",0x409);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_ac,
                             "BSA_HH_GET_DSCPINFO_EVT: app_hh_db_find_by_bda failed");
            }
            BSA_HhCloseInit(local_2c);
            local_2c[0] = *(undefined *)(param_2 + 1);
            BSA_HhClose(local_2c);
          }
          else {
            if (local_24[5] != 0) {
              free((void *)local_24[5]);
              local_24[5] = 0;
            }
            *(short *)((int)local_24 + 10) = param_2[5];
            *(short *)(local_24 + 3) = param_2[6];
            *(short *)((int)local_24 + 0xe) = param_2[7];
            local_24[4] = (uint)(ushort)param_2[8];
            if (local_24[4] != 0) {
              pvVar2 = malloc(local_24[4]);
              local_24[5] = pvVar2;
              if (local_24[5] == 0) {
                local_24[4] = 0;
              }
              else {
                memcpy((void *)local_24[5],param_2 + 9,local_24[4]);
              }
            }
            FUN_0004a20c();
            for (local_1c = 0; local_1c < 10; local_1c = local_1c + 1) {
              local_28 = &DAT_000896e8 + local_1c * 0x1b0;
              if ((*local_28 != '\0') &&
                 (iVar1 = bdcmp(&DAT_000896e9 + local_1c * 0x1b0,local_24 + 1), iVar1 == 0)) {
                iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                          "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                          ,"app_hh_cback",0x401);
                if (iVar1 != 0) {
                  duss_log_print(0x5c,3,auStack_ac,"Adding HID Device:%s",local_28 + 7);
                }
                FUN_0004b3b4((int)local_28);
                return;
              }
            }
          }
        }
      }
      break;
    case 0xb:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x394);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,
                       "BSA_HH_VC_UNPLUG_EVT is handled like a close event, redirecting");
      }
    case 1:
      iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x398);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_ac,"BSA_HH_CLOSE_EVT: status:%d  handle:%d",*param_2,
                       *(undefined *)(param_2 + 1));
      }
      if (*(char *)(param_2 + 1) == DAT_0008c2c7) {
        if (DAT_0008c2c8 != '\0') {
          DAT_0008c2c8 = DAT_0008c2c8 + -1;
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_ac,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_cback",0x3a0);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_ac,"%d 3DG MIP device connected",DAT_0008c2c8);
        }
      }
      else {
        local_20 = FUN_0004a4b4(*(char *)(param_2 + 1));
        if (local_20 != (byte *)0x0) {
          *local_20 = *local_20 & 0xfd;
        }
        FUN_0004e06a();
      }
      break;
    default:
      iVar1 = duss_log_gen_head(0x5c,1,auStack_ac,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_cback",0x44d);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_ac,"bad event:%d",param_1);
      }
    }
  }
  return;
}



undefined * FUN_0004b3b4(int param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  char *pcVar5;
  undefined auStack_3f8 [128];
  undefined auStack_378 [6];
  ushort local_372;
  undefined local_370;
  undefined2 local_36e;
  undefined2 local_36c;
  undefined2 local_36a;
  undefined2 local_368;
  undefined2 local_366;
  undefined2 local_364;
  undefined2 local_358;
  undefined auStack_356 [801];
  undefined local_35;
  undefined auStack_30 [4];
  short local_2c;
  byte local_2a;
  byte local_29;
  int local_28;
  undefined4 *local_24;
  byte *local_20;
  undefined1 *local_1c;
  
  local_20 = auStack_30;
  local_24 = FUN_0004a226(param_1 + 1);
  if (local_24 == (undefined4 *)0x0) {
    iVar4 = duss_log_gen_head(0x5c,1,auStack_3f8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_add_dev",0x470);
    if (iVar4 != 0) {
      duss_log_print(0x5c,1,auStack_3f8,"Trying to add an HH device that is not in the HH database")
      ;
    }
    local_1c = (undefined *)0x0;
  }
  else {
    local_1c = FUN_0004a52e(param_1 + 1);
    if ((local_1c == (undefined1 *)0x0) &&
       (local_1c = FUN_0004a5a8(param_1 + 1), local_1c == (undefined1 *)0x0)) {
      local_1c = (undefined *)0x0;
    }
    else {
      BSA_HhAddDevInit(auStack_378);
      bdcpy(auStack_378,local_24 + 1);
      local_370 = *(undefined *)(local_24 + 8);
      local_368 = *(undefined2 *)((int)local_24 + 10);
      local_366 = *(undefined2 *)(local_24 + 3);
      local_364 = *(undefined2 *)((int)local_24 + 0xe);
      local_372 = *(ushort *)((int)local_24 + 0x22) | 0x40;
      local_36e = *(undefined2 *)(param_1 + 0x124);
      local_36c = *(undefined2 *)(param_1 + 0x122);
      local_36a = *(undefined2 *)(param_1 + 0x126);
      if (((local_24[4] != 0) && ((uint)local_24[4] < 0x321)) && (local_24[5] != 0)) {
        local_358 = (undefined2)local_24[4];
        memcpy(auStack_356,(void *)local_24[5],local_24[4]);
      }
      if (DAT_0008c2d4 != (code *)0x0) {
        (*DAT_0008c2d4)(auStack_378,param_1);
      }
      local_28 = BSA_HhAddDev(auStack_378);
      if (local_28 == 0) {
        local_1c[7] = local_35;
        *(uint *)(param_1 + 0x108) = *(uint *)(param_1 + 0x108) | 0x40000;
        FUN_0002aa0a();
        iVar4 = duss_log_gen_head(0x5c,3,auStack_3f8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_add_dev",0x4b5);
        if (iVar4 != 0) {
          duss_log_print(0x5c,3,auStack_3f8,"Services = x%x",*(undefined4 *)(param_1 + 0x108));
        }
        local_20 = (byte *)(param_1 + 0x100);
        local_29 = *(byte *)(param_1 + 0x102) & 0xfc;
        local_2a = *(byte *)(param_1 + 0x101) & 0x1f;
        iVar4 = duss_log_gen_head(0x5c,3,auStack_3f8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_add_dev",0x4bb);
        if (iVar4 != 0) {
          bVar1 = *local_20;
          bVar2 = local_20[1];
          bVar3 = local_20[2];
          pcVar5 = FUN_0002f16c((int)local_20);
          duss_log_print(0x5c,3,auStack_3f8,"COD:%02X-%02X-%02X => %s",bVar1,bVar2,bVar3,pcVar5);
        }
        if ((local_2a == 5) && ((local_29 & 0x3f) == 0xc)) {
          local_2c = (ushort)*local_20 * 0x100 + (local_20[1] & 0xe0);
          iVar4 = duss_log_gen_head(0x5c,3,auStack_3f8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_add_dev",0x4c2);
          if (iVar4 != 0) {
            duss_log_print(0x5c,3,auStack_3f8,"This device is a RemoteControl");
          }
        }
      }
      else {
        iVar4 = duss_log_gen_head(0x5c,1,auStack_3f8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_add_dev",0x4a7);
        if (iVar4 != 0) {
          duss_log_print(0x5c,1,auStack_3f8,"Unable to add HID device:%d",local_28);
        }
        FUN_0004a2c2(param_1 + 1);
        *local_1c = 0;
        *(uint *)(param_1 + 0x108) = *(uint *)(param_1 + 0x108) & 0xfffbffff;
        FUN_0002aa0a();
        local_1c = (undefined *)0x0;
      }
    }
  }
  return local_1c;
}



undefined4 FUN_0004b788(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_b0 [128];
  undefined local_30 [4];
  undefined4 local_2c;
  undefined local_28;
  char *local_24;
  int local_20;
  int local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_start",0x507);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b0,"app_hh_start");
  }
  BSA_HhEnableInit(local_30);
  local_30[0] = 0;
  DAT_0008c2c9 = 0;
  local_2c = 0x4a6bd;
  local_20 = BSA_HhEnable(local_30);
  if (local_20 == 0) {
    DAT_0008c26c = local_28;
    UIPC_Open(local_28,0x4a673);
    for (local_1c = 0; local_1c < 10; local_1c = local_1c + 1) {
      (&DAT_0008c26d)[local_1c * 9] = 0;
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_start",0x523);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_b0,"Add all HID devices found in database (if any)");
    }
    FUN_0002a97e();
    for (local_1c = 0; local_1c < 10; local_1c = local_1c + 1) {
      local_24 = &DAT_000896e8 + local_1c * 0x1b0;
      if ((*local_24 != '\0') && ((*(uint *)(&DAT_000897f0 + local_1c * 0x1b0) & 0x40000) != 0)) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_start",0x52e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b0,
                         "Adding HID Device:%s BdAddr:%02X:%02X:%02X:%02X:%02X:%02X",local_24 + 7,
                         local_24[1],local_24[2],local_24[3],local_24[4],local_24[5],local_24[6]);
        }
        FUN_0004b3b4((int)local_24);
      }
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_start",0x512);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b0,"Unable to enable HID Host status:%d",local_20);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004b9d8(char param_1)

{
  int iVar1;
  undefined4 uVar2;
  char local_91;
  undefined auStack_90 [128];
  undefined local_10;
  char local_f;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_get_dscpinfo",0x545);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"Get HID DSCP Info");
  }
  local_91 = param_1;
  if (param_1 == -1) {
    iVar1 = FUN_0004e06a();
    if (iVar1 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_get_dscpinfo",0x54b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_90,"No HID devices");
      }
      return 0xffffffff;
    }
    iVar1 = FUN_0002f22c("Enter HID handle");
    local_91 = (char)iVar1;
  }
  BSA_HhGetInit(&local_10);
  local_10 = 4;
  local_f = local_91;
  local_c = BSA_HhGet(&local_10);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_get_dscpinfo",0x556);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_HhGet: Unable to get DSCP Info status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004bb12(undefined param_1,int param_2)

{
  int iVar1;
  undefined auStack_b8 [128];
  byte local_38;
  undefined local_37;
  undefined local_36;
  undefined auStack_34 [6];
  undefined local_2e;
  byte local_2d;
  undefined auStack_28 [6];
  short local_22;
  undefined4 local_20;
  int local_1c;
  uint local_18;
  char *local_14;
  char local_d;
  int local_c;
  
  local_20 = 0xffffffff;
  local_d = '\0';
  if (param_2 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_connect",0x576);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_b8,"Bluetooth HID connect menu:");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_connect",0x577);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_b8,"    0 Device from XML database (already paired)");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_connect",0x578);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_b8,"    1 Device found in last discovery");
    }
    local_c = FUN_0002f22c("Select source");
  }
  else {
    local_c = 1;
  }
  if (local_c == 0) {
    FUN_0002a97e();
    FUN_0002e882(0x896e8,10);
    local_c = FUN_0002f22c("Select device");
    if (((-1 < local_c) && (local_c < 10)) && ((&DAT_000896e8)[local_c * 0x1b0] != '\0')) {
      bdcpy(auStack_28,&DAT_000896e9 + local_c * 0x1b0);
      local_14 = (char *)(local_c * 0x1b0 + 0x896ef);
      local_38 = (&DAT_000897e8)[local_c * 0x1b0];
      local_37 = (&DAT_000897e9)[local_c * 0x1b0];
      local_36 = (&DAT_000897ea)[local_c * 0x1b0];
      local_d = '\x01';
    }
  }
  else {
    if (local_c != 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5af);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_b8,"Bad choice [XML(0) or Disc(1) only]");
      }
      return 0xffffffff;
    }
    if (param_2 == 0) {
      FUN_00023ce4();
      local_c = FUN_0002f22c("Select device");
    }
    else {
      local_c = FUN_00026f52(param_2);
    }
    if (((-1 < local_c) && (local_c < 0x14)) && ((&DAT_00086d50)[local_c * 0x210] != '\0')) {
      bdcpy(auStack_28,&DAT_00086d54 + local_c * 0x210);
      local_14 = (char *)(local_c * 0x210 + 0x86d5d);
      local_38 = (&DAT_00086d5a)[local_c * 0x210];
      local_37 = (&DAT_00086d5b)[local_c * 0x210];
      local_36 = (&DAT_00086d5c)[local_c * 0x210];
      local_d = '\x01';
    }
  }
  if (local_d == '\0') {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_connect",0x5b5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"Bad Device index:%d",local_c);
    }
    local_20 = 0xffffffff;
  }
  else {
    BSA_HhOpenInit(auStack_34);
    bdcpy(auStack_34,auStack_28);
    local_2e = param_1;
    if (param_2 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5bf);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"Security?");
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5c0);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"   NONE: 0");
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5c1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"   Authentication: 1");
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5c2);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"   Encryption+Authentication: 3");
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5c3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"   Authorization: 4");
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5c4);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"   Encryption+Authentication+Authorization: 7");
      }
      local_18 = FUN_0002f22c("Enter Security mask");
    }
    else {
      local_18 = 7;
    }
    if ((local_18 & 0xfffffff8) == 0) {
      local_2d = 0;
      if ((local_18 & 1) != 0) {
        local_2d = 0x12;
      }
      if ((local_18 & 2) != 0) {
        local_2d = local_2d | 0x24;
      }
      if ((local_18 & 4) != 0) {
        local_2d = local_2d | 1;
      }
      DAT_0008c2ca = local_2d;
      local_22 = BSA_HhOpen(auStack_34);
      if (local_22 == 0) {
        iVar1 = FUN_0002a97e();
        if (iVar1 < 0) {
          FUN_0004a380();
        }
        FUN_0002e708(0x896e8,10,auStack_28,local_14);
        FUN_0002e7b2(0x896e8,10,auStack_28,&local_38);
        for (local_1c = 0; local_1c < 0x14; local_1c = local_1c + 1) {
          iVar1 = bdcmp(&DAT_00086d54 + local_1c * 0x210,auStack_28);
          if (iVar1 == 0) {
            FUN_0002e708(0x896e8,10,auStack_28,(char *)(local_1c * 0x210 + 0x86d5d));
            FUN_0002ed9a(0x896e8,10,auStack_28,(&DAT_00086f5b)[local_1c * 0x210]);
            FUN_0002ee2c(0x896e8,10,auStack_28,(&DAT_00086f5c)[local_1c * 0x210]);
            break;
          }
        }
        FUN_0002aa0a();
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_connect",0x5e6);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_b8,"BSA_HhOpen failed: %d",local_22);
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_connect",0x5de);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_b8,"Bad Security Mask selected :%d",local_18);
      }
      local_20 = 0xffffffff;
    }
  }
  return local_20;
}



int FUN_0004c2c0(void)

{
  int iVar1;
  undefined auStack_b0 [128];
  byte local_30;
  undefined local_2f;
  undefined local_2e;
  undefined auStack_2c [6];
  undefined local_26;
  undefined local_25;
  undefined local_24;
  undefined auStack_20 [8];
  char *local_18;
  char local_11;
  int local_10;
  int local_c;
  
  local_c = -1;
  local_11 = '\0';
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_open_tbfc",0x630);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b0,"Bluetooth HID TBFC open menu:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_open_tbfc",0x631);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b0,"    0 Device from XML database (already paired)");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_open_tbfc",0x632);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b0,"    1 Device found in last discovery");
  }
  local_10 = FUN_0002f22c("Select source");
  if (local_10 == 0) {
    FUN_0002a97e();
    FUN_0002e882(0x896e8,10);
    local_10 = FUN_0002f22c("Select device");
    if (((-1 < local_10) && (local_10 < 10)) && ((&DAT_000896e8)[local_10 * 0x1b0] != '\0')) {
      bdcpy(auStack_20,&DAT_000896e9 + local_10 * 0x1b0);
      local_18 = (char *)(local_10 * 0x1b0 + 0x896ef);
      local_30 = (&DAT_000897e8)[local_10 * 0x1b0];
      local_2f = (&DAT_000897e9)[local_10 * 0x1b0];
      local_2e = (&DAT_000897ea)[local_10 * 0x1b0];
      local_11 = '\x01';
    }
  }
  else if (local_10 == 1) {
    FUN_00023ce4();
    local_10 = FUN_0002f22c("Select device");
    if (((-1 < local_10) && (local_10 < 0x14)) && ((&DAT_00086d50)[local_10 * 0x210] != '\0')) {
      bdcpy(auStack_20,&DAT_00086d54 + local_10 * 0x210);
      local_18 = (char *)(local_10 * 0x210 + 0x86d5d);
      local_30 = (&DAT_00086d5a)[local_10 * 0x210];
      local_2f = (&DAT_00086d5b)[local_10 * 0x210];
      local_2e = (&DAT_00086d5c)[local_10 * 0x210];
      local_11 = '\x01';
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_open_tbfc",0x65d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b0,"Bad choice [XML(0) or Disc(1) only]");
    }
  }
  if (local_11 == '\0') {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_open_tbfc",0x682);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b0,"Bad Device index:%d",local_10);
    }
  }
  else {
    BSA_HhOpenInit(auStack_2c);
    bdcpy(auStack_2c,auStack_20);
    local_26 = 0;
    local_25 = 0x12;
    DAT_0008c2ca = 0x12;
    local_24 = 1;
    local_c = BSA_HhOpen(auStack_2c);
    if (local_c == 0) {
      FUN_0002a97e();
      FUN_0002e708(0x896e8,10,auStack_20,local_18);
      FUN_0002e7b2(0x896e8,10,auStack_20,&local_30);
      FUN_0002aa0a();
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_b0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_open_tbfc",0x66c);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_b0,"Unable to connect HID device status:%d",local_c);
      }
    }
  }
  return local_c;
}



undefined4 FUN_0004c6f8(void *param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined auStack_94 [128];
  undefined local_14 [4];
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_disconnect",0x699);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Disconnect");
  }
  if (param_1 == (void *)0x0) {
    FUN_0004e06a();
    iVar1 = FUN_0002f22c("Enter HID Handle");
    local_9 = (undefined)iVar1;
  }
  else {
    uVar2 = FUN_0004e208(param_1);
    local_9 = (undefined)uVar2;
  }
  BSA_HhCloseInit(local_14);
  local_14[0] = local_9;
  local_10 = BSA_HhClose(local_14);
  if (local_10 == 0) {
    uVar3 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_disconnect",0x6ab);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"Unable to disconnect HID device status:%d",local_10);
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



int FUN_0004c7ee(void)

{
  int iVar1;
  undefined auStack_318 [128];
  undefined local_298;
  undefined local_297;
  undefined2 local_296;
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_318,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_idle",0x6c7);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_318,"Bluetooth HID Set Idle");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhSetInit(&local_298);
  local_298 = 2;
  local_297 = local_9;
  local_296 = 0;
  local_10 = BSA_HhSet(&local_298);
  if (local_10 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_318,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_idle",0x6d2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_318,"BSA_HhSet fail status:%d",local_10);
    }
  }
  return local_10;
}



int FUN_0004c8d4(void)

{
  int iVar1;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_get_idle",0x6e9);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Get Idle");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhGetInit(&local_14);
  local_14 = 2;
  local_13 = local_9;
  local_10 = BSA_HhGet(&local_14);
  if (local_10 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_get_idle",0x6f4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhGet fail status:%d",local_10);
    }
  }
  return local_10;
}



int FUN_0004c9aa(undefined param_1,undefined param_2)

{
  int iVar1;
  undefined auStack_314 [128];
  undefined local_294;
  undefined local_293;
  undefined local_292;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_314,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_change_proto_mode",0x70b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_314,"Bluetooth HID Change Proto Mode");
  }
  BSA_HhSetInit(&local_294);
  local_294 = 1;
  local_293 = param_1;
  local_292 = param_2;
  local_c = BSA_HhSet(&local_294);
  if (local_c != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_314,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_change_proto_mode",0x714);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_314,"BSA_HhSet fail status:%d",local_c);
    }
  }
  return local_c;
}



int FUN_0004ca94(void)

{
  int iVar1;
  undefined auStack_31c [128];
  undefined local_29c;
  undefined local_29b;
  undefined local_29a;
  int local_14;
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_proto_mode",0x72c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"Bluetooth HID Set Protocol mode");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhSetInit(&local_29c);
  local_29c = 1;
  local_29b = local_9;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_proto_mode",0x732);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"    Select Protocol Mode:");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_proto_mode",0x733);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"        0 Report Mode");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_proto_mode",0x734);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"        1 Boot Mode");
  }
  local_10 = FUN_0002f22c("Protocol Mode");
  if (local_10 == 0) {
    local_29a = 0;
  }
  else {
    if (local_10 != 1) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_set_proto_mode",0x73b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_31c,"Invalid choice");
      }
      return -1;
    }
    local_29a = 1;
  }
  local_14 = BSA_HhSet(&local_29c);
  if ((local_14 != 0) &&
     (iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_set_proto_mode",0x742), iVar1 != 0)) {
    duss_log_print(0x5c,1,auStack_31c,"BSA_HhSet fail status:%d",local_14);
  }
  return local_14;
}



int FUN_0004cca4(void)

{
  int iVar1;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  int local_10;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_get_proto_mode",0x759);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Get Proto Mode");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhGetInit(&local_14);
  local_14 = 1;
  local_13 = local_9;
  local_10 = BSA_HhGet(&local_14);
  if (local_10 != 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_get_proto_mode",0x764);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhGet fail status:%d",local_10);
    }
  }
  return local_10;
}



undefined4 FUN_0004cd7a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_3d4 [128];
  undefined auStack_354 [834];
  undefined local_12;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_3d4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_enable_mip",0x77a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_3d4,"app_hh_enable_mip");
  }
  BSA_HhAddDevInit(auStack_354);
  local_12 = 1;
  local_c = BSA_HhAddDev(auStack_354);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_3d4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_enable_mip",0x783);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_3d4,"BSA_HhAddDev: Unable to enable MIP feature status:%d",
                     local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004ce42(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined auStack_14 [6];
  undefined local_e;
  int local_c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_disable_mip",0x79a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"app_hh_enable_mip");
  }
  BSA_HhRemoveDevInit(auStack_14);
  local_e = 1;
  local_c = BSA_HhRemoveDev(auStack_14);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_disable_mip",0x7a3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhRemoveDev: Unable to disable MIP feature:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004cf02(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_31c [128];
  undefined local_29c;
  undefined local_29b;
  undefined local_29a;
  short local_298;
  undefined local_296;
  undefined auStack_295 [641];
  int local_14;
  undefined2 local_e;
  undefined2 local_c;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_report",0x7bb);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"Bluetooth HID Set Report");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  iVar1 = FUN_0002f22c("Report Type(0=RESRV,1=INPUT,2=OUTPUT,3=FEATURE)");
  local_c = (undefined2)iVar1;
  iVar1 = FUN_0002f22c("Enter report id");
  local_e = (undefined2)iVar1;
  BSA_HhSetInit(&local_29c);
  local_29c = 3;
  local_29b = local_9;
  local_29a = (undefined)local_c;
  local_14 = FUN_0002f374(0x6e4c8,(int)auStack_295,0x27e);
  if (local_14 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_report",0x7c9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_31c,"incorrect Data");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_298 = (short)local_14 + 1;
    local_296 = (undefined)local_e;
    local_14 = BSA_HhSet(&local_29c);
    if (local_14 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_set_report",0x7d1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_31c,"BSA_HhSet fail status:%d",local_14);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_0004d09c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  int local_10;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_send_vc_unplug",0x7ed);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Send Virtual Cable Unplug");
  }
  iVar1 = FUN_0002f22c("Select HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhSendCtrlInit(&local_14);
  local_13 = 5;
  local_14 = local_9;
  local_10 = BSA_HhSendCtrl(&local_14);
  if (local_10 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_send_vc_unplug",0x7f6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhSendCtrl fail status:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004d17a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  int local_10;
  undefined local_a;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_send_hid_ctrl",0x811);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth send HID Control");
  }
  iVar1 = FUN_0002f22c("Select HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhSendCtrlInit(&local_14);
  iVar1 = FUN_0002f22c("Message type(3:suspend, 4:exit_suspend, 5:virtual cable unplug");
  local_13 = (undefined)iVar1;
  local_14 = local_9;
  local_a = local_13;
  local_10 = BSA_HhSendCtrl(&local_14);
  if (local_10 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_send_hid_ctrl",0x81b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhSendCtrl fail status:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004d26c(int param_1,void *param_2,size_t param_3)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_320 [128];
  undefined local_2a0;
  undefined local_29f;
  undefined local_29e;
  short local_29c;
  undefined local_29a;
  undefined auStack_299 [641];
  int local_18;
  int local_14;
  undefined local_d;
  size_t local_c;
  
  if (param_2 == (void *)0x0) {
    FUN_0004e06a();
    iVar2 = FUN_0002f22c("Enter HID Handle");
    local_d = (undefined)iVar2;
  }
  else if (param_1 < 0) {
    uVar1 = FUN_0004e208((void *)0x0);
    local_d = (undefined)uVar1;
  }
  else {
    local_d = (undefined)param_1;
  }
  if (param_2 == (void *)0x0) {
    local_18 = FUN_0002f22c("Report Type(0=RESRV,1=INPUT,2=OUTPUT,3=FEATURE)");
  }
  else {
    local_18 = 2;
  }
  if ((local_18 < 0) || (3 < local_18)) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_320,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_send_ctrl_data",0x850);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_320,"Bad Report Type:0x%x",local_18);
    }
    uVar3 = 0xffffffff;
  }
  else {
    if (param_2 == (void *)0x0) {
      local_14 = FUN_0002f22c("ReportId");
    }
    else {
      local_14 = 2;
    }
    if ((local_14 < 0) || (0xff < local_14)) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_320,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_send_ctrl_data",0x85e);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_320,"Bad report Id:0x%x",local_14);
      }
      uVar3 = 0xffffffff;
    }
    else {
      BSA_HhSetInit(&local_2a0);
      local_2a0 = 3;
      local_29f = local_d;
      local_29e = (undefined)local_18;
      local_29a = (undefined)local_14;
      if (param_2 == (void *)0x0) {
        local_c = FUN_0002f374(0x6e4c8,(int)auStack_299,0x27e);
      }
      else {
        memcpy(auStack_299,param_2,param_3);
        local_c = param_3;
      }
      if ((int)local_c < 0) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_320,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_send_ctrl_data",0x874);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_320,"incorrect Data");
        }
        uVar3 = 0xffffffff;
      }
      else {
        local_29c = (short)local_c + 1;
        local_c = BSA_HhSet(&local_2a0);
        if (local_c == 0) {
          uVar3 = 0;
        }
        else {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_320,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_send_ctrl_data",0x87c);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_320,"BSA_HhSet fail status:%d",local_c);
          }
          uVar3 = 0xffffffff;
        }
      }
    }
  }
  return uVar3;
}



undefined4 FUN_0004d516(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_3c0 [128];
  undefined local_340 [2];
  undefined2 local_33e;
  char local_33c [800];
  int local_1c;
  int local_18;
  int local_14;
  undefined local_d;
  int local_c;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_3c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_send_int_data",0x899);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_3c0,"Bluetooth HID Send Interrupt Data");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_d = (undefined)iVar1;
  local_14 = FUN_0002f22c("ReportId");
  if ((local_14 < 0) || (0xff < local_14)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_3c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_send_int_data",0x89f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_3c0,"Bad report Id:0x%x",local_14);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_18 = FUN_0002f22c("Data Length (including report ID)");
    if ((local_18 < 1) || (799 < local_18)) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_3c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_send_int_data",0x8a6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_3c0,"Bad length Id:0x%x",local_18);
      }
      uVar2 = 0xffffffff;
    }
    else {
      BSA_HhSendDataInit(local_340);
      local_340[0] = local_d;
      local_33e = (undefined2)local_18;
      local_33c[0] = (char)local_14;
      for (local_c = 1; local_c < local_18; local_c = local_c + 1) {
        local_33c[local_c] = (char)local_c + -1;
      }
      local_1c = BSA_HhSendData(local_340);
      if (local_1c == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_3c0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_send_int_data",0x8b7);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_3c0,"BSA_HhSendData fail status:%d",local_1c);
        }
        uVar2 = 0xffffffff;
      }
    }
  }
  return uVar2;
}



undefined4 FUN_0004d71c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  undefined local_12;
  undefined local_11;
  int local_10;
  undefined local_a;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_get_report",0x8d3);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Get Report");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  iVar1 = FUN_0002f22c("Report Type(0=RESRV,1=INPUT,2=OUTPUT,3=FEATURE)");
  local_a = (undefined)iVar1;
  BSA_HhGetInit(&local_14);
  local_14 = 3;
  local_13 = local_9;
  local_12 = local_a;
  iVar1 = FUN_0002f22c("Enter Report ID");
  local_11 = (undefined)iVar1;
  local_10 = BSA_HhGet(&local_14);
  if (local_10 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_get_report",0x8e1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhGet fail status:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004d828(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined local_14;
  undefined local_13;
  undefined local_12;
  undefined local_11;
  int local_10;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_get_report_no_size",0x8fb);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Bluetooth HID Get Report w/o size info");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhGetInit(&local_14);
  local_14 = 7;
  local_13 = local_9;
  local_12 = 1;
  iVar1 = FUN_0002f22c("Enter Report ID");
  local_11 = (undefined)iVar1;
  local_10 = BSA_HhGet(&local_14);
  if (local_10 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_get_report_no_size",0x909);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_HhGet fail status:%d",local_10);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004d920(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_3b0 [128];
  undefined local_330 [2];
  undefined2 local_32e;
  undefined local_32c;
  undefined local_32b;
  short local_c;
  undefined local_9;
  
  FUN_0004e06a();
  iVar1 = duss_log_gen_head(0x5c,3,auStack_3b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_ucd_brr_mode",0x924);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_3b0,"Bluetooth HID Send data (UCD mode)");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_9 = (undefined)iVar1;
  BSA_HhSendDataInit(local_330);
  local_330[0] = local_9;
  local_32c = 0xff;
  local_32b = 0;
  local_32e = 2;
  local_c = BSA_HhSendData(local_330);
  if (local_c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_3b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_ucd_brr_mode",0x930);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_3b0,"BSA_HhSendData fail status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004da16(char param_1,char param_2,char param_3)

{
  int iVar1;
  undefined4 uVar2;
  char local_31b;
  char local_31a;
  char local_319;
  undefined auStack_318 [128];
  undefined local_298;
  char local_297;
  undefined local_296;
  undefined2 local_294;
  undefined local_292;
  char local_291;
  char local_290;
  short local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_318,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_cfg_hid_ucd",0x948);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_318,"Set HID UCD mode");
  }
  local_319 = param_1;
  if (param_1 == -1) {
    FUN_0004e06a();
    iVar1 = FUN_0002f22c("Enter HID handle");
    local_319 = (char)iVar1;
  }
  local_31a = param_2;
  if (param_2 == '\0') {
    iVar1 = FUN_0002f22c("Enter HID UCD command (1=Set, 2=Clear, 3=Exec)");
    local_31a = (char)iVar1;
  }
  local_31b = param_3;
  if (param_3 == '\0') {
    iVar1 = FUN_0002f22c("Enter flags to set (1=BRR, 2=UCD, 4=Multicast)");
    local_31b = (char)iVar1;
  }
  BSA_HhSetInit(&local_298);
  local_298 = 3;
  local_297 = local_319;
  local_296 = 3;
  local_294 = 3;
  local_292 = 0xcc;
  local_291 = local_31a;
  local_290 = local_31b;
  local_12 = BSA_HhSet(&local_298);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_318,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_cfg_hid_ucd",0x966);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_318,"BSA_HhSet fail status:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004db84(void)

{
  int local_c;
  
  memset(&DAT_0008c26c,0,0x6c);
  for (local_c = 0; local_c < 10; local_c = local_c + 1) {
    (&DAT_0008c274)[local_c * 9] = 0;
  }
  DAT_0008c2c8 = 0;
  DAT_0008c2c7 = 0xff;
  FUN_00049e3c();
  return 0;
}



undefined4 FUN_0004dbf2(void)

{
  undefined auStack_c [4];
  
  UIPC_Close(DAT_0008c26c);
  DAT_0008c26c = 0xff;
  DAT_0008c2c8 = 0;
  DAT_0008c2c7 = 0xff;
  BSA_HhDisableInit(auStack_c);
  BSA_HhDisable(auStack_c);
  FUN_00049e62();
  return 0;
}



undefined4 FUN_0004dc4e(char param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_31c [128];
  undefined local_29c;
  undefined local_29b;
  undefined2 local_29a;
  short local_298;
  undefined2 local_296;
  short local_294;
  short local_14;
  undefined local_11;
  
  if (param_2 == -1) {
    FUN_0004e06a();
    iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_3dsg_mode",0x9dd);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_31c,"Bluetooth HID Set 3DSG mode enable:%d",param_1);
    }
    iVar1 = FUN_0002f22c("Enter HID Handle");
    local_11 = (undefined)iVar1;
  }
  else {
    local_11 = (undefined)param_2;
  }
  BSA_HhSetInit(&local_29c);
  local_29b = local_11;
  if (param_1 == '\0') {
    local_29c = 6;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_3dsg_mode",0x9f8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_31c,"Disabling 3DSG");
    }
  }
  else {
    local_29c = 5;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_3dsg_mode",0x9ea);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_31c,"These parameters are for %d ms VSync Period",param_3);
    }
    local_29a = 0;
    local_298 = (short)(param_3 / 2) + -1;
    local_296 = (undefined2)(param_3 / 2);
    local_294 = (short)param_3 + -1;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_3dsg_mode",0x9f3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_31c,"Enabling 3DSG with LO:%d LC:%d RO:%d RC:%d",local_29a,
                     local_298,local_296,local_294);
    }
  }
  local_14 = BSA_HhSet(&local_29c);
  if (local_14 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_3dsg_mode",0x9fd);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_31c,"Failed to control 3DSG status:%d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004deb4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_324 [128];
  undefined local_2a4;
  undefined local_2a3;
  undefined2 local_2a2;
  undefined2 local_2a0;
  undefined2 local_29e;
  undefined2 local_29c;
  short local_1c;
  undefined2 local_1a;
  undefined2 local_18;
  undefined2 local_16;
  undefined2 local_14;
  undefined local_11;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_324,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_enable_3dsg_mode_manual",0xa18);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_324,"Set 3DSG mode (manual Offsets/Delay)");
  }
  iVar1 = FUN_0002f22c("Enter HID Handle");
  local_11 = (undefined)iVar1;
  iVar1 = FUN_0002f22c("Enter Left open");
  local_14 = (undefined2)iVar1;
  iVar1 = FUN_0002f22c("Enter Left Close");
  local_16 = (undefined2)iVar1;
  iVar1 = FUN_0002f22c("Enter Right Open");
  local_18 = (undefined2)iVar1;
  iVar1 = FUN_0002f22c("Enter Right Close");
  local_1a = (undefined2)iVar1;
  BSA_HhSetInit(&local_2a4);
  local_2a3 = local_11;
  local_2a4 = 5;
  local_2a2 = local_14;
  local_2a0 = local_16;
  local_29e = local_18;
  local_29c = local_1a;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_324,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_enable_3dsg_mode_manual",0xa2b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_324,"Enabling 3DSG with LO:%d LC:%d RO:%d RC:%d",local_2a2,
                   local_2a0,local_29e,local_29c);
  }
  local_1c = BSA_HhSet(&local_2a4);
  if (local_1c == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_324,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_enable_3dsg_mode_manual",0xa30);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_324,"Failed to Enable 3DSG status:%d",local_1c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



int FUN_0004e06a(void)

{
  int iVar1;
  char *pcVar2;
  undefined auStack_a4 [128];
  int local_24;
  int local_20;
  byte *local_1c;
  
  local_24 = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_display_status",0xa47);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a4,"Known HID device(s):");
  }
  local_1c = &DAT_0008c26d;
  for (local_20 = 0; local_20 < 10; local_20 = local_20 + 1) {
    if ((*local_1c & 1) != 0) {
      local_24 = local_24 + 1;
      iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_display_status",0xa54);
      if (iVar1 != 0) {
        if ((*local_1c & 2) == 0) {
          pcVar2 = "CLOSED";
        }
        else {
          pcVar2 = "OPENED";
        }
        duss_log_print(0x5c,3,auStack_a4,
                       "Handle:%d Index:%d BdAddr:%02X:%02X:%02X:%02X:%02X:%02X (%s)",local_1c[7],
                       local_20,local_1c[1],local_1c[2],local_1c[3],local_1c[4],local_1c[5],
                       local_1c[6],pcVar2);
      }
    }
    local_1c = local_1c + 9;
  }
  if (local_24 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_display_status",0xa5a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_a4,"No HID Connection");
    }
  }
  return local_24;
}



uint FUN_0004e208(void *param_1)

{
  int iVar1;
  undefined auStack_90 [128];
  int local_10;
  byte *local_c;
  
  local_c = &DAT_0008c26d;
  local_10 = 0;
  while( true ) {
    if (9 < local_10) {
      return 0xffffffff;
    }
    if (((*local_c & 1) != 0) && ((*local_c & 2) != 0)) break;
    local_10 = local_10 + 1;
    local_c = local_c + 9;
  }
  if ((param_1 != (void *)0x0) &&
     ((iVar1 = memcmp(param_1,local_c + 1,6), iVar1 != 0 &&
      (iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                 "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                 ,"app_hh_get_open_handle",0xa6e), iVar1 != 0)))) {
    duss_log_print(0x5c,1,auStack_90,"bd addr unmatch");
  }
  return (uint)local_c[7];
}



undefined4 FUN_0004e2d4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_b8 [128];
  undefined auStack_38 [8];
  undefined auStack_30 [8];
  undefined auStack_28 [8];
  int local_20;
  char *local_1c;
  byte *local_18;
  int local_14;
  int local_10;
  int local_c;
  
  local_10 = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_remove_dev",0xa92);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_b8,"Remove HH Device");
  }
  iVar1 = FUN_0004e06a();
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_remove_dev",0xa97);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_b8,"No HID devices");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_14 = FUN_0002f22c("Enter the index of the device to remove");
    if ((local_14 < 0) || (9 < local_14)) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_remove_dev",0xaa1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_b8,"Bad HH Device index");
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_18 = &DAT_0008c26d + local_14 * 9;
      if ((*local_18 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_remove_dev",0xaa9);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"HH Device not in use");
        }
        uVar2 = 0xffffffff;
      }
      else {
        bdcpy(auStack_38,&DAT_0008c26e + local_14 * 9);
        BSA_HhRemoveDevInit(auStack_28);
        bdcpy(auStack_28,auStack_38);
        local_10 = BSA_HhRemoveDev(auStack_28);
        if (local_10 == 0) {
          *local_18 = 0;
          FUN_0004a2c2(auStack_38);
          BSA_SecRemoveDeviceInit(auStack_30);
          bdcpy(auStack_30,auStack_38);
          local_10 = BSA_SecRemoveDevice(auStack_30);
          if (local_10 != 0) {
            iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                      ,"app_hh_remove_dev",0xace);
            if (iVar1 != 0) {
              duss_log_print(0x5c,1,auStack_b8,"BSA_SecRemoveDevice failed: %d",local_10);
            }
          }
          FUN_0002a97e();
          for (local_c = 0; local_c < 10; local_c = local_c + 1) {
            local_1c = &DAT_000896e8 + local_c * 0x1b0;
            if ((*local_1c != '\0') &&
               (iVar1 = bdcmp(&DAT_000896e9 + local_c * 0x1b0,auStack_38), iVar1 == 0)) {
              *local_1c = '\0';
              FUN_0002aa0a();
            }
          }
          iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_remove_dev",0xae3);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_b8,"Try to remove device from BLE DB");
          }
          local_20 = FUN_00048a6e(auStack_38);
          if (local_20 != 0) {
            FUN_00048770(auStack_38);
            FUN_00048718();
          }
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_remove_dev",0xab7);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_b8,"BSA_HhRemoveDev failed: %d",local_10);
          }
          uVar2 = 0xffffffff;
        }
      }
    }
  }
  return uVar2;
}



undefined4 FUN_0004e624(undefined param_1,undefined4 param_2,undefined param_3,undefined param_4)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_31c [128];
  undefined local_29c;
  undefined local_29b;
  undefined auStack_29a [6];
  undefined local_294;
  undefined local_293;
  int local_14;
  
  local_14 = 0;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_31c,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_send_set_prio",0xb0a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_31c,"app_hh_send_set_prio priority:%d direction:%d",param_3,
                   param_4);
  }
  BSA_HhSetInit(&local_29c);
  local_29c = 8;
  local_29b = param_1;
  bdcpy(auStack_29a,param_2);
  local_294 = param_3;
  local_293 = param_4;
  local_14 = BSA_HhSet(&local_29c);
  if (local_14 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_31c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_send_set_prio",0xb16);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_31c,"Failed to set priority status:%d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004e750(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  byte *local_14;
  int local_10;
  undefined local_a;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                            ,"app_hh_set_prio_audio",0xb2f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_94,"Set Priority Ext (for HID audio)");
  }
  iVar1 = FUN_0004e06a();
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                              ,"app_hh_set_prio_audio",0xb34);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"No HID devices");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_10 = FUN_0002f22c("Enter the index of the device");
    if ((local_10 < 0) || (9 < local_10)) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                ,"app_hh_set_prio_audio",0xb3e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_94,"Bad HH Device index");
      }
      uVar2 = 0xffffffff;
    }
    else {
      local_14 = &DAT_0008c26d + local_10 * 9;
      if ((*local_14 & 1) == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                  ,"app_hh_set_prio_audio",0xb46);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_94,"HH Device not in use");
        }
        uVar2 = 0xffffffff;
      }
      else {
        iVar1 = FUN_0002f22c("Enter priority (0=Normal, 1=High)");
        if ((char)iVar1 == '\0') {
          local_9 = 0;
          iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_set_prio_audio",0xb53);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_94,"Normal priority selected - priority =%d",local_9);
          }
        }
        else {
          local_9 = 1;
          iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_set_prio_audio",0xb4e);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_94,"High priority selected - priority =%d",local_9);
          }
        }
        iVar1 = FUN_0002f22c("Enter Audio direction (0=Source, 1=Sink)");
        if ((char)iVar1 == '\0') {
          local_a = 1;
          iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_set_prio_audio",0xb5f);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_94,"Audio Source selected - direction =%d",local_a);
          }
        }
        else {
          local_a = 2;
          iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_hh/source/app_hh.c"
                                    ,"app_hh_set_prio_audio",0xb5a);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_94,"Audio Sink selected - direction =%d",local_a);
          }
        }
        FUN_0004e624(local_14[7],local_14 + 1,local_9,local_a);
        uVar2 = 0;
      }
    }
  }
  return uVar2;
}



undefined4 FUN_0004ea78(undefined4 param_1)

{
  DAT_0008c2d4 = param_1;
  return 0;
}



void FUN_0004ea9c(void)

{
  int iVar1;
  undefined auStack_88 [128];
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x4f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"Bluetooth Test Module Application Main menu:\n");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x50);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Enable Test Mode",1);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x51);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Disable Test Mode",2);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x52);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Disconnect a device",3);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x53);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Get Server Memory Usage",4);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x54);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Get Client Memory Usage",5);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x55);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Ping",6);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x56);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Sent VendorSpecificCommand",7);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x57);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Control trace level(0 ~ 5)",8);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x58);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Add trace to bsa server",9);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x59);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read Version",10);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read RAM",0xb);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read BD address from flash",0xc);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read ACL connections table",0xd);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => VSE Register",0xe);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => VSE Deregister",0xf);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x5f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Set Tx Carrier Frequency",0x10);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x60);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read BFC parameters",0x11);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x61);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,
                   "    %d => Read WLAN Coexistence Parameters (require specific FW)",0x12);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x62);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,
                   "    %d => Write WLAN Coexistence Parameters (require specific FW)",0x13);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",99);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read RSSI",0x14);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",100);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read Raw RSSI",0x15);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x65);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Set Tx Power Level",0x16);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x66);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read Tx Power Level",0x17);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x67);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => LE Tests",0x18);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x68);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Config GPIO",0x19);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x69);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Read OTP",0x1a);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Write OTP",0x1b);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Configure PCM interface",0x1c);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Configure SCO",0x1d);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6d);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Change connection priority",0x1e);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Set External Frame Configuration",0x1f);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x6f);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Set MWS Channel Parameters",0x20);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x70);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Set AFH Behavior",0x21);
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_display_main_menu",0x71);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"    %d => Quit",99);
  }
  return;
}



undefined4 FUN_0004f366(int param_1,undefined2 *param_2)

{
  int iVar1;
  undefined auStack_88 [128];
  
  if (param_1 != 0) {
    return 0;
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_88,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"app_tm_mgt_callback",0x85);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_88,"app_tm_mgt_callback BSA_MGT_DISCONNECT_EVT reason:%d",*param_2
                  );
  }
                    // WARNING: Subroutine does not return
  exit(-1);
}



undefined4 FUN_0004f3d0(void)

{
  FUN_000502d4();
  return 0;
}



undefined4 FUN_0004f3de(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined local_10;
  undefined local_f;
  undefined local_e;
  undefined local_d;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"bt_test_start_ble_tx",0x9a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: channel:%d, pattern:%d\n",param_1,param_2);
  }
  FUN_0004f616();
  memset(&local_10,0,8);
  local_10 = 1;
  local_f = (undefined)param_1;
  local_d = 0x25;
  local_e = (undefined)param_2;
  iVar1 = FUN_000571b4(&local_10);
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_start_ble_tx",0xa7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test start.");
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_start_ble_tx",0xab);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004f4fe(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined local_10;
  undefined local_f;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                            ,"bt_test_start_ble_rx",0xb3);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_90,"wms: channel:%d\n",param_1);
  }
  FUN_0004f616();
  DAT_00086d48 = 0;
  memset(&local_10,0,8);
  local_10 = 0;
  local_f = (undefined)param_1;
  iVar1 = FUN_000571b4(&local_10);
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_start_ble_rx",0xc0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test start.");
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_start_ble_rx",0xc4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004f616(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined local_10 [6];
  ushort local_a;
  
  memset(local_10,0,8);
  local_10[0] = 4;
  iVar1 = FUN_000571b4(local_10);
  if (iVar1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_stop",0xd2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test retcount = %d",local_a);
    }
    DAT_00086d48 = (uint)local_a;
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"bt_test_stop",0xd7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"LE Test is failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0004f6de(void)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined auStack_1a8 [128];
  char acStack_128 [256];
  byte local_28;
  undefined local_27;
  undefined local_26;
  undefined local_25;
  undefined local_24;
  undefined local_23;
  undefined2 local_22;
  char local_20 [4];
  undefined uStack_1c;
  undefined uStack_1b;
  undefined uStack_1a;
  undefined uStack_19;
  undefined uStack_18;
  undefined auStack_17 [2];
  undefined local_15;
  undefined local_14;
  byte local_13;
  char local_12;
  char local_11;
  int local_10;
  int local_c;
  
  FUN_00034858();
  iVar1 = FUN_00034872((char *)0x0,0x4f367);
  if (iVar1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                              ,"app_tm_main",0xf5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a8,"Unable to connect to server");
    }
    uVar3 = 0xffffffff;
  }
  else {
    FUN_000502d4();
    do {
      FUN_0004ea9c();
      local_c = FUN_0002f22c("Select action");
      switch(local_c) {
      case 1:
        FUN_00054d50(1);
        break;
      case 2:
        FUN_00054d50(0);
        break;
      case 3:
        FUN_00054de4(0);
        break;
      case 4:
        FUN_0005563e('\0');
        break;
      case 5:
        FUN_0005563e('\x01');
        break;
      case 6:
        FUN_00055b38();
        break;
      case 7:
        FUN_00055bba();
        break;
      case 8:
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x120);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"Trace level supported:");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x121);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t0: None");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x122);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t1: Error");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x123);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t2: Warning");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x124);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t3: API");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x125);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t4: Event");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x126);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"\t5: Debug (full)");
        }
        local_10 = FUN_0002f22c("level");
        FUN_00055c5e(local_10);
        break;
      case 9:
        FUN_0002f300(0x6f450,(int)acStack_128,0x100);
        FUN_00055d4e(acStack_128);
        break;
      case 10:
        FUN_00055de4();
        break;
      case 0xb:
        FUN_00055f4c();
        break;
      case 0xc:
        FUN_0005681a();
        break;
      case 0xd:
        FUN_000560c4();
        break;
      case 0xe:
        FUN_00051930(-1,0);
        break;
      case 0xf:
        FUN_00051aae(-1,'\0');
        break;
      case 0x10:
        FUN_00056f20();
        break;
      case 0x11:
        FUN_000521cc((undefined *)0x0);
        break;
      case 0x12:
        FUN_00052faa();
        break;
      case 0x13:
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x155);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"WLAN Coexistence control (specific FW required)\n");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x156);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    0: to Disable\n");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x157);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    1: to Enable\n");
        }
        local_c = FUN_0002f22c("Coexistence control");
        if (local_c == 0) {
          local_20[0] = '\0';
          FUN_00052d4e(local_20);
        }
        else if (local_c == 1) {
          local_20[0] = '\x01';
          FUN_00052d4e(local_20);
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                    ,"app_tm_main",0x164);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1a8,"Bad choice:%d",local_c);
          }
        }
        break;
      case 0x14:
        FUN_000552e8(0);
        break;
      case 0x15:
        FUN_000550c0(0);
        break;
      case 0x16:
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x172);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,
                         "Enter the BD address of remote connected device(AA.BB.CC.DD.EE.FF):");
        }
        iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",&uStack_1c,&uStack_1b,&uStack_1a,&uStack_19,
                      &uStack_18,auStack_17);
        if (iVar1 == 6) {
          getchar();
          iVar1 = FUN_0002f22c("Enter Max Power Level");
          local_11 = (char)iVar1;
          FUN_000532b2((int)&uStack_1c,local_11);
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                    ,"app_tm_main",0x179);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1a8,"BD address not entered correctly");
          }
        }
        break;
      case 0x17:
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x182);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,
                         "Enter the BD address of remote connected device(AA.BB.CC.DD.EE.FF):");
        }
        iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",&uStack_1c,&uStack_1b,&uStack_1a,&uStack_19,
                      &uStack_18,auStack_17);
        if (iVar1 == 6) {
          getchar();
          FUN_00053624((int)&uStack_1c);
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                    ,"app_tm_main",0x188);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1a8,"BD address not entered correctly");
          }
        }
        break;
      case 0x18:
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",400);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"LE Cmd Tests:");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x191);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    %d: to run rx test",0);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x192);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    %d: to run tx test",1);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x193);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    **** 2M PHY Option ****");
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x194);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    %d: to run enhanced rx test",2);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x195);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    %d: to run enhanced tx test",3);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x196);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a8,"    %d: to end LE test",4);
        }
        memset(&local_28,0,8);
        uVar2 = FUN_0002f22c("LE Test");
        local_28 = (byte)uVar2;
        if (local_28 < 5) {
          switch(uVar2 & 0xff) {
          case 0:
            iVar1 = FUN_0002f22c("Enter rx frequency (0 - 39)");
            local_27 = (undefined)iVar1;
            break;
          case 1:
            iVar1 = FUN_0002f22c("Enter tx frequency (0 - 39)");
            local_27 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter test_data_len (0 - 255)");
            local_25 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter payload_pattern (0 - 7)");
            local_26 = (undefined)iVar1;
            break;
          case 2:
            iVar1 = FUN_0002f22c("Enter tx frequency (0 - 39)");
            local_27 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter phy (1 - 3)");
            local_23 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter modulation idx (0 - 1)");
            local_24 = (undefined)iVar1;
            break;
          case 3:
            iVar1 = FUN_0002f22c("Enter tx frequency (0 - 39)");
            local_27 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter test_data_len (0 - 255)");
            local_25 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter payload_pattern (0 - 7)");
            local_26 = (undefined)iVar1;
            iVar1 = FUN_0002f22c("Enter phy (1 - 4)");
            local_23 = (undefined)iVar1;
          }
          iVar1 = FUN_000571b4(&local_28);
          if (iVar1 == 0) {
            if ((local_28 == 4) &&
               (iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                          "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                          ,"app_tm_main",0x1bb), iVar1 != 0)) {
              duss_log_print(0x5c,3,auStack_1a8,"LE Test result. count = %d\n",local_22);
            }
          }
          else {
            iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                      ,"app_tm_main",0x1c0);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_1a8,"LE Test is failed");
            }
          }
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                    ,"app_tm_main",0x19b);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_1a8,"Invalid LE Test Command:%d",local_28);
          }
        }
        break;
      case 0x19:
        iVar1 = FUN_0002f22c("Auxiliary GPIO Control(0:disable, 1:enable)");
        local_12 = (char)iVar1;
        iVar1 = FUN_0002f22c("Select GPIO Pin number(0-7)");
        local_13 = (byte)iVar1;
        iVar1 = FUN_0002f22c("Pad configure(Input|Pullup|Pulldown|Hysteresis|Sel0|Sel1)");
        local_14 = (undefined)iVar1;
        iVar1 = FUN_0002f22c("Select value(0:low, 1:high)");
        local_15 = (undefined)iVar1;
        FUN_00053922(local_12,local_13,local_14,local_15);
        break;
      case 0x1a:
        FUN_00053a86();
        break;
      case 0x1b:
        FUN_00053d7e();
        break;
      case 0x1c:
        FUN_00054232();
        break;
      case 0x1d:
        FUN_00053f4e();
        break;
      case 0x1e:
        FUN_000545d0();
        break;
      case 0x1f:
        FUN_0005729a();
        break;
      case 0x20:
        FUN_00057528();
        break;
      case 0x21:
        FUN_0005489a();
        break;
      default:
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_main.c"
                                  ,"app_tm_main",0x1ee);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1a8,"Unknown choice:%d",local_c);
        }
      }
    } while (local_c != 99);
    FUN_000349fc();
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_000502d4(void)

{
  memset(&DAT_0008c2d8,0,0xc);
  DAT_0008c2e0 = 1;
  return 0;
}



char * FUN_000502fa(char param_1)

{
  char *pcVar1;
  
  if (param_1 == '\0') {
    pcVar1 = "3DG";
  }
  else if (param_1 == '\x01') {
    pcVar1 = "RC";
  }
  else {
    pcVar1 = "Unknown Type";
  }
  return pcVar1;
}



char * FUN_00050338(char param_1,char param_2)

{
  char *pcVar1;
  
  if (param_1 == '\0') {
    if (param_2 == '\0') {
      pcVar1 = "Multicast";
    }
    else if (param_2 == '\x01') {
      pcVar1 = "MIP";
    }
    else {
      pcVar1 = "Unknown 3DG SubType";
    }
  }
  else if (param_1 == '\x01') {
    if (param_2 == '\0') {
      pcVar1 = "Standard";
    }
    else if (param_2 == '\x01') {
      pcVar1 = "Voice";
    }
    else {
      pcVar1 = "Unknown RC SubType";
    }
  }
  else {
    pcVar1 = "Unknown Type";
  }
  return pcVar1;
}



undefined4 FUN_000503bc(char *param_1,byte param_2)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  char local_ad;
  char *local_ac;
  undefined auStack_a4 [128];
  undefined local_24;
  undefined local_23;
  undefined local_22;
  undefined local_21;
  undefined local_20;
  char local_1f;
  ushort local_1e;
  byte local_1c;
  byte local_1b;
  byte local_1a;
  char local_19;
  
  if (param_2 < 8) {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_association",0xaf);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_a4,
                     "Association message too short length:%d (expected at least 8)",param_2);
    }
    uVar6 = 0xffffffff;
  }
  else {
    pcVar3 = &local_1f;
    local_ac = param_1;
    for (iVar2 = 0; iVar2 < 6; iVar2 = iVar2 + 1) {
      *pcVar3 = *local_ac;
      pcVar3 = pcVar3 + -1;
      local_ac = local_ac + 1;
    }
    local_19 = *local_ac;
    local_1a = local_ac[1];
    iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_association",0xb8);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_a4,
                     "    Association message (Connect) BdAddr:%02X-%02X-%02X-%02X-%02X-%02X",
                     local_24,local_23,local_22,local_21,local_20,local_1f);
    }
    iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_association",0xbb);
    if (iVar2 != 0) {
      pcVar3 = FUN_000502fa(local_19);
      cVar1 = local_19;
      pcVar4 = FUN_00050338(local_19,local_1a);
      duss_log_print(0x5c,3,auStack_a4,"    Type:%s(0x%X) SubType:%s(0x%X)",pcVar3,cVar1,pcVar4,
                     local_1a);
    }
    if ((local_19 == '\0') && (local_1a == '\0')) {
      if (param_2 < 0xd) {
        iVar2 = duss_log_gen_head(0x5c,1,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_association",0xc5);
        if (iVar2 != 0) {
          duss_log_print(0x5c,1,auStack_a4,
                         "Association message too short length:%d (expected at least 13)",param_2);
        }
        uVar6 = 0xffffffff;
      }
      else {
        local_1b = local_ac[2];
        iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_association",0xcc);
        if (iVar2 != 0) {
          if ((local_1b & 0xf) == 1) {
            pcVar3 = "V1.0";
          }
          else {
            pcVar3 = "Unknown";
          }
          duss_log_print(0x5c,3,auStack_a4,"    3D Glasses version=%s(0x%x)",pcVar3,local_1b & 0xf);
        }
        iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_association",0xce);
        if (iVar2 != 0) {
          duss_log_print(0x5c,3,auStack_a4,"    Battery type=%s(0x%x)",
                         (&PTR_s_Primary_cell__Unknown_0006f9e8)[local_1b >> 4],local_1b >> 4);
        }
        local_1c = local_ac[3];
        if (local_1c == 0xff) {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xd8);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Voltage: No information(0x%x)",local_1c);
          }
        }
        else {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xd4);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Voltage: %dmV(0x%x)",(uint)local_1c * 0x19,
                           local_1c);
          }
        }
        local_1a = local_ac[4];
        if ((local_1a & 3) == 1) {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xe7);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Charging: reserved(0x%x)",local_1a & 3);
          }
        }
        else if ((local_1a & 3) == 2) {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xe4);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Charging: charging(0x%x)",local_1a & 3);
          }
        }
        else if ((local_1a & 3) == 0) {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xe1);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Charging: not in charging(0x%x)",local_1a & 3);
          }
        }
        else {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xea);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Charging: no info(0x%x)",local_1a & 3);
          }
        }
        local_1a = local_1a >> 2;
        switch(local_1a & 7) {
        case 0:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xf2);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: Almost 0%%(0x%x)",local_1a & 7);
          }
          break;
        default:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x101);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: reserved(0x%x)",local_1a & 7);
          }
          break;
        case 2:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xf8);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: 50%%(0x%x)",local_1a & 7);
          }
          break;
        case 4:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xf5);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: 25%%(0x%x)",local_1a & 7);
          }
          break;
        case 6:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xfb);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: Full(0x%x)",local_1a & 7);
          }
          break;
        case 7:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0xfe);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Level: No info(0x%x)",local_1a & 7);
          }
        }
        local_1a = local_1a >> 3;
        switch(local_1a & 7) {
        case 0:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x109);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: < 2 hrs(0x%x)",local_1a & 7);
          }
          break;
        default:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x118);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: reserved(0x%x)",local_1a & 7);
          }
          break;
        case 2:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x10f);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: ~ 10 hrs(0x%x)",local_1a & 7);
          }
          break;
        case 4:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x10c);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: ~ 5 hrs(0x%x)",local_1a & 7);
          }
          break;
        case 6:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x112);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: > 10 hrs(0x%x)",local_1a & 7);
          }
          break;
        case 7:
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x115);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Time: No info(0x%x)",local_1a & 7);
          }
        }
        local_1e = (ushort)(byte)local_ac[6] * 0x100 + (ushort)(byte)local_ac[5];
        local_ac = local_ac + 7;
        if (local_1e == 0) {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x120);
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Color: No information(0x%04x)",local_1e);
          }
        }
        else {
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x127);
          if (iVar2 != 0) {
            if ((local_1e & 0x80) == 0) {
              uVar6 = 0x2b;
            }
            else {
              uVar6 = 0x2d;
            }
            if ((short)local_1e < 0) {
              uVar5 = 0x2d;
            }
            else {
              uVar5 = 0x2b;
            }
            duss_log_print(0x5c,3,auStack_a4,"    Color: dU\'=%c%u dV\'=%c%u (0x%04x)",uVar6,
                           local_1e & 0x7f,uVar5,local_1e >> 8 & 0x7f,local_1e);
          }
        }
        local_ad = param_2 - 0xd;
        while (cVar1 = local_ad + -1, local_ad != '\0') {
          local_1a = *local_ac;
          local_ac = local_ac + 1;
          iVar2 = duss_log_gen_head(0x5c,3,auStack_a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_association",0x131);
          local_ad = cVar1;
          if (iVar2 != 0) {
            duss_log_print(0x5c,3,auStack_a4,"    Reserved byte: 0x%02X",local_1a);
          }
        }
        uVar6 = 0;
      }
    }
    else {
      uVar6 = 0;
    }
  }
  return uVar6;
}



// WARNING: Removing unreachable block (ram,0x00050fb4)

undefined4 FUN_00050e48(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined auStack_b8 [128];
  undefined local_38;
  undefined local_37;
  undefined local_36;
  undefined local_35;
  undefined local_34;
  byte local_33 [4];
  byte local_2f;
  byte local_2e;
  byte local_2d;
  byte local_2c;
  byte local_2b;
  byte local_2a;
  byte local_29;
  byte local_28;
  byte local_27;
  byte local_26;
  byte local_25;
  byte local_24;
  byte local_23;
  byte local_22;
  char local_21;
  byte *local_20;
  byte local_19;
  
  if (param_1 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_b8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_mcast_param",0x153);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_b8,"Null VSE pointer");
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_21 = param_1[2];
    local_20 = (byte *)(param_1 + 3);
    local_19 = *param_1 - 1;
LAB_0005141a:
    if (1 < local_19) {
      local_22 = *local_20;
      if (local_22 == 0) goto LAB_00051428;
      local_23 = local_20[1];
      pbVar3 = local_20 + 2;
      local_19 = (local_19 - local_22) - 1;
      if (local_23 == 5) {
        local_2a = *pbVar3;
        local_2b = local_20[3];
        local_2c = local_20[4];
        local_2d = local_20[5];
        local_2e = local_20[6];
        local_20 = local_20 + 7;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x199);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> FW Version[id:0x%x]:%d.%d.%d.%d.%d",local_23,local_2a
                         ,local_2b,local_2c,local_2d,local_2e);
        }
        goto LAB_0005141a;
      }
      if (local_23 < 6) {
        if (local_23 != 2) {
          if (local_23 < 3) {
            if (local_23 == 1) {
              local_24 = *pbVar3;
              local_20 = local_20 + 3;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                        ,"app_tm_vse_decode_mcast_param",0x176);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_b8,"=> Battery level[id:0x%x]:%d (%d%%)",local_23,
                               local_24,(int)((uint)local_24 * 100) >> 8);
              }
              goto LAB_0005141a;
            }
          }
          else {
            if (local_23 == 3) {
              local_26 = *pbVar3;
              local_27 = local_20[3];
              local_20 = local_20 + 4;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                        ,"app_tm_vse_decode_mcast_param",0x185);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_b8,"=> Model[id:0x%x]:0x%x 0x%x",local_23,local_26,
                               local_27);
              }
              goto LAB_0005141a;
            }
            if (local_23 == 4) {
              local_28 = *pbVar3;
              local_29 = local_20[3];
              local_20 = local_20 + 4;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                        ,"app_tm_vse_decode_mcast_param",0x18d);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_b8,"=> Vendor[id:0x%x]:0x%x 0x%x",local_23,local_28,
                               local_29);
              }
              goto LAB_0005141a;
            }
          }
LAB_000513c8:
          local_20 = pbVar3;
          iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_mcast_param",0x1b7);
          if (iVar1 != 0) {
            duss_log_print(0x5c,3,auStack_b8,"=> Unknown Report Id[id:0x%x] length:%d",local_23,
                           local_21);
          }
          goto LAB_0005141a;
        }
        local_25 = *pbVar3;
        local_20 = local_20 + 3;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x17d);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> RSSI level[id:0x%x]:%d",local_23,local_25);
        }
      }
      else if (local_23 == 7) {
        pbVar4 = local_33;
        local_20 = pbVar3;
        for (iVar1 = 0; iVar1 < 6; iVar1 = iVar1 + 1) {
          *pbVar4 = *local_20;
          pbVar4 = pbVar4 + -1;
          local_20 = local_20 + 1;
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x1a6);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> BdAddr[id:0x%x]:%02X:%02X:%02X:%02X:%02X:%02X",
                         local_23,local_38,local_37,local_36,local_35,local_34,local_33[0]);
        }
      }
      else if (local_23 < 7) {
        local_20 = pbVar3;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x19e);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> Button Press[id:0x%x]",local_23);
        }
      }
      else if (local_23 == 8) {
        local_20 = pbVar3;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x1b1);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> Reconnection Notification report[id:0x%x] length:%d",
                         local_23,local_22);
        }
        FUN_000503bc((char *)local_20,local_22 - 1);
      }
      else {
        if (local_23 != 0xff) goto LAB_000513c8;
        local_2f = *pbVar3;
        local_20 = local_20 + 3;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_b8,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_decode_mcast_param",0x1ad);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_b8,"=> Debug[id:0x%x]:%d.",local_23,local_2f);
        }
      }
      goto LAB_0005141a;
    }
LAB_00051428:
    uVar2 = 0;
  }
  return uVar2;
}



void FUN_00051432(byte *param_1)

{
  byte bVar1;
  int iVar2;
  undefined auStack_94 [129];
  byte local_13;
  byte local_12;
  byte local_11;
  short local_10;
  byte local_d;
  byte *local_c;
  
  local_c = param_1 + 2;
  local_d = *param_1;
  bVar1 = param_1[1];
  if (bVar1 == 0x25) {
    iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_param",0x1f6);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_94,"3D_MULTICAST_SYNC_TO");
    }
  }
  else if (bVar1 < 0x26) {
    if (bVar1 == 0x22) {
      local_10 = (ushort)param_1[3] * 0x100 + (ushort)*local_c;
      local_11 = param_1[4];
      local_12 = param_1[5];
      local_c = param_1 + 6;
      iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_decode_param",0x1e6);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_94,
                       "3D_FRAME_PERIOD Period:%d PeriodFraction:%d PeriodInitial:%d",local_10,
                       local_11,local_12);
      }
    }
    else if (bVar1 < 0x23) {
      if ((bVar1 == 0x21) &&
         (iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                    ,"app_tm_vse_decode_param",0x1dd), iVar2 != 0)) {
        duss_log_print(0x5c,3,auStack_94,"3D_MODE_CHANGE");
      }
    }
    else if (bVar1 == 0x23) {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_decode_param",0x1eb);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_94,"3D_CLOCK_SNAPSHOT");
      }
    }
    else if (bVar1 == 0x24) {
      local_13 = *local_c;
      local_c = param_1 + 3;
      iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_decode_param",0x1f1);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_94,"3D_MULTICAST_LOCK_CPLT LockStatus:%d",local_13);
      }
    }
  }
  else if (bVar1 == 0x30) {
    iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_param",0x1ff);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_94,"3D_MULTICAST_RX_DATA");
    }
    FUN_00050e48((char *)param_1);
  }
  else if (bVar1 < 0x31) {
    if (bVar1 == 0x29) {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_decode_param",0x1fa);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_94,"3D_EIR_HANDSHAKE_CPLT (Association Notification)");
      }
      FUN_000503bc((char *)local_c,local_d);
    }
  }
  else if (bVar1 == 0x54) {
    iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_param",0x205);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_94,"WLAN RESET notification!");
    }
  }
  else if (bVar1 == 0xf7) {
    iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_decode_param",0x209);
    if (iVar2 != 0) {
      duss_log_print(0x5c,3,auStack_94,"FW_CORE_DUMP");
    }
    if (DAT_0008c2e0 == '\0') {
      FUN_00051c50();
      FUN_00051f12(param_1 + 2,(uint)*param_1);
    }
    else {
      DAT_0008c2e0 = '\0';
      iVar2 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_decode_param",0x20f);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_94,"Writing FW Core Dump in %s","./fw_core_dump.log");
      }
      FUN_00051c2e();
      FUN_00051c50();
      FUN_00051e2a();
    }
    FUN_00051d40();
  }
  return;
}



void FUN_0005183c(char param_1,byte *param_2)

{
  int iVar1;
  undefined auStack_8c [131];
  char local_9;
  
  local_9 = '\0';
  if (param_2 == (byte *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_generic_callback",0x243);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"Null data pointer");
    }
  }
  else {
    if (DAT_0008c2d8 != (code *)0x0) {
      local_9 = (*DAT_0008c2d8)(param_1,param_2);
    }
    if (local_9 == '\0') {
      if (param_1 == '\0') {
        FUN_00051432(param_2);
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                  ,"app_tm_vse_generic_callback",0x25a);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_8c,"Unknown Event:%d received",param_1);
        }
      }
    }
  }
  return;
}



undefined4 FUN_00051930(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  int local_9c;
  undefined auStack_94 [128];
  undefined2 local_14 [2];
  undefined4 local_10;
  short local_a;
  
  local_9c = param_1;
  if (param_1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_register",0x277);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"Enter SubEvent to register");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_register",0x278);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"\t0..255 to register one SubEvent Only");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_register",0x279);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"\t65535 to register every SubEvents");
    }
    local_9c = FUN_0002f22c(&DAT_000701fc);
  }
  DAT_0008c2d8 = param_2;
  BSA_TmVseRegisterInit(local_14);
  local_10 = 0x5183d;
  local_14[0] = (undefined2)local_9c;
  local_a = BSA_TmVseRegister(local_14);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_register",0x28c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_TmVseRegister failed:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00051aae(int param_1,char param_2)

{
  int iVar1;
  undefined4 uVar2;
  int local_94;
  undefined auStack_90 [128];
  undefined2 local_10;
  char local_e;
  short local_a;
  
  local_94 = param_1;
  if (param_1 < 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_deregister",0x2a7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Enter SubEvent to deregister");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_deregister",0x2a8);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"\t0..255 to deregister one SubEvent Only");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_deregister",0x2a9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"\t65535 to deregister every SubEvents");
    }
    local_94 = FUN_0002f22c(&DAT_000701fc);
  }
  if (param_2 != '\0') {
    DAT_0008c2d8 = 0;
  }
  BSA_TmVseDeregisterInit(&local_10);
  local_10 = (undefined2)local_94;
  local_e = param_2;
  local_a = BSA_TmVseDeregister(&local_10);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_deregister",0x2ba);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_TmVseDeregister failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00051c2e(void)

{
  unlink("./fw_core_dump.log");
  DAT_0008c2dc = 0;
  return 0;
}



undefined4 FUN_00051c50(void)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined auStack_88 [128];
  
  if (DAT_0008c2dc == (FILE *)0x0) {
    DAT_0008c2dc = fopen("./fw_core_dump.log","a");
    if (DAT_0008c2dc == (FILE *)0x0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_fw_core_dump_open",0x2e9);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        duss_log_print(0x5c,1,auStack_88,"fopen(%s) failed (errno:%d)","./fw_core_dump.log",*piVar2)
        ;
      }
      uVar3 = 0xffffffff;
    }
    else {
      uVar3 = 0;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_88,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_fw_core_dump_open",0x2e2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_88,"FW Core Dump file:%s was already open","./fw_core_dump.log")
      ;
    }
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 FUN_00051d40(void)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined auStack_8c [128];
  int local_c;
  
  if (DAT_0008c2dc == (FILE *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_fw_core_dump_close",0x301);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"FW Core Dump file:%s is not opened","./fw_core_dump.log");
    }
    uVar3 = 1;
  }
  else {
    local_c = fclose(DAT_0008c2dc);
    DAT_0008c2dc = (FILE *)0x0;
    if (local_c < 0) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                                ,"app_tm_vse_fw_core_dump_close",0x309);
      if (iVar1 != 0) {
        piVar2 = __errno_location();
        duss_log_print(0x5c,1,auStack_8c,"Unable to close:%s (errno:%d)","./fw_core_dump.log",
                       *piVar2);
      }
      uVar3 = 0xffffffff;
    }
    else {
      uVar3 = 0;
    }
  }
  return uVar3;
}



undefined4 FUN_00051e2a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_18c [128];
  char acStack_10c [200];
  tm tStack_44;
  timeval tStack_18;
  
  if (DAT_0008c2dc == (FILE *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_18c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_fw_core_dump_write_header",0x324);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_18c,"FW Core Dump file:%s not open","./fw_core_dump.log");
    }
    uVar2 = 1;
  }
  else {
    gettimeofday(&tStack_18,(__timezone_ptr_t)0x0);
    localtime_r(&tStack_18.tv_sec,&tStack_44);
    strftime(acStack_10c,200,"%d/%m/%y  %H:%M:%S",&tStack_44);
    fwrite("#\n# FW Core Dump Generated\n",1,0x1b,DAT_0008c2dc);
    fprintf(DAT_0008c2dc,"#\n# Date (d/m/y) %s.%03d\n#\n",acStack_10c,tStack_18.tv_usec / 1000);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 FUN_00051f12(byte *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  byte *local_194;
  undefined auStack_190 [128];
  char acStack_110 [200];
  tm tStack_48;
  timeval tStack_1c;
  uint local_14;
  
  if (DAT_0008c2dc == (FILE *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vse.c"
                              ,"app_tm_vse_fw_core_dump_write_data",0x34b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_190,"FW Core Dump file:%s not open","./fw_core_dump.log");
    }
    uVar3 = 1;
  }
  else {
    gettimeofday(&tStack_1c,(__timezone_ptr_t)0x0);
    localtime_r(&tStack_1c.tv_sec,&tStack_48);
    strftime(acStack_110,200,"%d/%m/%y  %H:%M:%S",&tStack_48);
    iVar2 = param_2 + 1;
    iVar1 = iVar2;
    fprintf(DAT_0008c2dc,"\nusb0: %s.%03d\nHCIEvent\n{[FF %02X]:\n",acStack_110,
            tStack_1c.tv_usec / 1000,iVar2);
    local_194 = param_1;
    for (local_14 = 0; (int)local_14 < iVar2; local_14 = local_14 + 1) {
      if (local_14 == 0) {
        fwrite(&DAT_000703d4,1,3,DAT_0008c2dc);
      }
      else {
        if ((local_14 & 0x1f) == 0) {
          fputc(10,DAT_0008c2dc);
        }
        fprintf(DAT_0008c2dc," %02X",(uint)*local_194,(uint)*local_194,iVar1);
        local_194 = local_194 + 1;
      }
    }
    fwrite("}\n\n#----------------------------------------------------------------------------\n",1,
           0x51,DAT_0008c2dc);
    uVar3 = 0;
  }
  return uVar3;
}



undefined4
FUN_0005209c(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
            undefined param_5,undefined param_6,undefined param_7)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a0 [128];
  undefined2 local_120;
  undefined2 local_11e;
  undefined local_11a;
  undefined local_119;
  undefined local_118;
  undefined local_117;
  undefined local_116;
  undefined local_115;
  undefined local_114;
  undefined auStack_113 [251];
  undefined *local_18;
  short local_12;
  
  local_12 = BSA_TmVscInit(&local_120);
  local_120 = 0x14;
  local_11e = 7;
  local_116 = param_5;
  local_115 = param_6;
  local_18 = auStack_113;
  local_114 = param_7;
  local_11a = param_1;
  local_119 = param_2;
  local_118 = param_3;
  local_117 = param_4;
  local_12 = BSA_TmVsc(&local_120);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_set_tx_carrier_frequency",0x44);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a0,"BSA_TmVsc failed:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000521cc(undefined *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a4 [128];
  undefined2 local_124;
  ushort local_122;
  short local_120;
  undefined local_11d;
  undefined local_11c;
  undefined local_11b;
  undefined local_11a;
  undefined local_119;
  byte local_118;
  byte local_117;
  byte local_116;
  byte local_115;
  byte local_114;
  byte local_113;
  undefined local_112;
  undefined local_111;
  undefined local_110;
  undefined auStack_10f [242];
  undefined local_1d;
  short local_1c;
  short local_1a;
  short local_18;
  undefined local_15;
  undefined local_14;
  undefined local_13;
  undefined local_12;
  undefined local_11;
  undefined *local_10;
  short local_c;
  undefined local_a;
  undefined local_9;
  
  local_c = BSA_TmVscInit(&local_124);
  local_124 = 0xc3;
  local_122 = 0;
  local_c = BSA_TmVsc(&local_124);
  if (local_c == 0) {
    local_11 = local_11d;
    local_12 = local_11c;
    local_13 = local_11b;
    local_14 = local_11a;
    local_15 = local_119;
    local_18 = (ushort)local_117 * 0x100 + (ushort)local_118;
    local_1a = (ushort)local_115 * 0x100 + (ushort)local_116;
    local_1c = (ushort)local_113 * 0x100 + (ushort)local_114;
    local_1d = local_112;
    local_10 = &local_111;
    if (local_122 < 0xe) {
      local_9 = 0;
      local_a = 0;
    }
    else {
      local_9 = local_111;
      local_a = local_110;
      local_10 = auStack_10f;
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x82);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"VSC BFC read params complete:");
    }
    if (local_120 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_bfc_read_params",0x89);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"    status: successful");
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_bfc_read_params",0x85);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"    status: failed(%d)",local_120);
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x8b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    BFC Enable           : %d",local_11);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x8c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Frequency1           : %d",local_12);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x8d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Frequency2           : %d",local_13);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x8e);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Frequency3           : %d",local_14);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x8f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    AccessCode length    : %d",local_15);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x90);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Host scan interval   : %d",local_18);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x91);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Host trigger timeout : %d",local_1a);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x92);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    HID scan interval    : %d",local_1c);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x93);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    HID scan retry       : %d",local_1d);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x94);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Don\'t disturb        : %d",local_9);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x95);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,"    Wake Up mask         : %d",local_a);
    }
    if (param_1 != (undefined *)0x0) {
      *param_1 = local_11;
      param_1[1] = local_12;
      param_1[2] = local_13;
      param_1[3] = local_14;
      param_1[4] = local_15;
      *(short *)(param_1 + 6) = local_18;
      *(short *)(param_1 + 8) = local_1a;
      *(short *)(param_1 + 10) = local_1c;
      param_1[0xc] = local_1d;
      param_1[0xd] = local_9;
      param_1[0xe] = local_a;
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_read_params",0x67);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a4,"BSA_TmVsc failed:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000527f0(undefined *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  undefined local_112;
  undefined local_111;
  undefined local_110;
  undefined local_10f;
  undefined local_10e;
  undefined local_10d;
  undefined local_10c;
  undefined local_10b;
  undefined local_10a;
  undefined local_109;
  undefined local_108;
  undefined local_107;
  undefined local_106;
  undefined local_105;
  undefined auStack_104 [244];
  undefined *local_10;
  short local_a;
  
  if (param_1 == (undefined *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xbc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"Null parameter");
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"Write TBFC Parameters");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    BFC Enable           : %d",*param_1);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Frequency1           : %d",param_1[1]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Frequency2           : %d",param_1[2]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc4);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Frequency3           : %d",param_1[3]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc5);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    AccessCode length    : %d",param_1[4]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Host scan interval   : %d",*(undefined2 *)(param_1 + 6)
                    );
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",199);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Host trigger timeout : %d",*(undefined2 *)(param_1 + 8)
                    );
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",200);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    HID scan interval    : %d",
                     *(undefined2 *)(param_1 + 10));
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xc9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    HID scan retry       : %d",param_1[0xc]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xca);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Don\'t disturb        : %d",param_1[0xd]);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_bfc_write_params",0xcb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_198,"    Wake Up mask         : %d",param_1[0xe]);
    }
    local_a = BSA_TmVscInit(&local_118);
    local_118 = 0xc2;
    local_116 = 0xe;
    local_112 = *param_1;
    local_111 = param_1[1];
    local_110 = param_1[2];
    local_10f = param_1[3];
    local_10e = param_1[4];
    local_10d = (undefined)*(undefined2 *)(param_1 + 6);
    local_10c = (undefined)((ushort)*(undefined2 *)(param_1 + 6) >> 8);
    local_10b = (undefined)*(undefined2 *)(param_1 + 8);
    local_10a = (undefined)((ushort)*(undefined2 *)(param_1 + 8) >> 8);
    local_109 = (undefined)*(undefined2 *)(param_1 + 10);
    local_108 = (undefined)((ushort)*(undefined2 *)(param_1 + 10) >> 8);
    local_107 = param_1[0xc];
    local_106 = param_1[0xd];
    local_10 = auStack_104;
    local_105 = param_1[0xe];
    local_a = BSA_TmVsc(&local_118);
    if (local_a == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_bfc_write_params",0xe3);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_198,"BSA_TmVsc failed:%d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00052d4e(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  undefined auStack_194 [128];
  undefined2 local_114;
  ushort local_112;
  undefined local_10e;
  undefined local_10d;
  undefined local_10c;
  undefined local_10b;
  undefined local_10a;
  undefined local_109;
  undefined local_108;
  undefined local_107;
  undefined local_106;
  undefined local_105;
  undefined local_104;
  undefined local_103;
  undefined local_102;
  undefined local_101;
  undefined local_100;
  undefined local_ff;
  undefined auStack_fe [240];
  short local_e;
  undefined *local_c;
  
  if (param_1 == (char *)0x0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_194,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_write_collaboration_mode",0xff);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_194,"Null parameter");
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_194,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_write_collaboration_mode",0x103);
    if (iVar1 != 0) {
      if (*param_1 == '\0') {
        pcVar3 = "Disabled";
      }
      else {
        pcVar3 = "Enabled";
      }
      duss_log_print(0x5c,3,auStack_194,"Write Collaboration %s",pcVar3);
    }
    local_e = BSA_TmVscInit(&local_114);
    local_114 = 0x41;
    if (*param_1 == '\0') {
      local_10e = 0x80;
    }
    else {
      local_10e = 0x82;
    }
    local_10d = 0;
    local_10c = 0x1f;
    local_10b = 5;
    local_10a = 0xc9;
    local_109 = 0;
    local_108 = 0;
    local_107 = 0xfa;
    local_106 = 0;
    local_105 = 0;
    local_104 = 0x40;
    local_103 = 0x93;
    local_102 = 0;
    local_101 = 0;
    local_100 = 0;
    local_c = auStack_fe;
    local_ff = 0;
    local_112 = (short)local_c - (short)&local_10e & 0xff;
    local_e = BSA_TmVsc(&local_114);
    if (local_e == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_194,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_write_collaboration_mode",0x136);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_194,"BSA_TmVsc failed:%d",local_e);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00052faa(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_190 [128];
  undefined2 local_110;
  undefined2 local_10e;
  undefined auStack_10a [256];
  short local_a;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_190,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_read_collaboration_mode",0x14e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_190,"Read Collaboration");
  }
  local_a = BSA_TmVscInit(&local_110);
  local_110 = 0x40;
  local_10e = 0;
  local_a = BSA_TmVsc(&local_110);
  if (local_a == 0) {
    scru_dump_hex(auStack_10a,"WLAN Coexistence parameters",local_10e,0,5);
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_read_collaboration_mode",0x159);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_190,"BSA_TmVsc failed:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0005309a(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  short local_114;
  undefined local_112;
  undefined auStack_111 [257];
  undefined *local_10;
  short local_a;
  
  local_a = BSA_TmVscInit(&local_118);
  local_118 = 0x3b;
  local_116 = 1;
  local_112 = param_1 != 0;
  local_10 = auStack_111;
  local_a = BSA_TmVsc(&local_118);
  if (local_a == 0) {
    if (local_114 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_enable_uhe",0x192);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_198,"Bad HCI Return code");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_enable_uhe",0x187);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"Unable to Send VSC status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000531b8(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_190 [128];
  undefined2 local_110;
  undefined2 local_10e;
  short local_10c;
  undefined local_10a;
  short local_a;
  
  local_a = BSA_TmVscInit(&local_110);
  local_110 = 0xfa;
  local_10e = 1;
  local_10a = param_1;
  local_a = BSA_TmVsc(&local_110);
  if (local_a == 0) {
    if (local_10c == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_control_llr_scan",0x1bd);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_190,"Bad HCI Return code");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_control_llr_scan",0x1b2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_190,"Unable to Send VSC status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000532b2(int param_1,char param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a0 [128];
  undefined2 local_120;
  undefined2 local_11e;
  undefined local_11a;
  char local_118;
  short local_18;
  undefined auStack_16 [8];
  undefined2 local_e;
  short local_a;
  
  BSA_TmGetHandleInit(&local_18);
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_set_tx_power",0x1da);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a0,"BD address is not correct");
    }
    uVar2 = 0xffffffff;
  }
  else {
    bdcpy(auStack_16,param_1);
    BSA_TmGetHandle(&local_18);
    if (local_18 == 0) {
      local_a = BSA_TmVscInit(&local_120);
      local_120 = 0x26;
      local_11e = 3;
      local_11a = (undefined)local_e;
      local_118 = param_2;
      local_a = BSA_TmVsc(&local_120);
      if (local_a == 0) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_set_tx_power",0x1fb);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a0,"\tStatus:                   %d",local_a);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_set_tx_power",0x1fc);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a0,"\tConnection handle:        0x%02X (%d)",local_e,
                         local_e);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_set_tx_power",0x1fd);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a0,"\tSet Tranmsit Power Level: %d (dBm)",(int)param_2);
        }
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_set_tx_power",0x1f6);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1a0,"Unable to Send VSC status:%d",local_a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_set_tx_power",0x1e6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a0,"\tBad parameter (err=%d)",local_18);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00053516(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  short local_114;
  undefined local_112;
  undefined auStack_111 [257];
  undefined *local_10;
  short local_a;
  
  local_a = BSA_TmVscInit(&local_118);
  local_118 = 0x2b;
  local_116 = 1;
  local_10 = auStack_111;
  local_112 = param_1;
  local_a = BSA_TmVsc(&local_118);
  if (local_a == 0) {
    if (local_114 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_write_rcv_only",0x235);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_198,"Bad HCI Return code");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_write_rcv_only",0x223);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"Unable to Send VSC status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



// WARNING: Restarted to delay deadcode elimination for space: stack

undefined4 FUN_00053624(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1b0 [129];
  undefined local_12f;
  undefined2 local_12e;
  undefined2 local_12c;
  undefined2 local_12a;
  ushort local_126;
  byte local_124;
  char local_123 [2];
  undefined local_121;
  short local_24;
  undefined auStack_22 [8];
  char local_1a;
  char *local_18;
  undefined local_11;
  short local_10;
  char local_d;
  short local_c;
  undefined local_9;
  
  local_12e = 0;
  local_12f = 0;
  local_9 = 0;
  local_c = 0;
  local_d = 0;
  BSA_TmGetHandleInit(&local_24);
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_read_tx_power",0x25a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1b0,"BD address is not correct");
    }
    uVar2 = 0xffffffff;
  }
  else {
    bdcpy(auStack_22,param_1);
    BSA_TmGetHandle(&local_24);
    if (local_24 == 0) {
      local_10 = BSA_TmVscInit(&local_12c);
      local_11 = 6;
      local_12e = 0xc2d;
      local_12f = 3;
      local_12c = 0xa3;
      local_12a = 6;
      local_126 = 0xc2d;
      local_124 = 3;
      local_123[0] = local_1a;
      local_121 = 0;
      local_10 = BSA_TmVsc(&local_12c);
      if (local_10 == 0) {
        local_9 = (undefined)local_126;
        local_c = (ushort)local_124 * 0x100 + (local_126 >> 8);
        local_18 = local_123;
        local_d = local_123[0];
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_read_tx_power",0x285);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1b0,"\tStatus:               %d",local_9);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_read_tx_power",0x286);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1b0,"\tConnection handle:    0x%02X (%d)",local_c,local_c);
        }
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_read_tx_power",0x287);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1b0,"\tTranmsit Power Level: %d (dBm)",(int)local_d);
        }
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1b0,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_read_tx_power",0x27b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1b0,"Unable to Send VSC status:%d",local_10);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_read_tx_power",0x266);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1b0,"\tBad handle parameter (err=%d)",local_24);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00053922(char param_1,byte param_2,undefined param_3,undefined param_4)

{
  int iVar1;
  undefined4 uVar2;
  byte local_1a2;
  undefined auStack_1a0 [128];
  undefined2 local_120;
  ushort local_11e;
  byte local_11a;
  undefined local_119;
  undefined local_118;
  undefined auStack_117 [255];
  undefined *local_18;
  short local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_1a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_config_gpio",0x29e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_1a0,"app_tm_vsc_config_gpio pin:%d value:%d",param_2,param_4);
  }
  local_12 = BSA_TmVscInit(&local_120);
  local_120 = 0x19;
  local_1a2 = param_2;
  if (param_1 != '\0') {
    local_1a2 = param_2 | 0x80;
  }
  local_11a = local_1a2;
  local_18 = auStack_117;
  local_11e = (short)local_18 - (short)&local_11a & 0xff;
  local_119 = param_3;
  local_118 = param_4;
  local_12 = BSA_TmVsc(&local_120);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_config_gpio",0x2b3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a0,"BSA_TmVsc failed:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00053a86(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined *puVar3;
  undefined auStack_1b0 [128];
  undefined local_130;
  undefined local_12f;
  undefined local_12e;
  undefined local_12d;
  undefined local_12c;
  undefined local_12b [3];
  undefined2 local_128;
  ushort local_126;
  short local_124;
  undefined local_122;
  undefined local_121 [3];
  byte local_11e;
  undefined local_11d [254];
  undefined local_1f;
  ushort local_1e;
  undefined *local_1c;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_read_otp",0x2cd);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_1b0,"app_tm_vsc_read_otp");
  }
  local_1e = BSA_TmVscInit(&local_128);
  local_128 = 0xf3;
  local_1f = 5;
  local_1c = local_121;
  local_122 = 5;
  local_126 = (short)local_1c - (short)&local_122 & 0xff;
  local_1e = BSA_TmVsc(&local_128);
  if (local_1e == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_read_otp",0x2e2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1b0,"VSC OTP read complete:");
    }
    if (local_124 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_read_otp",0x2ea);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1b0,"    status: successful");
      }
      scru_dump_hex(&local_122,"Read OTP",local_126,0,5);
      local_1e = (ushort)local_11e;
      puVar3 = local_12b;
      local_1c = local_11d;
      for (iVar1 = 0; iVar1 < 6; iVar1 = iVar1 + 1) {
        *puVar3 = *local_1c;
        puVar3 = puVar3 + -1;
        local_1c = local_1c + 1;
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_read_otp",0x2f6);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1b0,"\tBdAddr:  %02X-%02X-%02X-%02X-%02X-%02X",local_130,
                       local_12f,local_12e,local_12d,local_12c,local_12b[0]);
      }
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1b0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_read_otp",0x2e5);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1b0,"    status: failed(%d)",local_124);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1b0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_read_otp",0x2de);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1b0,"BSA_TmVsc failed:%d",local_1e);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00053d7e(void)

{
  undefined *puVar1;
  int iVar2;
  undefined4 uVar3;
  undefined auStack_1a8 [128];
  undefined auStack_128 [8];
  undefined2 local_120;
  undefined2 local_11e;
  undefined local_11a;
  undefined local_119 [258];
  undefined local_17;
  short local_16;
  undefined *local_14;
  
  iVar2 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_write_otp",0x30f);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_1a8,"app_tm_vsc_write_otp");
  }
  iVar2 = duss_log_gen_head(0x5c,3,auStack_1a8,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_write_otp",0x311);
  if (iVar2 != 0) {
    duss_log_print(0x5c,3,auStack_1a8,"Enter the printer BD address(AA.BB.CC.DD.EE.FF): ");
  }
  iVar2 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",auStack_128,auStack_128 + 1,auStack_128 + 2,
                auStack_128 + 3,auStack_128 + 4,auStack_128 + 5);
  if (iVar2 == 6) {
    local_16 = BSA_TmVscInit(&local_120);
    local_120 = 0xf3;
    local_17 = 4;
    local_14 = local_119;
    local_11a = 4;
    for (iVar2 = 0; iVar2 < 6; iVar2 = iVar2 + 1) {
      puVar1 = local_14 + 1;
      *local_14 = auStack_128[5 - iVar2];
      local_14 = puVar1;
    }
    local_11e = 0x2a;
    local_16 = BSA_TmVsc(&local_120);
    if (local_16 == 0) {
      uVar3 = 0;
    }
    else {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_write_otp",0x32c);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_1a8,"BSA_TmVsc failed:%d",local_16);
      }
      uVar3 = 0xffffffff;
    }
  }
  else {
    iVar2 = duss_log_gen_head(0x5c,1,auStack_1a8,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_write_otp",0x318);
    if (iVar2 != 0) {
      duss_log_print(0x5c,1,auStack_1a8,"BD address not entered correctly");
    }
    uVar3 = 0xffffffff;
  }
  return uVar3;
}



undefined4 FUN_00053f4e(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  undefined local_112;
  undefined local_111;
  undefined local_110;
  undefined local_10f;
  undefined local_10e;
  short local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x344);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"app_tm_vsc_configure_pcm");
  }
  local_12 = BSA_TmVscInit(&local_118);
  local_118 = 0x1c;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x353);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte0 -- 0 for PCM, 1 for transport, 2 for codec, 3 for I2S")
    ;
  }
  iVar1 = FUN_0002f22c("Byte0:");
  local_112 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x355);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,
                   "Byte1 -- 0 for 128 KHz, 1 for 256, 2 for 512, 3 for 1024, 4 for 2048");
  }
  iVar1 = FUN_0002f22c("Byte1:");
  local_111 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x357);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte2 -- 0 for short frame sync, 1 for long");
  }
  iVar1 = FUN_0002f22c("Byte2");
  local_110 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x359);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte3 -- 0 for slave role, 1 for master role for SYNC pin");
  }
  iVar1 = FUN_0002f22c("Byte3");
  local_10f = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x35b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte4 -- 0 for slave role, 1 for master role for CLK pin");
  }
  iVar1 = FUN_0002f22c("Byte4");
  local_10e = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_sco",0x361);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"app_tm_vsc_configure_sco {%d, %d, %d, %d, %d}",local_112,
                   local_111,local_110,local_10f,local_10e);
  }
  local_116 = 5;
  local_12 = BSA_TmVsc(&local_118);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_configure_sco",0x369);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"BSA_TmVsc failed:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00054232(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_198 [128];
  undefined2 local_118;
  undefined2 local_116;
  undefined local_112;
  undefined local_111;
  undefined local_110;
  undefined local_10f;
  undefined local_10e;
  short local_12;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x381);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"app_tm_vsc_configure_pcm");
  }
  local_12 = BSA_TmVscInit(&local_118);
  local_118 = 0x1e;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x393);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte0 LSB_First -- 0 for MSb first");
  }
  iVar1 = FUN_0002f22c("Byte0:");
  local_112 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x395);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,
                   "Byte1 Fill value(0-1) -- Specified the value with which to fill unused bits if")
    ;
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x396);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"\tFill option is set to programmable.");
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x397);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"\tUse 0x0 for programmed fill bits");
  }
  iVar1 = FUN_0002f22c("Byte1:");
  local_111 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x399);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,
                   "Byte2 Fill option(0-3) -- Specifies the method of filling unused data bits values"
                  );
  }
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x39a);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"\t0x0:0\'s, 0x1:1\'s, 0x2:signed, 0x3:programmable");
  }
  iVar1 = FUN_0002f22c("Byte2");
  local_110 = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x39c);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"Byte3 Fill bits(0-3)   -- Fill all 3 bits.");
  }
  iVar1 = FUN_0002f22c("Byte3");
  local_10f = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x39e);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,
                   "Byte4 Right justify    -- Use left justify(fill data shifted lout last)");
  }
  iVar1 = FUN_0002f22c("Byte4");
  local_10e = (undefined)iVar1;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_198,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_configure_pcm",0x3a4);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_198,"app_tm_vsc_configure_pcm {%d, %d, %d, %d, %d}",local_112,
                   local_111,local_110,local_10f,local_10e);
  }
  local_116 = 5;
  local_12 = BSA_TmVsc(&local_118);
  if (local_12 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_198,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_configure_pcm",0x3ac);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_198,"BSA_TmVsc failed:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000545d0(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a4 [128];
  short local_124;
  undefined uStack_122;
  undefined uStack_121;
  undefined uStack_120;
  undefined uStack_11f;
  undefined uStack_11e;
  undefined uStack_11d;
  char local_11c;
  undefined2 local_11a;
  undefined2 local_118;
  undefined2 local_116;
  undefined local_112;
  undefined local_111;
  undefined local_110;
  undefined auStack_10f [255];
  undefined *local_10;
  short local_c;
  undefined local_9;
  
  iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_set_connection_priority",0x3c9);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_1a4,"app_tm_vsc_set_connection_priority");
  }
  BSA_TmGetHandleInit(&local_124);
  iVar1 = FUN_0002f22c("Select transport 1:BR_EDR, 2:LE");
  local_11c = (char)iVar1;
  if ((local_11c == '\x01') || (local_11c == '\x02')) {
    iVar1 = FUN_0002f22c("Priority 0:Normal, 1:High");
    local_9 = (undefined)iVar1;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_set_connection_priority",0x3d7);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_1a4,
                     "Enter the BD address of remote connected device(AA:BB:CC:DD:EE:FF): ");
    }
    iVar1 = scanf("%hhx:%hhx:%hhx:%hhx:%hhx:%hhx",&uStack_122,&uStack_121,&uStack_120,&uStack_11f,
                  &uStack_11e,&uStack_11d);
    if (iVar1 == 6) {
      BSA_TmGetHandle(&local_124);
      if (local_124 == 0) {
        local_c = BSA_TmVscInit(&local_118);
        local_118 = 0x57;
        local_112 = (undefined)local_11a;
        local_111 = (undefined)((ushort)local_11a >> 8);
        local_10 = auStack_10f;
        local_110 = local_9;
        local_116 = 3;
        local_c = BSA_TmVsc(&local_118);
        if (local_c == 0) {
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                    ,"app_tm_vsc_set_connection_priority",0x3f6);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_1a4,"BSA_TmVsc failed:%d",local_c);
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                  ,"app_tm_vsc_set_connection_priority",0x3e5);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_1a4,"\tBad parameter (err=%d)",local_124);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_set_connection_priority",0x3de);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1a4,"BD address not entered correctly");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_set_connection_priority",0x3d1);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a4,"Wrong Transport value:%d",local_11c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0005489a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1c0 [130];
  undefined2 local_13e;
  undefined2 local_13c;
  undefined2 local_138;
  undefined2 local_136;
  undefined local_132;
  undefined local_131;
  undefined local_130;
  undefined local_12f;
  undefined local_12e;
  undefined local_12d;
  undefined local_12c;
  undefined local_12b;
  undefined local_12a;
  undefined local_129;
  undefined local_128;
  undefined local_127;
  undefined local_126;
  undefined local_125;
  undefined local_124;
  undefined local_123;
  undefined local_122;
  undefined local_121;
  undefined local_120;
  undefined local_11f;
  undefined local_11e;
  undefined local_11d;
  undefined local_11c;
  undefined local_11b;
  undefined local_11a;
  undefined local_119;
  undefined local_118;
  undefined local_117;
  undefined local_116;
  undefined local_115;
  undefined local_114;
  undefined local_113;
  undefined auStack_112 [226];
  undefined *local_30;
  short local_2c;
  byte local_29;
  undefined2 local_28;
  undefined local_26;
  undefined local_25;
  undefined local_24;
  undefined local_23;
  undefined local_22;
  undefined local_21;
  undefined2 local_20;
  undefined local_1e;
  undefined local_1d;
  undefined local_1c;
  undefined local_1b;
  undefined local_1a;
  undefined local_19;
  undefined local_18;
  undefined local_17;
  undefined2 local_16;
  undefined local_14;
  undefined local_13;
  undefined local_12;
  undefined local_11;
  undefined4 local_10;
  undefined local_a;
  undefined local_9;
  
  local_13c = 0x1b00;
  local_9 = 0x78;
  local_a = 0x1e;
  local_10 = 0x3fffff;
  local_11 = 5;
  local_12 = 3;
  local_13 = 0x1f;
  local_14 = 0xc;
  local_16 = 0x1c2;
  local_17 = 0x50;
  local_18 = 0x50;
  local_19 = 0xae;
  local_1a = 0x38;
  local_1b = 0xba;
  local_1c = 10;
  local_1d = 5;
  local_1e = 0;
  local_20 = 0xffff;
  local_21 = 7;
  local_22 = 0xe3;
  local_23 = 0x32;
  local_24 = 0;
  local_25 = 0x7f;
  local_26 = 0xa8;
  local_28 = 0xffc6;
  iVar1 = duss_log_gen_head(0x5c,3,auStack_1c0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                            ,"app_tm_vsc_set_afh_behavior",0x447);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_1c0,"app_tm_vsc_set_afh_behavior");
  }
  iVar1 = FUN_0002f22c("log 0:No log, 1:RSSI log, 2:CC log, 3:RSSI and CC log");
  local_29 = (byte)iVar1;
  if (local_29 < 4) {
    local_13c = CONCAT11(local_13c._1_1_,(byte)local_13c & 0xfc | local_29 & 3);
    local_13e = local_13c;
    local_2c = BSA_TmVscInit(&local_138);
    local_138 = 0x32;
    local_132 = (undefined)local_13e;
    local_131 = (undefined)((ushort)local_13e >> 8);
    local_130 = local_9;
    local_12f = local_a;
    local_12e = (undefined)local_10;
    local_12d = (undefined)((uint)local_10 >> 8);
    local_12c = (undefined)((uint)local_10 >> 0x10);
    local_12b = (undefined)((uint)local_10 >> 0x18);
    local_12a = local_11;
    local_129 = local_12;
    local_128 = local_13;
    local_127 = local_14;
    local_126 = (undefined)local_16;
    local_125 = (undefined)((ushort)local_16 >> 8);
    local_124 = local_17;
    local_123 = local_18;
    local_122 = local_19;
    local_121 = local_1a;
    local_120 = local_1b;
    local_11f = local_1c;
    local_11e = local_1d;
    local_11d = local_1e;
    local_11c = (undefined)local_20;
    local_11b = (undefined)((ushort)local_20 >> 8);
    local_11a = local_21;
    local_119 = local_22;
    local_118 = local_23;
    local_117 = local_24;
    local_116 = local_25;
    local_115 = local_26;
    local_114 = (undefined)local_28;
    local_30 = auStack_112;
    local_113 = (undefined)((ushort)local_28 >> 8);
    local_136 = 0x20;
    local_2c = BSA_TmVsc(&local_138);
    if (local_2c == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1c0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                                ,"app_tm_vsc_set_afh_behavior",0x479);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1c0,"BSA_TmVsc failed:%d",local_2c);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1c0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm_vsc.c"
                              ,"app_tm_vsc_set_afh_behavior",0x44c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1c0,"wrong value :%d",local_29);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00054d50(undefined param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined local_c [2];
  short local_a;
  
  local_a = BSA_TmSetTestModeInit(local_c);
  local_c[0] = param_1;
  local_a = BSA_TmSetTestMode(local_c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_test_mode",0x3f);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"BSA_TmSetTestMode failed mode_requested:%d status:%d",
                     param_1,local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00054de4(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_90 [128];
  undefined uStack_10;
  undefined uStack_f;
  undefined uStack_e;
  undefined uStack_d;
  undefined uStack_c;
  undefined auStack_b [3];
  
  BSA_TmDisconnectInit(&uStack_10);
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_disconnect",0x59);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_90,"Enter the BD address to disconnect(AA.BB.CC.DD.EE.FF): ");
    }
    iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",&uStack_10,&uStack_f,&uStack_e,&uStack_d,&uStack_c
                  ,auStack_b);
    if (iVar1 != 6) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_disconnect",0x60);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_90,"BD address not entered correctly");
      }
      return 0xffffffff;
    }
  }
  else {
    bdcpy(&uStack_10,param_1);
  }
  iVar1 = BSA_TmDisconnect(&uStack_10);
  if (iVar1 == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_90,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_disconnect",0x6a);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_90,"BSA_TmDisconnect failed");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00054f2a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_a0 [128];
  undefined uStack_20;
  undefined uStack_1f;
  undefined uStack_1e;
  undefined uStack_1d;
  undefined uStack_1c;
  undefined uStack_1b;
  undefined local_1a;
  undefined local_19;
  int local_18;
  int local_14;
  int local_10;
  int local_c;
  
  BSA_TmQosInit(&uStack_20);
  iVar1 = FUN_0002f22c(&DAT_0007127c);
  local_1a = (undefined)iVar1;
  iVar1 = FUN_0002f22c("service_type");
  local_19 = (undefined)iVar1;
  local_18 = FUN_0002f22c("token_rate");
  local_14 = FUN_0002f22c("peak_bandwidth");
  local_10 = FUN_0002f22c("latency");
  local_c = FUN_0002f22c("delay_variation");
  iVar1 = duss_log_gen_head(0x5c,3,auStack_a0,0x80,
                            "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                            ,"app_tm_qos_setup",0x8b);
  if (iVar1 != 0) {
    duss_log_print(0x5c,3,auStack_a0,"Enter the BD address to configure QoS (AA.BB.CC.DD.EE.FF): ");
  }
  iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",&uStack_20,&uStack_1f,&uStack_1e,&uStack_1d,
                &uStack_1c,&uStack_1b);
  if (iVar1 == 6) {
    iVar1 = BSA_TmQos(&uStack_20);
    if (iVar1 == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_qos_setup",0x98);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_a0,"BSA_TmQos failed");
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_qos_setup",0x92);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_a0,"BD address not entered correctly");
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000550c0(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_94 [128];
  undefined uStack_14;
  undefined uStack_13;
  undefined uStack_12;
  undefined uStack_11;
  undefined uStack_10;
  undefined uStack_f;
  char local_e;
  undefined2 local_c;
  short local_a;
  
  BSA_TmReadRawRssiInit(&uStack_14);
  if (param_1 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc_read_raw_rssi",0xb3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,
                     "Enter the BD address of remote connected device(AA:BB:CC:DD:EE:FF): ");
    }
    iVar1 = scanf("%hhx:%hhx:%hhx:%hhx:%hhx:%hhx",&uStack_14,&uStack_13,&uStack_12,&uStack_11,
                  &uStack_10,&uStack_f);
    if (iVar1 != 6) {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_vsc_read_raw_rssi",0xba);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_94,"BD address not entered correctly");
      }
      return 0xffffffff;
    }
  }
  else {
    bdcpy(&uStack_14,param_1);
  }
  local_a = BSA_TmReadRawRssi(&uStack_14);
  if (local_a == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc_read_raw_rssi",0xca);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"\tStatus:\t\t\tSuccess");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc_read_raw_rssi",0xcb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"\tRSSI:\t\t\t%d (dB)",(int)local_e);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc_read_raw_rssi",0xcd);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_94,"\tConnection handle:\t0x%02X (%d)",local_c,local_c);
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_94,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc_read_raw_rssi",0xc6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_94,"BSA_TmReadRawRssi failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000552e8(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a4 [128];
  undefined2 local_124;
  undefined2 local_122;
  undefined2 local_120;
  undefined local_11e;
  byte local_11d;
  byte local_11c;
  char local_11b;
  undefined auStack_11a [254];
  short local_1c;
  undefined uStack_1a;
  undefined uStack_19;
  undefined uStack_18;
  undefined uStack_17;
  undefined uStack_16;
  undefined uStack_15;
  char local_14;
  undefined2 local_12;
  char *local_10;
  short local_c;
  char local_9;
  
  local_9 = 0;
  local_c = 0;
  BSA_TmGetHandleInit(&local_1c);
  iVar1 = FUN_0002f22c("Select transport 1:BR_EDR, 2:LE");
  local_14 = (char)iVar1;
  if ((local_14 == '\x01') || (local_14 == '\x02')) {
    if (param_1 == 0) {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_rssi",0xf1);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,
                       "Enter the BD address of remote connected device(AA.BB.CC.DD.EE.FF): ");
      }
      iVar1 = scanf("%hhx.%hhx.%hhx.%hhx.%hhx.%hhx",&uStack_1a,&uStack_19,&uStack_18,&uStack_17,
                    &uStack_16,&uStack_15);
      if (iVar1 != 6) {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_read_rssi",0xf8);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1a4,"BD address not entered correctly");
        }
        return 0xffffffff;
      }
    }
    else {
      bdcpy(&uStack_1a,param_1);
    }
    BSA_TmGetHandle(&local_1c);
    if (local_1c == 0) {
      BSA_TmHciInit(&local_124);
      local_124 = 0x1405;
      local_122 = 2;
      local_11e = 1;
      local_11d = (byte)local_12;
      local_10 = &local_11b;
      local_11c = (byte)((ushort)local_12 >> 8);
      BSA_TmHciCmd(&local_124);
      local_c = (ushort)local_11c * 0x100 + (ushort)local_11d;
      local_9 = local_11b;
      local_10 = auStack_11a;
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_rssi",0x119);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"\tStatus:\t\t\t%d",local_120);
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_rssi",0x11a);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"\tHandle:\t\t\t%d",local_c);
      }
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_rssi",0x11b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"\tRSSI:\t\t\t%d (dB)",(int)local_9);
      }
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_1a4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_rssi",0x104);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_1a4,"\tBad parameter (err=%d)",local_1c);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_rssi",0xec);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a4,"Wrong Transport value:%d",local_14);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0005563e(char param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_308 [128];
  char local_288;
  char local_287;
  char local_286;
  char acStack_284 [4];
  undefined2 auStack_280 [2];
  char acStack_27c [412];
  char acStack_e0 [2];
  undefined2 auStack_de [4];
  char acStack_d6 [184];
  short local_1e;
  int local_1c;
  
  local_1e = BSA_TmGetMemUsageInit(&local_288);
  local_288 = param_1;
  local_1e = BSA_TmGetMemUsage(&local_288);
  if (local_1e == 0) {
    if (param_1 == '\0') {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x13f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"BSA Server\'s task info");
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x143);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"BSA Client\'s task info");
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_get_mem_usage",0x146);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"%6s%20s%10s%10s%10s","TaskId","TaskName","TaskState",
                     "StackSize","StackUsed");
    }
    for (local_1c = 0; local_1c < 0xf; local_1c = local_1c + 1) {
      if (acStack_284[local_1c * 0x1c] != '\0') {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_get_mem_usage",0x150);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_308,"%6d%20s%10d%10d%10d",acStack_284[local_1c * 0x1c + 1],
                         acStack_284 + local_1c * 0x1c + 8,acStack_284[local_1c * 0x1c + 2],
                         *(undefined2 *)(acStack_284 + local_1c * 0x1c + 4),
                         *(undefined2 *)(acStack_284 + local_1c * 0x1c + 6));
        }
      }
    }
    if (local_287 != '\0') {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x155);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"One or several Server task info are missing");
      }
    }
    if (param_1 == '\0') {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x15b);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"BSA Server\'s GKI Buffer info:");
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x15f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,3,auStack_308,"BSA Client\'s GKI Buffer info:");
      }
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_get_mem_usage",0x161);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_308,"PoolId BufferSize NbBuffer CurUsed MaxUsed");
    }
    for (local_1c = 0; local_1c < 0xf; local_1c = local_1c + 1) {
      if (acStack_e0[local_1c * 0xc] != '\0') {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_308,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_get_mem_usage",0x16b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_308,"%6d%11d%9d%8d%8d",acStack_e0[local_1c * 0xc + 10],
                         *(undefined2 *)(acStack_e0 + local_1c * 0xc + 2),
                         *(undefined2 *)(acStack_e0 + local_1c * 0xc + 4),
                         *(undefined2 *)(acStack_e0 + local_1c * 0xc + 6),
                         *(undefined2 *)(acStack_e0 + local_1c * 0xc + 8));
        }
      }
    }
    if (local_286 != '\0') {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_get_mem_usage",0x170);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_308,"One or several Server GKI Buffer Pool info are missing");
      }
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_308,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_get_mem_usage",0x138);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_308,"BSA_TmGetMemUsage failed status:%d",local_1e);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00055b38(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [128];
  undefined auStack_c [2];
  short local_a;
  
  local_a = BSA_TmPingInit(auStack_c);
  local_a = BSA_TmPing(auStack_c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_ping",0x18d);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"BSA_TmPing failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00055bba(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_190 [128];
  undefined2 local_110;
  undefined2 local_10e;
  undefined auStack_10a [256];
  short local_a;
  
  local_a = BSA_TmVscInit(&local_110);
  local_110 = 1;
  local_10e = 6;
  memset(auStack_10a,0x55,6);
  local_a = BSA_TmVsc(&local_110);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_190,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_vsc",0x1ab);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_190,"BSA_TmVsc failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00055c5e(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_18c [128];
  undefined local_10c [258];
  short local_a;
  
  BSA_TmSetTraceLevelInit(local_10c);
  if ((param_1 < 0) || (6 < param_1)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_18c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_trace",0x1d2);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_18c,"app_tm_set_trace bad trace level:%d",param_1);
    }
    uVar2 = 0xffffffff;
  }
  else {
    local_10c[0] = (undefined)param_1;
    local_a = BSA_TmSetTraceLevel(local_10c);
    if (local_a == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_18c,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_set_trace",0x1da);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_18c,"BSA_TmSetTraceLevel failed status:%d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



undefined4 FUN_00055d4e(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_18c [128];
  undefined uStack_10c;
  char acStack_10b [257];
  short local_a;
  
  BSA_TmSetTraceTextInit(&uStack_10c);
  strncpy(acStack_10b,param_1,0xff);
  local_a = BSA_TmSetTraceText(&uStack_10c);
  if (local_a == 0) {
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_18c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_add_trace_text",0x1f6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_18c,"BSA_TmSetTraceLevel failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00055de4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_cc [128];
  undefined2 local_4c;
  undefined local_4a;
  undefined local_49;
  undefined local_48;
  undefined2 local_46;
  undefined auStack_44 [50];
  short local_12;
  
  local_12 = BSA_TmReadVersionInit(&local_4c);
  local_12 = BSA_TmReadVersion(&local_4c);
  if (local_12 == 0) {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_version",0x216);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"Server status:%d",local_4c);
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_version",0x21b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"FW Version:%d.%d.%d.%d",local_4a,local_49,local_48,local_46)
      ;
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_version",0x21c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_cc,"BSA Server Version:%s",auStack_44);
    }
    uVar2 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_cc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_version",0x212);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_cc,"BSA_TmReadVersion failed status:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00055f4c(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_1a0 [128];
  undefined2 local_120;
  undefined2 local_11e;
  char local_11a;
  undefined local_119;
  undefined local_118;
  undefined local_117;
  undefined local_116;
  undefined auStack_115 [253];
  undefined *local_18;
  short local_12;
  int local_10;
  int local_c;
  
  local_c = FUN_0002f22c("Enter the address to read at");
  local_10 = FUN_0002f22c("Enter the length to read");
  local_12 = BSA_TmVscInit(&local_120);
  local_120 = 0x4d;
  local_11e = 5;
  local_11a = (char)local_c;
  local_119 = (undefined)((uint)local_c >> 8);
  local_118 = (undefined)((uint)local_c >> 0x10);
  local_117 = (undefined)((uint)local_c >> 0x18);
  local_18 = auStack_115;
  local_116 = (undefined)local_10;
  local_12 = BSA_TmVsc(&local_120);
  if (local_12 == 0) {
    if (local_11a == '\0') {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_ram",0x248);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1a0,"VSC command returned failure: %d",local_11a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1a0,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_ram",0x241);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1a0,"BSA_TmVsc failed status:%d",local_12);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_000560c4(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_2d4 [128];
  char *local_254 [4];
  char *local_244;
  char *pcStack_240;
  undefined2 local_23c;
  undefined2 local_23a;
  char local_236;
  byte local_235 [4];
  undefined auStack_231 [253];
  undefined2 local_134;
  undefined2 local_132;
  char local_12e;
  byte local_12d [4];
  undefined auStack_129 [251];
  ushort local_2e;
  byte local_2b;
  short local_2a;
  undefined *local_28;
  int local_24;
  int local_20;
  byte *local_1c;
  
  local_24 = 0xe0;
  local_254[0] = "new";
  local_254[1] = "noconn";
  local_254[2] = "lmpsent";
  local_254[3] = "lmpack";
  local_244 = "l2capsent";
  pcStack_240 = "zlpsent";
  local_28 = &DAT_0008297c;
  local_2a = BSA_TmVscInit(&local_134);
  local_134 = 0x4d;
  local_132 = 5;
  local_12e = (char)local_28;
  local_12d[0] = (byte)((uint)local_28 >> 8);
  local_12d[1] = (byte)((uint)local_28 >> 0x10);
  local_12d[2] = (byte)((uint)local_28 >> 0x18);
  local_1c = auStack_129;
  local_12d[3] = (byte)local_24;
  local_2a = BSA_TmVsc(&local_134);
  if (local_2a == 0) {
    if (local_12e == '\0') {
      local_2a = BSA_TmVscInit(&local_23c);
      local_23c = 0x4d;
      local_23a = 5;
      local_235[3] = (byte)local_24;
      local_236 = local_235[3] + (char)local_28;
      local_235[0] = (byte)((uint)(local_28 + local_24) >> 8);
      local_235[1] = (byte)((uint)(local_28 + local_24) >> 0x10);
      local_235[2] = (byte)((uint)(local_28 + local_24) >> 0x18);
      local_1c = auStack_231;
      local_2a = BSA_TmVsc(&local_23c);
      if (local_2a == 0) {
        if (local_236 == '\0') {
          local_2a = 0;
          for (local_20 = 0; local_20 < 0xd; local_20 = local_20 + 1) {
            if (local_20 < 7) {
              local_1c = local_12d + local_20 * 0x20;
            }
            else {
              local_1c = local_235 + (local_20 + -7) * 0x20;
            }
            local_2b = local_1c[0x1f];
            if (local_2b != 1) {
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2a4);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,"ch %d -> %s",local_20,local_254[local_2b]);
              }
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2a6);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,
                               "  hs = x%08x, he = x%08x, ll = x%08x, lfl = x%08x",
                               (uint)local_1c[3] * 0x1000000 +
                               (uint)*local_1c + (uint)local_1c[1] * 0x100 +
                               (uint)local_1c[2] * 0x10000,
                               (uint)local_1c[7] * 0x1000000 +
                               (uint)local_1c[4] + (uint)local_1c[5] * 0x100 +
                               (uint)local_1c[6] * 0x10000,
                               (uint)local_1c[0xb] * 0x1000000 +
                               (uint)local_1c[8] + (uint)local_1c[9] * 0x100 +
                               (uint)local_1c[10] * 0x10000,
                               (uint)local_1c[0xf] * 0x1000000 +
                               (uint)local_1c[0xc] + (uint)local_1c[0xd] * 0x100 +
                               (uint)local_1c[0xe] * 0x10000);
              }
              local_1c = local_1c + 0x10;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2a9);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,"  fasttrack = %d, start_time = x%08x",*local_1c,
                               (uint)local_1c[7] * 0x1000000 +
                               (uint)local_1c[4] + (uint)local_1c[5] * 0x100 +
                               (uint)local_1c[6] * 0x10000);
              }
              local_1c = local_1c + 8;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2ac);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,"  flush_mode = %d, flush_state = %d",*local_1c,
                               local_1c[1]);
              }
              local_1c = local_1c + 2;
              local_2b = *local_1c;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2af);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,"  pktArrIndex = %d, pktDecIndex = %d",
                               local_2b & 0xf,local_2b >> 4);
              }
              local_1c = local_1c + 1;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2b1);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,"  hostCredits = %d, NumBufOnList = %d",*local_1c,
                               *local_1c);
              }
              local_2e = (ushort)local_1c[3] * 0x100 + (ushort)local_1c[2];
              local_1c = local_1c + 2;
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2b4);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,
                               "v=x%04x -> txstate = %d, l2cflowl = %d, l2cflowp = %d",local_2e,
                               local_2e & 7,local_2e >> 3 & 1,local_2e >> 4 & 1);
              }
              iVar1 = duss_log_gen_head(0x5c,3,auStack_2d4,0x80,
                                        "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                        ,"app_tm_read_conn",0x2b6);
              if (iVar1 != 0) {
                duss_log_print(0x5c,3,auStack_2d4,
                               "v=x%04x -> rxstate = %d, l2cflow  = %d, l2cflowc = %d, l2crel = %d, zlpsent = %d"
                               ,local_2e,local_2e >> 5 & 7,local_2e >> 8 & 1,local_2e >> 9 & 1,
                               local_2e >> 10 & 1,local_2e >> 0xb & 1);
              }
            }
          }
          uVar2 = 0;
        }
        else {
          iVar1 = duss_log_gen_head(0x5c,1,auStack_2d4,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                    ,"app_tm_read_conn",0x292);
          if (iVar1 != 0) {
            duss_log_print(0x5c,1,auStack_2d4,"VSC command returned failure: %d",local_236);
          }
          uVar2 = 0xffffffff;
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_2d4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_read_conn",0x28b);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_2d4,"BSA_TmVsc failed status:%d",local_2a);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_2d4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_conn",0x27e);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_2d4,"VSC command returned failure: %d",local_12e);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_2d4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_conn",0x277);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_2d4,"BSA_TmVsc failed status:%d",local_2a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_0005681a(void)

{
  undefined2 uVar1;
  int iVar2;
  undefined auStack_1b8 [128];
  byte local_138 [8];
  undefined2 local_130;
  undefined2 local_12e;
  char local_12a;
  byte local_129;
  undefined local_128;
  undefined local_127;
  undefined local_126;
  undefined auStack_125 [253];
  undefined *local_28;
  short local_22;
  int local_20;
  int local_1c;
  
  local_1c = -0x3fc1000;
  local_20 = 0;
  uVar1 = local_22;
  do {
    local_22 = uVar1;
    local_22 = BSA_TmVscInit(&local_130);
    local_130 = 10;
    local_12e = 5;
    local_12a = '\x04';
    local_129 = (byte)local_1c;
    local_128 = (undefined)((uint)local_1c >> 8);
    local_127 = (undefined)((uint)local_1c >> 0x10);
    local_28 = auStack_125;
    local_126 = (undefined)((uint)local_1c >> 0x18);
    local_22 = BSA_TmVsc(&local_130);
    if (local_22 != 0) {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_1b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_flash_bd_addr",0x2e1);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_1b8,"BSA_TmVsc failed status:%d",local_22);
      }
      return 0xffffffff;
    }
    if (local_12a != '\0') {
      iVar2 = duss_log_gen_head(0x5c,1,auStack_1b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_flash_bd_addr",0x2e8);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_1b8,"VSC command returned failure: %d",local_12a);
      }
      return 0xffffffff;
    }
    switch(local_20) {
    case 0:
      if (local_129 == 1) {
        local_20 = 2;
        local_1c = local_1c + 1;
      }
      else if (local_1c == -0x3f82000) {
        local_1c = -0x3f81000;
      }
      else {
        if (local_1c == -0x3f81000) {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_1b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                    ,"app_tm_read_flash_bd_addr",0x302);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_1b8,"Could not find valid SS location");
          }
          return 0xffffffff;
        }
        if (local_1c != -0x3fc1000) {
          iVar2 = duss_log_gen_head(0x5c,1,auStack_1b8,0x80,
                                    "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                    ,"app_tm_read_flash_bd_addr",0x306);
          if (iVar2 != 0) {
            duss_log_print(0x5c,1,auStack_1b8,"unexpected addr 0x%08X",local_1c);
          }
          return 0xffffffff;
        }
        local_1c = -0x3f82000;
      }
      break;
    case 1:
      if (local_129 == 0x40) {
        local_20 = 3;
        local_1c = local_1c + 3;
      }
      else {
        local_20 = 2;
        local_1c = local_1c + 1;
      }
      break;
    case 2:
      local_20 = 1;
      local_1c = local_1c + (uint)local_129 + 2;
      break;
    case 3:
    case 4:
    case 5:
    case 6:
    case 7:
    case 8:
      auStack_1b8[0x88 - local_20] = local_129;
      local_20 = local_20 + 1;
      local_1c = local_1c + 1;
      break;
    default:
      iVar2 = duss_log_gen_head(0x5c,1,auStack_1b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_flash_bd_addr",0x32c);
      if (iVar2 != 0) {
        duss_log_print(0x5c,1,auStack_1b8,"unexpected state %d",local_20);
      }
      return 0xffffffff;
    }
    uVar1 = 0;
    if (local_20 == 9) {
      iVar2 = duss_log_gen_head(0x5c,3,auStack_1b8,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_flash_bd_addr",0x335);
      if (iVar2 != 0) {
        duss_log_print(0x5c,3,auStack_1b8,"Flash BD address: %02X-%02X-%02X-%02X-%02X-%02X",
                       local_138[0],local_138[1],local_138[2],local_138[3],local_138[4],local_138[5]
                      );
      }
      return 0;
    }
  } while( true );
}



undefined4 FUN_00056be0(int param_1)

{
  int iVar1;
  byte *pbVar2;
  char *pcVar3;
  undefined auStack_1b4 [128];
  undefined local_134;
  undefined local_133;
  undefined local_132;
  undefined local_131;
  undefined local_130;
  char local_12f [3];
  undefined2 local_12c;
  undefined2 local_12a;
  char local_126;
  char local_125;
  char local_124;
  undefined local_123;
  undefined local_122;
  undefined auStack_121 [251];
  short local_26;
  undefined4 local_24;
  int local_20;
  char *local_1c;
  
  local_20 = 100;
  local_24 = 0xff000000;
  local_26 = BSA_TmVscInit(&local_12c);
  local_12c = 0x4d;
  local_12a = 5;
  local_126 = (char)local_24;
  local_125 = (char)((uint)local_24 >> 8);
  local_124 = (char)((uint)local_24 >> 0x10);
  local_123 = (undefined)((uint)local_24 >> 0x18);
  local_1c = auStack_121;
  local_122 = (undefined)local_20;
  local_26 = BSA_TmVsc(&local_12c);
  if (local_26 == 0) {
    if (local_126 == '\0') {
      local_1c = &local_125;
      local_20 = local_20 + -1;
      if ((local_125 == '\x01') && (local_124 == '\b')) {
        for (; local_20 != 0; local_20 = (local_20 - (uint)*pbVar2) + -3) {
          if ((*local_1c == '@') && (local_1c[1] == '\x06')) {
            pcVar3 = local_12f;
            local_1c = local_1c + 3;
            for (iVar1 = 0; iVar1 < 6; iVar1 = iVar1 + 1) {
              *pcVar3 = *local_1c;
              pcVar3 = pcVar3 + -1;
              local_1c = local_1c + 1;
            }
            iVar1 = duss_log_gen_head(0x5c,3,auStack_1b4,0x80,
                                      "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                      ,"app_tm_read_serial_flash_bd_addr",0x382);
            if (iVar1 != 0) {
              duss_log_print(0x5c,3,auStack_1b4,"Flash BD address: %02X-%02X-%02X-%02X-%02X-%02X",
                             local_134,local_133,local_132,local_131,local_130,local_12f[0]);
            }
            if (param_1 != 0) {
              bdcpy(param_1,&local_134);
            }
            return 0;
          }
          if (*local_1c == -1) break;
          pbVar2 = (byte *)(local_1c + 1);
          local_1c = local_1c + (byte)local_1c[1] + 3;
        }
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1b4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_read_serial_flash_bd_addr",0x397);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1b4,"BdAddr item not found");
        }
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_1b4,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_read_serial_flash_bd_addr",0x372);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_1b4,"IF_PLL item not found => this is not a Static Section")
          ;
        }
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_1b4,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_read_serial_flash_bd_addr",0x363);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_1b4,"VSC command returned failure: %d",local_126);
      }
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_1b4,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_read_serial_flash_bd_addr",0x35c);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_1b4,"BSA_TmVsc failed status:%d",local_26);
    }
  }
  return 0xffffffff;
}



undefined4 FUN_00056f20(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_98 [129];
  undefined local_17;
  undefined local_16;
  undefined local_15;
  undefined local_14;
  undefined local_13;
  undefined local_12;
  char local_11;
  
  local_12 = 0;
  local_13 = 0;
  local_14 = 0;
  local_15 = 0;
  local_16 = 0;
  local_17 = 0;
  iVar1 = FUN_0002f22c("Turn On(0) or Off(1)");
  local_11 = (char)iVar1;
  if (local_11 == '\0') {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3bb);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Enable selected");
    }
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3bd);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Frequency forced to:2(2402Mhz)");
    }
    local_12 = 2;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3c0);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Mode forced to:Unmodulated(0)");
    }
    local_13 = 0;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3c3);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Modulation (unused) set to:GFSK(0)");
    }
    local_14 = 0;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3c6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Transmit Power forced to:PowerTableIndex(0x09)");
    }
    local_15 = 9;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3c9);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Power dBm (unused) set to:0dBm");
    }
    local_16 = 0;
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3cc);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Power Table Index forced to:0");
    }
    local_17 = 0;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_98,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_set_tx_carrier_frequency_test",0x3b6);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_98,"Disable selected");
    }
    local_11 = '\x01';
  }
  uVar2 = FUN_0005209c(local_11,local_12,local_13,local_14,local_15,local_16,local_17);
  return uVar2;
}



undefined4 FUN_000571b4(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = BSA_TmLeTestCmd(param_1);
  return uVar1;
}



undefined4 FUN_000571cc(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_8c [131];
  byte local_9;
  
  local_9 = 0;
  iVar1 = FUN_0002f22c("Receive Frequency Encoded(2-80)");
  local_9 = (byte)iVar1;
  if ((local_9 < 2) || (0x50 < local_9)) {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_write_rcv_only",0x3ff);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_8c,"app_tm_vsc_write_rcv_only: Invalid parameter");
    }
    uVar2 = 0xffffffff;
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,3,auStack_8c,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_write_rcv_only",0x404);
    if (iVar1 != 0) {
      duss_log_print(0x5c,3,auStack_8c,"app_tm_vsc_write_rcv_only: frequency (%d)",local_9 + 0x960);
    }
    uVar2 = FUN_00053516(local_9);
  }
  return uVar2;
}



undefined4 FUN_0005729a(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_fc [128];
  undefined local_7c [2];
  undefined2 local_7a [3];
  byte local_74;
  undefined auStack_32 [34];
  uint local_10;
  short local_c;
  byte local_9;
  
  local_c = BSA_TmCoexOpInit(local_7c);
  if (local_c == 0) {
    local_7c[0] = 1;
    local_10 = FUN_0002f22c("ext_frame_duration(eg. 0x2710)");
    local_7a[0] = (undefined2)local_10;
    local_10 = FUN_0002f22c("ext_frame_sync_assert_offset(eg. 100)");
    local_7a[1] = (undefined2)local_10;
    local_10 = FUN_0002f22c("ext_frame_sync_assert_jitter(eg. 3)");
    local_7a[2] = 0;
    local_10 = FUN_0002f22c("ext_num_periods(eg. 1 ~ 32)");
    if (local_10 < 0x21) {
      local_74 = (byte)local_10;
      for (local_9 = 0; local_9 < local_74; local_9 = local_9 + 1) {
        iVar1 = duss_log_gen_head(0x5c,3,auStack_fc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_coex_set_ext_frame_config",0x435);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_fc,"duration array[%d]",local_9);
        }
        local_10 = FUN_0002f22c(&DAT_00071c6c);
        local_7a[local_9 + 4] = (short)local_10;
        iVar1 = duss_log_gen_head(0x5c,3,auStack_fc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_coex_set_ext_frame_config",0x438);
        if (iVar1 != 0) {
          duss_log_print(0x5c,3,auStack_fc,"type array[%d]",local_9);
        }
        local_10 = FUN_0002f22c(&DAT_00071c6c);
        auStack_32[local_9] = (char)local_10;
      }
      local_c = BSA_TmCoexOp(local_7c);
      if (local_c == 0) {
        uVar2 = 0;
      }
      else {
        iVar1 = duss_log_gen_head(0x5c,1,auStack_fc,0x80,
                                  "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                  ,"app_tm_coex_set_ext_frame_config",0x440);
        if (iVar1 != 0) {
          duss_log_print(0x5c,1,auStack_fc,"BSA_TmCoexOp failed status:%d",local_c);
        }
        uVar2 = 0xffffffff;
      }
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_fc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_coex_set_ext_frame_config",0x42f);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_fc,"invalid parameter:%d",local_10);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_fc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_coex_set_ext_frame_config",0x421);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_fc,"BSA_TmCoexOp failed status:%d",local_c);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



undefined4 FUN_00057528(void)

{
  int iVar1;
  undefined4 uVar2;
  undefined auStack_fc [128];
  undefined local_7c [2];
  undefined local_7a;
  undefined2 local_78;
  undefined2 local_76;
  undefined2 local_74;
  undefined2 local_72;
  undefined local_70;
  int local_10;
  short local_a;
  
  local_a = BSA_TmCoexOpInit(local_7c);
  if (local_a == 0) {
    local_7c[0] = 0;
    local_10 = FUN_0002f22c("channel_enable(eg. 1)");
    local_7a = (undefined)local_10;
    local_10 = FUN_0002f22c("rx_center_frequency(eg. 0)");
    local_78 = (undefined2)local_10;
    local_10 = FUN_0002f22c("tx_center_frequency(eg. 0)");
    local_76 = (undefined2)local_10;
    local_10 = FUN_0002f22c("rx_channel_bandwidth(eg. 0)");
    local_74 = (undefined2)local_10;
    local_10 = FUN_0002f22c("tx_channel_bandwidth(eg. 0)");
    local_72 = (undefined2)local_10;
    local_10 = FUN_0002f22c("channel_type(eg. 0)");
    local_70 = (undefined)local_10;
    local_a = BSA_TmCoexOp(local_7c);
    if (local_a == 0) {
      uVar2 = 0;
    }
    else {
      iVar1 = duss_log_gen_head(0x5c,1,auStack_fc,0x80,
                                "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                                ,"app_tm_coex_set_mws_channel_param",0x470);
      if (iVar1 != 0) {
        duss_log_print(0x5c,1,auStack_fc,"BSA_TmCoexOp failed status:%d",local_a);
      }
      uVar2 = 0xffffffff;
    }
  }
  else {
    iVar1 = duss_log_gen_head(0x5c,1,auStack_fc,0x80,
                              "/home/sam.huang/h22_wm161/wm161_wms/dji_network/build/WM161/../..//bt/cypress43455/amba_new/app_tm/source/app_tm.c"
                              ,"app_tm_coex_set_mws_channel_param",0x45b);
    if (iVar1 != 0) {
      duss_log_print(0x5c,1,auStack_fc,"BSA_TmCoexOp failed status:%d",local_a);
    }
    uVar2 = 0xffffffff;
  }
  return uVar2;
}



ulonglong FUN_000576ac(uint param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  
  if (param_2 - 1 == 0) {
    return CONCAT44(param_2,param_1);
  }
  if (param_2 == 0) {
    uVar1 = raise(8);
    return (ulonglong)uVar1;
  }
  if (param_1 <= param_2) {
    return CONCAT44(param_2,(uint)(param_1 == param_2));
  }
  if ((param_2 & param_2 - 1) == 0) {
    return CONCAT44(param_2,param_1 >> (0x1fU - LZCOUNT(param_2) & 0xff));
  }
  uVar1 = param_2 << (LZCOUNT(param_2) - LZCOUNT(param_1) & 0xffU);
  uVar3 = 1 << (LZCOUNT(param_2) - LZCOUNT(param_1) & 0xffU);
  uVar2 = 0;
  while( true ) {
    if (uVar1 <= param_1) {
      param_1 = param_1 - uVar1;
      uVar2 = uVar2 | uVar3;
    }
    bVar4 = uVar1 >> 1 <= param_1;
    if (bVar4) {
      param_1 = param_1 - (uVar1 >> 1);
    }
    if (bVar4) {
      uVar2 = uVar2 | uVar3 >> 1;
    }
    bVar4 = uVar1 >> 2 <= param_1;
    if (bVar4) {
      param_1 = param_1 - (uVar1 >> 2);
    }
    if (bVar4) {
      uVar2 = uVar2 | uVar3 >> 2;
    }
    bVar4 = uVar1 >> 3 <= param_1;
    if (bVar4) {
      param_1 = param_1 - (uVar1 >> 3);
    }
    if (bVar4) {
      uVar2 = uVar2 | uVar3 >> 3;
    }
    bVar4 = param_1 == 0;
    if (!bVar4) {
      uVar3 = uVar3 >> 4;
      bVar4 = uVar3 == 0;
    }
    if (bVar4) break;
    uVar1 = uVar1 >> 4;
  }
  return CONCAT44(uVar1,uVar2);
}



undefined4 _fini(undefined4 param_1)

{
  return param_1;
}


